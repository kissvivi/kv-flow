{"version":3,"file":"flow_static/js/app.ba5b2a5b.js","mappings":"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","sources":["webpack://kv-flow/./src/components/ef/jsplumb.js","webpack://kv-flow/./src/App.vue","webpack://kv-flow/./src/components/ef/panel.vue","webpack://kv-flow/./src/components/ef/mixins.js","webpack://kv-flow/./src/components/ef/node.vue","webpack://kv-flow/src/components/ef/node.vue","webpack://kv-flow/./src/components/ef/node.vue?17dd","webpack://kv-flow/./src/components/ef/node.vue?a0aa","webpack://kv-flow/./src/components/ef/node_menu.vue","webpack://kv-flow/./src/utils/http_request.js","webpack://kv-flow/./src/api/task_template.js","webpack://kv-flow/src/components/ef/node_menu.vue","webpack://kv-flow/./src/components/ef/node_menu.vue?c15f","webpack://kv-flow/./src/components/ef/node_menu.vue?7365","webpack://kv-flow/./src/components/ef/info.vue","webpack://kv-flow/src/components/ef/info.vue","webpack://kv-flow/./src/components/ef/info.vue?a103","webpack://kv-flow/./src/components/ef/info.vue?1536","webpack://kv-flow/./src/components/ef/help.vue","webpack://kv-flow/src/components/ef/help.vue","webpack://kv-flow/./src/components/ef/help.vue?2d26","webpack://kv-flow/./src/components/ef/help.vue?4d07","webpack://kv-flow/./src/components/ef/node_form.vue","webpack://kv-flow/src/components/ef/node_form.vue","webpack://kv-flow/./src/components/ef/node_form.vue?f31a","webpack://kv-flow/./src/components/ef/node_form.vue?bedc","webpack://kv-flow/./src/api/flow.js","webpack://kv-flow/./src/components/ef/data_A.js","webpack://kv-flow/./src/components/ef/data_B.js","webpack://kv-flow/./src/components/ef/data_C.js","webpack://kv-flow/./src/components/ef/data_D.js","webpack://kv-flow/./src/components/ef/data_E.js","webpack://kv-flow/./src/components/ef/force-directed.js","webpack://kv-flow/./src/components/ef/data_now.js","webpack://kv-flow/src/components/ef/panel.vue","webpack://kv-flow/./src/components/ef/panel.vue?af18","webpack://kv-flow/./src/components/ef/panel.vue?1cb3","webpack://kv-flow/src/App.vue","webpack://kv-flow/./src/App.vue?5a95","webpack://kv-flow/./src/App.vue?01fe","webpack://kv-flow/./src/main.js","webpack://kv-flow/webpack/bootstrap","webpack://kv-flow/webpack/runtime/chunk loaded","webpack://kv-flow/webpack/runtime/compat get default export","webpack://kv-flow/webpack/runtime/define property getters","webpack://kv-flow/webpack/runtime/global","webpack://kv-flow/webpack/runtime/hasOwnProperty shorthand","webpack://kv-flow/webpack/runtime/make namespace object","webpack://kv-flow/webpack/runtime/node module decorator","webpack://kv-flow/webpack/runtime/jsonp chunk loading","webpack://kv-flow/webpack/startup"],"sourcesContent":["/**\r\n * jsBezier\r\n *\r\n * Copyright (c) 2010 - 2017 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * licensed under the MIT license.\r\n *\r\n * a set of Bezier curve functions that deal with Beziers, used by jsPlumb, and perhaps useful for other people.  These functions work with Bezier\r\n * curves of arbitrary degree.\r\n *\r\n * - functions are all in the 'jsBezier' namespace.\r\n *\r\n * - all input points should be in the format {x:.., y:..}. all output points are in this format too.\r\n *\r\n * - all input curves should be in the format [ {x:.., y:..}, {x:.., y:..}, {x:.., y:..}, {x:.., y:..} ]\r\n *\r\n * - 'location' as used as an input here refers to a decimal in the range 0-1 inclusive, which indicates a point some proportion along the length\r\n * of the curve.  location as output has the same format and meaning.\r\n *\r\n *\r\n * Function List:\r\n * --------------\r\n *\r\n * distanceFromCurve(point, curve)\r\n *\r\n * \tCalculates the distance that the given point lies from the given Bezier.  Note that it is computed relative to the center of the Bezier,\r\n * so if you have stroked the curve with a wide pen you may wish to take that into account!  The distance returned is relative to the values\r\n * of the curve and the point - it will most likely be pixels.\r\n *\r\n * gradientAtPoint(curve, location)\r\n *\r\n * \tCalculates the gradient to the curve at the given location, as a decimal between 0 and 1 inclusive.\r\n *\r\n * gradientAtPointAlongCurveFrom (curve, location)\r\n *\r\n *\tCalculates the gradient at the point on the given curve that is 'distance' units from location.\r\n *\r\n * nearestPointOnCurve(point, curve)\r\n *\r\n *\tCalculates the nearest point to the given point on the given curve.  The return value of this is a JS object literal, containing both the\r\n *point's coordinates and also the 'location' of the point (see above), for example:  { point:{x:551,y:150}, location:0.263365 }.\r\n *\r\n * pointOnCurve(curve, location)\r\n *\r\n * \tCalculates the coordinates of the point on the given Bezier curve at the given location.\r\n *\r\n * pointAlongCurveFrom(curve, location, distance)\r\n *\r\n * \tCalculates the coordinates of the point on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\r\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\r\n *\r\n * locationAlongCurveFrom(curve, location, distance)\r\n *\r\n * \tCalculates the location on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\r\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\r\n *\r\n * perpendicularToCurveAt(curve, location, length, distance)\r\n *\r\n * \tCalculates the perpendicular to the given curve at the given location.  length is the length of the line you wish for (it will be centered\r\n * on the point at 'location'). distance is optional, and allows you to specify a point along the path from the given location as the center of\r\n * the perpendicular returned.  The return value of this is an array of two points: [ {x:...,y:...}, {x:...,y:...} ].\r\n *\r\n *\r\n */\r\n\r\n(function() {\r\n\r\n    var root = this;\r\n\r\n    if(typeof Math.sgn == \"undefined\") {\r\n        Math.sgn = function(x) { return x == 0 ? 0 : x > 0 ? 1 :-1; };\r\n    }\r\n\r\n    var Vectors = {\r\n            subtract \t: \tfunction(v1, v2) { return {x:v1.x - v2.x, y:v1.y - v2.y }; },\r\n            dotProduct\t: \tfunction(v1, v2) { return (v1.x * v2.x)  + (v1.y * v2.y); },\r\n            square\t\t:\tfunction(v) { return Math.sqrt((v.x * v.x) + (v.y * v.y)); },\r\n            scale\t\t:\tfunction(v, s) { return {x:v.x * s, y:v.y * s }; }\r\n        },\r\n\r\n        maxRecursion = 64,\r\n        flatnessTolerance = Math.pow(2.0,-maxRecursion-1);\r\n\r\n    /**\r\n     * Calculates the distance that the point lies from the curve.\r\n     *\r\n     * @param point a point in the form {x:567, y:3342}\r\n     * @param curve a Bezier curve in the form [{x:..., y:...}, {x:..., y:...}, {x:..., y:...}, {x:..., y:...}].  note that this is currently\r\n     * hardcoded to assume cubiz beziers, but would be better off supporting any degree.\r\n     * @return a JS object literal containing location and distance, for example: {location:0.35, distance:10}.  Location is analogous to the location\r\n     * argument you pass to the pointOnPath function: it is a ratio of distance travelled along the curve.  Distance is the distance in pixels from\r\n     * the point to the curve.\r\n     */\r\n    var _distanceFromCurve = function(point, curve) {\r\n        var candidates = [],\r\n            w = _convertToBezier(point, curve),\r\n            degree = curve.length - 1, higherDegree = (2 * degree) - 1,\r\n            numSolutions = _findRoots(w, higherDegree, candidates, 0),\r\n            v = Vectors.subtract(point, curve[0]), dist = Vectors.square(v), t = 0.0;\r\n\r\n        for (var i = 0; i < numSolutions; i++) {\r\n            v = Vectors.subtract(point, _bezier(curve, degree, candidates[i], null, null));\r\n            var newDist = Vectors.square(v);\r\n            if (newDist < dist) {\r\n                dist = newDist;\r\n                t = candidates[i];\r\n            }\r\n        }\r\n        v = Vectors.subtract(point, curve[degree]);\r\n        newDist = Vectors.square(v);\r\n        if (newDist < dist) {\r\n            dist = newDist;\r\n            t = 1.0;\r\n        }\r\n        return {location:t, distance:dist};\r\n    };\r\n    /**\r\n     * finds the nearest point on the curve to the given point.\r\n     */\r\n    var _nearestPointOnCurve = function(point, curve) {\r\n        var td = _distanceFromCurve(point, curve);\r\n        return {point:_bezier(curve, curve.length - 1, td.location, null, null), location:td.location};\r\n    };\r\n    var _convertToBezier = function(point, curve) {\r\n        var degree = curve.length - 1, higherDegree = (2 * degree) - 1,\r\n            c = [], d = [], cdTable = [], w = [],\r\n            z = [ [1.0, 0.6, 0.3, 0.1], [0.4, 0.6, 0.6, 0.4], [0.1, 0.3, 0.6, 1.0] ];\r\n\r\n        for (var i = 0; i <= degree; i++) c[i] = Vectors.subtract(curve[i], point);\r\n        for (var i = 0; i <= degree - 1; i++) {\r\n            d[i] = Vectors.subtract(curve[i+1], curve[i]);\r\n            d[i] = Vectors.scale(d[i], 3.0);\r\n        }\r\n        for (var row = 0; row <= degree - 1; row++) {\r\n            for (var column = 0; column <= degree; column++) {\r\n                if (!cdTable[row]) cdTable[row] = [];\r\n                cdTable[row][column] = Vectors.dotProduct(d[row], c[column]);\r\n            }\r\n        }\r\n        for (i = 0; i <= higherDegree; i++) {\r\n            if (!w[i]) w[i] = [];\r\n            w[i].y = 0.0;\r\n            w[i].x = parseFloat(i) / higherDegree;\r\n        }\r\n        var n = degree, m = degree-1;\r\n        for (var k = 0; k <= n + m; k++) {\r\n            var lb = Math.max(0, k - m),\r\n                ub = Math.min(k, n);\r\n            for (i = lb; i <= ub; i++) {\r\n                var j = k - i;\r\n                w[i+j].y += cdTable[j][i] * z[j][i];\r\n            }\r\n        }\r\n        return w;\r\n    };\r\n    /**\r\n     * counts how many roots there are.\r\n     */\r\n    var _findRoots = function(w, degree, t, depth) {\r\n        var left = [], right = [],\r\n            left_count, right_count,\r\n            left_t = [], right_t = [];\r\n\r\n        switch (_getCrossingCount(w, degree)) {\r\n            case 0 : {\r\n                return 0;\r\n            }\r\n            case 1 : {\r\n                if (depth >= maxRecursion) {\r\n                    t[0] = (w[0].x + w[degree].x) / 2.0;\r\n                    return 1;\r\n                }\r\n                if (_isFlatEnough(w, degree)) {\r\n                    t[0] = _computeXIntercept(w, degree);\r\n                    return 1;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        _bezier(w, degree, 0.5, left, right);\r\n        left_count  = _findRoots(left,  degree, left_t, depth+1);\r\n        right_count = _findRoots(right, degree, right_t, depth+1);\r\n        for (var i = 0; i < left_count; i++) t[i] = left_t[i];\r\n        for (var i = 0; i < right_count; i++) t[i+left_count] = right_t[i];\r\n        return (left_count+right_count);\r\n    };\r\n    var _getCrossingCount = function(curve, degree) {\r\n        var n_crossings = 0, sign, old_sign;\r\n        sign = old_sign = Math.sgn(curve[0].y);\r\n        for (var i = 1; i <= degree; i++) {\r\n            sign = Math.sgn(curve[i].y);\r\n            if (sign != old_sign) n_crossings++;\r\n            old_sign = sign;\r\n        }\r\n        return n_crossings;\r\n    };\r\n    var _isFlatEnough = function(curve, degree) {\r\n        var  error,\r\n            intercept_1, intercept_2, left_intercept, right_intercept,\r\n            a, b, c, det, dInv, a1, b1, c1, a2, b2, c2;\r\n        a = curve[0].y - curve[degree].y;\r\n        b = curve[degree].x - curve[0].x;\r\n        c = curve[0].x * curve[degree].y - curve[degree].x * curve[0].y;\r\n\r\n        var max_distance_above, max_distance_below;\r\n        max_distance_above = max_distance_below = 0.0;\r\n\r\n        for (var i = 1; i < degree; i++) {\r\n            var value = a * curve[i].x + b * curve[i].y + c;\r\n            if (value > max_distance_above)\r\n                max_distance_above = value;\r\n            else if (value < max_distance_below)\r\n                max_distance_below = value;\r\n        }\r\n\r\n        a1 = 0.0; b1 = 1.0; c1 = 0.0; a2 = a; b2 = b;\r\n        c2 = c - max_distance_above;\r\n        det = a1 * b2 - a2 * b1;\r\n        dInv = 1.0/det;\r\n        intercept_1 = (b1 * c2 - b2 * c1) * dInv;\r\n        a2 = a; b2 = b; c2 = c - max_distance_below;\r\n        det = a1 * b2 - a2 * b1;\r\n        dInv = 1.0/det;\r\n        intercept_2 = (b1 * c2 - b2 * c1) * dInv;\r\n        left_intercept = Math.min(intercept_1, intercept_2);\r\n        right_intercept = Math.max(intercept_1, intercept_2);\r\n        error = right_intercept - left_intercept;\r\n        return (error < flatnessTolerance)? 1 : 0;\r\n    };\r\n    var _computeXIntercept = function(curve, degree) {\r\n        var XLK = 1.0, YLK = 0.0,\r\n            XNM = curve[degree].x - curve[0].x, YNM = curve[degree].y - curve[0].y,\r\n            XMK = curve[0].x - 0.0, YMK = curve[0].y - 0.0,\r\n            det = XNM*YLK - YNM*XLK, detInv = 1.0/det,\r\n            S = (XNM*YMK - YNM*XMK) * detInv;\r\n        return 0.0 + XLK * S;\r\n    };\r\n    var _bezier = function(curve, degree, t, left, right) {\r\n        var temp = [[]];\r\n        for (var j =0; j <= degree; j++) temp[0][j] = curve[j];\r\n        for (var i = 1; i <= degree; i++) {\r\n            for (var j =0 ; j <= degree - i; j++) {\r\n                if (!temp[i]) temp[i] = [];\r\n                if (!temp[i][j]) temp[i][j] = {};\r\n                temp[i][j].x = (1.0 - t) * temp[i-1][j].x + t * temp[i-1][j+1].x;\r\n                temp[i][j].y = (1.0 - t) * temp[i-1][j].y + t * temp[i-1][j+1].y;\r\n            }\r\n        }\r\n        if (left != null)\r\n            for (j = 0; j <= degree; j++) left[j]  = temp[j][0];\r\n        if (right != null)\r\n            for (j = 0; j <= degree; j++) right[j] = temp[degree-j][j];\r\n\r\n        return (temp[degree][0]);\r\n    };\r\n\r\n    var _curveFunctionCache = {};\r\n    var _getCurveFunctions = function(order) {\r\n        var fns = _curveFunctionCache[order];\r\n        if (!fns) {\r\n            fns = [];\r\n            var f_term = function() { return function(t) { return Math.pow(t, order); }; },\r\n                l_term = function() { return function(t) { return Math.pow((1-t), order); }; },\r\n                c_term = function(c) { return function(t) { return c; }; },\r\n                t_term = function() { return function(t) { return t; }; },\r\n                one_minus_t_term = function() { return function(t) { return 1-t; }; },\r\n                _termFunc = function(terms) {\r\n                    return function(t) {\r\n                        var p = 1;\r\n                        for (var i = 0; i < terms.length; i++) p = p * terms[i](t);\r\n                        return p;\r\n                    };\r\n                };\r\n\r\n            fns.push(new f_term());  // first is t to the power of the curve order\r\n            for (var i = 1; i < order; i++) {\r\n                var terms = [new c_term(order)];\r\n                for (var j = 0 ; j < (order - i); j++) terms.push(new t_term());\r\n                for (var j = 0 ; j < i; j++) terms.push(new one_minus_t_term());\r\n                fns.push(new _termFunc(terms));\r\n            }\r\n            fns.push(new l_term());  // last is (1-t) to the power of the curve order\r\n\r\n            _curveFunctionCache[order] = fns;\r\n        }\r\n\r\n        return fns;\r\n    };\r\n\r\n\r\n    /**\r\n     * calculates a point on the curve, for a Bezier of arbitrary order.\r\n     * @param curve an array of control points, eg [{x:10,y:20}, {x:50,y:50}, {x:100,y:100}, {x:120,y:100}].  For a cubic bezier this should have four points.\r\n     * @param location a decimal indicating the distance along the curve the point should be located at.  this is the distance along the curve as it travels, taking the way it bends into account.  should be a number from 0 to 1, inclusive.\r\n     */\r\n    var _pointOnPath = function(curve, location) {\r\n        var cc = _getCurveFunctions(curve.length - 1),\r\n            _x = 0, _y = 0;\r\n        for (var i = 0; i < curve.length ; i++) {\r\n            _x = _x + (curve[i].x * cc[i](location));\r\n            _y = _y + (curve[i].y * cc[i](location));\r\n        }\r\n\r\n        return {x:_x, y:_y};\r\n    };\r\n\r\n    var _dist = function(p1,p2) {\r\n        return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\r\n    };\r\n\r\n    var _isPoint = function(curve) {\r\n        return curve[0].x === curve[1].x && curve[0].y === curve[1].y;\r\n    };\r\n\r\n    /**\r\n     * finds the point that is 'distance' along the path from 'location'.  this method returns both the x,y location of the point and also\r\n     * its 'location' (proportion of travel along the path); the method below - _pointAlongPathFrom - calls this method and just returns the\r\n     * point.\r\n     */\r\n    var _pointAlongPath = function(curve, location, distance) {\r\n\r\n        if (_isPoint(curve)) {\r\n            return {\r\n                point:curve[0],\r\n                location:location\r\n            };\r\n        }\r\n\r\n        var prev = _pointOnPath(curve, location),\r\n            tally = 0,\r\n            curLoc = location,\r\n            direction = distance > 0 ? 1 : -1,\r\n            cur = null;\r\n\r\n        while (tally < Math.abs(distance)) {\r\n            curLoc += (0.005 * direction);\r\n            cur = _pointOnPath(curve, curLoc);\r\n            tally += _dist(cur, prev);\r\n            prev = cur;\r\n        }\r\n        return {point:cur, location:curLoc};\r\n    };\r\n\r\n    var _length = function(curve) {\r\n        if (_isPoint(curve)) return 0;\r\n\r\n        var prev = _pointOnPath(curve, 0),\r\n            tally = 0,\r\n            curLoc = 0,\r\n            direction = 1,\r\n            cur = null;\r\n\r\n        while (curLoc < 1) {\r\n            curLoc += (0.005 * direction);\r\n            cur = _pointOnPath(curve, curLoc);\r\n            tally += _dist(cur, prev);\r\n            prev = cur;\r\n        }\r\n        return tally;\r\n    };\r\n\r\n    /**\r\n     * finds the point that is 'distance' along the path from 'location'.\r\n     */\r\n    var _pointAlongPathFrom = function(curve, location, distance) {\r\n        return _pointAlongPath(curve, location, distance).point;\r\n    };\r\n\r\n    /**\r\n     * finds the location that is 'distance' along the path from 'location'.\r\n     */\r\n    var _locationAlongPathFrom = function(curve, location, distance) {\r\n        return _pointAlongPath(curve, location, distance).location;\r\n    };\r\n\r\n    /**\r\n     * returns the gradient of the curve at the given location, which is a decimal between 0 and 1 inclusive.\r\n     *\r\n     * thanks // http://bimixual.org/AnimationLibrary/beziertangents.html\r\n     */\r\n    var _gradientAtPoint = function(curve, location) {\r\n        var p1 = _pointOnPath(curve, location),\r\n            p2 = _pointOnPath(curve.slice(0, curve.length - 1), location),\r\n            dy = p2.y - p1.y, dx = p2.x - p1.x;\r\n        return dy === 0 ? Infinity : Math.atan(dy / dx);\r\n    };\r\n\r\n    /**\r\n     returns the gradient of the curve at the point which is 'distance' from the given location.\r\n     if this point is greater than location 1, the gradient at location 1 is returned.\r\n     if this point is less than location 0, the gradient at location 0 is returned.\r\n     */\r\n    var _gradientAtPointAlongPathFrom = function(curve, location, distance) {\r\n        var p = _pointAlongPath(curve, location, distance);\r\n        if (p.location > 1) p.location = 1;\r\n        if (p.location < 0) p.location = 0;\r\n        return _gradientAtPoint(curve, p.location);\r\n    };\r\n\r\n    /**\r\n     * calculates a line that is 'length' pixels long, perpendicular to, and centered on, the path at 'distance' pixels from the given location.\r\n     * if distance is not supplied, the perpendicular for the given location is computed (ie. we set distance to zero).\r\n     */\r\n    var _perpendicularToPathAt = function(curve, location, length, distance) {\r\n        distance = distance == null ? 0 : distance;\r\n        var p = _pointAlongPath(curve, location, distance),\r\n            m = _gradientAtPoint(curve, p.location),\r\n            _theta2 = Math.atan(-1 / m),\r\n            y =  length / 2 * Math.sin(_theta2),\r\n            x =  length / 2 * Math.cos(_theta2);\r\n        return [{x:p.point.x + x, y:p.point.y + y}, {x:p.point.x - x, y:p.point.y - y}];\r\n    };\r\n\r\n    /**\r\n     * Calculates all intersections of the given line with the given curve.\r\n     * @param x1\r\n     * @param y1\r\n     * @param x2\r\n     * @param y2\r\n     * @param curve\r\n     * @returns {Array}\r\n     */\r\n    var _lineIntersection = function(x1, y1, x2, y2, curve) {\r\n        var a = y2 - y1,\r\n            b = x1 - x2,\r\n            c = (x1 * (y1 - y2)) + (y1 * (x2-x1)),\r\n            coeffs = _computeCoefficients(curve),\r\n            p = [\r\n                (a*coeffs[0][0]) + (b * coeffs[1][0]),\r\n                (a*coeffs[0][1])+(b*coeffs[1][1]),\r\n                (a*coeffs[0][2])+(b*coeffs[1][2]),\r\n                (a*coeffs[0][3])+(b*coeffs[1][3]) + c\r\n            ],\r\n            r = _cubicRoots.apply(null, p),\r\n            intersections = [];\r\n\r\n        if (r != null) {\r\n\r\n            for (var i = 0; i < 3; i++) {\r\n                var t = r[i],\r\n                    t2 = Math.pow(t, 2),\r\n                    t3 = Math.pow(t, 3),\r\n                    x = [\r\n                        (coeffs[0][0] * t3) + (coeffs[0][1] * t2) + (coeffs[0][2] * t) + coeffs[0][3],\r\n                        (coeffs[1][0] * t3) + (coeffs[1][1] * t2) + (coeffs[1][2] * t) + coeffs[1][3]\r\n                    ];\r\n\r\n                // check bounds of the line\r\n                var s;\r\n                if ((x2 - x1) !== 0) {\r\n                    s = (x[0] - x1) / (x2 - x1);\r\n                }\r\n                else {\r\n                    s = (x[1] - y1) / (y2 - y1);\r\n                }\r\n\r\n                if (t >= 0 && t <= 1.0 && s >= 0 && s <= 1.0) {\r\n                    intersections.push(x);\r\n                }\r\n            }\r\n        }\r\n\r\n        return intersections;\r\n    };\r\n\r\n    /**\r\n     * Calculates all intersections of the given box with the given curve.\r\n     * @param x X position of top left corner of box\r\n     * @param y Y position of top left corner of box\r\n     * @param w width of box\r\n     * @param h height of box\r\n     * @param curve\r\n     * @returns {Array}\r\n     */\r\n    var _boxIntersection = function(x, y, w, h, curve) {\r\n        var i = [];\r\n        i.push.apply(i, _lineIntersection(x, y, x + w, y, curve));\r\n        i.push.apply(i, _lineIntersection(x + w, y, x + w, y + h, curve));\r\n        i.push.apply(i, _lineIntersection(x + w, y + h, x, y + h, curve));\r\n        i.push.apply(i, _lineIntersection(x, y + h, x, y, curve));\r\n        return i;\r\n    };\r\n\r\n    /**\r\n     * Calculates all intersections of the given bounding box with the given curve.\r\n     * @param boundingBox Bounding box, in { x:.., y:..., w:..., h:... } format.\r\n     * @param curve\r\n     * @returns {Array}\r\n     */\r\n    var _boundingBoxIntersection = function(boundingBox, curve) {\r\n        var i = [];\r\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y, curve));\r\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y, boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, curve));\r\n        i.push.apply(i, _lineIntersection(boundingBox.x + boundingBox.w, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y + boundingBox.h, curve));\r\n        i.push.apply(i, _lineIntersection(boundingBox.x, boundingBox.y + boundingBox.h, boundingBox.x, boundingBox.y, curve));\r\n        return i;\r\n    };\r\n\r\n\r\n    function _computeCoefficientsForAxis(curve, axis) {\r\n        return [\r\n            -(curve[0][axis]) + (3*curve[1][axis]) + (-3 * curve[2][axis]) + curve[3][axis],\r\n            (3*(curve[0][axis])) - (6*(curve[1][axis])) + (3*(curve[2][axis])),\r\n            -3*curve[0][axis] + 3*curve[1][axis],\r\n            curve[0][axis]\r\n        ];\r\n    }\r\n\r\n    function _computeCoefficients(curve)\r\n    {\r\n        return [\r\n            _computeCoefficientsForAxis(curve, \"x\"),\r\n            _computeCoefficientsForAxis(curve, \"y\")\r\n        ];\r\n    }\r\n\r\n    function sgn(x) {\r\n        return x < 0 ? -1 : x > 0 ? 1 : 0;\r\n    }\r\n\r\n    function _cubicRoots(a, b, c, d) {\r\n        var A = b / a,\r\n            B = c / a,\r\n            C = d / a,\r\n            Q = (3*B - Math.pow(A, 2))/9,\r\n            R = (9*A*B - 27*C - 2*Math.pow(A, 3))/54,\r\n            D = Math.pow(Q, 3) + Math.pow(R, 2),\r\n            S,\r\n            T,\r\n            t = [];\r\n\r\n        if (D >= 0)                                 // complex or duplicate roots\r\n        {\r\n            S = sgn(R + Math.sqrt(D))*Math.pow(Math.abs(R + Math.sqrt(D)),(1/3));\r\n            T = sgn(R - Math.sqrt(D))*Math.pow(Math.abs(R - Math.sqrt(D)),(1/3));\r\n\r\n            t[0] = -A/3 + (S + T);\r\n            t[1] = -A/3 - (S + T)/2;\r\n            t[2] = -A/3 - (S + T)/2;\r\n\r\n            /*discard complex roots*/\r\n            if (Math.abs(Math.sqrt(3)*(S - T)/2) !== 0) {\r\n                t[1] = -1;\r\n                t[2] = -1;\r\n            }\r\n        }\r\n        else                                          // distinct real roots\r\n        {\r\n            var th = Math.acos(R/Math.sqrt(-Math.pow(Q, 3)));\r\n            t[0] = 2*Math.sqrt(-Q)*Math.cos(th/3) - A/3;\r\n            t[1] = 2*Math.sqrt(-Q)*Math.cos((th + 2*Math.PI)/3) - A/3;\r\n            t[2] = 2*Math.sqrt(-Q)*Math.cos((th + 4*Math.PI)/3) - A/3;\r\n        }\r\n\r\n        // discard out of spec roots\r\n        for (var i = 0; i < 3; i++) {\r\n            if (t[i] < 0 || t[i] > 1.0) {\r\n                t[i] = -1;\r\n            }\r\n        }\r\n\r\n        return t;\r\n    }\r\n\r\n    var jsBezier = this.jsBezier = {\r\n        distanceFromCurve : _distanceFromCurve,\r\n        gradientAtPoint : _gradientAtPoint,\r\n        gradientAtPointAlongCurveFrom : _gradientAtPointAlongPathFrom,\r\n        nearestPointOnCurve : _nearestPointOnCurve,\r\n        pointOnCurve : _pointOnPath,\r\n        pointAlongCurveFrom : _pointAlongPathFrom,\r\n        perpendicularToCurveAt : _perpendicularToPathAt,\r\n        locationAlongCurveFrom:_locationAlongPathFrom,\r\n        getLength:_length,\r\n        lineIntersection:_lineIntersection,\r\n        boxIntersection:_boxIntersection,\r\n        boundingBoxIntersection:_boundingBoxIntersection,\r\n        version:\"0.9.0\"\r\n    };\r\n\r\n    if (typeof exports !== \"undefined\") {\r\n        exports.jsBezier = jsBezier;\r\n    }\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/**\r\n * Biltong v0.4.0\r\n *\r\n * Various geometry functions written as part of jsPlumb and perhaps useful for others.\r\n *\r\n * Copyright (c) 2017 jsPlumb\r\n * https://jsplumbtoolkit.com\r\n *\r\n * Permission is hereby granted, free of charge, to any person\r\n * obtaining a copy of this software and associated documentation\r\n * files (the \"Software\"), to deal in the Software without\r\n * restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the\r\n * Software is furnished to do so, subject to the following\r\n * conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\r\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\r\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\r\n * OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n(function() {\r\n\r\n    \"use strict\";\r\n    var root = this;\r\n\r\n    var Biltong = root.Biltong = {\r\n        version:\"0.4.0\"\r\n    };\r\n\r\n    if (typeof exports !== \"undefined\") {\r\n        exports.Biltong = Biltong;\r\n    }\r\n\r\n    var _isa = function(a) { return Object.prototype.toString.call(a) === \"[object Array]\"; },\r\n        _pointHelper = function(p1, p2, fn) {\r\n            p1 = _isa(p1) ? p1 : [p1.x, p1.y];\r\n            p2 = _isa(p2) ? p2 : [p2.x, p2.y];\r\n            return fn(p1, p2);\r\n        },\r\n        /**\r\n         * @name Biltong.gradient\r\n         * @function\r\n         * @desc Calculates the gradient of a line between the two points.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Float} The gradient of a line between the two points.\r\n         */\r\n        _gradient = Biltong.gradient = function(p1, p2) {\r\n            return _pointHelper(p1, p2, function(_p1, _p2) {\r\n                if (_p2[0] == _p1[0])\r\n                    return _p2[1] > _p1[1] ? Infinity : -Infinity;\r\n                else if (_p2[1] == _p1[1])\r\n                    return _p2[0] > _p1[0] ? 0 : -0;\r\n                else\r\n                    return (_p2[1] - _p1[1]) / (_p2[0] - _p1[0]);\r\n            });\r\n        },\r\n        /**\r\n         * @name Biltong.normal\r\n         * @function\r\n         * @desc Calculates the gradient of a normal to a line between the two points.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Float} The gradient of a normal to a line between the two points.\r\n         */\r\n        _normal = Biltong.normal = function(p1, p2) {\r\n            return -1 / _gradient(p1, p2);\r\n        },\r\n        /**\r\n         * @name Biltong.lineLength\r\n         * @function\r\n         * @desc Calculates the length of a line between the two points.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Float} The length of a line between the two points.\r\n         */\r\n        _lineLength = Biltong.lineLength = function(p1, p2) {\r\n            return _pointHelper(p1, p2, function(_p1, _p2) {\r\n                return Math.sqrt(Math.pow(_p2[1] - _p1[1], 2) + Math.pow(_p2[0] - _p1[0], 2));\r\n            });\r\n        },\r\n        /**\r\n         * @name Biltong.quadrant\r\n         * @function\r\n         * @desc Calculates the quadrant in which the angle between the two points lies.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Integer} The quadrant - 1 for upper right, 2 for lower right, 3 for lower left, 4 for upper left.\r\n         */\r\n        _quadrant = Biltong.quadrant = function(p1, p2) {\r\n            return _pointHelper(p1, p2, function(_p1, _p2) {\r\n                if (_p2[0] > _p1[0]) {\r\n                    return (_p2[1] > _p1[1]) ? 2 : 1;\r\n                }\r\n                else if (_p2[0] == _p1[0]) {\r\n                    return _p2[1] > _p1[1] ? 2 : 1;\r\n                }\r\n                else {\r\n                    return (_p2[1] > _p1[1]) ? 3 : 4;\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * @name Biltong.theta\r\n         * @function\r\n         * @desc Calculates the angle between the two points.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Float} The angle between the two points.\r\n         */\r\n        _theta = Biltong.theta = function(p1, p2) {\r\n            return _pointHelper(p1, p2, function(_p1, _p2) {\r\n                var m = _gradient(_p1, _p2),\r\n                    t = Math.atan(m),\r\n                    s = _quadrant(_p1, _p2);\r\n                if ((s == 4 || s== 3)) t += Math.PI;\r\n                if (t < 0) t += (2 * Math.PI);\r\n\r\n                return t;\r\n            });\r\n        },\r\n        /**\r\n         * @name Biltong.intersects\r\n         * @function\r\n         * @desc Calculates whether or not the two rectangles intersect.\r\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n         * @return {Boolean} True if the rectangles intersect, false otherwise.\r\n         */\r\n        _intersects = Biltong.intersects = function(r1, r2) {\r\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\r\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h;\r\n\r\n            return  ( (x1 <= a1 && a1 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\r\n                ( (x1 <= a2 && a2 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\r\n                ( (x1 <= a1 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\r\n                ( (x1 <= a2 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\r\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\r\n                ( (a1 <= x2 && x2 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\r\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y2 && y2 <= b2) ) ||\r\n                ( (a1 <= x2 && x1 <= a2) && (b1 <= y2 && y2 <= b2) );\r\n        },\r\n        /**\r\n         * @name Biltong.encloses\r\n         * @function\r\n         * @desc Calculates whether or not r2 is completely enclosed by r1.\r\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n         * @param {Boolean} [allowSharedEdges=false] If true, the concept of enclosure allows for one or more edges to be shared by the two rectangles.\r\n         * @return {Boolean} True if r1 encloses r2, false otherwise.\r\n         */\r\n        _encloses = Biltong.encloses = function(r1, r2, allowSharedEdges) {\r\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\r\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h,\r\n                c = function(v1, v2, v3, v4) { return allowSharedEdges ? v1 <= v2 && v3>= v4 : v1 < v2 && v3 > v4; };\r\n\r\n            return c(x1,a1,x2,a2) && c(y1,b1,y2,b2);\r\n        },\r\n        _segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1] ],\r\n        _inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1] ],\r\n        /**\r\n         * @name Biltong.pointOnLine\r\n         * @function\r\n         * @desc Calculates a point on the line from `fromPoint` to `toPoint` that is `distance` units along the length of the line.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Point} Point on the line, in the form `{ x:..., y:... }`.\r\n         */\r\n        _pointOnLine = Biltong.pointOnLine = function(fromPoint, toPoint, distance) {\r\n            var m = _gradient(fromPoint, toPoint),\r\n                s = _quadrant(fromPoint, toPoint),\r\n                segmentMultiplier = distance > 0 ? _segmentMultipliers[s] : _inverseSegmentMultipliers[s],\r\n                theta = Math.atan(m),\r\n                y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\r\n                x =  Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\r\n            return { x:fromPoint.x + x, y:fromPoint.y + y };\r\n        },\r\n        /**\r\n         * @name Biltong.perpendicularLineTo\r\n         * @function\r\n         * @desc Calculates a line of length `length` that is perpendicular to the line from `fromPoint` to `toPoint` and passes through `toPoint`.\r\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n         * @return {Line} Perpendicular line, in the form `[ { x:..., y:... }, { x:..., y:... } ]`.\r\n         */\r\n        _perpendicularLineTo = Biltong.perpendicularLineTo = function(fromPoint, toPoint, length) {\r\n            var m = _gradient(fromPoint, toPoint),\r\n                theta2 = Math.atan(-1 / m),\r\n                y =  length / 2 * Math.sin(theta2),\r\n                x =  length / 2 * Math.cos(theta2);\r\n            return [{x:toPoint.x + x, y:toPoint.y + y}, {x:toPoint.x - x, y:toPoint.y - y}];\r\n        };\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    /**\r\n     * Creates a Touch object.\r\n     * @param view\r\n     * @param target\r\n     * @param pageX\r\n     * @param pageY\r\n     * @param screenX\r\n     * @param screenY\r\n     * @param clientX\r\n     * @param clientY\r\n     * @returns {Touch}\r\n     * @private\r\n     */\r\n    function _touch(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\r\n\r\n        return new Touch({\r\n            target:target,\r\n            identifier:_uuid(),\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            screenX: screenX,\r\n            screenY: screenY,\r\n            clientX: clientX || screenX,\r\n            clientY: clientY || screenY\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Create a synthetic touch list from the given list of Touch objects.\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    function _touchList() {\r\n        var list = [];\r\n        Array.prototype.push.apply(list, arguments);\r\n        list.item =  function(index) { return this[index]; };\r\n        return list;\r\n    }\r\n\r\n    /**\r\n     * Create a Touch object and then insert it into a synthetic touch list, returning the list.s\r\n     * @param view\r\n     * @param target\r\n     * @param pageX\r\n     * @param pageY\r\n     * @param screenX\r\n     * @param screenY\r\n     * @param clientX\r\n     * @param clientY\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    function _touchAndList(view, target, pageX, pageY, screenX, screenY, clientX, clientY) {\r\n        return _touchList(_touch.apply(null, arguments));\r\n    }\r\n\r\n    var root = this,\r\n        matchesSelector = function (el, selector, ctx) {\r\n            ctx = ctx || el.parentNode;\r\n            var possibles = ctx.querySelectorAll(selector);\r\n            for (var i = 0; i < possibles.length; i++) {\r\n                if (possibles[i] === el) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        _gel = function (el) {\r\n            return (typeof el == \"string\" || el.constructor === String) ? document.getElementById(el) : el;\r\n        },\r\n        _t = function (e) {\r\n            return e.srcElement || e.target;\r\n        },\r\n        //\r\n        // gets path info for the given event - the path from target to obj, in the event's bubble chain. if doCompute\r\n        // is false we just return target for the path.\r\n        //\r\n        _pi = function(e, target, obj, doCompute) {\r\n            if (!doCompute) return { path:[target], end:1 };\r\n            else if (typeof e.path !== \"undefined\" && e.path.indexOf) {\r\n                return { path: e.path, end: e.path.indexOf(obj) };\r\n            } else {\r\n                var out = { path:[], end:-1 }, _one = function(el) {\r\n                    out.path.push(el);\r\n                    if (el === obj) {\r\n                        out.end = out.path.length - 1;\r\n                    }\r\n                    else if (el.parentNode != null) {\r\n                        _one(el.parentNode)\r\n                    }\r\n                };\r\n                _one(target);\r\n                return out;\r\n            }\r\n        },\r\n        _d = function (l, fn) {\r\n            for (var i = 0, j = l.length; i < j; i++) {\r\n                if (l[i] == fn) break;\r\n            }\r\n            if (i < l.length) l.splice(i, 1);\r\n        },\r\n        guid = 1,\r\n        //\r\n        // this function generates a guid for every handler, sets it on the handler, then adds\r\n        // it to the associated object's map of handlers for the given event. this is what enables us\r\n        // to unbind all events of some type, or all events (the second of which can be requested by the user,\r\n        // but it also used by Mottle when an element is removed.)\r\n        _store = function (obj, event, fn) {\r\n            var g = guid++;\r\n            obj.__ta = obj.__ta || {};\r\n            obj.__ta[event] = obj.__ta[event] || {};\r\n            // store each handler with a unique guid.\r\n            obj.__ta[event][g] = fn;\r\n            // set the guid on the handler.\r\n            fn.__tauid = g;\r\n            return g;\r\n        },\r\n        _unstore = function (obj, event, fn) {\r\n            obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\r\n            // a handler might have attached extra functions, so we unbind those too.\r\n            if (fn.__taExtra) {\r\n                for (var i = 0; i < fn.__taExtra.length; i++) {\r\n                    _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\r\n                }\r\n                fn.__taExtra.length = 0;\r\n            }\r\n            // a handler might have attached an unstore callback\r\n            fn.__taUnstore && fn.__taUnstore();\r\n        },\r\n        _curryChildFilter = function (children, obj, fn, evt) {\r\n            if (children == null) return fn;\r\n            else {\r\n                var c = children.split(\",\"),\r\n                    _fn = function (e) {\r\n                        _fn.__tauid = fn.__tauid;\r\n                        var t = _t(e), target = t;  // t is the target element on which the event occurred. it is the\r\n                        // element we will wish to pass to any callbacks.\r\n                        var pathInfo = _pi(e, t, obj, children != null)\r\n                        if (pathInfo.end != -1) {\r\n                            for (var p = 0; p < pathInfo.end; p++) {\r\n                                target = pathInfo.path[p];\r\n                                for (var i = 0; i < c.length; i++) {\r\n                                    if (matchesSelector(target, c[i], obj)) {\r\n                                        fn.apply(target, arguments);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n                registerExtraFunction(fn, evt, _fn);\r\n                return _fn;\r\n            }\r\n        },\r\n        //\r\n        // registers an 'extra' function on some event listener function we were given - a function that we\r\n        // created and bound to the element as part of our housekeeping, and which we want to unbind and remove\r\n        // whenever the given function is unbound.\r\n        registerExtraFunction = function (fn, evt, newFn) {\r\n            fn.__taExtra = fn.__taExtra || [];\r\n            fn.__taExtra.push([evt, newFn]);\r\n        },\r\n        DefaultHandler = function (obj, evt, fn, children) {\r\n            if (isTouchDevice && touchMap[evt]) {\r\n                var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\r\n                _bind(obj, touchMap[evt], tfn , fn);\r\n            }\r\n            if (evt === \"focus\" && obj.getAttribute(\"tabindex\") == null) {\r\n                obj.setAttribute(\"tabindex\", \"1\");\r\n            }\r\n            _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn);\r\n        },\r\n        SmartClickHandler = function (obj, evt, fn, children) {\r\n            if (obj.__taSmartClicks == null) {\r\n                var down = function (e) {\r\n                        obj.__tad = _pageLocation(e);\r\n                    },\r\n                    up = function (e) {\r\n                        obj.__tau = _pageLocation(e);\r\n                    },\r\n                    click = function (e) {\r\n                        if (obj.__tad && obj.__tau && obj.__tad[0] === obj.__tau[0] && obj.__tad[1] === obj.__tau[1]) {\r\n                            for (var i = 0; i < obj.__taSmartClicks.length; i++)\r\n                                obj.__taSmartClicks[i].apply(_t(e), [ e ]);\r\n                        }\r\n                    };\r\n                DefaultHandler(obj, \"mousedown\", down, children);\r\n                DefaultHandler(obj, \"mouseup\", up, children);\r\n                DefaultHandler(obj, \"click\", click, children);\r\n                obj.__taSmartClicks = [];\r\n            }\r\n\r\n            // store in the list of callbacks\r\n            obj.__taSmartClicks.push(fn);\r\n            // the unstore function removes this function from the object's listener list for this type.\r\n            fn.__taUnstore = function () {\r\n                _d(obj.__taSmartClicks, fn);\r\n            };\r\n        },\r\n        _tapProfiles = {\r\n            \"tap\": {touches: 1, taps: 1},\r\n            \"dbltap\": {touches: 1, taps: 2},\r\n            \"contextmenu\": {touches: 2, taps: 1}\r\n        },\r\n        TapHandler = function (clickThreshold, dblClickThreshold) {\r\n            return function (obj, evt, fn, children) {\r\n                // if event is contextmenu, for devices which are mouse only, we want to\r\n                // use the default bind.\r\n                if (evt == \"contextmenu\" && isMouseDevice)\r\n                    DefaultHandler(obj, evt, fn, children);\r\n                else {\r\n                    // the issue here is that this down handler gets registered only for the\r\n                    // child nodes in the first registration. in fact it should be registered with\r\n                    // no child selector and then on down we should cycle through the registered\r\n                    // functions to see if one of them matches. on mouseup we should execute ALL of\r\n                    // the functions whose children are either null or match the element.\r\n                    if (obj.__taTapHandler == null) {\r\n                        var tt = obj.__taTapHandler = {\r\n                            tap: [],\r\n                            dbltap: [],\r\n                            contextmenu: [],\r\n                            down: false,\r\n                            taps: 0,\r\n                            downSelectors: []\r\n                        };\r\n                        var down = function (e) {\r\n                                var target = _t(e), pathInfo = _pi(e, target, obj, children != null), finished = false;\r\n                                for (var p = 0; p < pathInfo.end; p++) {\r\n                                    if (finished) return;\r\n                                    target = pathInfo.path[p];\r\n                                    for (var i = 0; i < tt.downSelectors.length; i++) {\r\n                                        if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\r\n                                            tt.down = true;\r\n                                            setTimeout(clearSingle, clickThreshold);\r\n                                            setTimeout(clearDouble, dblClickThreshold);\r\n                                            finished = true;\r\n                                            break; // we only need one match on mousedown\r\n                                        }\r\n                                    }\r\n                                }\r\n                            },\r\n                            up = function (e) {\r\n                                if (tt.down) {\r\n                                    var target = _t(e), currentTarget, pathInfo;\r\n                                    tt.taps++;\r\n                                    var tc = _touchCount(e);\r\n                                    for (var eventId in _tapProfiles) {\r\n                                        if (_tapProfiles.hasOwnProperty(eventId)) {\r\n                                            var p = _tapProfiles[eventId];\r\n                                            if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\r\n                                                for (var i = 0; i < tt[eventId].length; i++) {\r\n                                                    pathInfo = _pi(e, target, obj, tt[eventId][i][1] != null);\r\n                                                    for (var pLoop = 0; pLoop < pathInfo.end; pLoop++) {\r\n                                                        currentTarget = pathInfo.path[pLoop];\r\n                                                        // this is a single event registration handler.\r\n                                                        if (tt[eventId][i][1] == null || matchesSelector(currentTarget, tt[eventId][i][1], obj)) {\r\n                                                            tt[eventId][i][0].apply(currentTarget, [ e ]);\r\n                                                            break;\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            },\r\n                            clearSingle = function () {\r\n                                tt.down = false;\r\n                            },\r\n                            clearDouble = function () {\r\n                                tt.taps = 0;\r\n                            };\r\n\r\n                        DefaultHandler(obj, \"mousedown\", down);\r\n                        DefaultHandler(obj, \"mouseup\", up);\r\n                    }\r\n                    // add this child selector (it can be null, that's fine).\r\n                    obj.__taTapHandler.downSelectors.push(children);\r\n\r\n                    obj.__taTapHandler[evt].push([fn, children]);\r\n                    // the unstore function removes this function from the object's listener list for this type.\r\n                    fn.__taUnstore = function () {\r\n                        _d(obj.__taTapHandler[evt], fn);\r\n                    };\r\n                }\r\n            };\r\n        },\r\n        meeHelper = function (type, evt, obj, target) {\r\n            for (var i in obj.__tamee[type]) {\r\n                if (obj.__tamee[type].hasOwnProperty(i)) {\r\n                    obj.__tamee[type][i].apply(target, [ evt ]);\r\n                }\r\n            }\r\n        },\r\n        MouseEnterExitHandler = function () {\r\n            var activeElements = [];\r\n            return function (obj, evt, fn, children) {\r\n                if (!obj.__tamee) {\r\n                    // __tamee holds a flag saying whether the mouse is currently \"in\" the element, and a list of\r\n                    // both mouseenter and mouseexit functions.\r\n                    obj.__tamee = { over: false, mouseenter: [], mouseexit: [] };\r\n                    // register over and out functions\r\n                    var over = function (e) {\r\n                            var t = _t(e);\r\n                            if ((children == null && (t == obj && !obj.__tamee.over)) || (matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over))) {\r\n                                meeHelper(\"mouseenter\", e, obj, t);\r\n                                t.__tamee = t.__tamee || {};\r\n                                t.__tamee.over = true;\r\n                                activeElements.push(t);\r\n                            }\r\n                        },\r\n                        out = function (e) {\r\n                            var t = _t(e);\r\n                            // is the current target one of the activeElements? and is the\r\n                            // related target NOT a descendant of it?\r\n                            for (var i = 0; i < activeElements.length; i++) {\r\n                                if (t == activeElements[i] && !matchesSelector((e.relatedTarget || e.toElement), \"*\", t)) {\r\n                                    t.__tamee.over = false;\r\n                                    activeElements.splice(i, 1);\r\n                                    meeHelper(\"mouseexit\", e, obj, t);\r\n                                }\r\n                            }\r\n                        };\r\n\r\n                    _bind(obj, \"mouseover\", _curryChildFilter(children, obj, over, \"mouseover\"), over);\r\n                    _bind(obj, \"mouseout\", _curryChildFilter(children, obj, out, \"mouseout\"), out);\r\n                }\r\n\r\n                fn.__taUnstore = function () {\r\n                    delete obj.__tamee[evt][fn.__tauid];\r\n                };\r\n\r\n                _store(obj, evt, fn);\r\n                obj.__tamee[evt][fn.__tauid] = fn;\r\n            };\r\n        },\r\n        isTouchDevice = \"ontouchstart\" in document.documentElement,\r\n        isMouseDevice = \"onmousedown\" in document.documentElement,\r\n        touchMap = { \"mousedown\": \"touchstart\", \"mouseup\": \"touchend\", \"mousemove\": \"touchmove\" },\r\n        touchstart = \"touchstart\", touchend = \"touchend\", touchmove = \"touchmove\",\r\n        iev = (function () {\r\n            var rv = -1;\r\n            if (navigator.appName == 'Microsoft Internet Explorer') {\r\n                var ua = navigator.userAgent,\r\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                if (re.exec(ua) != null)\r\n                    rv = parseFloat(RegExp.$1);\r\n            }\r\n            return rv;\r\n        })(),\r\n        isIELT9 = iev > -1 && iev < 9,\r\n        _genLoc = function (e, prefix) {\r\n            if (e == null) return [ 0, 0 ];\r\n            var ts = _touches(e), t = _getTouch(ts, 0);\r\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\r\n        },\r\n        _pageLocation = function (e) {\r\n            if (e == null) return [ 0, 0 ];\r\n            if (isIELT9) {\r\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\r\n            }\r\n            else {\r\n                return _genLoc(e, \"page\");\r\n            }\r\n        },\r\n        _screenLocation = function (e) {\r\n            return _genLoc(e, \"screen\");\r\n        },\r\n        _clientLocation = function (e) {\r\n            return _genLoc(e, \"client\");\r\n        },\r\n        _getTouch = function (touches, idx) {\r\n            return touches.item ? touches.item(idx) : touches[idx];\r\n        },\r\n        _touches = function (e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                        [ e ];\r\n        },\r\n        _touchCount = function (e) {\r\n            return _touches(e).length;\r\n        },\r\n        //http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html\r\n        _bind = function (obj, type, fn, originalFn) {\r\n            _store(obj, type, fn);\r\n            originalFn.__tauid = fn.__tauid;\r\n            if (obj.addEventListener)\r\n                obj.addEventListener(type, fn, false);\r\n            else if (obj.attachEvent) {\r\n                var key = type + fn.__tauid;\r\n                obj[\"e\" + key] = fn;\r\n                // TODO look at replacing with .call(..)\r\n                obj[key] = function () {\r\n                    obj[\"e\" + key] && obj[\"e\" + key](window.event);\r\n                };\r\n                obj.attachEvent(\"on\" + type, obj[key]);\r\n            }\r\n        },\r\n        _unbind = function (obj, type, fn) {\r\n            if (fn == null) return;\r\n            _each(obj, function () {\r\n                var _el = _gel(this);\r\n                _unstore(_el, type, fn);\r\n                // it has been bound if there is a tauid. otherwise it was not bound and we can ignore it.\r\n                if (fn.__tauid != null) {\r\n                    if (_el.removeEventListener) {\r\n                        _el.removeEventListener(type, fn, false);\r\n                        if (isTouchDevice && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\r\n                    }\r\n                    else if (this.detachEvent) {\r\n                        var key = type + fn.__tauid;\r\n                        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\r\n                        _el[key] = null;\r\n                        _el[\"e\" + key] = null;\r\n                    }\r\n                }\r\n\r\n                // if a touch event was also registered, deregister now.\r\n                if (fn.__taTouchProxy) {\r\n                    _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\r\n                }\r\n            });\r\n        },\r\n        _each = function (obj, fn) {\r\n            if (obj == null) return;\r\n            // if a list (or list-like), use it. if a string, get a list\r\n            // by running the string through querySelectorAll. else, assume\r\n            // it's an Element.\r\n            // obj.top is \"unknown\" in IE8.\r\n            obj = (typeof Window !== \"undefined\" && (typeof obj.top !== \"unknown\" && obj == obj.top)) ? [ obj ] :\r\n                (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj :\r\n                    typeof obj === \"string\" ? document.querySelectorAll(obj)\r\n                        : [ obj ];\r\n\r\n            for (var i = 0; i < obj.length; i++)\r\n                fn.apply(obj[i]);\r\n        },\r\n        _uuid = function () {\r\n            return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n                return v.toString(16);\r\n            }));\r\n        };\r\n\r\n    /**\r\n     * Mottle offers support for abstracting out the differences\r\n     * between touch and mouse devices, plus \"smart click\" functionality\r\n     * (don't fire click if the mouse has moved between mousedown and mouseup),\r\n     * and synthesized click/tap events.\r\n     * @class Mottle\r\n     * @constructor\r\n     * @param {Object} params Constructor params\r\n     * @param {Number} [params.clickThreshold=250] Threshold, in milliseconds beyond which a touchstart followed by a touchend is not considered to be a click.\r\n     * @param {Number} [params.dblClickThreshold=450] Threshold, in milliseconds beyond which two successive tap events are not considered to be a click.\r\n     * @param {Boolean} [params.smartClicks=false] If true, won't fire click events if the mouse has moved between mousedown and mouseup. Note that this functionality\r\n     * requires that Mottle consume the mousedown event, and so may not be viable in all use cases.\r\n     */\r\n    root.Mottle = function (params) {\r\n        params = params || {};\r\n        var clickThreshold = params.clickThreshold || 250,\r\n            dblClickThreshold = params.dblClickThreshold || 450,\r\n            mouseEnterExitHandler = new MouseEnterExitHandler(),\r\n            tapHandler = new TapHandler(clickThreshold, dblClickThreshold),\r\n            _smartClicks = params.smartClicks,\r\n            _doBind = function (obj, evt, fn, children) {\r\n                if (fn == null) return;\r\n                _each(obj, function () {\r\n                    var _el = _gel(this);\r\n                    if (_smartClicks && evt === \"click\")\r\n                        SmartClickHandler(_el, evt, fn, children);\r\n                    else if (evt === \"tap\" || evt === \"dbltap\" || evt === \"contextmenu\") {\r\n                        tapHandler(_el, evt, fn, children);\r\n                    }\r\n                    else if (evt === \"mouseenter\" || evt == \"mouseexit\")\r\n                        mouseEnterExitHandler(_el, evt, fn, children);\r\n                    else\r\n                        DefaultHandler(_el, evt, fn, children);\r\n                });\r\n            };\r\n\r\n        /**\r\n         * Removes an element from the DOM, and deregisters all event handlers for it. You should use this\r\n         * to ensure you don't leak memory.\r\n         * @method remove\r\n         * @param {String|Element} el Element, or id of the element, to remove.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.remove = function (el) {\r\n            _each(el, function () {\r\n                var _el = _gel(this);\r\n                if (_el.__ta) {\r\n                    for (var evt in _el.__ta) {\r\n                        if (_el.__ta.hasOwnProperty(evt)) {\r\n                            for (var h in _el.__ta[evt]) {\r\n                                if (_el.__ta[evt].hasOwnProperty(h))\r\n                                    _unbind(_el, evt, _el.__ta[evt][h]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                _el.parentNode && _el.parentNode.removeChild(_el);\r\n            });\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Register an event handler, optionally as a delegate for some set of descendant elements. Note\r\n         * that this method takes either 3 or 4 arguments - if you supply 3 arguments it is assumed you have\r\n         * omitted the `children` parameter, and that the event handler should be bound directly to the given element.\r\n         * @method on\r\n         * @param {Element[]|Element|String} el Either an Element, or a CSS spec for a list of elements, or an array of Elements.\r\n         * @param {String} [children] Comma-delimited list of selectors identifying allowed children.\r\n         * @param {String} event Event ID.\r\n         * @param {Function} fn Event handler function.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.on = function (el, event, children, fn) {\r\n            var _el = arguments[0],\r\n                _c = arguments.length == 4 ? arguments[2] : null,\r\n                _e = arguments[1],\r\n                _f = arguments[arguments.length - 1];\r\n\r\n            _doBind(_el, _e, _f, _c);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Cancel delegate event handling for the given function. Note that unlike with 'on' you do not supply\r\n         * a list of child selectors here: it removes event delegation from all of the child selectors for which the\r\n         * given function was registered (if any).\r\n         * @method off\r\n         * @param {Element[]|Element|String} el Element - or ID of element - from which to remove event listener.\r\n         * @param {String} event Event ID.\r\n         * @param {Function} fn Event handler function.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.off = function (el, event, fn) {\r\n            _unbind(el, event, fn);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Triggers some event for a given element.\r\n         * @method trigger\r\n         * @param {Element} el Element for which to trigger the event.\r\n         * @param {String} event Event ID.\r\n         * @param {Event} originalEvent The original event. Should be optional of course, but currently is not, due\r\n         * to the jsPlumb use case that caused this method to be added.\r\n         * @param {Object} [payload] Optional object to set as `payload` on the generated event; useful for message passing.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.trigger = function (el, event, originalEvent, payload) {\r\n            // MouseEvent undefined in old IE; that's how we know it's a mouse event.  A fine Microsoft paradox.\r\n            var originalIsMouse = isMouseDevice && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\r\n\r\n            var eventToBind = (isTouchDevice && !isMouseDevice && touchMap[event]) ? touchMap[event] : event,\r\n                bindingAMouseEvent = !(isTouchDevice && !isMouseDevice && touchMap[event]);\r\n\r\n            var pl = _pageLocation(originalEvent), sl = _screenLocation(originalEvent), cl = _clientLocation(originalEvent);\r\n            _each(el, function () {\r\n                var _el = _gel(this), evt;\r\n                originalEvent = originalEvent || {\r\n                    screenX: sl[0],\r\n                    screenY: sl[1],\r\n                    clientX: cl[0],\r\n                    clientY: cl[1]\r\n                };\r\n\r\n                var _decorate = function (_evt) {\r\n                    if (payload) _evt.payload = payload;\r\n                };\r\n\r\n                var eventGenerators = {\r\n                    \"TouchEvent\": function (evt) {\r\n\r\n                        var touchList = _touchAndList(window, _el, 0, pl[0], pl[1], sl[0], sl[1], cl[0], cl[1]),\r\n                            init = evt.initTouchEvent || evt.initEvent;\r\n\r\n                        init(eventToBind, true, true, window, null, sl[0], sl[1],\r\n                            cl[0], cl[1], false, false, false, false,\r\n                            touchList, touchList, touchList, 1, 0);\r\n                    },\r\n                    \"MouseEvents\": function (evt) {\r\n                        evt.initMouseEvent(eventToBind, true, true, window, 0,\r\n                            sl[0], sl[1],\r\n                            cl[0], cl[1],\r\n                            false, false, false, false, 1, _el);\r\n                    }\r\n                };\r\n\r\n                if (document.createEvent) {\r\n\r\n                    var ite = !bindingAMouseEvent && !originalIsMouse && (isTouchDevice && touchMap[event]),\r\n                        evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\r\n\r\n                    evt = document.createEvent(evtName);\r\n                    eventGenerators[evtName](evt);\r\n                    _decorate(evt);\r\n                    _el.dispatchEvent(evt);\r\n                }\r\n                else if (document.createEventObject) {\r\n                    evt = document.createEventObject();\r\n                    evt.eventType = evt.eventName = eventToBind;\r\n                    evt.screenX = sl[0];\r\n                    evt.screenY = sl[1];\r\n                    evt.clientX = cl[0];\r\n                    evt.clientY = cl[1];\r\n                    _decorate(evt);\r\n                    _el.fireEvent('on' + eventToBind, evt);\r\n                }\r\n            });\r\n            return this;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Static method to assist in 'consuming' an element: uses `stopPropagation` where available, or sets\r\n     * `e.returnValue=false` where it is not.\r\n     * @method Mottle.consume\r\n     * @param {Event} e Event to consume\r\n     * @param {Boolean} [doNotPreventDefault=false] If true, does not call `preventDefault()` on the event.\r\n     */\r\n    root.Mottle.consume = function (e, doNotPreventDefault) {\r\n        if (e.stopPropagation)\r\n            e.stopPropagation();\r\n        else\r\n            e.returnValue = false;\r\n\r\n        if (!doNotPreventDefault && e.preventDefault)\r\n            e.preventDefault();\r\n    };\r\n\r\n    /**\r\n     * Gets the page location corresponding to the given event. For touch events this means get the page location of the first touch.\r\n     * @method Mottle.pageLocation\r\n     * @param {Event} e Event to get page location for.\r\n     * @return {Number[]} [left, top] for the given event.\r\n     */\r\n    root.Mottle.pageLocation = _pageLocation;\r\n\r\n    /**\r\n     * Forces touch events to be turned \"on\". Useful for testing: even if you don't have a touch device, you can still\r\n     * trigger a touch event when this is switched on and it will be captured and acted on.\r\n     * @method setForceTouchEvents\r\n     * @param {Boolean} value If true, force touch events to be on.\r\n     */\r\n    root.Mottle.setForceTouchEvents = function (value) {\r\n        isTouchDevice = value;\r\n    };\r\n\r\n    /**\r\n     * Forces mouse events to be turned \"on\". Useful for testing: even if you don't have a mouse, you can still\r\n     * trigger a mouse event when this is switched on and it will be captured and acted on.\r\n     * @method setForceMouseEvents\r\n     * @param {Boolean} value If true, force mouse events to be on.\r\n     */\r\n    root.Mottle.setForceMouseEvents = function (value) {\r\n        isMouseDevice = value;\r\n    };\r\n\r\n    root.Mottle.version = \"0.8.0\";\r\n\r\n    if (typeof exports !== \"undefined\") {\r\n        exports.Mottle = root.Mottle;\r\n    }\r\n\r\n}).call(typeof window === \"undefined\" ? this : window);\r\n\r\n/**\r\n drag/drop functionality for use with jsPlumb but with\r\n no knowledge of jsPlumb. supports multiple scopes (separated by whitespace), dragging\r\n multiple elements, constrain to parent, drop filters, drag start filters, custom\r\n css classes.\r\n\r\n a lot of the functionality of this script is expected to be plugged in:\r\n\r\n addClass\r\n removeClass\r\n\r\n addEvent\r\n removeEvent\r\n\r\n getPosition\r\n setPosition\r\n getSize\r\n\r\n indexOf\r\n intersects\r\n\r\n the name came from here:\r\n\r\n http://mrsharpoblunto.github.io/foswig.js/\r\n\r\n copyright 2016 jsPlumb\r\n */\r\n\r\n(function() {\r\n\r\n    \"use strict\";\r\n    var root = this;\r\n\r\n    var _suggest = function(list, item, head) {\r\n        if (list.indexOf(item) === -1) {\r\n            head ? list.unshift(item) : list.push(item);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _vanquish = function(list, item) {\r\n        var idx = list.indexOf(item);\r\n        if (idx !== -1) list.splice(idx, 1);\r\n    };\r\n\r\n    var _difference = function(l1, l2) {\r\n        var d = [];\r\n        for (var i = 0; i < l1.length; i++) {\r\n            if (l2.indexOf(l1[i]) === -1)\r\n                d.push(l1[i]);\r\n        }\r\n        return d;\r\n    };\r\n\r\n    var _isString = function(f) {\r\n        return f == null ? false : (typeof f === \"string\" || f.constructor === String);\r\n    };\r\n\r\n    var getOffsetRect = function (elem) {\r\n        // (1)\r\n        var box = elem.getBoundingClientRect(),\r\n            body = document.body,\r\n            docElem = document.documentElement,\r\n            // (2)\r\n            scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\r\n            scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\r\n            // (3)\r\n            clientTop = docElem.clientTop || body.clientTop || 0,\r\n            clientLeft = docElem.clientLeft || body.clientLeft || 0,\r\n            // (4)\r\n            top  = box.top +  scrollTop - clientTop,\r\n            left = box.left + scrollLeft - clientLeft;\r\n\r\n        return { top: Math.round(top), left: Math.round(left) };\r\n    };\r\n\r\n    var matchesSelector = function(el, selector, ctx) {\r\n        ctx = ctx || el.parentNode;\r\n        var possibles = ctx.querySelectorAll(selector);\r\n        for (var i = 0; i < possibles.length; i++) {\r\n            if (possibles[i] === el)\r\n                return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var findDelegateElement = function(parentElement, childElement, selector) {\r\n        if (matchesSelector(childElement, selector, parentElement)) {\r\n            return childElement;\r\n        } else {\r\n            var currentParent = childElement.parentNode;\r\n            while (currentParent != null && currentParent !== parentElement) {\r\n                if (matchesSelector(currentParent, selector, parentElement)) {\r\n                    return currentParent;\r\n                } else {\r\n                    currentParent = currentParent.parentNode;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Finds all elements matching the given selector, for the given parent. In order to support \"scoped root\" selectors,\r\n     * ie. things like \"> .someClass\", that is .someClass elements that are direct children of `parentElement`, we have to\r\n     * jump through a small hoop here: when a delegate draggable is registered, we write a `katavorio-draggable` attribute\r\n     * on the element on which the draggable is registered. Then when this method runs, we grab the value of that attribute and\r\n     * prepend it as part of the selector we're looking for.  So \"> .someClass\" ends up being written as\r\n     * \"[katavorio-draggable='...' > .someClass]\", which works with querySelectorAll.\r\n     *\r\n     * @param availableSelectors\r\n     * @param parentElement\r\n     * @param childElement\r\n     * @returns {*}\r\n     */\r\n    var findMatchingSelector = function(availableSelectors, parentElement, childElement) {\r\n        var el = null;\r\n        var draggableId = parentElement.getAttribute(\"katavorio-draggable\"),\r\n            prefix = draggableId != null ? \"[katavorio-draggable='\" + draggableId + \"'] \" : \"\";\r\n\r\n        for (var i = 0; i < availableSelectors.length; i++) {\r\n            el = findDelegateElement(parentElement, childElement, prefix + availableSelectors[i].selector);\r\n            if (el != null) {\r\n                if (availableSelectors[i].filter) {\r\n                    var matches = matchesSelector(childElement, availableSelectors[i].filter, el),\r\n                        exclude = availableSelectors[i].filterExclude === true;\r\n\r\n                    if ( (exclude && !matches) || matches) {\r\n                        return null;\r\n                    }\r\n\r\n                }\r\n                return [ availableSelectors[i], el ];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    var iev = (function() {\r\n            var rv = -1;\r\n            if (navigator.appName === 'Microsoft Internet Explorer') {\r\n                var ua = navigator.userAgent,\r\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                if (re.exec(ua) != null)\r\n                    rv = parseFloat(RegExp.$1);\r\n            }\r\n            return rv;\r\n        })(),\r\n        DEFAULT_GRID_X = 10,\r\n        DEFAULT_GRID_Y = 10,\r\n        isIELT9 = iev > -1 && iev < 9,\r\n        isIE9 = iev === 9,\r\n        _pl = function(e) {\r\n            if (isIELT9) {\r\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\r\n            }\r\n            else {\r\n                var ts = _touches(e), t = _getTouch(ts, 0);\r\n                // for IE9 pageX might be null if the event was synthesized. We try for pageX/pageY first,\r\n                // falling back to clientX/clientY if necessary. In every other browser we want to use pageX/pageY.\r\n                return isIE9 ? [t.pageX || t.clientX, t.pageY || t.clientY] : [t.pageX, t.pageY];\r\n            }\r\n        },\r\n        _getTouch = function(touches, idx) { return touches.item ? touches.item(idx) : touches[idx]; },\r\n        _touches = function(e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                        [ e ];\r\n        },\r\n        _classes = {\r\n            delegatedDraggable:\"katavorio-delegated-draggable\",  // elements that are the delegated drag handler for a bunch of other elements\r\n            draggable:\"katavorio-draggable\",    // draggable elements\r\n            droppable:\"katavorio-droppable\",    // droppable elements\r\n            drag : \"katavorio-drag\",            // elements currently being dragged\r\n            selected:\"katavorio-drag-selected\", // elements in current drag selection\r\n            active : \"katavorio-drag-active\",   // droppables that are targets of a currently dragged element\r\n            hover : \"katavorio-drag-hover\",     // droppables over which a matching drag element is hovering\r\n            noSelect : \"katavorio-drag-no-select\", // added to the body to provide a hook to suppress text selection\r\n            ghostProxy:\"katavorio-ghost-proxy\",  // added to a ghost proxy element in use when a drag has exited the bounds of its parent.\r\n            clonedDrag:\"katavorio-clone-drag\"     // added to a node that is a clone of an element created at the start of a drag\r\n        },\r\n        _defaultScope = \"katavorio-drag-scope\",\r\n        _events = [ \"stop\", \"start\", \"drag\", \"drop\", \"over\", \"out\", \"beforeStart\" ],\r\n        _devNull = function() {},\r\n        _true = function() { return true; },\r\n        _foreach = function(l, fn, from) {\r\n            for (var i = 0; i < l.length; i++) {\r\n                if (l[i] != from)\r\n                    fn(l[i]);\r\n            }\r\n        },\r\n        _setDroppablesActive = function(dd, val, andHover, drag) {\r\n            _foreach(dd, function(e) {\r\n                e.setActive(val);\r\n                if (val) e.updatePosition();\r\n                if (andHover) e.setHover(drag, val);\r\n            });\r\n        },\r\n        _each = function(obj, fn) {\r\n            if (obj == null) return;\r\n            obj = !_isString(obj) && (obj.tagName == null && obj.length != null) ? obj : [ obj ];\r\n            for (var i = 0; i < obj.length; i++)\r\n                fn.apply(obj[i], [ obj[i] ]);\r\n        },\r\n        _consume = function(e) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            }\r\n            else {\r\n                e.returnValue = false;\r\n            }\r\n        },\r\n        _defaultInputFilterSelector = \"input,textarea,select,button,option\",\r\n        //\r\n        // filters out events on all input elements, like textarea, checkbox, input, select.\r\n        _inputFilter = function(e, el, _katavorio) {\r\n            var t = e.srcElement || e.target;\r\n            return !matchesSelector(t, _katavorio.getInputFilterSelector(), el);\r\n        };\r\n\r\n    var Super = function(el, params, css, scope) {\r\n        this.params = params || {};\r\n        this.el = el;\r\n        this.params.addClass(this.el, this._class);\r\n        this.uuid = _uuid();\r\n        var enabled = true;\r\n        this.setEnabled = function(e) { enabled = e; };\r\n        this.isEnabled = function() { return enabled; };\r\n        this.toggleEnabled = function() { enabled = !enabled; };\r\n        this.setScope = function(scopes) {\r\n            this.scopes = scopes ? scopes.split(/\\s+/) : [ scope ];\r\n        };\r\n        this.addScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { m[s] = true;});\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.removeScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { delete m[s];});\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.toggleScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) {\r\n                if (m[s]) delete m[s];\r\n                else m[s] = true;\r\n            });\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.setScope(params.scope);\r\n        this.k = params.katavorio;\r\n        return params.katavorio;\r\n    };\r\n\r\n    var TRUE = function() { return true; };\r\n    var FALSE = function() { return false; };\r\n\r\n    var Drag = function(el, params, css, scope) {\r\n        this._class = css.draggable;\r\n        var k = Super.apply(this, arguments);\r\n        this.rightButtonCanDrag = this.params.rightButtonCanDrag;\r\n        var downAt = [0,0], posAtDown = null, pagePosAtDown = null, pageDelta = [0,0], moving = false, initialScroll = [0,0],\r\n            consumeStartEvent = this.params.consumeStartEvent !== false,\r\n            dragEl = this.el,\r\n            clone = this.params.clone,\r\n            scroll = this.params.scroll,\r\n            _multipleDrop = params.multipleDrop !== false,\r\n            isConstrained = false,\r\n            useGhostProxy = params.ghostProxy === true ? TRUE : params.ghostProxy && typeof params.ghostProxy === \"function\" ? params.ghostProxy : FALSE,\r\n            ghostProxy = function(el) { return el.cloneNode(true); },\r\n            elementToDrag = null,\r\n            availableSelectors = [],\r\n            activeSelectorParams = null, // which, if any, selector config is currently active.\r\n            ghostProxyParent = params.ghostProxyParent,\r\n            currentParentPosition,\r\n            ghostParentPosition,\r\n            ghostDx,\r\n            ghostDy;\r\n\r\n        // if an initial selector was provided, push the entire set of params as a selector config.\r\n        if (params.selector) {\r\n            var draggableId = el.getAttribute(\"katavorio-draggable\");\r\n            if (draggableId == null) {\r\n                draggableId = \"\" + new Date().getTime();\r\n                el.setAttribute(\"katavorio-draggable\", draggableId);\r\n            }\r\n\r\n            availableSelectors.push(params);\r\n        }\r\n\r\n        var snapThreshold = params.snapThreshold,\r\n            _snap = function(pos, gridX, gridY, thresholdX, thresholdY) {\r\n                var _dx = Math.floor(pos[0] / gridX),\r\n                    _dxl = gridX * _dx,\r\n                    _dxt = _dxl + gridX,\r\n                    _x = Math.abs(pos[0] - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos[0]) <= thresholdX ? _dxt : pos[0];\r\n\r\n                var _dy = Math.floor(pos[1] / gridY),\r\n                    _dyl = gridY * _dy,\r\n                    _dyt = _dyl + gridY,\r\n                    _y = Math.abs(pos[1] - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos[1]) <= thresholdY ? _dyt : pos[1];\r\n\r\n                return [ _x, _y];\r\n            };\r\n\r\n        this.posses = [];\r\n        this.posseRoles = {};\r\n\r\n        this.toGrid = function(pos) {\r\n            if (this.params.grid == null) {\r\n                return pos;\r\n            }\r\n            else {\r\n                var tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_X / 2,\r\n                    ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold ? snapThreshold : DEFAULT_GRID_Y / 2;\r\n\r\n                return _snap(pos, this.params.grid[0], this.params.grid[1], tx, ty);\r\n            }\r\n        };\r\n\r\n        this.snap = function(x, y) {\r\n            if (dragEl == null) return;\r\n            x = x || (this.params.grid ? this.params.grid[0] : DEFAULT_GRID_X);\r\n            y = y || (this.params.grid ? this.params.grid[1] : DEFAULT_GRID_Y);\r\n            var p = this.params.getPosition(dragEl),\r\n                tx = this.params.grid ? this.params.grid[0] / 2 : snapThreshold,\r\n                ty = this.params.grid ? this.params.grid[1] / 2 : snapThreshold,\r\n                snapped = _snap(p, x, y, tx, ty);\r\n\r\n            this.params.setPosition(dragEl, snapped);\r\n            return snapped;\r\n        };\r\n\r\n        this.setUseGhostProxy = function(val) {\r\n            useGhostProxy = val ? TRUE : FALSE;\r\n        };\r\n\r\n        var constrain;\r\n        var negativeFilter = function(pos) {\r\n            return (params.allowNegative === false) ? [ Math.max (0, pos[0]), Math.max(0, pos[1]) ] : pos;\r\n        };\r\n\r\n        var _setConstrain = function(value) {\r\n            constrain = typeof value === \"function\" ? value : value ? function(pos, dragEl, _constrainRect, _size) {\r\n                return negativeFilter([\r\n                    Math.max(0, Math.min(_constrainRect.w - _size[0], pos[0])),\r\n                    Math.max(0, Math.min(_constrainRect.h - _size[1], pos[1]))\r\n                ]);\r\n            }.bind(this) : function(pos) { return negativeFilter(pos); };\r\n        }.bind(this);\r\n\r\n        _setConstrain(typeof this.params.constrain === \"function\" ? this.params.constrain  : (this.params.constrain || this.params.containment));\r\n\r\n\r\n        /**\r\n         * Sets whether or not the Drag is constrained. A value of 'true' means constrain to parent bounds; a function\r\n         * will be executed and returns true if the position is allowed.\r\n         * @param value\r\n         */\r\n        this.setConstrain = function(value) {\r\n            _setConstrain(value);\r\n        };\r\n\r\n        var revertFunction;\r\n        /**\r\n         * Sets a function to call on drag stop, which, if it returns true, indicates that the given element should\r\n         * revert to its position before the previous drag.\r\n         * @param fn\r\n         */\r\n        this.setRevert = function(fn) {\r\n            revertFunction = fn;\r\n        };\r\n\r\n        if (this.params.revert) {\r\n            revertFunction = this.params.revert;\r\n        }\r\n\r\n        var _assignId = function(obj) {\r\n                if (typeof obj === \"function\") {\r\n                    obj._katavorioId = _uuid();\r\n                    return obj._katavorioId;\r\n                } else {\r\n                    return obj;\r\n                }\r\n            },\r\n            // a map of { spec -> [ fn, exclusion ] } entries.\r\n            _filters = {},\r\n            _testFilter = function(e) {\r\n                for (var key in _filters) {\r\n                    var f = _filters[key];\r\n                    var rv = f[0](e);\r\n                    if (f[1]) rv = !rv;\r\n                    if (!rv) return false;\r\n                }\r\n                return true;\r\n            },\r\n            _setFilter = this.setFilter = function(f, _exclude) {\r\n                if (f) {\r\n                    var key = _assignId(f);\r\n                    _filters[key] = [\r\n                        function(e) {\r\n                            var t = e.srcElement || e.target, m;\r\n                            if (_isString(f)) {\r\n                                m = matchesSelector(t, f, el);\r\n                            }\r\n                            else if (typeof f === \"function\") {\r\n                                m = f(e, el);\r\n                            }\r\n                            return m;\r\n                        },\r\n                        _exclude !== false\r\n                    ];\r\n\r\n                }\r\n            },\r\n            _addFilter = this.addFilter = _setFilter,\r\n            _removeFilter = this.removeFilter = function(f) {\r\n                var key = typeof f === \"function\" ? f._katavorioId : f;\r\n                delete _filters[key];\r\n            };\r\n\r\n        this.clearAllFilters = function() {\r\n            _filters = {};\r\n        };\r\n\r\n        this.canDrag = this.params.canDrag || _true;\r\n\r\n        var constrainRect,\r\n            matchingDroppables = [],\r\n            intersectingDroppables = [];\r\n\r\n        this.addSelector = function(params) {\r\n            if (params.selector) {\r\n                availableSelectors.push(params);\r\n            }\r\n        };\r\n\r\n        this.downListener = function(e) {\r\n            if (e.defaultPrevented) { return; }\r\n            var isNotRightClick = this.rightButtonCanDrag || (e.which !== 3 && e.button !== 2);\r\n            if (isNotRightClick && this.isEnabled() && this.canDrag()) {\r\n\r\n                var _f =  _testFilter(e) && _inputFilter(e, this.el, this.k);\r\n                if (_f) {\r\n\r\n                    activeSelectorParams = null;\r\n                    elementToDrag = null;\r\n\r\n                    // if (selector) {\r\n                    //     elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\r\n                    //     if(elementToDrag == null) {\r\n                    //         return;\r\n                    //     }\r\n                    // }\r\n                    if (availableSelectors.length > 0) {\r\n                        var match = findMatchingSelector(availableSelectors, this.el, e.target || e.srcElement);\r\n                        if (match != null) {\r\n                            activeSelectorParams = match[0];\r\n                            elementToDrag = match[1];\r\n                        }\r\n                        // elementToDrag = findDelegateElement(this.el, e.target || e.srcElement, selector);\r\n                        if(elementToDrag == null) {\r\n                            return;\r\n                        }\r\n                    }\r\n                    else {\r\n                        elementToDrag = this.el;\r\n                    }\r\n\r\n                    if (clone) {\r\n                        dragEl = elementToDrag.cloneNode(true);\r\n                        this.params.addClass(dragEl, _classes.clonedDrag);\r\n\r\n                        dragEl.setAttribute(\"id\", null);\r\n                        dragEl.style.position = \"absolute\";\r\n\r\n                        if (this.params.parent != null) {\r\n                            var p = this.params.getPosition(this.el);\r\n                            dragEl.style.left = p[0] + \"px\";\r\n                            dragEl.style.top = p[1] + \"px\";\r\n                            this.params.parent.appendChild(dragEl);\r\n                        } else {\r\n                            // the clone node is added to the body; getOffsetRect gives us a value\r\n                            // relative to the body.\r\n                            var b = getOffsetRect(elementToDrag);\r\n                            dragEl.style.left = b.left + \"px\";\r\n                            dragEl.style.top = b.top + \"px\";\r\n\r\n                            document.body.appendChild(dragEl);\r\n                        }\r\n\r\n                    } else {\r\n                        dragEl = elementToDrag;\r\n                    }\r\n\r\n                    consumeStartEvent && _consume(e);\r\n                    downAt = _pl(e);\r\n                    if (dragEl && dragEl.parentNode)\r\n                    {\r\n                        initialScroll = [dragEl.parentNode.scrollLeft, dragEl.parentNode.scrollTop];\r\n                    }\r\n                    //\r\n                    this.params.bind(document, \"mousemove\", this.moveListener);\r\n                    this.params.bind(document, \"mouseup\", this.upListener);\r\n                    k.markSelection(this);\r\n                    k.markPosses(this);\r\n                    this.params.addClass(document.body, css.noSelect);\r\n                    _dispatch(\"beforeStart\", {el:this.el, pos:posAtDown, e:e, drag:this});\r\n                }\r\n                else if (this.params.consumeFilteredEvents) {\r\n                    _consume(e);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        this.moveListener = function(e) {\r\n            if (downAt) {\r\n                if (!moving) {\r\n                    var _continue = _dispatch(\"start\", {el:this.el, pos:posAtDown, e:e, drag:this});\r\n                    if (_continue !== false) {\r\n                        if (!downAt) {\r\n                            return;\r\n                        }\r\n                        this.mark(true);\r\n                        moving = true;\r\n                    } else {\r\n                        this.abort();\r\n                    }\r\n                }\r\n\r\n                // it is possible that the start event caused the drag to be aborted. So we check\r\n                // again that we are currently dragging.\r\n                if (downAt) {\r\n                    intersectingDroppables.length = 0;\r\n                    var pos = _pl(e), dx = pos[0] - downAt[0], dy = pos[1] - downAt[1],\r\n                        z = this.params.ignoreZoom ? 1 : k.getZoom();\r\n                    if (dragEl && dragEl.parentNode)\r\n                    {\r\n                        dx += dragEl.parentNode.scrollLeft - initialScroll[0];\r\n                        dy += dragEl.parentNode.scrollTop - initialScroll[1];\r\n                    }\r\n                    dx /= z;\r\n                    dy /= z;\r\n                    this.moveBy(dx, dy, e);\r\n                    k.updateSelection(dx, dy, this);\r\n                    k.updatePosses(dx, dy, this);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        this.upListener = function(e) {\r\n            if (downAt) {\r\n                downAt = null;\r\n                this.params.unbind(document, \"mousemove\", this.moveListener);\r\n                this.params.unbind(document, \"mouseup\", this.upListener);\r\n                this.params.removeClass(document.body, css.noSelect);\r\n                this.unmark(e);\r\n                k.unmarkSelection(this, e);\r\n                k.unmarkPosses(this, e);\r\n                this.stop(e);\r\n\r\n                k.notifyPosseDragStop(this, e);\r\n                moving = false;\r\n                intersectingDroppables.length = 0;\r\n\r\n                if (clone) {\r\n                    dragEl && dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\r\n                    dragEl = null;\r\n                } else {\r\n                    if (revertFunction && revertFunction(dragEl, this.params.getPosition(dragEl)) === true) {\r\n                        this.params.setPosition(dragEl, posAtDown);\r\n                        _dispatch(\"revert\", dragEl);\r\n                    }\r\n                }\r\n\r\n            }\r\n        }.bind(this);\r\n\r\n        this.getFilters = function() { return _filters; };\r\n\r\n        this.abort = function() {\r\n            if (downAt != null) {\r\n                this.upListener();\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Returns the element that was last dragged. This may be some original element from the DOM, or if `clone` is\r\n         * set, then its actually a copy of some original DOM element. In some client calls to this method, it is the\r\n         * actual element that was dragged that is desired. In others, it is the original DOM element that the user\r\n         * wishes to get - in which case, pass true for `retrieveOriginalElement`.\r\n         *\r\n         * @returns {*}\r\n         */\r\n        this.getDragElement = function(retrieveOriginalElement) {\r\n            return retrieveOriginalElement ? elementToDrag || this.el : dragEl || this.el;\r\n        };\r\n\r\n        var listeners = {\"start\":[], \"drag\":[], \"stop\":[], \"over\":[], \"out\":[], \"beforeStart\":[], \"revert\":[] };\r\n        if (params.events.start) listeners.start.push(params.events.start);\r\n        if (params.events.beforeStart) listeners.beforeStart.push(params.events.beforeStart);\r\n        if (params.events.stop) listeners.stop.push(params.events.stop);\r\n        if (params.events.drag) listeners.drag.push(params.events.drag);\r\n        if (params.events.revert) listeners.revert.push(params.events.revert);\r\n\r\n        this.on = function(evt, fn) {\r\n            if (listeners[evt]) listeners[evt].push(fn);\r\n        };\r\n\r\n        this.off = function(evt, fn) {\r\n            if (listeners[evt]) {\r\n                var l = [];\r\n                for (var i = 0; i < listeners[evt].length; i++) {\r\n                    if (listeners[evt][i] !== fn) l.push(listeners[evt][i]);\r\n                }\r\n                listeners[evt] = l;\r\n            }\r\n        };\r\n\r\n        var _dispatch = function(evt, value) {\r\n            var result = null;\r\n            if (activeSelectorParams && activeSelectorParams[evt]) {\r\n                result = activeSelectorParams[evt](value);\r\n            } else if (listeners[evt]) {\r\n                for (var i = 0; i < listeners[evt].length; i++) {\r\n                    try {\r\n                        var v = listeners[evt][i](value);\r\n                        if (v != null) {\r\n                            result = v;\r\n                        }\r\n                    }\r\n                    catch (e) { }\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        this.notifyStart = function(e) {\r\n            _dispatch(\"start\", {el:this.el, pos:this.params.getPosition(dragEl), e:e, drag:this});\r\n        };\r\n\r\n        this.stop = function(e, force) {\r\n            if (force || moving) {\r\n                var positions = [],\r\n                    sel = k.getSelection(),\r\n                    dPos = this.params.getPosition(dragEl);\r\n\r\n                if (sel.length > 0) {\r\n                    for (var i = 0; i < sel.length; i++) {\r\n                        var p = this.params.getPosition(sel[i].el);\r\n                        positions.push([ sel[i].el, { left: p[0], top: p[1] }, sel[i] ]);\r\n                    }\r\n                }\r\n                else {\r\n                    positions.push([ dragEl, {left:dPos[0], top:dPos[1]}, this ]);\r\n                }\r\n\r\n                _dispatch(\"stop\", {\r\n                    el: dragEl,\r\n                    pos: ghostProxyOffsets || dPos,\r\n                    finalPos:dPos,\r\n                    e: e,\r\n                    drag: this,\r\n                    selection:positions\r\n                });\r\n            }\r\n        };\r\n\r\n        this.mark = function(andNotify) {\r\n            posAtDown = this.params.getPosition(dragEl);\r\n            pagePosAtDown = this.params.getPosition(dragEl, true);\r\n            pageDelta = [pagePosAtDown[0] - posAtDown[0], pagePosAtDown[1] - posAtDown[1]];\r\n            this.size = this.params.getSize(dragEl);\r\n            matchingDroppables = k.getMatchingDroppables(this);\r\n            _setDroppablesActive(matchingDroppables, true, false, this);\r\n            this.params.addClass(dragEl, this.params.dragClass || css.drag);\r\n\r\n            var cs;\r\n            if (this.params.getConstrainingRectangle) {\r\n                cs = this.params.getConstrainingRectangle(dragEl)\r\n            } else {\r\n                cs = this.params.getSize(dragEl.parentNode);\r\n            }\r\n            constrainRect = {w: cs[0], h: cs[1]};\r\n\r\n            ghostDx = 0;\r\n            ghostDy = 0;\r\n\r\n            if (andNotify) {\r\n                k.notifySelectionDragStart(this);\r\n            }\r\n        };\r\n        var ghostProxyOffsets;\r\n        this.unmark = function(e, doNotCheckDroppables) {\r\n            _setDroppablesActive(matchingDroppables, false, true, this);\r\n\r\n            if (isConstrained && useGhostProxy(elementToDrag, dragEl)) {\r\n                ghostProxyOffsets = [dragEl.offsetLeft - ghostDx, dragEl.offsetTop - ghostDy];\r\n                dragEl.parentNode.removeChild(dragEl);\r\n                dragEl = elementToDrag;\r\n            }\r\n            else {\r\n                ghostProxyOffsets = null;\r\n            }\r\n\r\n            this.params.removeClass(dragEl, this.params.dragClass || css.drag);\r\n            matchingDroppables.length = 0;\r\n            isConstrained = false;\r\n            if (!doNotCheckDroppables) {\r\n                if (intersectingDroppables.length > 0 && ghostProxyOffsets) {\r\n                    params.setPosition(elementToDrag, ghostProxyOffsets);\r\n                }\r\n                intersectingDroppables.sort(_rankSort);\r\n                for (var i = 0; i < intersectingDroppables.length; i++) {\r\n                    var retVal = intersectingDroppables[i].drop(this, e);\r\n                    if (retVal === true) break;\r\n                }\r\n            }\r\n        };\r\n        this.moveBy = function(dx, dy, e) {\r\n            intersectingDroppables.length = 0;\r\n\r\n            var desiredLoc = this.toGrid([posAtDown[0] + dx, posAtDown[1] + dy]),\r\n                cPos = constrain(desiredLoc, dragEl, constrainRect, this.size);\r\n\r\n            // if we should use a ghost proxy...\r\n            if (useGhostProxy(this.el, dragEl)) {\r\n                // and the element has been dragged outside of its parent bounds\r\n                if (desiredLoc[0] !== cPos[0] || desiredLoc[1] !== cPos[1]) {\r\n\r\n                    // ...if ghost proxy not yet created\r\n                    if (!isConstrained) {\r\n                        // create it\r\n                        var gp = ghostProxy(elementToDrag);\r\n                        params.addClass(gp, _classes.ghostProxy);\r\n\r\n                        if (ghostProxyParent) {\r\n                            ghostProxyParent.appendChild(gp);\r\n                            // find offset between drag el's parent the ghost parent\r\n                            currentParentPosition = params.getPosition(elementToDrag.parentNode, true);\r\n                            ghostParentPosition = params.getPosition(params.ghostProxyParent, true);\r\n                            ghostDx = currentParentPosition[0] - ghostParentPosition[0];\r\n                            ghostDy = currentParentPosition[1] - ghostParentPosition[1];\r\n\r\n                        } else {\r\n                            elementToDrag.parentNode.appendChild(gp);\r\n                        }\r\n\r\n                        // the ghost proxy is the drag element\r\n                        dragEl = gp;\r\n                        // set this flag so we dont recreate the ghost proxy\r\n                        isConstrained = true;\r\n                    }\r\n                    // now the drag position can be the desired position, as the ghost proxy can support it.\r\n                    cPos = desiredLoc;\r\n                }\r\n                else {\r\n                    // if the element is not outside of its parent bounds, and ghost proxy is in place,\r\n                    if (isConstrained) {\r\n                        // remove the ghost proxy from the dom\r\n                        dragEl.parentNode.removeChild(dragEl);\r\n                        // reset the drag element to the original element\r\n                        dragEl = elementToDrag;\r\n                        // clear this flag.\r\n                        isConstrained = false;\r\n                        currentParentPosition = null;\r\n                        ghostParentPosition = null;\r\n                        ghostDx = 0;\r\n                        ghostDy = 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            var rect = { x:cPos[0], y:cPos[1], w:this.size[0], h:this.size[1]},\r\n                pageRect = { x:rect.x + pageDelta[0], y:rect.y + pageDelta[1], w:rect.w, h:rect.h},\r\n                focusDropElement = null;\r\n\r\n            this.params.setPosition(dragEl, [cPos[0] + ghostDx, cPos[1] + ghostDy]);\r\n\r\n            for (var i = 0; i < matchingDroppables.length; i++) {\r\n                var r2 = { x:matchingDroppables[i].pagePosition[0], y:matchingDroppables[i].pagePosition[1], w:matchingDroppables[i].size[0], h:matchingDroppables[i].size[1]};\r\n                if (this.params.intersects(pageRect, r2) && (_multipleDrop || focusDropElement == null || focusDropElement === matchingDroppables[i].el) && matchingDroppables[i].canDrop(this)) {\r\n                    if (!focusDropElement) focusDropElement = matchingDroppables[i].el;\r\n                    intersectingDroppables.push(matchingDroppables[i]);\r\n                    matchingDroppables[i].setHover(this, true, e);\r\n                }\r\n                else if (matchingDroppables[i].isHover()) {\r\n                    matchingDroppables[i].setHover(this, false, e);\r\n                }\r\n            }\r\n\r\n            _dispatch(\"drag\", {el:this.el, pos:cPos, e:e, drag:this});\r\n\r\n            /* test to see if the parent needs to be scrolled (future)\r\n             if (scroll) {\r\n             var pnsl = dragEl.parentNode.scrollLeft, pnst = dragEl.parentNode.scrollTop;\r\n             console.log(\"scroll!\", pnsl, pnst);\r\n             }*/\r\n        };\r\n        this.destroy = function() {\r\n            this.params.unbind(this.el, \"mousedown\", this.downListener);\r\n            this.params.unbind(document, \"mousemove\", this.moveListener);\r\n            this.params.unbind(document, \"mouseup\", this.upListener);\r\n            this.downListener = null;\r\n            this.upListener = null;\r\n            this.moveListener = null;\r\n        };\r\n\r\n        // init:register mousedown, and perhaps set a filter\r\n        this.params.bind(this.el, \"mousedown\", this.downListener);\r\n\r\n        // if handle provided, use that.  otherwise, try to set a filter.\r\n        // note that a `handle` selector always results in filterExclude being set to false, ie.\r\n        // the selector defines the handle element(s).\r\n        if (this.params.handle)\r\n            _setFilter(this.params.handle, false);\r\n        else\r\n            _setFilter(this.params.filter, this.params.filterExclude);\r\n    };\r\n\r\n    var Drop = function(el, params, css, scope) {\r\n        this._class = css.droppable;\r\n        this.params = params || {};\r\n        this.rank = params.rank || 0;\r\n        this._activeClass = this.params.activeClass || css.active;\r\n        this._hoverClass = this.params.hoverClass || css.hover;\r\n        Super.apply(this, arguments);\r\n        var hover = false;\r\n        this.allowLoopback = this.params.allowLoopback !== false;\r\n\r\n        this.setActive = function(val) {\r\n            this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._activeClass);\r\n        };\r\n\r\n        this.updatePosition = function() {\r\n            this.position = this.params.getPosition(this.el);\r\n            this.pagePosition = this.params.getPosition(this.el, true);\r\n            this.size = this.params.getSize(this.el);\r\n        };\r\n\r\n        this.canDrop = this.params.canDrop || function(drag) {\r\n            return true;\r\n        };\r\n\r\n        this.isHover = function() { return hover; };\r\n\r\n        this.setHover = function(drag, val, e) {\r\n            // if turning off hover but this was not the drag that caused the hover, ignore.\r\n            if (val || this.el._katavorioDragHover == null || this.el._katavorioDragHover === drag.el._katavorio) {\r\n                this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._hoverClass);\r\n                this.el._katavorioDragHover = val ? drag.el._katavorio : null;\r\n                if (hover !== val) {\r\n                    this.params.events[val ? \"over\" : \"out\"]({el: this.el, e: e, drag: drag, drop: this});\r\n                }\r\n                hover = val;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * A drop event. `drag` is the corresponding Drag object, which may be a Drag for some specific element, or it\r\n         * may be a Drag on some element acting as a delegate for elements contained within it.\r\n         * @param drag\r\n         * @param event\r\n         * @returns {*}\r\n         */\r\n        this.drop = function(drag, event) {\r\n            return this.params.events[\"drop\"]({ drag:drag, e:event, drop:this });\r\n        };\r\n\r\n        this.destroy = function() {\r\n            this._class = null;\r\n            this._activeClass = null;\r\n            this._hoverClass = null;\r\n            hover = null;\r\n        };\r\n    };\r\n\r\n    var _uuid = function() {\r\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            var r = Math.random()*16|0, v = c === 'x' ? r : (r&0x3|0x8);\r\n            return v.toString(16);\r\n        }));\r\n    };\r\n\r\n    var _rankSort = function(a,b) {\r\n        return a.rank < b.rank ? 1 : a.rank > b.rank ? -1 : 0;\r\n    };\r\n\r\n    var _gel = function(el) {\r\n        if (el == null) return null;\r\n        el = (typeof el === \"string\" || el.constructor === String)  ? document.getElementById(el) : el;\r\n        if (el == null) return null;\r\n        el._katavorio = el._katavorio || _uuid();\r\n        return el;\r\n    };\r\n\r\n    root.Katavorio = function(katavorioParams) {\r\n\r\n        var _selection = [],\r\n            _selectionMap = {};\r\n\r\n        this._dragsByScope = {};\r\n        this._dropsByScope = {};\r\n        var _zoom = 1,\r\n            _reg = function(obj, map) {\r\n                _each(obj, function(_obj) {\r\n                    for(var i = 0; i < _obj.scopes.length; i++) {\r\n                        map[_obj.scopes[i]] = map[_obj.scopes[i]] || [];\r\n                        map[_obj.scopes[i]].push(_obj);\r\n                    }\r\n                });\r\n            },\r\n            _unreg = function(obj, map) {\r\n                var c = 0;\r\n                _each(obj, function(_obj) {\r\n                    for(var i = 0; i < _obj.scopes.length; i++) {\r\n                        if (map[_obj.scopes[i]]) {\r\n                            var idx = katavorioParams.indexOf(map[_obj.scopes[i]], _obj);\r\n                            if (idx !== -1) {\r\n                                map[_obj.scopes[i]].splice(idx, 1);\r\n                                c++;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                return c > 0 ;\r\n            },\r\n            _getMatchingDroppables = this.getMatchingDroppables = function(drag) {\r\n                var dd = [], _m = {};\r\n                for (var i = 0; i < drag.scopes.length; i++) {\r\n                    var _dd = this._dropsByScope[drag.scopes[i]];\r\n                    if (_dd) {\r\n                        for (var j = 0; j < _dd.length; j++) {\r\n                            if (_dd[j].canDrop(drag) &&  !_m[_dd[j].uuid] && (_dd[j].allowLoopback || _dd[j].el !== drag.el)) {\r\n                                _m[_dd[j].uuid] = true;\r\n                                dd.push(_dd[j]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                dd.sort(_rankSort);\r\n                return dd;\r\n            },\r\n            _prepareParams = function(p) {\r\n                p = p || {};\r\n                var _p = {\r\n                    events:{}\r\n                }, i;\r\n                for (i in katavorioParams) _p[i] = katavorioParams[i];\r\n                for (i in p) _p[i] = p[i];\r\n                // events\r\n\r\n                for (i = 0; i < _events.length; i++) {\r\n                    _p.events[_events[i]] = p[_events[i]] || _devNull;\r\n                }\r\n                _p.katavorio = this;\r\n                return _p;\r\n            }.bind(this),\r\n            _mistletoe = function(existingDrag, params) {\r\n                for (var i = 0; i < _events.length; i++) {\r\n                    if (params[_events[i]]) {\r\n                        existingDrag.on(_events[i], params[_events[i]]);\r\n                    }\r\n                }\r\n            }.bind(this),\r\n            _css = {},\r\n            overrideCss = katavorioParams.css || {},\r\n            _scope = katavorioParams.scope || _defaultScope;\r\n\r\n        // prepare map of css classes based on defaults frst, then optional overrides\r\n        for (var i in _classes) _css[i] = _classes[i];\r\n        for (var i in overrideCss) _css[i] = overrideCss[i];\r\n\r\n        var inputFilterSelector = katavorioParams.inputFilterSelector || _defaultInputFilterSelector;\r\n        /**\r\n         * Gets the selector identifying which input elements to filter from drag events.\r\n         * @method getInputFilterSelector\r\n         * @return {String} Current input filter selector.\r\n         */\r\n        this.getInputFilterSelector = function() { return inputFilterSelector; };\r\n\r\n        /**\r\n         * Sets the selector identifying which input elements to filter from drag events.\r\n         * @method setInputFilterSelector\r\n         * @param {String} selector Input filter selector to set.\r\n         * @return {Katavorio} Current instance; method may be chained.\r\n         */\r\n        this.setInputFilterSelector = function(selector) {\r\n            inputFilterSelector = selector;\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Either makes the given element draggable, or identifies it as an element inside which some identified list\r\n         * of elements may be draggable.\r\n         * @param el\r\n         * @param params\r\n         * @returns {Array}\r\n         */\r\n        this.draggable = function(el, params) {\r\n            var o = [];\r\n            _each(el, function (_el) {\r\n                _el = _gel(_el);\r\n                if (_el != null) {\r\n                    if (_el._katavorioDrag == null) {\r\n                        var p = _prepareParams(params);\r\n                        _el._katavorioDrag = new Drag(_el, p, _css, _scope);\r\n                        _reg(_el._katavorioDrag, this._dragsByScope);\r\n                        o.push(_el._katavorioDrag);\r\n                        katavorioParams.addClass(_el, p.selector ? _css.delegatedDraggable : _css.draggable);\r\n                    }\r\n                    else {\r\n                        _mistletoe(_el._katavorioDrag, params);\r\n                    }\r\n                }\r\n            }.bind(this));\r\n            return o;\r\n        };\r\n\r\n        this.droppable = function(el, params) {\r\n            var o = [];\r\n            _each(el, function(_el) {\r\n                _el = _gel(_el);\r\n                if (_el != null) {\r\n                    var drop = new Drop(_el, _prepareParams(params), _css, _scope);\r\n                    _el._katavorioDrop = _el._katavorioDrop || [];\r\n                    _el._katavorioDrop.push(drop);\r\n                    _reg(drop, this._dropsByScope);\r\n                    o.push(drop);\r\n                    katavorioParams.addClass(_el, _css.droppable);\r\n                }\r\n            }.bind(this));\r\n            return o;\r\n        };\r\n\r\n        /**\r\n         * @name Katavorio#select\r\n         * @function\r\n         * @desc Adds an element to the current selection (for multiple node drag)\r\n         * @param {Element|String} DOM element - or id of the element - to add.\r\n         */\r\n        this.select = function(el) {\r\n            _each(el, function() {\r\n                var _el = _gel(this);\r\n                if (_el && _el._katavorioDrag) {\r\n                    if (!_selectionMap[_el._katavorio]) {\r\n                        _selection.push(_el._katavorioDrag);\r\n                        _selectionMap[_el._katavorio] = [ _el, _selection.length - 1 ];\r\n                        katavorioParams.addClass(_el, _css.selected);\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * @name Katavorio#deselect\r\n         * @function\r\n         * @desc Removes an element from the current selection (for multiple node drag)\r\n         * @param {Element|String} DOM element - or id of the element - to remove.\r\n         */\r\n        this.deselect = function(el) {\r\n            _each(el, function() {\r\n                var _el = _gel(this);\r\n                if (_el && _el._katavorio) {\r\n                    var e = _selectionMap[_el._katavorio];\r\n                    if (e) {\r\n                        var _s = [];\r\n                        for (var i = 0; i < _selection.length; i++)\r\n                            if (_selection[i].el !== _el) _s.push(_selection[i]);\r\n                        _selection = _s;\r\n                        delete _selectionMap[_el._katavorio];\r\n                        katavorioParams.removeClass(_el, _css.selected);\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        };\r\n\r\n        this.deselectAll = function() {\r\n            for (var i in _selectionMap) {\r\n                var d = _selectionMap[i];\r\n                katavorioParams.removeClass(d[0], _css.selected);\r\n            }\r\n\r\n            _selection.length = 0;\r\n            _selectionMap = {};\r\n        };\r\n\r\n        this.markSelection = function(drag) {\r\n            _foreach(_selection, function(e) { e.mark(); }, drag);\r\n        };\r\n\r\n        this.markPosses = function(drag) {\r\n            if (drag.posses) {\r\n                _each(drag.posses, function(p) {\r\n                    if (drag.posseRoles[p] && _posses[p]) {\r\n                        _foreach(_posses[p].members, function (d) {\r\n                            d.mark();\r\n                        }, drag);\r\n                    }\r\n                })\r\n            }\r\n        };\r\n\r\n        this.unmarkSelection = function(drag, event) {\r\n            _foreach(_selection, function(e) { e.unmark(event); }, drag);\r\n        };\r\n\r\n        this.unmarkPosses = function(drag, event) {\r\n            if (drag.posses) {\r\n                _each(drag.posses, function(p) {\r\n                    if (drag.posseRoles[p] && _posses[p]) {\r\n                        _foreach(_posses[p].members, function (d) {\r\n                            d.unmark(event, true);\r\n                        }, drag);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        this.getSelection = function() { return _selection.slice(0); };\r\n\r\n        this.updateSelection = function(dx, dy, drag) {\r\n            _foreach(_selection, function(e) { e.moveBy(dx, dy); }, drag);\r\n        };\r\n\r\n        var _posseAction = function(fn, drag) {\r\n            if (drag.posses) {\r\n                _each(drag.posses, function(p) {\r\n                    if (drag.posseRoles[p] && _posses[p]) {\r\n                        _foreach(_posses[p].members, function (e) {\r\n                            fn(e);\r\n                        }, drag);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        this.updatePosses = function(dx, dy, drag) {\r\n            _posseAction(function(e) { e.moveBy(dx, dy); }, drag);\r\n        };\r\n\r\n        this.notifyPosseDragStop = function(drag, evt) {\r\n            _posseAction(function(e) { e.stop(evt, true); }, drag);\r\n        };\r\n\r\n        this.notifySelectionDragStop = function(drag, evt) {\r\n            _foreach(_selection, function(e) { e.stop(evt, true); }, drag);\r\n        };\r\n\r\n        this.notifySelectionDragStart = function(drag, evt) {\r\n            _foreach(_selection, function(e) { e.notifyStart(evt);}, drag);\r\n        };\r\n\r\n        this.setZoom = function(z) { _zoom = z; };\r\n        this.getZoom = function() { return _zoom; };\r\n\r\n        // does the work of changing scopes\r\n        var _scopeManip = function(kObj, scopes, map, fn) {\r\n            _each(kObj, function(_kObj) {\r\n                _unreg(_kObj, map);  // deregister existing scopes\r\n                _kObj[fn](scopes); // set scopes\r\n                _reg(_kObj, map); // register new ones\r\n            });\r\n        };\r\n\r\n        _each([ \"set\", \"add\", \"remove\", \"toggle\"], function(v) {\r\n            this[v + \"Scope\"] = function(el, scopes) {\r\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\r\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n            this[v + \"DragScope\"] = function(el, scopes) {\r\n                _scopeManip(el.constructor === Drag ? el : el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n            this[v + \"DropScope\"] = function(el, scopes) {\r\n                _scopeManip(el.constructor === Drop ? el : el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n        }.bind(this));\r\n\r\n        this.snapToGrid = function(x, y) {\r\n            for (var s in this._dragsByScope) {\r\n                _foreach(this._dragsByScope[s], function(d) { d.snap(x, y); });\r\n            }\r\n        };\r\n\r\n        this.getDragsForScope = function(s) { return this._dragsByScope[s]; };\r\n        this.getDropsForScope = function(s) { return this._dropsByScope[s]; };\r\n\r\n        var _destroy = function(el, type, map) {\r\n            el = _gel(el);\r\n            if (el[type]) {\r\n\r\n                // remove from selection, if present.\r\n                var selIdx = _selection.indexOf(el[type]);\r\n                if (selIdx >= 0) {\r\n                    _selection.splice(selIdx, 1);\r\n                }\r\n\r\n                if (_unreg(el[type], map)) {\r\n                    _each(el[type], function(kObj) { kObj.destroy() });\r\n                }\r\n\r\n                delete el[type];\r\n            }\r\n        };\r\n\r\n        var _removeListener = function(el, type, evt, fn) {\r\n            el = _gel(el);\r\n            if (el[type]) {\r\n                el[type].off(evt, fn);\r\n            }\r\n        };\r\n\r\n        this.elementRemoved = function(el) {\r\n            this.destroyDraggable(el);\r\n            this.destroyDroppable(el);\r\n        };\r\n\r\n        /**\r\n         * Either completely remove drag functionality from the given element, or remove a specific event handler. If you\r\n         * call this method with a single argument - the element - all drag functionality is removed from it. Otherwise, if\r\n         * you provide an event name and listener function, this function is de-registered (if found).\r\n         * @param el Element to update\r\n         * @param {string} [evt] Optional event name to unsubscribe\r\n         * @param {Function} [fn] Optional function to unsubscribe\r\n         */\r\n        this.destroyDraggable = function(el, evt, fn) {\r\n            if (arguments.length === 1) {\r\n                _destroy(el, \"_katavorioDrag\", this._dragsByScope);\r\n            } else {\r\n                _removeListener(el, \"_katavorioDrag\", evt, fn);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Either completely remove drop functionality from the given element, or remove a specific event handler. If you\r\n         * call this method with a single argument - the element - all drop functionality is removed from it. Otherwise, if\r\n         * you provide an event name and listener function, this function is de-registered (if found).\r\n         * @param el Element to update\r\n         * @param {string} [evt] Optional event name to unsubscribe\r\n         * @param {Function} [fn] Optional function to unsubscribe\r\n         */\r\n        this.destroyDroppable = function(el, evt, fn) {\r\n            if (arguments.length === 1) {\r\n                _destroy(el, \"_katavorioDrop\", this._dropsByScope);\r\n            } else {\r\n                _removeListener(el, \"_katavorioDrop\", evt, fn);\r\n            }\r\n        };\r\n\r\n        this.reset = function() {\r\n            this._dragsByScope = {};\r\n            this._dropsByScope = {};\r\n            _selection = [];\r\n            _selectionMap = {};\r\n            _posses = {};\r\n        };\r\n\r\n        // ----- groups\r\n        var _posses = {};\r\n\r\n        var _processOneSpec = function(el, _spec, dontAddExisting) {\r\n            var posseId = _isString(_spec) ? _spec : _spec.id;\r\n            var active = _isString(_spec) ? true : _spec.active !== false;\r\n            var posse = _posses[posseId] || (function() {\r\n                var g = {name:posseId, members:[]};\r\n                _posses[posseId] = g;\r\n                return g;\r\n            })();\r\n            _each(el, function(_el) {\r\n                if (_el._katavorioDrag) {\r\n\r\n                    if (dontAddExisting && _el._katavorioDrag.posseRoles[posse.name] != null) return;\r\n\r\n                    _suggest(posse.members, _el._katavorioDrag);\r\n                    _suggest(_el._katavorioDrag.posses, posse.name);\r\n                    _el._katavorioDrag.posseRoles[posse.name] = active;\r\n                }\r\n            });\r\n            return posse;\r\n        };\r\n\r\n        /**\r\n         * Add the given element to the posse with the given id, creating the group if it at first does not exist.\r\n         * @method addToPosse\r\n         * @param {Element} el Element to add.\r\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\r\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\r\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\r\n         * true.\r\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) was/were added.\r\n         */\r\n        this.addToPosse = function(el, spec) {\r\n\r\n            var posses = [];\r\n\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                posses.push(_processOneSpec(el, arguments[i]));\r\n            }\r\n\r\n            return posses.length === 1 ? posses[0] : posses;\r\n        };\r\n\r\n        /**\r\n         * Sets the posse(s) for the element with the given id, creating those that do not yet exist, and removing from\r\n         * the element any current Posses that are not specified by this method call. This method will not change the\r\n         * active/passive state if it is given a posse in which the element is already a member.\r\n         * @method setPosse\r\n         * @param {Element} el Element to set posse(s) on.\r\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\r\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\r\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\r\n         * true.\r\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) now belongs.\r\n         */\r\n        this.setPosse = function(el, spec) {\r\n\r\n            var posses = [];\r\n\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                posses.push(_processOneSpec(el, arguments[i], true).name);\r\n            }\r\n\r\n            _each(el, function(_el) {\r\n                if (_el._katavorioDrag) {\r\n                    var diff = _difference(_el._katavorioDrag.posses, posses);\r\n                    var p = [];\r\n                    Array.prototype.push.apply(p, _el._katavorioDrag.posses);\r\n                    for (var i = 0; i < diff.length; i++) {\r\n                        this.removeFromPosse(_el, diff[i]);\r\n                    }\r\n                }\r\n            }.bind(this));\r\n\r\n            return posses.length === 1 ? posses[0] : posses;\r\n        };\r\n\r\n        /**\r\n         * Remove the given element from the given posse(s).\r\n         * @method removeFromPosse\r\n         * @param {Element} el Element to remove.\r\n         * @param {String...} posseId Varargs parameter: one value for each posse to remove the element from.\r\n         */\r\n        this.removeFromPosse = function(el, posseId) {\r\n            if (arguments.length < 2) throw new TypeError(\"No posse id provided for remove operation\");\r\n            for(var i = 1; i < arguments.length; i++) {\r\n                posseId = arguments[i];\r\n                _each(el, function (_el) {\r\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\r\n                        var d = _el._katavorioDrag;\r\n                        _each(posseId, function (p) {\r\n                            _vanquish(_posses[p].members, d);\r\n                            _vanquish(d.posses, p);\r\n                            delete d.posseRoles[p];\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Remove the given element from all Posses to which it belongs.\r\n         * @method removeFromAllPosses\r\n         * @param {Element|Element[]} el Element to remove from Posses.\r\n         */\r\n        this.removeFromAllPosses = function(el) {\r\n            _each(el, function(_el) {\r\n                if (_el._katavorioDrag && _el._katavorioDrag.posses) {\r\n                    var d = _el._katavorioDrag;\r\n                    _each(d.posses, function(p) {\r\n                        _vanquish(_posses[p].members, d);\r\n                    });\r\n                    d.posses.length = 0;\r\n                    d.posseRoles = {};\r\n                }\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Changes the participation state for the element in the Posse with the given ID.\r\n         * @param {Element|Element[]} el Element(s) to change state for.\r\n         * @param {String} posseId ID of the Posse to change element state for.\r\n         * @param {Boolean} state True to make active, false to make passive.\r\n         */\r\n        this.setPosseState = function(el, posseId, state) {\r\n            var posse = _posses[posseId];\r\n            if (posse) {\r\n                _each(el, function(_el) {\r\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\r\n                        _el._katavorioDrag.posseRoles[posse.name] = state;\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n    };\r\n\r\n    root.Katavorio.version = \"1.0.0\";\r\n\r\n    if (typeof exports !== \"undefined\") {\r\n        exports.Katavorio = root.Katavorio;\r\n    }\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n\r\n(function() {\r\n\r\n    var root = this;\r\n    root.jsPlumbUtil = root.jsPlumbUtil || {};\r\n    var jsPlumbUtil = root.jsPlumbUtil;\r\n\r\n    if (typeof exports !=='undefined') { exports.jsPlumbUtil = jsPlumbUtil;}\r\n\r\n\r\n    /**\r\n     * Tests if the given object is an Array.\r\n     * @param a\r\n     */\r\n    function isArray(a) {\r\n        return Object.prototype.toString.call(a) === \"[object Array]\";\r\n    }\r\n    jsPlumbUtil.isArray = isArray;\r\n    /**\r\n     * Tests if the given object is a Number.\r\n     * @param n\r\n     */\r\n    function isNumber(n) {\r\n        return Object.prototype.toString.call(n) === \"[object Number]\";\r\n    }\r\n    jsPlumbUtil.isNumber = isNumber;\r\n    function isString(s) {\r\n        return typeof s === \"string\";\r\n    }\r\n    jsPlumbUtil.isString = isString;\r\n    function isBoolean(s) {\r\n        return typeof s === \"boolean\";\r\n    }\r\n    jsPlumbUtil.isBoolean = isBoolean;\r\n    function isNull(s) {\r\n        return s == null;\r\n    }\r\n    jsPlumbUtil.isNull = isNull;\r\n    function isObject(o) {\r\n        return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\r\n    }\r\n    jsPlumbUtil.isObject = isObject;\r\n    function isDate(o) {\r\n        return Object.prototype.toString.call(o) === \"[object Date]\";\r\n    }\r\n    jsPlumbUtil.isDate = isDate;\r\n    function isFunction(o) {\r\n        return Object.prototype.toString.call(o) === \"[object Function]\";\r\n    }\r\n    jsPlumbUtil.isFunction = isFunction;\r\n    function isNamedFunction(o) {\r\n        return isFunction(o) && o.name != null && o.name.length > 0;\r\n    }\r\n    jsPlumbUtil.isNamedFunction = isNamedFunction;\r\n    function isEmpty(o) {\r\n        for (var i in o) {\r\n            if (o.hasOwnProperty(i)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    jsPlumbUtil.isEmpty = isEmpty;\r\n    function clone(a) {\r\n        if (isString(a)) {\r\n            return \"\" + a;\r\n        }\r\n        else if (isBoolean(a)) {\r\n            return !!a;\r\n        }\r\n        else if (isDate(a)) {\r\n            return new Date(a.getTime());\r\n        }\r\n        else if (isFunction(a)) {\r\n            return a;\r\n        }\r\n        else if (isArray(a)) {\r\n            var b = [];\r\n            for (var i = 0; i < a.length; i++) {\r\n                b.push(clone(a[i]));\r\n            }\r\n            return b;\r\n        }\r\n        else if (isObject(a)) {\r\n            var c = {};\r\n            for (var j in a) {\r\n                c[j] = clone(a[j]);\r\n            }\r\n            return c;\r\n        }\r\n        else {\r\n            return a;\r\n        }\r\n    }\r\n    jsPlumbUtil.clone = clone;\r\n    function merge(a, b, collations, overwrites) {\r\n        // first change the collations array - if present - into a lookup table, because its faster.\r\n        var cMap = {}, ar, i, oMap = {};\r\n        collations = collations || [];\r\n        overwrites = overwrites || [];\r\n        for (i = 0; i < collations.length; i++) {\r\n            cMap[collations[i]] = true;\r\n        }\r\n        for (i = 0; i < overwrites.length; i++) {\r\n            oMap[overwrites[i]] = true;\r\n        }\r\n        var c = clone(a);\r\n        for (i in b) {\r\n            if (c[i] == null || oMap[i]) {\r\n                c[i] = b[i];\r\n            }\r\n            else if (isString(b[i]) || isBoolean(b[i])) {\r\n                if (!cMap[i]) {\r\n                    c[i] = b[i]; // if we dont want to collate, just copy it in.\r\n                }\r\n                else {\r\n                    ar = [];\r\n                    // if c's object is also an array we can keep its values.\r\n                    ar.push.apply(ar, isArray(c[i]) ? c[i] : [c[i]]);\r\n                    ar.push.apply(ar, isBoolean(b[i]) ? b[i] : [b[i]]);\r\n                    c[i] = ar;\r\n                }\r\n            }\r\n            else {\r\n                if (isArray(b[i])) {\r\n                    ar = [];\r\n                    // if c's object is also an array we can keep its values.\r\n                    if (isArray(c[i])) {\r\n                        ar.push.apply(ar, c[i]);\r\n                    }\r\n                    ar.push.apply(ar, b[i]);\r\n                    c[i] = ar;\r\n                }\r\n                else if (isObject(b[i])) {\r\n                    // overwrite c's value with an object if it is not already one.\r\n                    if (!isObject(c[i])) {\r\n                        c[i] = {};\r\n                    }\r\n                    for (var j in b[i]) {\r\n                        c[i][j] = b[i][j];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return c;\r\n    }\r\n    jsPlumbUtil.merge = merge;\r\n    function replace(inObj, path, value) {\r\n        if (inObj == null) {\r\n            return;\r\n        }\r\n        var q = inObj, t = q;\r\n        path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\r\n            var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/), last = pos + term.length >= str.length, _getArray = function () {\r\n                return t[array[1]] || (function () {\r\n                    t[array[1]] = [];\r\n                    return t[array[1]];\r\n                })();\r\n            };\r\n            if (last) {\r\n                // set term = value on current t, creating term as array if necessary.\r\n                if (array) {\r\n                    _getArray()[array[3]] = value;\r\n                }\r\n                else {\r\n                    t[term] = value;\r\n                }\r\n            }\r\n            else {\r\n                // set to current t[term], creating t[term] if necessary.\r\n                if (array) {\r\n                    var a_1 = _getArray();\r\n                    t = a_1[array[3]] || (function () {\r\n                        a_1[array[3]] = {};\r\n                        return a_1[array[3]];\r\n                    })();\r\n                }\r\n                else {\r\n                    t = t[term] || (function () {\r\n                        t[term] = {};\r\n                        return t[term];\r\n                    })();\r\n                }\r\n            }\r\n            return \"\";\r\n        });\r\n        return inObj;\r\n    }\r\n    jsPlumbUtil.replace = replace;\r\n    //\r\n    // chain a list of functions, supplied by [ object, method name, args ], and return on the first\r\n    // one that returns the failValue. if none return the failValue, return the successValue.\r\n    //\r\n    function functionChain(successValue, failValue, fns) {\r\n        for (var i = 0; i < fns.length; i++) {\r\n            var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\r\n            if (o === failValue) {\r\n                return o;\r\n            }\r\n        }\r\n        return successValue;\r\n    }\r\n    jsPlumbUtil.functionChain = functionChain;\r\n    /**\r\n     *\r\n     * Take the given model and expand out any parameters. 'functionPrefix' is optional, and if present, helps jsplumb figure out what to do if a value is a Function.\r\n     * if you do not provide it (and doNotExpandFunctions is null, or false), jsplumb will run the given values through any functions it finds, and use the function's\r\n     * output as the value in the result. if you do provide the prefix, only functions that are named and have this prefix\r\n     * will be executed; other functions will be passed as values to the output.\r\n     *\r\n     * @param model\r\n     * @param values\r\n     * @param functionPrefix\r\n     * @param doNotExpandFunctions\r\n     * @returns {any}\r\n     */\r\n    function populate(model, values, functionPrefix, doNotExpandFunctions) {\r\n        // for a string, see if it has parameter matches, and if so, try to make the substitutions.\r\n        var getValue = function (fromString) {\r\n            var matches = fromString.match(/(\\${.*?})/g);\r\n            if (matches != null) {\r\n                for (var i = 0; i < matches.length; i++) {\r\n                    var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\r\n                    if (val != null) {\r\n                        fromString = fromString.replace(matches[i], val);\r\n                    }\r\n                }\r\n            }\r\n            return fromString;\r\n        };\r\n        // process one entry.\r\n        var _one = function (d) {\r\n            if (d != null) {\r\n                if (isString(d)) {\r\n                    return getValue(d);\r\n                }\r\n                else if (isFunction(d) && !doNotExpandFunctions && (functionPrefix == null || (d.name || \"\").indexOf(functionPrefix) === 0)) {\r\n                    return d(values);\r\n                }\r\n                else if (isArray(d)) {\r\n                    var r = [];\r\n                    for (var i = 0; i < d.length; i++) {\r\n                        r.push(_one(d[i]));\r\n                    }\r\n                    return r;\r\n                }\r\n                else if (isObject(d)) {\r\n                    var s = {};\r\n                    for (var j in d) {\r\n                        s[j] = _one(d[j]);\r\n                    }\r\n                    return s;\r\n                }\r\n                else {\r\n                    return d;\r\n                }\r\n            }\r\n        };\r\n        return _one(model);\r\n    }\r\n    jsPlumbUtil.populate = populate;\r\n    /**\r\n     * Find the index of a given object in an array.\r\n     * @param a The array to search\r\n     * @param f The function to run on each element. Return true if the element matches.\r\n     * @returns {number} -1 if not found, otherwise the index in the array.\r\n     */\r\n    function findWithFunction(a, f) {\r\n        if (a) {\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (f(a[i])) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    jsPlumbUtil.findWithFunction = findWithFunction;\r\n    /**\r\n     * Remove some element from an array by matching each element in the array against some predicate function. Note that this\r\n     * is an in-place removal; the array is altered.\r\n     * @param a The array to search\r\n     * @param f The function to run on each element. Return true if the element matches.\r\n     * @returns {boolean} true if removed, false otherwise.\r\n     */\r\n    function removeWithFunction(a, f) {\r\n        var idx = findWithFunction(a, f);\r\n        if (idx > -1) {\r\n            a.splice(idx, 1);\r\n        }\r\n        return idx !== -1;\r\n    }\r\n    jsPlumbUtil.removeWithFunction = removeWithFunction;\r\n    /**\r\n     * Remove some element from an array by simple lookup in the array for the given element. Note that this\r\n     * is an in-place removal; the array is altered.\r\n     * @param l The array to search\r\n     * @param v The value to remove.\r\n     * @returns {boolean} true if removed, false otherwise.\r\n     */\r\n    function remove(l, v) {\r\n        var idx = l.indexOf(v);\r\n        if (idx > -1) {\r\n            l.splice(idx, 1);\r\n        }\r\n        return idx !== -1;\r\n    }\r\n    jsPlumbUtil.remove = remove;\r\n    /**\r\n     * Add some element to the given array, unless it is determined that it is already in the array.\r\n     * @param list The array to add the element to.\r\n     * @param item The item to add.\r\n     * @param hashFunction A function to use to determine if the given item already exists in the array.\r\n     */\r\n    function addWithFunction(list, item, hashFunction) {\r\n        if (findWithFunction(list, hashFunction) === -1) {\r\n            list.push(item);\r\n        }\r\n    }\r\n    jsPlumbUtil.addWithFunction = addWithFunction;\r\n    /**\r\n     * Add some element to a list that is contained in a map of lists.\r\n     * @param map The map of [ key -> list ] entries\r\n     * @param key The name of the list to insert into\r\n     * @param value The value to insert\r\n     * @param insertAtStart Whether or not to insert at the start; defaults to false.\r\n     */\r\n    function addToList(map, key, value, insertAtStart) {\r\n        var l = map[key];\r\n        if (l == null) {\r\n            l = [];\r\n            map[key] = l;\r\n        }\r\n        l[insertAtStart ? \"unshift\" : \"push\"](value);\r\n        return l;\r\n    }\r\n    jsPlumbUtil.addToList = addToList;\r\n    /**\r\n     * Add an item to a list, unless it is already in the list. The test for pre-existence is a simple list lookup.\r\n     * If you want to do something more complex, perhaps #addWithFunction might help.\r\n     * @param list List to add the item to\r\n     * @param item Item to add\r\n     * @param insertAtHead Whether or not to insert at the start; defaults to false.\r\n     */\r\n    function suggest(list, item, insertAtHead) {\r\n        if (list.indexOf(item) === -1) {\r\n            if (insertAtHead) {\r\n                list.unshift(item);\r\n            }\r\n            else {\r\n                list.push(item);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    jsPlumbUtil.suggest = suggest;\r\n    /**\r\n     * Extends the given obj (which can be an array) with the given constructor function, prototype functions, and class members, any of which may be null.\r\n     * @param child\r\n     * @param parent\r\n     * @param _protoFn\r\n     */\r\n    function extend(child, parent, _protoFn) {\r\n        var i;\r\n        parent = isArray(parent) ? parent : [parent];\r\n        var _copyProtoChain = function (focus) {\r\n            var proto = focus.__proto__;\r\n            while (proto != null) {\r\n                if (proto.prototype != null) {\r\n                    for (var j in proto.prototype) {\r\n                        if (proto.prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\r\n                            child.prototype[j] = proto.prototype[j];\r\n                        }\r\n                    }\r\n                    proto = proto.prototype.__proto__;\r\n                }\r\n                else {\r\n                    proto = null;\r\n                }\r\n            }\r\n        };\r\n        for (i = 0; i < parent.length; i++) {\r\n            for (var j in parent[i].prototype) {\r\n                if (parent[i].prototype.hasOwnProperty(j) && !child.prototype.hasOwnProperty(j)) {\r\n                    child.prototype[j] = parent[i].prototype[j];\r\n                }\r\n            }\r\n            _copyProtoChain(parent[i]);\r\n        }\r\n        var _makeFn = function (name, protoFn) {\r\n            return function () {\r\n                for (i = 0; i < parent.length; i++) {\r\n                    if (parent[i].prototype[name]) {\r\n                        parent[i].prototype[name].apply(this, arguments);\r\n                    }\r\n                }\r\n                return protoFn.apply(this, arguments);\r\n            };\r\n        };\r\n        var _oneSet = function (fns) {\r\n            for (var k in fns) {\r\n                child.prototype[k] = _makeFn(k, fns[k]);\r\n            }\r\n        };\r\n        if (arguments.length > 2) {\r\n            for (i = 2; i < arguments.length; i++) {\r\n                _oneSet(arguments[i]);\r\n            }\r\n        }\r\n        return child;\r\n    }\r\n    jsPlumbUtil.extend = extend;\r\n    /**\r\n     * Generate a UUID.\r\n     */\r\n    function uuid() {\r\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        }));\r\n    }\r\n    jsPlumbUtil.uuid = uuid;\r\n    /**\r\n     * Trim a string.\r\n     * @param s String to trim\r\n     * @returns the String with leading and trailing whitespace removed.\r\n     */\r\n    function fastTrim(s) {\r\n        if (s == null) {\r\n            return null;\r\n        }\r\n        var str = s.replace(/^\\s\\s*/, ''), ws = /\\s/, i = str.length;\r\n        while (ws.test(str.charAt(--i))) {\r\n        }\r\n        return str.slice(0, i + 1);\r\n    }\r\n    jsPlumbUtil.fastTrim = fastTrim;\r\n    function each(obj, fn) {\r\n        obj = obj.length == null || typeof obj === \"string\" ? [obj] : obj;\r\n        for (var i = 0; i < obj.length; i++) {\r\n            fn(obj[i]);\r\n        }\r\n    }\r\n    jsPlumbUtil.each = each;\r\n    function map(obj, fn) {\r\n        var o = [];\r\n        for (var i = 0; i < obj.length; i++) {\r\n            o.push(fn(obj[i]));\r\n        }\r\n        return o;\r\n    }\r\n    jsPlumbUtil.map = map;\r\n    function mergeWithParents(type, map, parentAttribute) {\r\n        parentAttribute = parentAttribute || \"parent\";\r\n        var _def = function (id) {\r\n            return id ? map[id] : null;\r\n        };\r\n        var _parent = function (def) {\r\n            return def ? _def(def[parentAttribute]) : null;\r\n        };\r\n        var _one = function (parent, def) {\r\n            if (parent == null) {\r\n                return def;\r\n            }\r\n            else {\r\n                var overrides = [\"anchor\", \"anchors\", \"cssClass\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\"];\r\n                if (def.mergeStrategy === \"override\") {\r\n                    Array.prototype.push.apply(overrides, [\"events\", \"overlays\"]);\r\n                }\r\n                var d_1 = merge(parent, def, [], overrides);\r\n                return _one(_parent(parent), d_1);\r\n            }\r\n        };\r\n        var _getDef = function (t) {\r\n            if (t == null) {\r\n                return {};\r\n            }\r\n            if (typeof t === \"string\") {\r\n                return _def(t);\r\n            }\r\n            else if (t.length) {\r\n                var done = false, i = 0, _dd = void 0;\r\n                while (!done && i < t.length) {\r\n                    _dd = _getDef(t[i]);\r\n                    if (_dd) {\r\n                        done = true;\r\n                    }\r\n                    else {\r\n                        i++;\r\n                    }\r\n                }\r\n                return _dd;\r\n            }\r\n        };\r\n        var d = _getDef(type);\r\n        if (d) {\r\n            return _one(_parent(d), d);\r\n        }\r\n        else {\r\n            return {};\r\n        }\r\n    }\r\n    jsPlumbUtil.mergeWithParents = mergeWithParents;\r\n    jsPlumbUtil.logEnabled = true;\r\n    function log() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (jsPlumbUtil.logEnabled && typeof console !== \"undefined\") {\r\n            try {\r\n                var msg = arguments[arguments.length - 1];\r\n                console.log(msg);\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n    }\r\n    jsPlumbUtil.log = log;\r\n    /**\r\n     * Wraps one function with another, creating a placeholder for the\r\n     * wrapped function if it was null. this is used to wrap the various\r\n     * drag/drop event functions - to allow jsPlumb to be notified of\r\n     * important lifecycle events without imposing itself on the user's\r\n     * drag/drop functionality.\r\n     * @method jsPlumbUtil.wrap\r\n     * @param {Function} wrappedFunction original function to wrap; may be null.\r\n     * @param {Function} newFunction function to wrap the original with.\r\n     * @param {Object} [returnOnThisValue] Optional. Indicates that the wrappedFunction should\r\n     * not be executed if the newFunction returns a value matching 'returnOnThisValue'.\r\n     * note that this is a simple comparison and only works for primitives right now.\r\n     */\r\n    function wrap(wrappedFunction, newFunction, returnOnThisValue) {\r\n        return function () {\r\n            var r = null;\r\n            try {\r\n                if (newFunction != null) {\r\n                    r = newFunction.apply(this, arguments);\r\n                }\r\n            }\r\n            catch (e) {\r\n                log(\"jsPlumb function failed : \" + e);\r\n            }\r\n            if ((wrappedFunction != null) && (returnOnThisValue == null || (r !== returnOnThisValue))) {\r\n                try {\r\n                    r = wrappedFunction.apply(this, arguments);\r\n                }\r\n                catch (e) {\r\n                    log(\"wrapped function failed : \" + e);\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n    }\r\n    jsPlumbUtil.wrap = wrap;\r\n    var EventGenerator = /** @class */ (function () {\r\n        function EventGenerator() {\r\n            var _this = this;\r\n            this._listeners = {};\r\n            this.eventsSuspended = false;\r\n            this.tick = false;\r\n            // this is a list of events that should re-throw any errors that occur during their dispatch.\r\n            this.eventsToDieOn = { \"ready\": true };\r\n            this.queue = [];\r\n            this.bind = function (event, listener, insertAtStart) {\r\n                var _one = function (evt) {\r\n                    addToList(_this._listeners, evt, listener, insertAtStart);\r\n                    listener.__jsPlumb = listener.__jsPlumb || {};\r\n                    listener.__jsPlumb[uuid()] = evt;\r\n                };\r\n                if (typeof event === \"string\") {\r\n                    _one(event);\r\n                }\r\n                else if (event.length != null) {\r\n                    for (var i = 0; i < event.length; i++) {\r\n                        _one(event[i]);\r\n                    }\r\n                }\r\n                return _this;\r\n            };\r\n            this.fire = function (event, value, originalEvent) {\r\n                if (!this.tick) {\r\n                    this.tick = true;\r\n                    if (!this.eventsSuspended && this._listeners[event]) {\r\n                        var l = this._listeners[event].length, i = 0, _gone = false, ret = null;\r\n                        if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\r\n                            while (!_gone && i < l && ret !== false) {\r\n                                // doing it this way rather than catching and then possibly re-throwing means that an error propagated by this\r\n                                // method will have the whole call stack available in the debugger.\r\n                                if (this.eventsToDieOn[event]) {\r\n                                    this._listeners[event][i].apply(this, [value, originalEvent]);\r\n                                }\r\n                                else {\r\n                                    try {\r\n                                        ret = this._listeners[event][i].apply(this, [value, originalEvent]);\r\n                                    }\r\n                                    catch (e) {\r\n                                        log(\"jsPlumb: fire failed for event \" + event + \" : \" + e);\r\n                                    }\r\n                                }\r\n                                i++;\r\n                                if (this._listeners == null || this._listeners[event] == null) {\r\n                                    _gone = true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    this.tick = false;\r\n                    this._drain();\r\n                }\r\n                else {\r\n                    this.queue.unshift(arguments);\r\n                }\r\n                return this;\r\n            };\r\n            this._drain = function () {\r\n                var n = _this.queue.pop();\r\n                if (n) {\r\n                    _this.fire.apply(_this, n);\r\n                }\r\n            };\r\n            this.unbind = function (eventOrListener, listener) {\r\n                if (arguments.length === 0) {\r\n                    this._listeners = {};\r\n                }\r\n                else if (arguments.length === 1) {\r\n                    if (typeof eventOrListener === \"string\") {\r\n                        delete this._listeners[eventOrListener];\r\n                    }\r\n                    else if (eventOrListener.__jsPlumb) {\r\n                        var evt = void 0;\r\n                        for (var i in eventOrListener.__jsPlumb) {\r\n                            evt = eventOrListener.__jsPlumb[i];\r\n                            remove(this._listeners[evt] || [], eventOrListener);\r\n                        }\r\n                    }\r\n                }\r\n                else if (arguments.length === 2) {\r\n                    remove(this._listeners[eventOrListener] || [], listener);\r\n                }\r\n                return this;\r\n            };\r\n            this.getListener = function (forEvent) {\r\n                return _this._listeners[forEvent];\r\n            };\r\n            this.setSuspendEvents = function (val) {\r\n                _this.eventsSuspended = val;\r\n            };\r\n            this.isSuspendEvents = function () {\r\n                return _this.eventsSuspended;\r\n            };\r\n            this.silently = function (fn) {\r\n                _this.setSuspendEvents(true);\r\n                try {\r\n                    fn();\r\n                }\r\n                catch (e) {\r\n                    log(\"Cannot execute silent function \" + e);\r\n                }\r\n                _this.setSuspendEvents(false);\r\n            };\r\n            this.cleanupListeners = function () {\r\n                for (var i in _this._listeners) {\r\n                    _this._listeners[i] = null;\r\n                }\r\n            };\r\n        }\r\n        return EventGenerator;\r\n    }());\r\n    jsPlumbUtil.EventGenerator = EventGenerator;\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains utility functions that run in browsers only.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function() {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this;\r\n\r\n    root.jsPlumbUtil.matchesSelector = function(el, selector, ctx) {\r\n        ctx = ctx || el.parentNode;\r\n        var possibles = ctx.querySelectorAll(selector);\r\n        for (var i = 0; i < possibles.length; i++) {\r\n            if (possibles[i] === el) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    root.jsPlumbUtil.consume = function(e, doNotPreventDefault) {\r\n        if (e.stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n        else {\r\n            e.returnValue = false;\r\n        }\r\n\r\n        if (!doNotPreventDefault && e.preventDefault){\r\n            e.preventDefault();\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Function: sizeElement\r\n     * Helper to size and position an element. You would typically use\r\n     * this when writing your own Connector or Endpoint implementation.\r\n     *\r\n     * Parameters:\r\n     *  x - [int] x position for the element origin\r\n     *  y - [int] y position for the element origin\r\n     *  w - [int] width of the element\r\n     *  h - [int] height of the element\r\n     *\r\n     */\r\n    root.jsPlumbUtil.sizeElement = function(el, x, y, w, h) {\r\n        if (el) {\r\n            el.style.height = h + \"px\";\r\n            el.height = h;\r\n            el.style.width = w + \"px\";\r\n            el.width = w;\r\n            el.style.left = x + \"px\";\r\n            el.style.top = y + \"px\";\r\n        }\r\n    };\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n(function() {\r\n\r\n    var DEFAULT_OPTIONS = {\r\n        deriveAnchor:function(edge, index, ep, conn) {\r\n            return {\r\n                top:[\"TopRight\", \"TopLeft\"],\r\n                bottom:[\"BottomRight\", \"BottomLeft\"]\r\n            }[edge][index];\r\n        }\r\n    };\r\n\r\n    var root = this;\r\n\r\n    var ListManager = function(jsPlumbInstance) {\r\n\r\n        this.count = 0;\r\n        this.instance = jsPlumbInstance;\r\n        this.lists = {};\r\n\r\n        this.instance.addList = function(el, options) {\r\n            return this.listManager.addList(el, options);\r\n        };\r\n\r\n        this.instance.removeList = function(el) {\r\n            this.listManager.removeList(el);\r\n        };\r\n\r\n        this.instance.bind(\"manageElement\", function(p) {\r\n\r\n            //look for [jtk-scrollable-list] elements and attach scroll listeners if necessary\r\n            var scrollableLists = this.instance.getSelector(p.el, \"[jtk-scrollable-list]\");\r\n            for (var i = 0; i < scrollableLists.length; i++) {\r\n                this.addList(scrollableLists[i]);\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n        this.instance.bind(\"unmanageElement\", function(p) {\r\n            this.removeList(p.el);\r\n        });\r\n\r\n\r\n        this.instance.bind(\"connection\", function(c, evt) {\r\n            if (evt == null) {\r\n                // not added by mouse. look for an ancestor of the source and/or target element that is a scrollable list, and run\r\n                // its scroll method.\r\n                this._maybeUpdateParentList(c.source);\r\n                this._maybeUpdateParentList(c.target);\r\n            }\r\n        }.bind(this));\r\n    };\r\n\r\n    root.jsPlumbListManager = ListManager;\r\n\r\n    ListManager.prototype = {\r\n\r\n        addList : function(el, options) {\r\n            var dp = this.instance.extend({}, DEFAULT_OPTIONS);\r\n            options = this.instance.extend(dp,  options || {});\r\n            var id = [this.instance.getInstanceIndex(), this.count++].join(\"_\");\r\n            this.lists[id] = new List(this.instance, el, options, id);\r\n        },\r\n\r\n        removeList:function(el) {\r\n            var list = this.lists[el._jsPlumbList];\r\n            if (list) {\r\n                list.destroy();\r\n                delete this.lists[el._jsPlumbList];\r\n            }\r\n        },\r\n\r\n        _maybeUpdateParentList:function (el) {\r\n            var parent = el.parentNode, container = this.instance.getContainer();\r\n            while(parent != null && parent !== container) {\r\n                if (parent._jsPlumbList != null && this.lists[parent._jsPlumbList] != null) {\r\n                    parent._jsPlumbScrollHandler();\r\n                    return\r\n                }\r\n                parent = parent.parentNode;\r\n            }\r\n        }\r\n\r\n\r\n    };\r\n\r\n    var List = function(instance, el, options, id) {\r\n\r\n        el[\"_jsPlumbList\"] = id;\r\n\r\n        //\r\n        // Derive an anchor to use for the current situation. In contrast to the way we derive an endpoint, here we use `anchor` from the options, if present, as\r\n        // our first choice, and then `deriveAnchor` as our next choice. There is a default `deriveAnchor` implementation that uses TopRight/TopLeft for top and\r\n        // BottomRight/BottomLeft for bottom.\r\n        //\r\n        // edge - \"top\" or \"bottom\"\r\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\r\n        // ep - the endpoint that is being proxied\r\n        // conn - the connection that is being proxied\r\n        //\r\n        function deriveAnchor(edge, index, ep, conn) {\r\n            return options.anchor ? options.anchor : options.deriveAnchor(edge, index, ep, conn);\r\n        }\r\n\r\n        //\r\n        // Derive an endpoint to use for the current situation. We'll use a `deriveEndpoint` function passed in to the options as our first choice,\r\n        // followed by `endpoint` (an endpoint spec) from the options, and failing either of those we just use the `type` of the endpoint that is being proxied.\r\n        //\r\n        // edge - \"top\" or \"bottom\"\r\n        // index - 0 when endpoint is connection source, 1 when endpoint is connection target\r\n        // endpoint - the endpoint that is being proxied\r\n        // connection - the connection that is being proxied\r\n        //\r\n        function deriveEndpoint(edge, index, ep, conn) {\r\n            return options.deriveEndpoint ? options.deriveEndpoint(edge, index, ep, conn) : options.endpoint ? options.endpoint : ep.type;\r\n        }\r\n\r\n        //\r\n        // look for a parent of the given scrollable list that is draggable, and then update the child offsets for it. this should not\r\n        // be necessary in the delegated drag stuff from the upcoming 3.0.0 release.\r\n        //\r\n        function _maybeUpdateDraggable(el) {\r\n            var parent = el.parentNode, container = instance.getContainer();\r\n            while(parent != null && parent !== container) {\r\n                if (instance.hasClass(parent, \"jtk-managed\")) {\r\n                    instance.recalculateOffsets(parent);\r\n                    return\r\n                }\r\n                parent = parent.parentNode;\r\n            }\r\n        }\r\n\r\n        var scrollHandler = function(e) {\r\n\r\n            var children = instance.getSelector(el, \".jtk-managed\");\r\n            var elId = instance.getId(el);\r\n\r\n            for (var i = 0; i < children.length; i++) {\r\n\r\n                if (children[i].offsetTop < el.scrollTop) {\r\n                    if (!children[i]._jsPlumbProxies) {\r\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\r\n                        instance.select({source: children[i]}).each(function (c) {\r\n\r\n\r\n                            instance.proxyConnection(c, 0, el, elId, function () {\r\n                                return deriveEndpoint(\"top\", 0, c.endpoints[0], c);\r\n                            }, function () {\r\n                                return deriveAnchor(\"top\", 0, c.endpoints[0], c);\r\n                            });\r\n                            children[i]._jsPlumbProxies.push([c, 0]);\r\n                        });\r\n\r\n                        instance.select({target: children[i]}).each(function (c) {\r\n                            instance.proxyConnection(c, 1, el, elId, function () {\r\n                                return deriveEndpoint(\"top\", 1, c.endpoints[1], c);\r\n                            }, function () {\r\n                                return deriveAnchor(\"top\", 1, c.endpoints[1], c);\r\n                            });\r\n                            children[i]._jsPlumbProxies.push([c, 1]);\r\n                        });\r\n                    }\r\n                }\r\n                //\r\n                else if (children[i].offsetTop > el.scrollTop + el.offsetHeight) {\r\n                    if (!children[i]._jsPlumbProxies) {\r\n                        children[i]._jsPlumbProxies = children[i]._jsPlumbProxies || [];\r\n\r\n                        instance.select({source: children[i]}).each(function (c) {\r\n                            instance.proxyConnection(c, 0, el, elId, function () {\r\n                                return deriveEndpoint(\"bottom\", 0, c.endpoints[0], c);\r\n                            }, function () {\r\n                                return deriveAnchor(\"bottom\", 0, c.endpoints[0], c);\r\n                            });\r\n                            children[i]._jsPlumbProxies.push([c, 0]);\r\n                        });\r\n\r\n                        instance.select({target: children[i]}).each(function (c) {\r\n                            instance.proxyConnection(c, 1, el, elId, function () {\r\n                                return deriveEndpoint(\"bottom\", 1, c.endpoints[1], c);\r\n                            }, function () {\r\n                                return deriveAnchor(\"bottom\", 1, c.endpoints[1], c);\r\n                            });\r\n                            children[i]._jsPlumbProxies.push([c, 1]);\r\n                        });\r\n                    }\r\n                } else if (children[i]._jsPlumbProxies) {\r\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\r\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\r\n                    }\r\n\r\n                    delete children[i]._jsPlumbProxies;\r\n                }\r\n\r\n                instance.revalidate(children[i]);\r\n            }\r\n\r\n            _maybeUpdateDraggable(el);\r\n        };\r\n\r\n        instance.setAttribute(el, \"jtk-scrollable-list\", \"true\");\r\n        el._jsPlumbScrollHandler = scrollHandler;\r\n        instance.on(el, \"scroll\", scrollHandler);\r\n        scrollHandler(); // run it once; there may be connections already.\r\n\r\n        this.destroy = function() {\r\n            instance.off(el, \"scroll\", scrollHandler);\r\n            delete el._jsPlumbScrollHandler;\r\n\r\n            var children = instance.getSelector(el, \".jtk-managed\");\r\n            var elId = instance.getId(el);\r\n\r\n            for (var i = 0; i < children.length; i++) {\r\n                if (children[i]._jsPlumbProxies) {\r\n                    for (var j = 0; j < children[i]._jsPlumbProxies.length; j++) {\r\n                        instance.unproxyConnection(children[i]._jsPlumbProxies[j][0], children[i]._jsPlumbProxies[j][1], elId);\r\n                    }\r\n\r\n                    delete children[i]._jsPlumbProxies;\r\n                }\r\n            }\r\n        };\r\n    };\r\n\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the core code.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this;\r\n\r\n    var _ju = root.jsPlumbUtil,\r\n\r\n        /**\r\n         * creates a timestamp, using milliseconds since 1970, but as a string.\r\n         */\r\n        _timestamp = function () {\r\n            return \"\" + (new Date()).getTime();\r\n        },\r\n\r\n        // helper method to update the hover style whenever it, or paintStyle, changes.\r\n        // we use paintStyle as the foundation and merge hoverPaintStyle over the\r\n        // top.\r\n        _updateHoverStyle = function (component) {\r\n            if (component._jsPlumb.paintStyle && component._jsPlumb.hoverPaintStyle) {\r\n                var mergedHoverStyle = {};\r\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.paintStyle);\r\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.hoverPaintStyle);\r\n                delete component._jsPlumb.hoverPaintStyle;\r\n                // we want the fill of paintStyle to override a gradient, if possible.\r\n                if (mergedHoverStyle.gradient && component._jsPlumb.paintStyle.fill) {\r\n                    delete mergedHoverStyle.gradient;\r\n                }\r\n                component._jsPlumb.hoverPaintStyle = mergedHoverStyle;\r\n            }\r\n        },\r\n        events = [\"tap\", \"dbltap\", \"click\", \"dblclick\", \"mouseover\", \"mouseout\", \"mousemove\", \"mousedown\", \"mouseup\", \"contextmenu\" ],\r\n        eventFilters = { \"mouseout\": \"mouseleave\", \"mouseexit\": \"mouseleave\" },\r\n        _updateAttachedElements = function (component, state, timestamp, sourceElement) {\r\n            var affectedElements = component.getAttachedElements();\r\n            if (affectedElements) {\r\n                for (var i = 0, j = affectedElements.length; i < j; i++) {\r\n                    if (!sourceElement || sourceElement !== affectedElements[i]) {\r\n                        affectedElements[i].setHover(state, true, timestamp);\t\t\t// tell the attached elements not to inform their own attached elements.\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _splitType = function (t) {\r\n            return t == null ? null : t.split(\" \");\r\n        },\r\n        _mapType = function(map, obj, typeId) {\r\n            for (var i in obj) {\r\n                map[i] = typeId;\r\n            }\r\n        },\r\n        _each = function(fn, obj) {\r\n            obj = _ju.isArray(obj) || (obj.length != null && !_ju.isString(obj)) ? obj : [ obj ];\r\n            for (var i = 0; i < obj.length; i++) {\r\n                try {\r\n                    fn.apply(obj[i], [ obj[i] ]);\r\n                }\r\n                catch (e) {\r\n                    _ju.log(\".each iteration failed : \" + e);\r\n                }\r\n            }\r\n        },\r\n        _applyTypes = function (component, params, doNotRepaint) {\r\n            if (component.getDefaultType) {\r\n                var td = component.getTypeDescriptor(), map = {};\r\n                var defType = component.getDefaultType();\r\n                var o = _ju.merge({}, defType);\r\n                _mapType(map, defType, \"__default\");\r\n                for (var i = 0, j = component._jsPlumb.types.length; i < j; i++) {\r\n                    var tid = component._jsPlumb.types[i];\r\n                    if (tid !== \"__default\") {\r\n                        var _t = component._jsPlumb.instance.getType(tid, td);\r\n                        if (_t != null) {\r\n\r\n                            var overrides = [\"anchor\", \"anchors\", \"connector\", \"paintStyle\", \"hoverPaintStyle\", \"endpoint\", \"endpoints\", \"connectorOverlays\", \"connectorStyle\", \"connectorHoverStyle\", \"endpointStyle\", \"endpointHoverStyle\"];\r\n                            var collations = [ ];\r\n\r\n                            if (_t.mergeStrategy === \"override\") {\r\n                                Array.prototype.push.apply(overrides, [\"events\", \"overlays\", \"cssClass\"]);\r\n                            } else {\r\n                                collations.push(\"cssClass\");\r\n                            }\r\n\r\n                            o = _ju.merge(o, _t, collations, overrides);\r\n                            _mapType(map, _t, tid);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (params) {\r\n                    o = _ju.populate(o, params, \"_\");\r\n                }\r\n\r\n                component.applyType(o, doNotRepaint, map);\r\n                if (!doNotRepaint) {\r\n                    component.repaint();\r\n                }\r\n            }\r\n        },\r\n\r\n// ------------------------------ BEGIN jsPlumbUIComponent --------------------------------------------\r\n\r\n        jsPlumbUIComponent = root.jsPlumbUIComponent = function (params) {\r\n\r\n            _ju.EventGenerator.apply(this, arguments);\r\n\r\n            var self = this,\r\n                a = arguments,\r\n                idPrefix = self.idPrefix,\r\n                id = idPrefix + (new Date()).getTime();\r\n\r\n            this._jsPlumb = {\r\n                instance: params._jsPlumb,\r\n                parameters: params.parameters || {},\r\n                paintStyle: null,\r\n                hoverPaintStyle: null,\r\n                paintStyleInUse: null,\r\n                hover: false,\r\n                beforeDetach: params.beforeDetach,\r\n                beforeDrop: params.beforeDrop,\r\n                overlayPlacements: [],\r\n                hoverClass: params.hoverClass || params._jsPlumb.Defaults.HoverClass,\r\n                types: [],\r\n                typeCache:{}\r\n            };\r\n\r\n            this.cacheTypeItem = function(key, item, typeId) {\r\n                this._jsPlumb.typeCache[typeId] = this._jsPlumb.typeCache[typeId] || {};\r\n                this._jsPlumb.typeCache[typeId][key] = item;\r\n            };\r\n            this.getCachedTypeItem = function(key, typeId) {\r\n                return this._jsPlumb.typeCache[typeId] ? this._jsPlumb.typeCache[typeId][key] : null;\r\n            };\r\n\r\n            this.getId = function () {\r\n                return id;\r\n            };\r\n\r\n// ----------------------------- default type --------------------------------------------\r\n\r\n\r\n            var o = params.overlays || [], oo = {};\r\n            if (this.defaultOverlayKeys) {\r\n                for (var i = 0; i < this.defaultOverlayKeys.length; i++) {\r\n                    Array.prototype.push.apply(o, this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]] || []);\r\n                }\r\n\r\n                for (i = 0; i < o.length; i++) {\r\n                    // if a string, convert to object representation so that we can store the typeid on it.\r\n                    // also assign an id.\r\n                    var fo = jsPlumb.convertToFullOverlaySpec(o[i]);\r\n                    oo[fo[1].id] = fo;\r\n                }\r\n            }\r\n\r\n            var _defaultType = {\r\n                overlays:oo,\r\n                parameters: params.parameters || {},\r\n                scope: params.scope || this._jsPlumb.instance.getDefaultScope()\r\n            };\r\n            this.getDefaultType = function() {\r\n                return _defaultType;\r\n            };\r\n            this.appendToDefaultType = function(obj) {\r\n                for (var i in obj) {\r\n                    _defaultType[i] = obj[i];\r\n                }\r\n            };\r\n\r\n// ----------------------------- end default type --------------------------------------------\r\n\r\n            // all components can generate events\r\n\r\n            if (params.events) {\r\n                for (var evtName in params.events) {\r\n                    self.bind(evtName, params.events[evtName]);\r\n                }\r\n            }\r\n\r\n            // all components get this clone function.\r\n            // TODO issue 116 showed a problem with this - it seems 'a' that is in\r\n            // the clone function's scope is shared by all invocations of it, the classic\r\n            // JS closure problem.  for now, jsPlumb does a version of this inline where\r\n            // it used to call clone.  but it would be nice to find some time to look\r\n            // further at this.\r\n            this.clone = function () {\r\n                var o = Object.create(this.constructor.prototype);\r\n                this.constructor.apply(o, a);\r\n                return o;\r\n            }.bind(this);\r\n\r\n            // user can supply a beforeDetach callback, which will be executed before a detach\r\n            // is performed; returning false prevents the detach.\r\n            this.isDetachAllowed = function (connection) {\r\n                var r = true;\r\n                if (this._jsPlumb.beforeDetach) {\r\n                    try {\r\n                        r = this._jsPlumb.beforeDetach(connection);\r\n                    }\r\n                    catch (e) {\r\n                        _ju.log(\"jsPlumb: beforeDetach callback failed\", e);\r\n                    }\r\n                }\r\n                return r;\r\n            };\r\n\r\n            // user can supply a beforeDrop callback, which will be executed before a dropped\r\n            // connection is confirmed. user can return false to reject connection.\r\n            this.isDropAllowed = function (sourceId, targetId, scope, connection, dropEndpoint, source, target) {\r\n                var r = this._jsPlumb.instance.checkCondition(\"beforeDrop\", {\r\n                    sourceId: sourceId,\r\n                    targetId: targetId,\r\n                    scope: scope,\r\n                    connection: connection,\r\n                    dropEndpoint: dropEndpoint,\r\n                    source: source, target: target\r\n                });\r\n                if (this._jsPlumb.beforeDrop) {\r\n                    try {\r\n                        r = this._jsPlumb.beforeDrop({\r\n                            sourceId: sourceId,\r\n                            targetId: targetId,\r\n                            scope: scope,\r\n                            connection: connection,\r\n                            dropEndpoint: dropEndpoint,\r\n                            source: source, target: target\r\n                        });\r\n                    }\r\n                    catch (e) {\r\n                        _ju.log(\"jsPlumb: beforeDrop callback failed\", e);\r\n                    }\r\n                }\r\n                return r;\r\n            };\r\n\r\n            var domListeners = [];\r\n\r\n            // sets the component associated with listener events. for instance, an overlay delegates\r\n            // its events back to a connector. but if the connector is swapped on the underlying connection,\r\n            // then this component must be changed. This is called by setConnector in the Connection class.\r\n            this.setListenerComponent = function (c) {\r\n                for (var i = 0; i < domListeners.length; i++) {\r\n                    domListeners[i][3] = c;\r\n                }\r\n            };\r\n\r\n\r\n        };\r\n\r\n    var _removeTypeCssHelper = function (component, typeIndex) {\r\n        var typeId = component._jsPlumb.types[typeIndex],\r\n            type = component._jsPlumb.instance.getType(typeId, component.getTypeDescriptor());\r\n\r\n        if (type != null && type.cssClass && component.canvas) {\r\n            component._jsPlumb.instance.removeClass(component.canvas, type.cssClass);\r\n        }\r\n    };\r\n\r\n    _ju.extend(root.jsPlumbUIComponent, _ju.EventGenerator, {\r\n\r\n        getParameter: function (name) {\r\n            return this._jsPlumb.parameters[name];\r\n        },\r\n\r\n        setParameter: function (name, value) {\r\n            this._jsPlumb.parameters[name] = value;\r\n        },\r\n\r\n        getParameters: function () {\r\n            return this._jsPlumb.parameters;\r\n        },\r\n\r\n        setParameters: function (p) {\r\n            this._jsPlumb.parameters = p;\r\n        },\r\n\r\n        getClass:function() {\r\n            return jsPlumb.getClass(this.canvas);\r\n        },\r\n\r\n        hasClass:function(clazz) {\r\n            return jsPlumb.hasClass(this.canvas, clazz);\r\n        },\r\n\r\n        addClass: function (clazz) {\r\n            jsPlumb.addClass(this.canvas, clazz);\r\n        },\r\n\r\n        removeClass: function (clazz) {\r\n            jsPlumb.removeClass(this.canvas, clazz);\r\n        },\r\n\r\n        updateClasses: function (classesToAdd, classesToRemove) {\r\n            jsPlumb.updateClasses(this.canvas, classesToAdd, classesToRemove);\r\n        },\r\n\r\n        setType: function (typeId, params, doNotRepaint) {\r\n            this.clearTypes();\r\n            this._jsPlumb.types = _splitType(typeId) || [];\r\n            _applyTypes(this, params, doNotRepaint);\r\n        },\r\n\r\n        getType: function () {\r\n            return this._jsPlumb.types;\r\n        },\r\n\r\n        reapplyTypes: function (params, doNotRepaint) {\r\n            _applyTypes(this, params, doNotRepaint);\r\n        },\r\n\r\n        hasType: function (typeId) {\r\n            return this._jsPlumb.types.indexOf(typeId) !== -1;\r\n        },\r\n\r\n        addType: function (typeId, params, doNotRepaint) {\r\n            var t = _splitType(typeId), _cont = false;\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    if (!this.hasType(t[i])) {\r\n                        this._jsPlumb.types.push(t[i]);\r\n                        _cont = true;\r\n                    }\r\n                }\r\n                if (_cont) {\r\n                    _applyTypes(this, params, doNotRepaint);\r\n                }\r\n            }\r\n        },\r\n\r\n        removeType: function (typeId, params, doNotRepaint) {\r\n            var t = _splitType(typeId), _cont = false, _one = function (tt) {\r\n                var idx = this._jsPlumb.types.indexOf(tt);\r\n                if (idx !== -1) {\r\n                    // remove css class if necessary\r\n                    _removeTypeCssHelper(this, idx);\r\n                    this._jsPlumb.types.splice(idx, 1);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }.bind(this);\r\n\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    _cont = _one(t[i]) || _cont;\r\n                }\r\n                if (_cont) {\r\n                    _applyTypes(this, params, doNotRepaint);\r\n                }\r\n            }\r\n        },\r\n        clearTypes: function (params, doNotRepaint) {\r\n            var i = this._jsPlumb.types.length;\r\n            for (var j = 0; j < i; j++) {\r\n                _removeTypeCssHelper(this, 0);\r\n                this._jsPlumb.types.splice(0, 1);\r\n            }\r\n            _applyTypes(this, params, doNotRepaint);\r\n        },\r\n\r\n        toggleType: function (typeId, params, doNotRepaint) {\r\n            var t = _splitType(typeId);\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    var idx = this._jsPlumb.types.indexOf(t[i]);\r\n                    if (idx !== -1) {\r\n                        _removeTypeCssHelper(this, idx);\r\n                        this._jsPlumb.types.splice(idx, 1);\r\n                    }\r\n                    else {\r\n                        this._jsPlumb.types.push(t[i]);\r\n                    }\r\n                }\r\n\r\n                _applyTypes(this, params, doNotRepaint);\r\n            }\r\n        },\r\n        applyType: function (t, doNotRepaint) {\r\n            this.setPaintStyle(t.paintStyle, doNotRepaint);\r\n            this.setHoverPaintStyle(t.hoverPaintStyle, doNotRepaint);\r\n            if (t.parameters) {\r\n                for (var i in t.parameters) {\r\n                    this.setParameter(i, t.parameters[i]);\r\n                }\r\n            }\r\n            this._jsPlumb.paintStyleInUse = this.getPaintStyle();\r\n        },\r\n        setPaintStyle: function (style, doNotRepaint) {\r\n            // this._jsPlumb.paintStyle = jsPlumb.extend({}, style);\r\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\r\n            this._jsPlumb.paintStyle = style;\r\n            this._jsPlumb.paintStyleInUse = this._jsPlumb.paintStyle;\r\n            _updateHoverStyle(this);\r\n            if (!doNotRepaint) {\r\n                this.repaint();\r\n            }\r\n        },\r\n        getPaintStyle: function () {\r\n            return this._jsPlumb.paintStyle;\r\n        },\r\n        setHoverPaintStyle: function (style, doNotRepaint) {\r\n            //this._jsPlumb.hoverPaintStyle = jsPlumb.extend({}, style);\r\n            // TODO figure out if we want components to clone paintStyle so as not to share it.\r\n            this._jsPlumb.hoverPaintStyle = style;\r\n            _updateHoverStyle(this);\r\n            if (!doNotRepaint) {\r\n                this.repaint();\r\n            }\r\n        },\r\n        getHoverPaintStyle: function () {\r\n            return this._jsPlumb.hoverPaintStyle;\r\n        },\r\n        destroy: function (force) {\r\n            if (force || this.typeId == null) {\r\n                this.cleanupListeners(); // this is on EventGenerator\r\n                this.clone = null;\r\n                this._jsPlumb = null;\r\n            }\r\n        },\r\n\r\n        isHover: function () {\r\n            return this._jsPlumb.hover;\r\n        },\r\n\r\n        setHover: function (hover, ignoreAttachedElements, timestamp) {\r\n            // while dragging, we ignore these events.  this keeps the UI from flashing and\r\n            // swishing and whatevering.\r\n            if (this._jsPlumb && !this._jsPlumb.instance.currentlyDragging && !this._jsPlumb.instance.isHoverSuspended()) {\r\n\r\n                this._jsPlumb.hover = hover;\r\n                var method = hover ? \"addClass\" : \"removeClass\";\r\n\r\n                if (this.canvas != null) {\r\n                    if (this._jsPlumb.instance.hoverClass != null) {\r\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.instance.hoverClass);\r\n                    }\r\n                    if (this._jsPlumb.hoverClass != null) {\r\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.hoverClass);\r\n                    }\r\n                }\r\n                if (this._jsPlumb.hoverPaintStyle != null) {\r\n                    this._jsPlumb.paintStyleInUse = hover ? this._jsPlumb.hoverPaintStyle : this._jsPlumb.paintStyle;\r\n                    if (!this._jsPlumb.instance.isSuspendDrawing()) {\r\n                        timestamp = timestamp || _timestamp();\r\n                        this.repaint({timestamp: timestamp, recalc: false});\r\n                    }\r\n                }\r\n                // get the list of other affected elements, if supported by this component.\r\n                // for a connection, its the endpoints.  for an endpoint, its the connections! surprise.\r\n                if (this.getAttachedElements && !ignoreAttachedElements) {\r\n                    _updateAttachedElements(this, hover, _timestamp(), this);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n// ------------------------------ END jsPlumbUIComponent --------------------------------------------\r\n\r\n    var _jsPlumbInstanceIndex = 0,\r\n        getInstanceIndex = function () {\r\n            var i = _jsPlumbInstanceIndex + 1;\r\n            _jsPlumbInstanceIndex++;\r\n            return i;\r\n        };\r\n\r\n    var jsPlumbInstance = root.jsPlumbInstance = function (_defaults) {\r\n\r\n        this.version = \"2.12.6\";\r\n\r\n        this.Defaults = {\r\n            Anchor: \"Bottom\",\r\n            Anchors: [ null, null ],\r\n            ConnectionsDetachable: true,\r\n            ConnectionOverlays: [ ],\r\n            Connector: \"Bezier\",\r\n            Container: null,\r\n            DoNotThrowErrors: false,\r\n            DragOptions: { },\r\n            DropOptions: { },\r\n            Endpoint: \"Dot\",\r\n            EndpointOverlays: [ ],\r\n            Endpoints: [ null, null ],\r\n            EndpointStyle: { fill: \"#456\" },\r\n            EndpointStyles: [ null, null ],\r\n            EndpointHoverStyle: null,\r\n            EndpointHoverStyles: [ null, null ],\r\n            HoverPaintStyle: null,\r\n            LabelStyle: { color: \"black\" },\r\n            LogEnabled: false,\r\n            Overlays: [ ],\r\n            MaxConnections: 1,\r\n            PaintStyle: { \"stroke-width\": 4, stroke: \"#456\" },\r\n            ReattachConnections: false,\r\n            RenderMode: \"svg\",\r\n            Scope: \"jsPlumb_DefaultScope\"\r\n        };\r\n\r\n        if (_defaults) {\r\n            jsPlumb.extend(this.Defaults, _defaults);\r\n        }\r\n\r\n        this.logEnabled = this.Defaults.LogEnabled;\r\n        this._connectionTypes = {};\r\n        this._endpointTypes = {};\r\n\r\n        _ju.EventGenerator.apply(this);\r\n\r\n        var _currentInstance = this,\r\n            _instanceIndex = getInstanceIndex(),\r\n            _bb = _currentInstance.bind,\r\n            _initialDefaults = {},\r\n            _zoom = 1,\r\n            _info = function (el) {\r\n                if (el == null) {\r\n                    return null;\r\n                }\r\n                else if (el.nodeType === 3 || el.nodeType === 8) {\r\n                    return { el:el, text:true };\r\n                }\r\n                else {\r\n                    var _el = _currentInstance.getElement(el);\r\n                    return { el: _el, id: (_ju.isString(el) && _el == null) ? el : _getId(_el) };\r\n                }\r\n            };\r\n\r\n        this.getInstanceIndex = function () {\r\n            return _instanceIndex;\r\n        };\r\n\r\n        // CONVERTED\r\n        this.setZoom = function (z, repaintEverything) {\r\n            _zoom = z;\r\n            _currentInstance.fire(\"zoom\", _zoom);\r\n            if (repaintEverything) {\r\n                _currentInstance.repaintEverything();\r\n            }\r\n            return true;\r\n        };\r\n        // CONVERTED\r\n        this.getZoom = function () {\r\n            return _zoom;\r\n        };\r\n\r\n        for (var i in this.Defaults) {\r\n            _initialDefaults[i] = this.Defaults[i];\r\n        }\r\n\r\n        var _container, _containerDelegations = [];\r\n        this.unbindContainer = function() {\r\n            if (_container != null && _containerDelegations.length > 0) {\r\n                for (var i = 0; i < _containerDelegations.length; i++) {\r\n                    _currentInstance.off(_container, _containerDelegations[i][0], _containerDelegations[i][1]);\r\n                }\r\n            }\r\n        };\r\n        this.setContainer = function (c) {\r\n\r\n            this.unbindContainer();\r\n\r\n            // get container as dom element.\r\n            c = this.getElement(c);\r\n            // move existing connections and endpoints, if any.\r\n            this.select().each(function (conn) {\r\n                conn.moveParent(c);\r\n            });\r\n            this.selectEndpoints().each(function (ep) {\r\n                ep.moveParent(c);\r\n            });\r\n\r\n            // set container.\r\n            var previousContainer = _container;\r\n            _container = c;\r\n            _containerDelegations.length = 0;\r\n            var eventAliases = {\r\n                \"endpointclick\":\"endpointClick\",\r\n                \"endpointdblclick\":\"endpointDblClick\"\r\n            };\r\n\r\n            var _oneDelegateHandler = function (id, e, componentType) {\r\n                var t = e.srcElement || e.target,\r\n                    jp = (t && t.parentNode ? t.parentNode._jsPlumb : null) || (t ? t._jsPlumb : null) || (t && t.parentNode && t.parentNode.parentNode ? t.parentNode.parentNode._jsPlumb : null);\r\n                if (jp) {\r\n                    jp.fire(id, jp, e);\r\n                    var alias = componentType ? eventAliases[componentType + id] || id : id;\r\n                    // jsplumb also fires every event coming from components/overlays. That's what the test for `jp.component` is for.\r\n                    _currentInstance.fire(alias, jp.component || jp, e);\r\n                }\r\n            };\r\n\r\n            var _addOneDelegate = function(eventId, selector, fn) {\r\n                _containerDelegations.push([eventId, fn]);\r\n                _currentInstance.on(_container, eventId, selector, fn);\r\n            };\r\n\r\n            // delegate one event on the container to jsplumb elements. it might be possible to\r\n            // abstract this out: each of endpoint, connection and overlay could register themselves with\r\n            // jsplumb as \"component types\" or whatever, and provide a suitable selector. this would be\r\n            // done by the renderer (although admittedly from 2.0 onwards we're not supporting vml anymore)\r\n            var _oneDelegate = function (id) {\r\n                // connections.\r\n                _addOneDelegate(id, \".jtk-connector\", function (e) {\r\n                    _oneDelegateHandler(id, e);\r\n                });\r\n                // endpoints. note they can have an enclosing div, or not.\r\n                _addOneDelegate(id, \".jtk-endpoint\", function (e) {\r\n                    _oneDelegateHandler(id, e, \"endpoint\");\r\n                });\r\n                // overlays\r\n                _addOneDelegate(id, \".jtk-overlay\", function (e) {\r\n                    _oneDelegateHandler(id, e);\r\n                });\r\n            };\r\n\r\n            for (var i = 0; i < events.length; i++) {\r\n                _oneDelegate(events[i]);\r\n            }\r\n\r\n            // managed elements\r\n            for (var elId in managedElements) {\r\n                var el = managedElements[elId].el;\r\n                if (el.parentNode === previousContainer) {\r\n                    previousContainer.removeChild(el);\r\n                    _container.appendChild(el);\r\n                }\r\n            }\r\n\r\n        };\r\n        this.getContainer = function () {\r\n            return _container;\r\n        };\r\n\r\n        this.bind = function (event, fn) {\r\n            if (\"ready\" === event && initialized) {\r\n                fn();\r\n            }\r\n            else {\r\n                _bb.apply(_currentInstance, [event, fn]);\r\n            }\r\n        };\r\n\r\n        _currentInstance.importDefaults = function (d) {\r\n            for (var i in d) {\r\n                _currentInstance.Defaults[i] = d[i];\r\n            }\r\n            if (d.Container) {\r\n                _currentInstance.setContainer(d.Container);\r\n            }\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        _currentInstance.restoreDefaults = function () {\r\n            _currentInstance.Defaults = jsPlumb.extend({}, _initialDefaults);\r\n            return _currentInstance;\r\n        };\r\n\r\n        var log = null,\r\n            initialized = false,\r\n            // TODO remove from window scope\r\n            connections = [],\r\n            // map of element id -> endpoint lists. an element can have an arbitrary\r\n            // number of endpoints on it, and not all of them have to be connected\r\n            // to anything.\r\n            endpointsByElement = {},\r\n            endpointsByUUID = {},\r\n            managedElements = {},\r\n            offsets = {},\r\n            offsetTimestamps = {},\r\n            draggableStates = {},\r\n            connectionBeingDragged = false,\r\n            sizes = [],\r\n            _suspendDrawing = false,\r\n            _suspendedAt = null,\r\n            DEFAULT_SCOPE = this.Defaults.Scope,\r\n            _curIdStamp = 1,\r\n            _idstamp = function () {\r\n                return \"\" + _curIdStamp++;\r\n            },\r\n\r\n            //\r\n            // appends an element to some other element, which is calculated as follows:\r\n            //\r\n            // 1. if Container exists, use that element.\r\n            // 2. if the 'parent' parameter exists, use that.\r\n            // 3. otherwise just use the root element.\r\n            //\r\n            //\r\n            _appendElement = function (el, parent) {\r\n                if (_container) {\r\n                    _container.appendChild(el);\r\n                }\r\n                else if (!parent) {\r\n                    this.appendToRoot(el);\r\n                }\r\n                else {\r\n                    this.getElement(parent).appendChild(el);\r\n                }\r\n            }.bind(this),\r\n\r\n            //\r\n            // Draws an endpoint and its connections. this is the main entry point into drawing connections as well\r\n            // as endpoints, since jsPlumb is endpoint-centric under the hood.\r\n            //\r\n            // @param element element to draw (of type library specific element object)\r\n            // @param ui UI object from current library's event system. optional.\r\n            // @param timestamp timestamp for this paint cycle. used to speed things up a little by cutting down the amount of offset calculations we do.\r\n            // @param clearEdits defaults to false; indicates that mouse edits for connectors should be cleared\r\n            ///\r\n            _draw = function (element, ui, timestamp, clearEdits) {\r\n\r\n                if (!_suspendDrawing) {\r\n                    var id = _getId(element),\r\n                        repaintEls,\r\n                        dm = _currentInstance.getDragManager();\r\n\r\n                    if (dm) {\r\n                        repaintEls = dm.getElementsForDraggable(id);\r\n                    }\r\n\r\n                    if (timestamp == null) {\r\n                        timestamp = _timestamp();\r\n                    }\r\n\r\n                    // update the offset of everything _before_ we try to draw anything.\r\n                    var o = _updateOffset({ elId: id, offset: ui, recalc: false, timestamp: timestamp });\r\n\r\n                    if (repaintEls && o && o.o) {\r\n                        for (var i in repaintEls) {\r\n                            _updateOffset({\r\n                                elId: repaintEls[i].id,\r\n                                offset: {\r\n                                    left: o.o.left + repaintEls[i].offset.left,\r\n                                    top: o.o.top + repaintEls[i].offset.top\r\n                                },\r\n                                recalc: false,\r\n                                timestamp: timestamp\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    _currentInstance.anchorManager.redraw(id, ui, timestamp, null, clearEdits);\r\n\r\n                    if (repaintEls) {\r\n                        for (var j in repaintEls) {\r\n                            _currentInstance.anchorManager.redraw(repaintEls[j].id, ui, timestamp, repaintEls[j].offset, clearEdits, true);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n            //\r\n            // gets an Endpoint by uuid.\r\n            //\r\n            _getEndpoint = function (uuid) {\r\n                return endpointsByUUID[uuid];\r\n            },\r\n\r\n            /**\r\n             * inits a draggable if it's not already initialised.\r\n             * TODO: somehow abstract this to the adapter, because the concept of \"draggable\" has no\r\n             * place on the server.\r\n             */\r\n\r\n\r\n            _scopeMatch = function (e1, e2) {\r\n                var s1 = e1.scope.split(/\\s/), s2 = e2.scope.split(/\\s/);\r\n                for (var i = 0; i < s1.length; i++) {\r\n                    for (var j = 0; j < s2.length; j++) {\r\n                        if (s2[j] === s1[i]) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return false;\r\n            },\r\n\r\n            _mergeOverrides = function (def, values) {\r\n                var m = jsPlumb.extend({}, def);\r\n                for (var i in values) {\r\n                    if (values[i]) {\r\n                        m[i] = values[i];\r\n                    }\r\n                }\r\n                return m;\r\n            },\r\n\r\n            /*\r\n             * prepares a final params object that can be passed to _newConnection, taking into account defaults, events, etc.\r\n             */\r\n            _prepareConnectionParams = function (params, referenceParams) {\r\n                var _p = jsPlumb.extend({ }, params);\r\n                if (referenceParams) {\r\n                    jsPlumb.extend(_p, referenceParams);\r\n                }\r\n\r\n                // hotwire endpoints passed as source or target to sourceEndpoint/targetEndpoint, respectively.\r\n                if (_p.source) {\r\n                    if (_p.source.endpoint) {\r\n                        _p.sourceEndpoint = _p.source;\r\n                    }\r\n                    else {\r\n                        _p.source = _currentInstance.getElement(_p.source);\r\n                    }\r\n                }\r\n                if (_p.target) {\r\n                    if (_p.target.endpoint) {\r\n                        _p.targetEndpoint = _p.target;\r\n                    }\r\n                    else {\r\n                        _p.target = _currentInstance.getElement(_p.target);\r\n                    }\r\n                }\r\n\r\n                // test for endpoint uuids to connect\r\n                if (params.uuids) {\r\n                    _p.sourceEndpoint = _getEndpoint(params.uuids[0]);\r\n                    _p.targetEndpoint = _getEndpoint(params.uuids[1]);\r\n                }\r\n\r\n                // now ensure that if we do have Endpoints already, they're not full.\r\n                // source:\r\n                if (_p.sourceEndpoint && _p.sourceEndpoint.isFull()) {\r\n                    _ju.log(_currentInstance, \"could not add connection; source endpoint is full\");\r\n                    return;\r\n                }\r\n\r\n                // target:\r\n                if (_p.targetEndpoint && _p.targetEndpoint.isFull()) {\r\n                    _ju.log(_currentInstance, \"could not add connection; target endpoint is full\");\r\n                    return;\r\n                }\r\n\r\n                // if source endpoint mandates connection type and nothing specified in our params, use it.\r\n                if (!_p.type && _p.sourceEndpoint) {\r\n                    _p.type = _p.sourceEndpoint.connectionType;\r\n                }\r\n\r\n                // copy in any connectorOverlays that were specified on the source endpoint.\r\n                // it doesnt copy target endpoint overlays.  i'm not sure if we want it to or not.\r\n                if (_p.sourceEndpoint && _p.sourceEndpoint.connectorOverlays) {\r\n                    _p.overlays = _p.overlays || [];\r\n                    for (var i = 0, j = _p.sourceEndpoint.connectorOverlays.length; i < j; i++) {\r\n                        _p.overlays.push(_p.sourceEndpoint.connectorOverlays[i]);\r\n                    }\r\n                }\r\n\r\n                // scope\r\n                if (_p.sourceEndpoint && _p.sourceEndpoint.scope) {\r\n                    _p.scope = _p.sourceEndpoint.scope;\r\n                }\r\n\r\n                // pointer events\r\n                if (!_p[\"pointer-events\"] && _p.sourceEndpoint && _p.sourceEndpoint.connectorPointerEvents) {\r\n                    _p[\"pointer-events\"] = _p.sourceEndpoint.connectorPointerEvents;\r\n                }\r\n\r\n\r\n                var _addEndpoint = function (el, def, idx) {\r\n                    var params = _mergeOverrides(def, {\r\n                        anchor: _p.anchors ? _p.anchors[idx] : _p.anchor,\r\n                        endpoint: _p.endpoints ? _p.endpoints[idx] : _p.endpoint,\r\n                        paintStyle: _p.endpointStyles ? _p.endpointStyles[idx] : _p.endpointStyle,\r\n                        hoverPaintStyle: _p.endpointHoverStyles ? _p.endpointHoverStyles[idx] : _p.endpointHoverStyle\r\n                    });\r\n                    return _currentInstance.addEndpoint(el, params);\r\n                };\r\n\r\n                // check for makeSource/makeTarget specs.\r\n\r\n                var _oneElementDef = function (type, idx, defs, matchType) {\r\n                    if (_p[type] && !_p[type].endpoint && !_p[type + \"Endpoint\"] && !_p.newConnection) {\r\n                        var tid = _getId(_p[type]), tep = defs[tid];\r\n\r\n                        tep = tep ? tep[matchType] : null;\r\n\r\n                        if (tep) {\r\n                            // if not enabled, return.\r\n                            if (!tep.enabled) {\r\n                                return false;\r\n                            }\r\n\r\n                            var epDef = jsPlumb.extend({}, tep.def);\r\n                            delete epDef.label;\r\n\r\n                            var newEndpoint = tep.endpoint != null && tep.endpoint._jsPlumb ? tep.endpoint : _addEndpoint(_p[type], epDef, idx);\r\n                            if (newEndpoint.isFull()) {\r\n                                return false;\r\n                            }\r\n                            _p[type + \"Endpoint\"] = newEndpoint;\r\n                            if (!_p.scope && epDef.scope) {\r\n                                _p.scope = epDef.scope;\r\n                            } // provide scope if not already provided and endpoint def has one.\r\n                            if (tep.uniqueEndpoint) {\r\n                                if (!tep.endpoint) {\r\n                                    tep.endpoint = newEndpoint;\r\n                                    newEndpoint.setDeleteOnEmpty(false);\r\n                                }\r\n                                else {\r\n                                    newEndpoint.finalEndpoint = tep.endpoint;\r\n                                }\r\n                            } else {\r\n                                newEndpoint.setDeleteOnEmpty(true);\r\n                            }\r\n\r\n                            //\r\n                            // copy in connector overlays if present on the source definition.\r\n                            //\r\n                            if (idx === 0 && tep.def.connectorOverlays) {\r\n                                _p.overlays = _p.overlays || [];\r\n                                Array.prototype.push.apply(_p.overlays, tep.def.connectorOverlays);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n\r\n                if (_oneElementDef(\"source\", 0, this.sourceEndpointDefinitions, _p.type || \"default\") === false) {\r\n                    return;\r\n                }\r\n                if (_oneElementDef(\"target\", 1, this.targetEndpointDefinitions, _p.type || \"default\") === false) {\r\n                    return;\r\n                }\r\n\r\n                // last, ensure scopes match\r\n                if (_p.sourceEndpoint && _p.targetEndpoint) {\r\n                    if (!_scopeMatch(_p.sourceEndpoint, _p.targetEndpoint)) {\r\n                        _p = null;\r\n                    }\r\n                }\r\n\r\n                return _p;\r\n            }.bind(_currentInstance),\r\n\r\n            _newConnection = function (params) {\r\n                var connectionFunc = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType();\r\n\r\n                params._jsPlumb = _currentInstance;\r\n                params.newConnection = _newConnection;\r\n                params.newEndpoint = _newEndpoint;\r\n                params.endpointsByUUID = endpointsByUUID;\r\n                params.endpointsByElement = endpointsByElement;\r\n                params.finaliseConnection = _finaliseConnection;\r\n                params.id = \"con_\" + _idstamp();\r\n                var con = new connectionFunc(params);\r\n\r\n                // if the connection is draggable, then maybe we need to tell the target endpoint to init the\r\n                // dragging code. it won't run again if it already configured to be draggable.\r\n                if (con.isDetachable()) {\r\n                    con.endpoints[0].initDraggable(\"_jsPlumbSource\");\r\n                    con.endpoints[1].initDraggable(\"_jsPlumbTarget\");\r\n                }\r\n\r\n                return con;\r\n            },\r\n\r\n            //\r\n            // adds the connection to the backing model, fires an event if necessary and then redraws\r\n            //\r\n            _finaliseConnection = _currentInstance.finaliseConnection = function (jpc, params, originalEvent, doInformAnchorManager) {\r\n                params = params || {};\r\n                // add to list of connections (by scope).\r\n                if (!jpc.suspendedEndpoint) {\r\n                    connections.push(jpc);\r\n                }\r\n\r\n                jpc.pending = null;\r\n\r\n                // turn off isTemporarySource on the source endpoint (only viable on first draw)\r\n                jpc.endpoints[0].isTemporarySource = false;\r\n\r\n                // always inform the anchor manager\r\n                // except that if jpc has a suspended endpoint it's not true to say the\r\n                // connection is new; it has just (possibly) moved. the question is whether\r\n                // to make that call here or in the anchor manager.  i think perhaps here.\r\n                if (doInformAnchorManager !== false) {\r\n                    _currentInstance.anchorManager.newConnection(jpc);\r\n                }\r\n\r\n                // force a paint\r\n                _draw(jpc.source);\r\n\r\n                // fire an event\r\n                if (!params.doNotFireConnectionEvent && params.fireEvent !== false) {\r\n\r\n                    var eventArgs = {\r\n                        connection: jpc,\r\n                        source: jpc.source, target: jpc.target,\r\n                        sourceId: jpc.sourceId, targetId: jpc.targetId,\r\n                        sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\r\n                    };\r\n\r\n                    _currentInstance.fire(\"connection\", eventArgs, originalEvent);\r\n                }\r\n            },\r\n\r\n            /*\r\n             factory method to prepare a new endpoint.  this should always be used instead of creating Endpoints\r\n             manually, since this method attaches event listeners and an id.\r\n             */\r\n            _newEndpoint = function (params, id) {\r\n                var endpointFunc = _currentInstance.Defaults.EndpointType || jsPlumb.Endpoint;\r\n                var _p = jsPlumb.extend({}, params);\r\n                //delete _p.label; // not supported by endpoint.\r\n                _p._jsPlumb = _currentInstance;\r\n                _p.newConnection = _newConnection;\r\n                _p.newEndpoint = _newEndpoint;\r\n                _p.endpointsByUUID = endpointsByUUID;\r\n                _p.endpointsByElement = endpointsByElement;\r\n                _p.fireDetachEvent = fireDetachEvent;\r\n                _p.elementId = id || _getId(_p.source);\r\n                var ep = new endpointFunc(_p);\r\n                ep.id = \"ep_\" + _idstamp();\r\n                _manage(_p.elementId, _p.source);\r\n\r\n                if (!jsPlumb.headless) {\r\n                    _currentInstance.getDragManager().endpointAdded(_p.source, id);\r\n                }\r\n\r\n                return ep;\r\n            },\r\n\r\n            /*\r\n             * performs the given function operation on all the connections found\r\n             * for the given element id; this means we find all the endpoints for\r\n             * the given element, and then for each endpoint find the connectors\r\n             * connected to it. then we pass each connection in to the given\r\n             * function.\r\n             */\r\n            _operation = function (elId, func, endpointFunc) {\r\n                var endpoints = endpointsByElement[elId];\r\n                if (endpoints && endpoints.length) {\r\n                    for (var i = 0, ii = endpoints.length; i < ii; i++) {\r\n                        for (var j = 0, jj = endpoints[i].connections.length; j < jj; j++) {\r\n                            var retVal = func(endpoints[i].connections[j]);\r\n                            // if the function passed in returns true, we exit.\r\n                            // most functions return false.\r\n                            if (retVal) {\r\n                                return;\r\n                            }\r\n                        }\r\n                        if (endpointFunc) {\r\n                            endpointFunc(endpoints[i]);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n            _setDraggable = function (element, draggable) {\r\n                return jsPlumb.each(element, function (el) {\r\n                    if (_currentInstance.isDragSupported(el)) {\r\n                        draggableStates[_currentInstance.getAttribute(el, \"id\")] = draggable;\r\n                        _currentInstance.setElementDraggable(el, draggable);\r\n                    }\r\n                });\r\n            },\r\n            /*\r\n             * private method to do the business of hiding/showing.\r\n             *\r\n             * @param el\r\n             *            either Id of the element in question or a library specific\r\n             *            object for the element.\r\n             * @param state\r\n             *            String specifying a value for the css 'display' property\r\n             *            ('block' or 'none').\r\n             */\r\n            _setVisible = function (el, state, alsoChangeEndpoints) {\r\n                state = state === \"block\";\r\n                var endpointFunc = null;\r\n                if (alsoChangeEndpoints) {\r\n                    endpointFunc = function (ep) {\r\n                        ep.setVisible(state, true, true);\r\n                    };\r\n                }\r\n                var info = _info(el);\r\n                _operation(info.id, function (jpc) {\r\n                    if (state && alsoChangeEndpoints) {\r\n                        // this test is necessary because this functionality is new, and i wanted to maintain backwards compatibility.\r\n                        // this block will only set a connection to be visible if the other endpoint in the connection is also visible.\r\n                        var oidx = jpc.sourceId === info.id ? 1 : 0;\r\n                        if (jpc.endpoints[oidx].isVisible()) {\r\n                            jpc.setVisible(true);\r\n                        }\r\n                    }\r\n                    else { // the default behaviour for show, and what always happens for hide, is to just set the visibility without getting clever.\r\n                        jpc.setVisible(state);\r\n                    }\r\n                }, endpointFunc);\r\n            },\r\n            /**\r\n             * private method to do the business of toggling hiding/showing.\r\n             */\r\n            _toggleVisible = function (elId, changeEndpoints) {\r\n                var endpointFunc = null;\r\n                if (changeEndpoints) {\r\n                    endpointFunc = function (ep) {\r\n                        var state = ep.isVisible();\r\n                        ep.setVisible(!state);\r\n                    };\r\n                }\r\n                _operation(elId, function (jpc) {\r\n                    var state = jpc.isVisible();\r\n                    jpc.setVisible(!state);\r\n                }, endpointFunc);\r\n            },\r\n\r\n            // TODO comparison performance\r\n            _getCachedData = function (elId) {\r\n                var o = offsets[elId];\r\n                if (!o) {\r\n                    return _updateOffset({elId: elId});\r\n                }\r\n                else {\r\n                    return {o: o, s: sizes[elId]};\r\n                }\r\n            },\r\n\r\n            /**\r\n             * gets an id for the given element, creating and setting one if\r\n             * necessary.  the id is of the form\r\n             *\r\n             *    jsPlumb_<instance index>_<index in instance>\r\n             *\r\n             * where \"index in instance\" is a monotonically increasing integer that starts at 0,\r\n             * for each instance.  this method is used not only to assign ids to elements that do not\r\n             * have them but also to connections and endpoints.\r\n             */\r\n            _getId = function (element, uuid, doNotCreateIfNotFound) {\r\n                if (_ju.isString(element)) {\r\n                    return element;\r\n                }\r\n                if (element == null) {\r\n                    return null;\r\n                }\r\n                var id = _currentInstance.getAttribute(element, \"id\");\r\n                if (!id || id === \"undefined\") {\r\n                    // check if fixed uuid parameter is given\r\n                    if (arguments.length === 2 && arguments[1] !== undefined) {\r\n                        id = uuid;\r\n                    }\r\n                    else if (arguments.length === 1 || (arguments.length === 3 && !arguments[2])) {\r\n                        id = \"jsPlumb_\" + _instanceIndex + \"_\" + _idstamp();\r\n                    }\r\n\r\n                    if (!doNotCreateIfNotFound) {\r\n                        _currentInstance.setAttribute(element, \"id\", id);\r\n                    }\r\n                }\r\n                return id;\r\n            };\r\n\r\n        this.setConnectionBeingDragged = function (v) {\r\n            connectionBeingDragged = v;\r\n        };\r\n        this.isConnectionBeingDragged = function () {\r\n            return connectionBeingDragged;\r\n        };\r\n\r\n        /**\r\n         * Returns a map of all the elements this jsPlumbInstance is currently managing.\r\n         * @returns {Object} Map of [id-> {el, endpoint[], connection, position}] information.\r\n         */\r\n        this.getManagedElements = function() {\r\n            return managedElements;\r\n        };\r\n\r\n        this.connectorClass = \"jtk-connector\";\r\n        this.connectorOutlineClass = \"jtk-connector-outline\";\r\n        this.connectedClass = \"jtk-connected\";\r\n        this.hoverClass = \"jtk-hover\";\r\n        this.endpointClass = \"jtk-endpoint\";\r\n        this.endpointConnectedClass = \"jtk-endpoint-connected\";\r\n        this.endpointFullClass = \"jtk-endpoint-full\";\r\n        this.endpointDropAllowedClass = \"jtk-endpoint-drop-allowed\";\r\n        this.endpointDropForbiddenClass = \"jtk-endpoint-drop-forbidden\";\r\n        this.overlayClass = \"jtk-overlay\";\r\n        this.draggingClass = \"jtk-dragging\";// CONVERTED\r\n        this.elementDraggingClass = \"jtk-element-dragging\";// CONVERTED\r\n        this.sourceElementDraggingClass = \"jtk-source-element-dragging\"; // CONVERTED\r\n        this.targetElementDraggingClass = \"jtk-target-element-dragging\";// CONVERTED\r\n        this.endpointAnchorClassPrefix = \"jtk-endpoint-anchor\";\r\n        this.hoverSourceClass = \"jtk-source-hover\";\r\n        this.hoverTargetClass = \"jtk-target-hover\";\r\n        this.dragSelectClass = \"jtk-drag-select\";\r\n\r\n        this.Anchors = {};\r\n        this.Connectors = {  \"svg\": {} };\r\n        this.Endpoints = { \"svg\": {} };\r\n        this.Overlays = { \"svg\": {} } ;\r\n        this.ConnectorRenderers = {};\r\n        this.SVG = \"svg\";\r\n\r\n// --------------------------- jsPlumbInstance public API ---------------------------------------------------------\r\n\r\n\r\n        this.addEndpoint = function (el, params, referenceParams) {\r\n            referenceParams = referenceParams || {};\r\n            var p = jsPlumb.extend({}, referenceParams);\r\n            jsPlumb.extend(p, params);\r\n            p.endpoint = p.endpoint || _currentInstance.Defaults.Endpoint;\r\n            p.paintStyle = p.paintStyle || _currentInstance.Defaults.EndpointStyle;\r\n\r\n            var results = [],\r\n                inputs = (_ju.isArray(el) || (el.length != null && !_ju.isString(el))) ? el : [ el ];\r\n\r\n            for (var i = 0, j = inputs.length; i < j; i++) {\r\n                p.source = _currentInstance.getElement(inputs[i]);\r\n                _ensureContainer(p.source);\r\n\r\n                var id = _getId(p.source), e = _newEndpoint(p, id);\r\n\r\n                // ensure element is managed.\r\n                var myOffset = _manage(id, p.source).info.o;\r\n                _ju.addToList(endpointsByElement, id, e);\r\n\r\n                if (!_suspendDrawing) {\r\n                    e.paint({\r\n                        anchorLoc: e.anchor.compute({ xy: [ myOffset.left, myOffset.top ], wh: sizes[id], element: e, timestamp: _suspendedAt }),\r\n                        timestamp: _suspendedAt\r\n                    });\r\n                }\r\n\r\n                results.push(e);\r\n            }\r\n\r\n            return results.length === 1 ? results[0] : results;\r\n        };\r\n\r\n        this.addEndpoints = function (el, endpoints, referenceParams) {\r\n            var results = [];\r\n            for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                var e = _currentInstance.addEndpoint(el, endpoints[i], referenceParams);\r\n                if (_ju.isArray(e)) {\r\n                    Array.prototype.push.apply(results, e);\r\n                }\r\n                else {\r\n                    results.push(e);\r\n                }\r\n            }\r\n            return results;\r\n        };\r\n\r\n        this.animate = function (el, properties, options) {\r\n            if (!this.animationSupported) {\r\n                return false;\r\n            }\r\n\r\n            options = options || {};\r\n            var del = _currentInstance.getElement(el),\r\n                id = _getId(del),\r\n                stepFunction = jsPlumb.animEvents.step,\r\n                completeFunction = jsPlumb.animEvents.complete;\r\n\r\n            options[stepFunction] = _ju.wrap(options[stepFunction], function () {\r\n                _currentInstance.revalidate(id);\r\n            });\r\n\r\n            // onComplete repaints, just to make sure everything looks good at the end of the animation.\r\n            options[completeFunction] = _ju.wrap(options[completeFunction], function () {\r\n                _currentInstance.revalidate(id);\r\n            });\r\n\r\n            _currentInstance.doAnimate(del, properties, options);\r\n        };\r\n\r\n        /**\r\n         * checks for a listener for the given condition, executing it if found, passing in the given value.\r\n         * condition listeners would have been attached using \"bind\" (which is, you could argue, now overloaded, since\r\n         * firing click events etc is a bit different to what this does).  i thought about adding a \"bindCondition\"\r\n         * or something, but decided against it, for the sake of simplicity. jsPlumb will never fire one of these\r\n         * condition events anyway.\r\n         */\r\n        this.checkCondition = function (conditionName, args) {\r\n            var l = _currentInstance.getListener(conditionName),\r\n                r = true;\r\n\r\n            if (l && l.length > 0) {\r\n                var values = Array.prototype.slice.call(arguments, 1);\r\n                try {\r\n                    for (var i = 0, j = l.length; i < j; i++) {\r\n                        r = r && l[i].apply(l[i], values);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    _ju.log(_currentInstance, \"cannot check condition [\" + conditionName + \"]\" + e);\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n\r\n        this.connect = function (params, referenceParams) {\r\n            // prepare a final set of parameters to create connection with\r\n            var _p = _prepareConnectionParams(params, referenceParams), jpc;\r\n            // TODO probably a nicer return value if the connection was not made.  _prepareConnectionParams\r\n            // will return null (and log something) if either endpoint was full.  what would be nicer is to\r\n            // create a dedicated 'error' object.\r\n            if (_p) {\r\n                if (_p.source == null && _p.sourceEndpoint == null) {\r\n                    _ju.log(\"Cannot establish connection - source does not exist\");\r\n                    return;\r\n                }\r\n                if (_p.target == null && _p.targetEndpoint == null) {\r\n                    _ju.log(\"Cannot establish connection - target does not exist\");\r\n                    return;\r\n                }\r\n                _ensureContainer(_p.source);\r\n                // create the connection.  it is not yet registered\r\n                jpc = _newConnection(_p);\r\n                // now add it the model, fire an event, and redraw\r\n                _finaliseConnection(jpc, _p);\r\n            }\r\n            return jpc;\r\n        };\r\n\r\n        var stTypes = [\r\n            { el: \"source\", elId: \"sourceId\", epDefs: \"sourceEndpointDefinitions\" },\r\n            { el: \"target\", elId: \"targetId\", epDefs: \"targetEndpointDefinitions\" }\r\n        ];\r\n\r\n        var _set = function (c, el, idx, doNotRepaint) {\r\n            var ep, _st = stTypes[idx], cId = c[_st.elId], cEl = c[_st.el], sid, sep,\r\n                oldEndpoint = c.endpoints[idx];\r\n\r\n            var evtParams = {\r\n                index: idx,\r\n                originalSourceId: idx === 0 ? cId : c.sourceId,\r\n                newSourceId: c.sourceId,\r\n                originalTargetId: idx === 1 ? cId : c.targetId,\r\n                newTargetId: c.targetId,\r\n                connection: c\r\n            };\r\n\r\n            if (el.constructor === jsPlumb.Endpoint) {\r\n                ep = el;\r\n                ep.addConnection(c);\r\n                el = ep.element;\r\n            }\r\n            else {\r\n                sid = _getId(el);\r\n                sep = this[_st.epDefs][sid];\r\n\r\n                if (sid === c[_st.elId]) {\r\n                    ep = null; // dont change source/target if the element is already the one given.\r\n                }\r\n                else if (sep) {\r\n                    for (var t in sep) {\r\n                        if (!sep[t].enabled) {\r\n                            return;\r\n                        }\r\n                        ep = sep[t].endpoint != null && sep[t].endpoint._jsPlumb ? sep[t].endpoint : this.addEndpoint(el, sep[t].def);\r\n                        if (sep[t].uniqueEndpoint) {\r\n                            sep[t].endpoint = ep;\r\n                        }\r\n                        ep.addConnection(c);\r\n                    }\r\n                }\r\n                else {\r\n                    ep = c.makeEndpoint(idx === 0, el, sid);\r\n                }\r\n            }\r\n\r\n            if (ep != null) {\r\n                oldEndpoint.detachFromConnection(c);\r\n                c.endpoints[idx] = ep;\r\n                c[_st.el] = ep.element;\r\n                c[_st.elId] = ep.elementId;\r\n                evtParams[idx === 0 ? \"newSourceId\" : \"newTargetId\"] = ep.elementId;\r\n\r\n                fireMoveEvent(evtParams);\r\n\r\n                if (!doNotRepaint) {\r\n                    c.repaint();\r\n                }\r\n            }\r\n\r\n            evtParams.element = el;\r\n            return evtParams;\r\n\r\n        }.bind(this);\r\n\r\n        this.setSource = function (connection, el, doNotRepaint) {\r\n            var p = _set(connection, el, 0, doNotRepaint);\r\n            this.anchorManager.sourceChanged(p.originalSourceId, p.newSourceId, connection, p.el);\r\n        };\r\n        this.setTarget = function (connection, el, doNotRepaint) {\r\n            var p = _set(connection, el, 1, doNotRepaint);\r\n            this.anchorManager.updateOtherEndpoint(p.originalSourceId, p.originalTargetId, p.newTargetId, connection);\r\n        };\r\n\r\n        this.deleteEndpoint = function (object, dontUpdateHover, deleteAttachedObjects) {\r\n            var endpoint = (typeof object === \"string\") ? endpointsByUUID[object] : object;\r\n            if (endpoint) {\r\n                _currentInstance.deleteObject({ endpoint: endpoint, dontUpdateHover: dontUpdateHover, deleteAttachedObjects:deleteAttachedObjects });\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.deleteEveryEndpoint = function () {\r\n            var _is = _currentInstance.setSuspendDrawing(true);\r\n            for (var id in endpointsByElement) {\r\n                var endpoints = endpointsByElement[id];\r\n                if (endpoints && endpoints.length) {\r\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                        _currentInstance.deleteEndpoint(endpoints[i], true);\r\n                    }\r\n                }\r\n            }\r\n            endpointsByElement = {};\r\n            managedElements = {};\r\n            endpointsByUUID = {};\r\n            offsets = {};\r\n            offsetTimestamps = {};\r\n            _currentInstance.anchorManager.reset();\r\n            var dm = _currentInstance.getDragManager();\r\n            if (dm) {\r\n                dm.reset();\r\n            }\r\n            if (!_is) {\r\n                _currentInstance.setSuspendDrawing(false);\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        var fireDetachEvent = function (jpc, doFireEvent, originalEvent) {\r\n            // may have been given a connection, or in special cases, an object\r\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\r\n                argIsConnection = jpc.constructor === connType,\r\n                params = argIsConnection ? {\r\n                    connection: jpc,\r\n                    source: jpc.source, target: jpc.target,\r\n                    sourceId: jpc.sourceId, targetId: jpc.targetId,\r\n                    sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\r\n                } : jpc;\r\n\r\n            if (doFireEvent) {\r\n                _currentInstance.fire(\"connectionDetached\", params, originalEvent);\r\n            }\r\n\r\n            // always fire this. used by internal jsplumb stuff.\r\n            _currentInstance.fire(\"internal.connectionDetached\", params, originalEvent);\r\n\r\n            _currentInstance.anchorManager.connectionDetached(params);\r\n        };\r\n\r\n        var fireMoveEvent = _currentInstance.fireMoveEvent = function (params, evt) {\r\n            _currentInstance.fire(\"connectionMoved\", params, evt);\r\n        };\r\n\r\n        this.unregisterEndpoint = function (endpoint) {\r\n            if (endpoint._jsPlumb.uuid) {\r\n                endpointsByUUID[endpoint._jsPlumb.uuid] = null;\r\n            }\r\n            _currentInstance.anchorManager.deleteEndpoint(endpoint);\r\n            // TODO at least replace this with a removeWithFunction call.\r\n            for (var e in endpointsByElement) {\r\n                var endpoints = endpointsByElement[e];\r\n                if (endpoints) {\r\n                    var newEndpoints = [];\r\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                        if (endpoints[i] !== endpoint) {\r\n                            newEndpoints.push(endpoints[i]);\r\n                        }\r\n                    }\r\n\r\n                    endpointsByElement[e] = newEndpoints;\r\n                }\r\n                if (endpointsByElement[e].length < 1) {\r\n                    delete endpointsByElement[e];\r\n                }\r\n            }\r\n        };\r\n\r\n        var IS_DETACH_ALLOWED = \"isDetachAllowed\";\r\n        var BEFORE_DETACH = \"beforeDetach\";\r\n        var CHECK_CONDITION = \"checkCondition\";\r\n\r\n        /**\r\n         * Deletes a Connection.\r\n         * @method deleteConnection\r\n         * @param connection Connection to delete\r\n         * @param {Object} [params] Optional delete parameters\r\n         * @param {Boolean} [params.doNotFireEvent=false] If true, a connection detached event will not be fired. Otherwise one will.\r\n         * @param {Boolean} [params.force=false] If true, the connection will be deleted even if a beforeDetach interceptor tries to stop the deletion.\r\n         * @returns {Boolean} True if the connection was deleted, false otherwise.\r\n         */\r\n        this.deleteConnection = function(connection, params) {\r\n\r\n            if (connection != null) {\r\n                params = params || {};\r\n\r\n                if (params.force || _ju.functionChain(true, false, [\r\n                    [ connection.endpoints[0], IS_DETACH_ALLOWED, [ connection ] ],\r\n                    [ connection.endpoints[1], IS_DETACH_ALLOWED, [ connection ] ],\r\n                    [ connection, IS_DETACH_ALLOWED, [ connection ] ],\r\n                    [ _currentInstance, CHECK_CONDITION, [ BEFORE_DETACH, connection ] ]\r\n                ])) {\r\n\r\n                    connection.setHover(false);\r\n                    fireDetachEvent(connection, !connection.pending && params.fireEvent !== false, params.originalEvent);\r\n\r\n                    connection.endpoints[0].detachFromConnection(connection);\r\n                    connection.endpoints[1].detachFromConnection(connection);\r\n                    _ju.removeWithFunction(connections, function (_c) {\r\n                        return connection.id === _c.id;\r\n                    });\r\n\r\n                    connection.cleanup();\r\n                    connection.destroy();\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        /**\r\n         * Remove all Connections from all elements, but leaves Endpoints in place ((unless a connection is set to auto delete its Endpoints).\r\n         * @method deleteEveryConnection\r\n         * @param {Object} [params] optional params object for the call\r\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire detach events\r\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\r\n         * @returns {Number} The number of connections that were deleted.\r\n         */\r\n        this.deleteEveryConnection = function (params) {\r\n            params = params || {};\r\n            var count = connections.length, deletedCount = 0;\r\n            _currentInstance.batch(function () {\r\n                for (var i = 0; i < count; i++) {\r\n                    deletedCount += _currentInstance.deleteConnection(connections[0], params) ? 1 : 0;\r\n                }\r\n            });\r\n            return deletedCount;\r\n        };\r\n\r\n        /**\r\n         * Removes all an element's Connections.\r\n         * @method deleteConnectionsForElement\r\n         * @param {Object} el Either the id of the element, or a selector for the element.\r\n         * @param {Object} [params] Optional parameters.\r\n         * @param {Boolean} [params.fireEvent=true] Whether or not to fire the detach event.\r\n         * @param {Boolean} [params.forceDetach=false] If true, this call will ignore any `beforeDetach` interceptors.\r\n         * @return {jsPlumbInstance} The current jsPlumb instance.\r\n         */\r\n        this.deleteConnectionsForElement = function (el, params) {\r\n            params = params || {};\r\n            el = _currentInstance.getElement(el);\r\n            var id = _getId(el), endpoints = endpointsByElement[id];\r\n            if (endpoints && endpoints.length) {\r\n                for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                    endpoints[i].deleteEveryConnection(params);\r\n                }\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        /// not public.  but of course its exposed. how to change this.\r\n        this.deleteObject = function (params) {\r\n            var result = {\r\n                    endpoints: {},\r\n                    connections: {},\r\n                    endpointCount: 0,\r\n                    connectionCount: 0\r\n                },\r\n                deleteAttachedObjects = params.deleteAttachedObjects !== false;\r\n\r\n            var unravelConnection = function (connection) {\r\n                if (connection != null && result.connections[connection.id] == null) {\r\n                    if (!params.dontUpdateHover && connection._jsPlumb != null) {\r\n                        connection.setHover(false);\r\n                    }\r\n                    result.connections[connection.id] = connection;\r\n                    result.connectionCount++;\r\n                }\r\n            };\r\n            var unravelEndpoint = function (endpoint) {\r\n                if (endpoint != null && result.endpoints[endpoint.id] == null) {\r\n                    if (!params.dontUpdateHover && endpoint._jsPlumb != null) {\r\n                        endpoint.setHover(false);\r\n                    }\r\n                    result.endpoints[endpoint.id] = endpoint;\r\n                    result.endpointCount++;\r\n\r\n                    if (deleteAttachedObjects) {\r\n                        for (var i = 0; i < endpoint.connections.length; i++) {\r\n                            var c = endpoint.connections[i];\r\n                            unravelConnection(c);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (params.connection) {\r\n                unravelConnection(params.connection);\r\n            }\r\n            else {\r\n                unravelEndpoint(params.endpoint);\r\n            }\r\n\r\n            // loop through connections\r\n            for (var i in result.connections) {\r\n                var c = result.connections[i];\r\n                if (c._jsPlumb) {\r\n                    _ju.removeWithFunction(connections, function (_c) {\r\n                        return c.id === _c.id;\r\n                    });\r\n\r\n                    fireDetachEvent(c, params.fireEvent === false ? false : !c.pending, params.originalEvent);\r\n                    var doNotCleanup = params.deleteAttachedObjects == null ? null : !params.deleteAttachedObjects;\r\n\r\n                    c.endpoints[0].detachFromConnection(c, null, doNotCleanup);\r\n                    c.endpoints[1].detachFromConnection(c, null, doNotCleanup);\r\n\r\n                    c.cleanup(true);\r\n                    c.destroy(true);\r\n                }\r\n            }\r\n\r\n            // loop through endpoints\r\n            for (var j in result.endpoints) {\r\n                var e = result.endpoints[j];\r\n                if (e._jsPlumb) {\r\n                    _currentInstance.unregisterEndpoint(e);\r\n                    // FIRE some endpoint deleted event?\r\n                    e.cleanup(true);\r\n                    e.destroy(true);\r\n                }\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n        // helpers for select/selectEndpoints\r\n        var _setOperation = function (list, func, args, selector) {\r\n                for (var i = 0, j = list.length; i < j; i++) {\r\n                    list[i][func].apply(list[i], args);\r\n                }\r\n                return selector(list);\r\n            },\r\n            _getOperation = function (list, func, args) {\r\n                var out = [];\r\n                for (var i = 0, j = list.length; i < j; i++) {\r\n                    out.push([ list[i][func].apply(list[i], args), list[i] ]);\r\n                }\r\n                return out;\r\n            },\r\n            setter = function (list, func, selector) {\r\n                return function () {\r\n                    return _setOperation(list, func, arguments, selector);\r\n                };\r\n            },\r\n            getter = function (list, func) {\r\n                return function () {\r\n                    return _getOperation(list, func, arguments);\r\n                };\r\n            },\r\n            prepareList = function (input, doNotGetIds) {\r\n                var r = [];\r\n                if (input) {\r\n                    if (typeof input === 'string') {\r\n                        if (input === \"*\") {\r\n                            return input;\r\n                        }\r\n                        r.push(input);\r\n                    }\r\n                    else {\r\n                        if (doNotGetIds) {\r\n                            r = input;\r\n                        }\r\n                        else {\r\n                            if (input.length) {\r\n                                for (var i = 0, j = input.length; i < j; i++) {\r\n                                    r.push(_info(input[i]).id);\r\n                                }\r\n                            }\r\n                            else {\r\n                                r.push(_info(input).id);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return r;\r\n            },\r\n            filterList = function (list, value, missingIsFalse) {\r\n                if (list === \"*\") {\r\n                    return true;\r\n                }\r\n                return list.length > 0 ? list.indexOf(value) !== -1 : !missingIsFalse;\r\n            };\r\n\r\n        // get some connections, specifying source/target/scope\r\n        this.getConnections = function (options, flat) {\r\n            if (!options) {\r\n                options = {};\r\n            } else if (options.constructor === String) {\r\n                options = { \"scope\": options };\r\n            }\r\n            var scope = options.scope || _currentInstance.getDefaultScope(),\r\n                scopes = prepareList(scope, true),\r\n                sources = prepareList(options.source),\r\n                targets = prepareList(options.target),\r\n                results = (!flat && scopes.length > 1) ? {} : [],\r\n                _addOne = function (scope, obj) {\r\n                    if (!flat && scopes.length > 1) {\r\n                        var ss = results[scope];\r\n                        if (ss == null) {\r\n                            ss = results[scope] = [];\r\n                        }\r\n                        ss.push(obj);\r\n                    } else {\r\n                        results.push(obj);\r\n                    }\r\n                };\r\n\r\n            for (var j = 0, jj = connections.length; j < jj; j++) {\r\n                var c = connections[j],\r\n                    sourceId = c.proxies && c.proxies[0] ? c.proxies[0].originalEp.elementId : c.sourceId,\r\n                    targetId = c.proxies && c.proxies[1] ? c.proxies[1].originalEp.elementId : c.targetId;\r\n\r\n                if (filterList(scopes, c.scope) && filterList(sources, sourceId) && filterList(targets, targetId)) {\r\n                    _addOne(c.scope, c);\r\n                }\r\n            }\r\n\r\n            return results;\r\n        };\r\n\r\n        var _curryEach = function (list, executor) {\r\n                return function (f) {\r\n                    for (var i = 0, ii = list.length; i < ii; i++) {\r\n                        f(list[i]);\r\n                    }\r\n                    return executor(list);\r\n                };\r\n            },\r\n            _curryGet = function (list) {\r\n                return function (idx) {\r\n                    return list[idx];\r\n                };\r\n            };\r\n\r\n        var _makeCommonSelectHandler = function (list, executor) {\r\n            var out = {\r\n                    length: list.length,\r\n                    each: _curryEach(list, executor),\r\n                    get: _curryGet(list)\r\n                },\r\n                setters = [\"setHover\", \"removeAllOverlays\", \"setLabel\", \"addClass\", \"addOverlay\", \"removeOverlay\",\r\n                    \"removeOverlays\", \"showOverlay\", \"hideOverlay\", \"showOverlays\", \"hideOverlays\", \"setPaintStyle\",\r\n                    \"setHoverPaintStyle\", \"setSuspendEvents\", \"setParameter\", \"setParameters\", \"setVisible\",\r\n                    \"repaint\", \"addType\", \"toggleType\", \"removeType\", \"removeClass\", \"setType\", \"bind\", \"unbind\" ],\r\n\r\n                getters = [\"getLabel\", \"getOverlay\", \"isHover\", \"getParameter\", \"getParameters\", \"getPaintStyle\",\r\n                    \"getHoverPaintStyle\", \"isVisible\", \"hasType\", \"getType\", \"isSuspendEvents\" ],\r\n                i, ii;\r\n\r\n            for (i = 0, ii = setters.length; i < ii; i++) {\r\n                out[setters[i]] = setter(list, setters[i], executor);\r\n            }\r\n\r\n            for (i = 0, ii = getters.length; i < ii; i++) {\r\n                out[getters[i]] = getter(list, getters[i]);\r\n            }\r\n\r\n            return out;\r\n        };\r\n\r\n        var _makeConnectionSelectHandler = function (list) {\r\n            var common = _makeCommonSelectHandler(list, _makeConnectionSelectHandler);\r\n            return jsPlumb.extend(common, {\r\n                // setters\r\n                setDetachable: setter(list, \"setDetachable\", _makeConnectionSelectHandler),\r\n                setReattach: setter(list, \"setReattach\", _makeConnectionSelectHandler),\r\n                setConnector: setter(list, \"setConnector\", _makeConnectionSelectHandler),\r\n                delete: function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++) {\r\n                        _currentInstance.deleteConnection(list[i]);\r\n                    }\r\n                },\r\n                // getters\r\n                isDetachable: getter(list, \"isDetachable\"),\r\n                isReattach: getter(list, \"isReattach\")\r\n            });\r\n        };\r\n\r\n        var _makeEndpointSelectHandler = function (list) {\r\n            var common = _makeCommonSelectHandler(list, _makeEndpointSelectHandler);\r\n            return jsPlumb.extend(common, {\r\n                setEnabled: setter(list, \"setEnabled\", _makeEndpointSelectHandler),\r\n                setAnchor: setter(list, \"setAnchor\", _makeEndpointSelectHandler),\r\n                isEnabled: getter(list, \"isEnabled\"),\r\n                deleteEveryConnection: function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++) {\r\n                        list[i].deleteEveryConnection();\r\n                    }\r\n                },\r\n                \"delete\": function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++) {\r\n                        _currentInstance.deleteEndpoint(list[i]);\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        this.select = function (params) {\r\n            params = params || {};\r\n            params.scope = params.scope || \"*\";\r\n            return _makeConnectionSelectHandler(params.connections || _currentInstance.getConnections(params, true));\r\n        };\r\n\r\n        this.selectEndpoints = function (params) {\r\n            params = params || {};\r\n            params.scope = params.scope || \"*\";\r\n            var noElementFilters = !params.element && !params.source && !params.target,\r\n                elements = noElementFilters ? \"*\" : prepareList(params.element),\r\n                sources = noElementFilters ? \"*\" : prepareList(params.source),\r\n                targets = noElementFilters ? \"*\" : prepareList(params.target),\r\n                scopes = prepareList(params.scope, true);\r\n\r\n            var ep = [];\r\n\r\n            for (var el in endpointsByElement) {\r\n                var either = filterList(elements, el, true),\r\n                    source = filterList(sources, el, true),\r\n                    sourceMatchExact = sources !== \"*\",\r\n                    target = filterList(targets, el, true),\r\n                    targetMatchExact = targets !== \"*\";\r\n\r\n                // if they requested 'either' then just match scope. otherwise if they requested 'source' (not as a wildcard) then we have to match only endpoints that have isSource set to to true, and the same thing with isTarget.\r\n                if (either || source || target) {\r\n                    inner:\r\n                        for (var i = 0, ii = endpointsByElement[el].length; i < ii; i++) {\r\n                            var _ep = endpointsByElement[el][i];\r\n                            if (filterList(scopes, _ep.scope, true)) {\r\n\r\n                                var noMatchSource = (sourceMatchExact && sources.length > 0 && !_ep.isSource),\r\n                                    noMatchTarget = (targetMatchExact && targets.length > 0 && !_ep.isTarget);\r\n\r\n                                if (noMatchSource || noMatchTarget) {\r\n                                    continue inner;\r\n                                }\r\n\r\n                                ep.push(_ep);\r\n                            }\r\n                        }\r\n                }\r\n            }\r\n\r\n            return _makeEndpointSelectHandler(ep);\r\n        };\r\n\r\n        // get all connections managed by the instance of jsplumb.\r\n        this.getAllConnections = function () {\r\n            return connections;\r\n        };\r\n        this.getDefaultScope = function () {\r\n            return DEFAULT_SCOPE;\r\n        };\r\n        // get an endpoint by uuid.\r\n        this.getEndpoint = _getEndpoint;\r\n        /**\r\n         * Gets the list of Endpoints for a given element.\r\n         * @method getEndpoints\r\n         * @param {String|Element|Selector} el The element to get endpoints for.\r\n         * @return {Endpoint[]} An array of Endpoints for the specified element.\r\n         */\r\n        this.getEndpoints = function (el) {\r\n            return endpointsByElement[_info(el).id] || [];\r\n        };\r\n        // gets the default endpoint type. used when subclassing. see wiki.\r\n        this.getDefaultEndpointType = function () {\r\n            return jsPlumb.Endpoint;\r\n        };\r\n        // gets the default connection type. used when subclassing.  see wiki.\r\n        this.getDefaultConnectionType = function () {\r\n            return jsPlumb.Connection;\r\n        };\r\n        /*\r\n         * Gets an element's id, creating one if necessary. really only exposed\r\n         * for the lib-specific functionality to access; would be better to pass\r\n         * the current instance into the lib-specific code (even though this is\r\n         * a static call. i just don't want to expose it to the public API).\r\n         */\r\n        this.getId = _getId;\r\n        this.draw = _draw;\r\n        this.info = _info;\r\n\r\n        this.appendElement = _appendElement;\r\n\r\n        var _hoverSuspended = false;\r\n        this.isHoverSuspended = function () {\r\n            return _hoverSuspended;\r\n        };\r\n        this.setHoverSuspended = function (s) {\r\n            _hoverSuspended = s;\r\n        };\r\n\r\n        // set an element's connections to be hidden\r\n        this.hide = function (el, changeEndpoints) {\r\n            _setVisible(el, \"none\", changeEndpoints);\r\n            return _currentInstance;\r\n        };\r\n\r\n        // exposed for other objects to use to get a unique id.\r\n        this.idstamp = _idstamp;\r\n\r\n        // ensure that, if the current container exists, it is a DOM element and not a selector.\r\n        // if it does not exist and `candidate` is supplied, the offset parent of that element will be set as the Container.\r\n        // this is used to do a better default behaviour for the case that the user has not set a container:\r\n        // addEndpoint, makeSource, makeTarget and connect all call this method with the offsetParent of the\r\n        // element in question (for connect it is the source element). So if no container is set, it is inferred\r\n        // to be the offsetParent of the first element the user tries to connect.\r\n        var _ensureContainer = function (candidate) {\r\n            if (!_container && candidate) {\r\n                var can = _currentInstance.getElement(candidate);\r\n                if (can.offsetParent) {\r\n                    _currentInstance.setContainer(can.offsetParent);\r\n                }\r\n            }\r\n        };\r\n\r\n        var _getContainerFromDefaults = function () {\r\n            if (_currentInstance.Defaults.Container) {\r\n                _currentInstance.setContainer(_currentInstance.Defaults.Container);\r\n            }\r\n        };\r\n\r\n        // check if a given element is managed or not. if not, add to our map. if drawing is not suspended then\r\n        // we'll also stash its dimensions; otherwise we'll do this in a lazy way through updateOffset.\r\n        var _manage = _currentInstance.manage = function (id, element, _transient) {\r\n            if (!managedElements[id]) {\r\n                managedElements[id] = {\r\n                    el: element,\r\n                    endpoints: [],\r\n                    connections: []\r\n                };\r\n\r\n                managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt });\r\n                _currentInstance.addClass(element, \"jtk-managed\");\r\n\r\n                if (!_transient) {\r\n                    _currentInstance.fire(\"manageElement\", { id:id, info:managedElements[id].info, el:element });\r\n                }\r\n            }\r\n\r\n            return managedElements[id];\r\n        };\r\n\r\n        var _unmanage = _currentInstance.unmanage = function(id) {\r\n            if (managedElements[id]) {\r\n                var el = managedElements[id].el;\r\n                _currentInstance.removeClass(el, \"jtk-managed\");\r\n                delete managedElements[id];\r\n                _currentInstance.fire(\"unmanageElement\", {id:id, el:el});\r\n            }\r\n        };\r\n\r\n        /**\r\n         * updates the offset and size for a given element, and stores the\r\n         * values. if 'offset' is not null we use that (it would have been\r\n         * passed in from a drag call) because it's faster; but if it is null,\r\n         * or if 'recalc' is true in order to force a recalculation, we get the current values.\r\n         * @method updateOffset\r\n         */\r\n        var _updateOffset = function (params) {\r\n\r\n            var timestamp = params.timestamp, recalc = params.recalc, offset = params.offset, elId = params.elId, s;\r\n            if (_suspendDrawing && !timestamp) {\r\n                timestamp = _suspendedAt;\r\n            }\r\n            if (!recalc) {\r\n                if (timestamp && timestamp === offsetTimestamps[elId]) {\r\n                    return {o: params.offset || offsets[elId], s: sizes[elId]};\r\n                }\r\n            }\r\n            if (recalc || (!offset && offsets[elId] == null)) { // if forced repaint or no offset available, we recalculate.\r\n\r\n                // get the current size and offset, and store them\r\n                s = managedElements[elId] ? managedElements[elId].el : null;\r\n                if (s != null) {\r\n                    sizes[elId] = _currentInstance.getSize(s);\r\n                    offsets[elId] = _currentInstance.getOffset(s);\r\n                    offsetTimestamps[elId] = timestamp;\r\n                }\r\n            } else {\r\n                offsets[elId] = offset || offsets[elId];\r\n                if (sizes[elId] == null) {\r\n                    s = managedElements[elId].el;\r\n                    if (s != null) {\r\n                        sizes[elId] = _currentInstance.getSize(s);\r\n                    }\r\n                }\r\n                offsetTimestamps[elId] = timestamp;\r\n            }\r\n\r\n            if (offsets[elId] && !offsets[elId].right) {\r\n                offsets[elId].right = offsets[elId].left + sizes[elId][0];\r\n                offsets[elId].bottom = offsets[elId].top + sizes[elId][1];\r\n                offsets[elId].width = sizes[elId][0];\r\n                offsets[elId].height = sizes[elId][1];\r\n                offsets[elId].centerx = offsets[elId].left + (offsets[elId].width / 2);\r\n                offsets[elId].centery = offsets[elId].top + (offsets[elId].height / 2);\r\n            }\r\n\r\n            return {o: offsets[elId], s: sizes[elId]};\r\n        };\r\n\r\n        this.updateOffset = _updateOffset;\r\n\r\n        /**\r\n         * callback from the current library to tell us to prepare ourselves (attach\r\n         * mouse listeners etc; can't do that until the library has provided a bind method)\r\n         */\r\n        this.init = function () {\r\n            if (!initialized) {\r\n                _getContainerFromDefaults();\r\n                _currentInstance.anchorManager = new root.jsPlumb.AnchorManager({jsPlumbInstance: _currentInstance});\r\n                initialized = true;\r\n                _currentInstance.fire(\"ready\", _currentInstance);\r\n            }\r\n        }.bind(this);\r\n\r\n        this.log = log;\r\n        this.jsPlumbUIComponent = jsPlumbUIComponent;\r\n\r\n        /*\r\n         * Creates an anchor with the given params.\r\n         *\r\n         *\r\n         * Returns: The newly created Anchor.\r\n         * Throws: an error if a named anchor was not found.\r\n         */\r\n        this.makeAnchor = function () {\r\n            var pp, _a = function (t, p) {\r\n                if (root.jsPlumb.Anchors[t]) {\r\n                    return new root.jsPlumb.Anchors[t](p);\r\n                }\r\n                if (!_currentInstance.Defaults.DoNotThrowErrors) {\r\n                    throw { msg: \"jsPlumb: unknown anchor type '\" + t + \"'\" };\r\n                }\r\n            };\r\n            if (arguments.length === 0) {\r\n                return null;\r\n            }\r\n            var specimen = arguments[0], elementId = arguments[1], jsPlumbInstance = arguments[2], newAnchor = null;\r\n            // if it appears to be an anchor already...\r\n            if (specimen.compute && specimen.getOrientation) {\r\n                return specimen;\r\n            }  //TODO hazy here about whether it should be added or is already added somehow.\r\n            // is it the name of an anchor type?\r\n            else if (typeof specimen === \"string\") {\r\n                newAnchor = _a(arguments[0], {elementId: elementId, jsPlumbInstance: _currentInstance});\r\n            }\r\n            // is it an array? it will be one of:\r\n            // an array of [spec, params] - this defines a single anchor, which may be dynamic, but has parameters.\r\n            // an array of arrays - this defines some dynamic anchors\r\n            // an array of numbers - this defines a single anchor.\r\n            else if (_ju.isArray(specimen)) {\r\n                if (_ju.isArray(specimen[0]) || _ju.isString(specimen[0])) {\r\n                    // if [spec, params] format\r\n                    if (specimen.length === 2 && _ju.isObject(specimen[1])) {\r\n                        // if first arg is a string, its a named anchor with params\r\n                        if (_ju.isString(specimen[0])) {\r\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance}, specimen[1]);\r\n                            newAnchor = _a(specimen[0], pp);\r\n                        }\r\n                        // otherwise first arg is array, second is params. we treat as a dynamic anchor, which is fine\r\n                        // even if the first arg has only one entry. you could argue all anchors should be implicitly dynamic in fact.\r\n                        else {\r\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance, anchors: specimen[0]}, specimen[1]);\r\n                            newAnchor = new root.jsPlumb.DynamicAnchor(pp);\r\n                        }\r\n                    }\r\n                    else {\r\n                        newAnchor = new jsPlumb.DynamicAnchor({anchors: specimen, selector: null, elementId: elementId, jsPlumbInstance: _currentInstance});\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    var anchorParams = {\r\n                        x: specimen[0], y: specimen[1],\r\n                        orientation: (specimen.length >= 4) ? [ specimen[2], specimen[3] ] : [0, 0],\r\n                        offsets: (specimen.length >= 6) ? [ specimen[4], specimen[5] ] : [ 0, 0 ],\r\n                        elementId: elementId,\r\n                        jsPlumbInstance: _currentInstance,\r\n                        cssClass: specimen.length === 7 ? specimen[6] : null\r\n                    };\r\n                    newAnchor = new root.jsPlumb.Anchor(anchorParams);\r\n                    newAnchor.clone = function () {\r\n                        return new root.jsPlumb.Anchor(anchorParams);\r\n                    };\r\n                }\r\n            }\r\n\r\n            if (!newAnchor.id) {\r\n                newAnchor.id = \"anchor_\" + _idstamp();\r\n            }\r\n            return newAnchor;\r\n        };\r\n\r\n        /**\r\n         * makes a list of anchors from the given list of types or coords, eg\r\n         * [\"TopCenter\", \"RightMiddle\", \"BottomCenter\", [0, 1, -1, -1] ]\r\n         */\r\n        this.makeAnchors = function (types, elementId, jsPlumbInstance) {\r\n            var r = [];\r\n            for (var i = 0, ii = types.length; i < ii; i++) {\r\n                if (typeof types[i] === \"string\") {\r\n                    r.push(root.jsPlumb.Anchors[types[i]]({elementId: elementId, jsPlumbInstance: jsPlumbInstance}));\r\n                }\r\n                else if (_ju.isArray(types[i])) {\r\n                    r.push(_currentInstance.makeAnchor(types[i], elementId, jsPlumbInstance));\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n\r\n        /**\r\n         * Makes a dynamic anchor from the given list of anchors (which may be in shorthand notation as strings or dimension arrays, or Anchor\r\n         * objects themselves) and the given, optional, anchorSelector function (jsPlumb uses a default if this is not provided; most people will\r\n         * not need to provide this - i think).\r\n         */\r\n        this.makeDynamicAnchor = function (anchors, anchorSelector) {\r\n            return new root.jsPlumb.DynamicAnchor({anchors: anchors, selector: anchorSelector, elementId: null, jsPlumbInstance: _currentInstance});\r\n        };\r\n\r\n// --------------------- makeSource/makeTarget ----------------------------------------------\r\n\r\n        this.targetEndpointDefinitions = {};\r\n        this.sourceEndpointDefinitions = {};\r\n\r\n        var selectorFilter = function (evt, _el, selector, _instance, negate) {\r\n            var t = evt.target || evt.srcElement, ok = false,\r\n                sel = _instance.getSelector(_el, selector);\r\n            for (var j = 0; j < sel.length; j++) {\r\n                if (sel[j] === t) {\r\n                    ok = true;\r\n                    break;\r\n                }\r\n            }\r\n            return negate ? !ok : ok;\r\n        };\r\n\r\n        var _makeElementDropHandler = function (elInfo, p, dropOptions, isSource, isTarget) {\r\n            var proxyComponent = new jsPlumbUIComponent(p);\r\n            var _drop = p._jsPlumb.EndpointDropHandler({\r\n                jsPlumb: _currentInstance,\r\n                enabled: function () {\r\n                    return elInfo.def.enabled;\r\n                },\r\n                isFull: function () {\r\n                    var targetCount = _currentInstance.select({target: elInfo.id}).length;\r\n                    return elInfo.def.maxConnections > 0 && targetCount >= elInfo.def.maxConnections;\r\n                },\r\n                element: elInfo.el,\r\n                elementId: elInfo.id,\r\n                isSource: isSource,\r\n                isTarget: isTarget,\r\n                addClass: function (clazz) {\r\n                    _currentInstance.addClass(elInfo.el, clazz);\r\n                },\r\n                removeClass: function (clazz) {\r\n                    _currentInstance.removeClass(elInfo.el, clazz);\r\n                },\r\n                onDrop: function (jpc) {\r\n                    var source = jpc.endpoints[0];\r\n                    source.anchor.unlock();\r\n                },\r\n                isDropAllowed: function () {\r\n                    return proxyComponent.isDropAllowed.apply(proxyComponent, arguments);\r\n                },\r\n                isRedrop:function(jpc) {\r\n                    return (jpc.suspendedElement != null && jpc.suspendedEndpoint != null && jpc.suspendedEndpoint.element === elInfo.el);\r\n                },\r\n                getEndpoint: function (jpc) {\r\n\r\n                    // make a new Endpoint for the target, or get it from the cache if uniqueEndpoint\r\n                    // is set. if its a redrop the new endpoint will be immediately cleaned up.\r\n\r\n                    var newEndpoint = elInfo.def.endpoint;\r\n\r\n                    // if no cached endpoint, or there was one but it has been cleaned up\r\n                    // (ie. detached), create a new one\r\n                    if (newEndpoint == null || newEndpoint._jsPlumb == null) {\r\n                        var eps = _currentInstance.deriveEndpointAndAnchorSpec(jpc.getType().join(\" \"), true);\r\n                        var pp = eps.endpoints ? root.jsPlumb.extend(p, {\r\n                            endpoint:elInfo.def.def.endpoint || eps.endpoints[1]\r\n                        }) :p;\r\n                        if (eps.anchors) {\r\n                            pp = root.jsPlumb.extend(pp, {\r\n                                anchor:elInfo.def.def.anchor || eps.anchors[1]\r\n                            });\r\n                        }\r\n                        newEndpoint = _currentInstance.addEndpoint(elInfo.el, pp);\r\n                        newEndpoint._mtNew = true;\r\n                    }\r\n\r\n                    if (p.uniqueEndpoint) {\r\n                        elInfo.def.endpoint = newEndpoint;\r\n                    }\r\n\r\n                    newEndpoint.setDeleteOnEmpty(true);\r\n\r\n                    // if connection is detachable, init the new endpoint to be draggable, to support that happening.\r\n                    if (jpc.isDetachable()) {\r\n                        newEndpoint.initDraggable();\r\n                    }\r\n\r\n                    // if the anchor has a 'positionFinder' set, then delegate to that function to find\r\n                    // out where to locate the anchor.\r\n                    if (newEndpoint.anchor.positionFinder != null) {\r\n                        var dropPosition = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom()),\r\n                            elPosition = _currentInstance.getOffset(elInfo.el),\r\n                            elSize = _currentInstance.getSize(elInfo.el),\r\n                            ap = dropPosition == null ? [0,0] : newEndpoint.anchor.positionFinder(dropPosition, elPosition, elSize, newEndpoint.anchor.constructorParams);\r\n\r\n                        newEndpoint.anchor.x = ap[0];\r\n                        newEndpoint.anchor.y = ap[1];\r\n                        // now figure an orientation for it..kind of hard to know what to do actually. probably the best thing i can do is to\r\n                        // support specifying an orientation in the anchor's spec. if one is not supplied then i will make the orientation\r\n                        // be what will cause the most natural link to the source: it will be pointing at the source, but it needs to be\r\n                        // specified in one axis only, and so how to make that choice? i think i will use whichever axis is the one in which\r\n                        // the target is furthest away from the source.\r\n                    }\r\n\r\n                    return newEndpoint;\r\n                },\r\n                maybeCleanup: function (ep) {\r\n                    if (ep._mtNew && ep.connections.length === 0) {\r\n                        _currentInstance.deleteObject({endpoint: ep});\r\n                    }\r\n                    else {\r\n                        delete ep._mtNew;\r\n                    }\r\n                }\r\n            });\r\n\r\n            // wrap drop events as needed and initialise droppable\r\n            var dropEvent = root.jsPlumb.dragEvents.drop;\r\n            dropOptions.scope = dropOptions.scope || (p.scope || _currentInstance.Defaults.Scope);\r\n            dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], _drop, true);\r\n            dropOptions.rank = p.rank || 0;\r\n\r\n            // if target, return true from the over event. this will cause katavorio to stop setting drops to hover\r\n            // if multipleDrop is set to false.\r\n            if (isTarget) {\r\n                dropOptions[root.jsPlumb.dragEvents.over] = function () { return true; };\r\n            }\r\n\r\n            // vanilla jsplumb only\r\n            if (p.allowLoopback === false) {\r\n                dropOptions.canDrop = function (_drag) {\r\n                    var de = _drag.getDragElement()._jsPlumbRelatedElement;\r\n                    return de !== elInfo.el;\r\n                };\r\n            }\r\n            _currentInstance.initDroppable(elInfo.el, dropOptions, \"internal\");\r\n\r\n            return _drop;\r\n\r\n        };\r\n\r\n        // see API docs\r\n        this.makeTarget = function (el, params, referenceParams) {\r\n\r\n            // put jsplumb ref into params without altering the params passed in\r\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\r\n            root.jsPlumb.extend(p, params);\r\n\r\n            var maxConnections = p.maxConnections || -1,\r\n\r\n                _doOne = function (el) {\r\n\r\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\r\n                    // and use the endpoint definition if found.\r\n                    // decode the info for this element (id and element)\r\n                    var elInfo = _info(el),\r\n                        elid = elInfo.id,\r\n                        dropOptions = root.jsPlumb.extend({}, p.dropOptions || {}),\r\n                        type = p.connectionType || \"default\";\r\n\r\n                    this.targetEndpointDefinitions[elid] = this.targetEndpointDefinitions[elid] || {};\r\n\r\n                    _ensureContainer(elid);\r\n\r\n                    // if this is a group and the user has not mandated a rank, set to -1 so that Nodes takes\r\n                    // precedence.\r\n                    if (elInfo.el._isJsPlumbGroup && dropOptions.rank == null) {\r\n                        dropOptions.rank = -1;\r\n                    }\r\n\r\n                    // store the definition\r\n                    var _def = {\r\n                        def: root.jsPlumb.extend({}, p),\r\n                        uniqueEndpoint: p.uniqueEndpoint,\r\n                        maxConnections: maxConnections,\r\n                        enabled: true\r\n                    };\r\n\r\n                    if (p.createEndpoint) {\r\n                        _def.uniqueEndpoint = true;\r\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\r\n                        _def.endpoint.setDeleteOnEmpty(false);\r\n                    }\r\n\r\n                    elInfo.def = _def;\r\n                    this.targetEndpointDefinitions[elid][type] = _def;\r\n                    _makeElementDropHandler(elInfo, p, dropOptions, p.isSource === true, true);\r\n                    // stash the definition on the drop\r\n                    elInfo.el._katavorioDrop[elInfo.el._katavorioDrop.length - 1].targetDef = _def;\r\n\r\n                }.bind(this);\r\n\r\n            // make an array if only given one element\r\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\r\n\r\n            // register each one in the list.\r\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\r\n                _doOne(inputs[i]);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeTarget = function (el, doNotClearArrays) {\r\n            var info = _info(el);\r\n            _currentInstance.destroyDroppable(info.el, \"internal\");\r\n            if (!doNotClearArrays) {\r\n                delete this.targetEndpointDefinitions[info.id];\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.makeSource = function (el, params, referenceParams) {\r\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\r\n            root.jsPlumb.extend(p, params);\r\n            var type = p.connectionType || \"default\";\r\n            var aae = _currentInstance.deriveEndpointAndAnchorSpec(type);\r\n            p.endpoint = p.endpoint || aae.endpoints[0];\r\n            p.anchor = p.anchor || aae.anchors[0];\r\n            var maxConnections = p.maxConnections || -1,\r\n                onMaxConnections = p.onMaxConnections,\r\n                _doOne = function (elInfo) {\r\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\r\n                    // and use the endpoint definition if found.\r\n                    var elid = elInfo.id,\r\n                        _del = this.getElement(elInfo.el);\r\n\r\n                    this.sourceEndpointDefinitions[elid] = this.sourceEndpointDefinitions[elid] || {};\r\n                    _ensureContainer(elid);\r\n\r\n                    var _def = {\r\n                        def:root.jsPlumb.extend({}, p),\r\n                        uniqueEndpoint: p.uniqueEndpoint,\r\n                        maxConnections: maxConnections,\r\n                        enabled: true\r\n                    };\r\n\r\n                    if (p.createEndpoint) {\r\n                        _def.uniqueEndpoint = true;\r\n                        _def.endpoint = _currentInstance.addEndpoint(el, _def.def);\r\n                        _def.endpoint.setDeleteOnEmpty(false);\r\n                    }\r\n\r\n                    this.sourceEndpointDefinitions[elid][type] = _def;\r\n                    elInfo.def = _def;\r\n\r\n                    var stopEvent = root.jsPlumb.dragEvents.stop,\r\n                        dragEvent = root.jsPlumb.dragEvents.drag,\r\n                        dragOptions = root.jsPlumb.extend({ }, p.dragOptions || {}),\r\n                        existingDrag = dragOptions.drag,\r\n                        existingStop = dragOptions.stop,\r\n                        ep = null,\r\n                        endpointAddedButNoDragYet = false;\r\n\r\n                    // set scope if its not set in dragOptions but was passed in in params\r\n                    dragOptions.scope = dragOptions.scope || p.scope;\r\n\r\n                    dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], function () {\r\n                        if (existingDrag) {\r\n                            existingDrag.apply(this, arguments);\r\n                        }\r\n                        endpointAddedButNoDragYet = false;\r\n                    });\r\n\r\n                    dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], function () {\r\n\r\n                        if (existingStop) {\r\n                            existingStop.apply(this, arguments);\r\n                        }\r\n                        this.currentlyDragging = false;\r\n                        if (ep._jsPlumb != null) { // if not cleaned up...\r\n\r\n                            // reset the anchor to the anchor that was initially provided. the one we were using to drag\r\n                            // the connection was just a placeholder that was located at the place the user pressed the\r\n                            // mouse button to initiate the drag.\r\n                            var anchorDef = p.anchor || this.Defaults.Anchor,\r\n                                oldAnchor = ep.anchor,\r\n                                oldConnection = ep.connections[0];\r\n\r\n                            var    newAnchor = this.makeAnchor(anchorDef, elid, this),\r\n                                _el = ep.element;\r\n\r\n                            // if the anchor has a 'positionFinder' set, then delegate to that function to find\r\n                            // out where to locate the anchor. issue 117.\r\n                            if (newAnchor.positionFinder != null) {\r\n                                var elPosition = _currentInstance.getOffset(_el),\r\n                                    elSize = this.getSize(_el),\r\n                                    dropPosition = { left: elPosition.left + (oldAnchor.x * elSize[0]), top: elPosition.top + (oldAnchor.y * elSize[1]) },\r\n                                    ap = newAnchor.positionFinder(dropPosition, elPosition, elSize, newAnchor.constructorParams);\r\n\r\n                                newAnchor.x = ap[0];\r\n                                newAnchor.y = ap[1];\r\n                            }\r\n\r\n                            ep.setAnchor(newAnchor, true);\r\n                            ep.repaint();\r\n                            this.repaint(ep.elementId);\r\n                            if (oldConnection != null) {\r\n                                this.repaint(oldConnection.targetId);\r\n                            }\r\n                        }\r\n                    }.bind(this));\r\n\r\n                    // when the user presses the mouse, add an Endpoint, if we are enabled.\r\n                    var mouseDownListener = function (e) {\r\n                        // on right mouse button, abort.\r\n                        if (e.which === 3 || e.button === 2) {\r\n                            return;\r\n                        }\r\n\r\n                        // TODO store def on element.\r\n                        var def = this.sourceEndpointDefinitions[elid][type];\r\n\r\n                        // if disabled, return.\r\n                        if (!def.enabled) {\r\n                            return;\r\n                        }\r\n\r\n                        elid = this.getId(this.getElement(elInfo.el)); // elid might have changed since this method was called to configure the element.\r\n\r\n                        // if a filter was given, run it, and return if it says no.\r\n                        if (p.filter) {\r\n                            var r = _ju.isString(p.filter) ? selectorFilter(e, elInfo.el, p.filter, this, p.filterExclude) : p.filter(e, elInfo.el);\r\n                            if (r === false) {\r\n                                return;\r\n                            }\r\n                        }\r\n\r\n                        // if maxConnections reached\r\n                        var sourceCount = this.select({source: elid}).length;\r\n                        if (def.maxConnections >= 0 && (sourceCount >= def.maxConnections)) {\r\n                            if (onMaxConnections) {\r\n                                onMaxConnections({\r\n                                    element: elInfo.el,\r\n                                    maxConnections: maxConnections\r\n                                }, e);\r\n                            }\r\n                            return false;\r\n                        }\r\n\r\n                        // find the position on the element at which the mouse was pressed; this is where the endpoint\r\n                        // will be located.\r\n                        var elxy = root.jsPlumb.getPositionOnElement(e, _del, _zoom);\r\n\r\n                        // we need to override the anchor in here, and force 'isSource', but we don't want to mess with\r\n                        // the params passed in, because after a connection is established we're going to reset the endpoint\r\n                        // to have the anchor we were given.\r\n                        var tempEndpointParams = {};\r\n                        root.jsPlumb.extend(tempEndpointParams, def.def);\r\n                        tempEndpointParams.isTemporarySource = true;\r\n                        tempEndpointParams.anchor = [ elxy[0], elxy[1] , 0, 0];\r\n                        tempEndpointParams.dragOptions = dragOptions;\r\n\r\n                        if (def.def.scope) {\r\n                            tempEndpointParams.scope = def.def.scope;\r\n                        }\r\n\r\n                        ep = this.addEndpoint(elid, tempEndpointParams);\r\n                        endpointAddedButNoDragYet = true;\r\n                        ep.setDeleteOnEmpty(true);\r\n\r\n                        // if unique endpoint and it's already been created, push it onto the endpoint we create. at the end\r\n                        // of a successful connection we'll switch to that endpoint.\r\n                        // TODO this is the same code as the programmatic endpoints create on line 1050 ish\r\n                        if (def.uniqueEndpoint) {\r\n                            if (!def.endpoint) {\r\n                                def.endpoint = ep;\r\n                                ep.setDeleteOnEmpty(false);\r\n                            }\r\n                            else {\r\n                                ep.finalEndpoint = def.endpoint;\r\n                            }\r\n                        }\r\n\r\n                        var _delTempEndpoint = function () {\r\n                            // this mouseup event is fired only if no dragging occurred, by jquery and yui, but for mootools\r\n                            // it is fired even if dragging has occurred, in which case we would blow away a perfectly\r\n                            // legitimate endpoint, were it not for this check.  the flag is set after adding an\r\n                            // endpoint and cleared in a drag listener we set in the dragOptions above.\r\n                            _currentInstance.off(ep.canvas, \"mouseup\", _delTempEndpoint);\r\n                            _currentInstance.off(elInfo.el, \"mouseup\", _delTempEndpoint);\r\n                            if (endpointAddedButNoDragYet) {\r\n                                endpointAddedButNoDragYet = false;\r\n                                _currentInstance.deleteEndpoint(ep);\r\n                            }\r\n                        };\r\n\r\n                        _currentInstance.on(ep.canvas, \"mouseup\", _delTempEndpoint);\r\n                        _currentInstance.on(elInfo.el, \"mouseup\", _delTempEndpoint);\r\n\r\n                        // optionally check for attributes to extract from the source element\r\n                        var payload = {};\r\n                        if (def.def.extract) {\r\n                            for (var att in def.def.extract) {\r\n                                var v = (e.srcElement || e.target).getAttribute(att);\r\n                                if (v) {\r\n                                    payload[def.def.extract[att]] = v;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        // and then trigger its mousedown event, which will kick off a drag, which will start dragging\r\n                        // a new connection from this endpoint.\r\n                        _currentInstance.trigger(ep.canvas, \"mousedown\", e, payload);\r\n\r\n                        _ju.consume(e);\r\n\r\n                    }.bind(this);\r\n\r\n                    this.on(elInfo.el, \"mousedown\", mouseDownListener);\r\n                    _def.trigger = mouseDownListener;\r\n\r\n                    // if a filter was provided, set it as a dragFilter on the element,\r\n                    // to prevent the element drag function from kicking in when we want to\r\n                    // drag a new connection\r\n                    if (p.filter && (_ju.isString(p.filter) || _ju.isFunction(p.filter))) {\r\n                        _currentInstance.setDragFilter(elInfo.el, p.filter);\r\n                    }\r\n\r\n                    var dropOptions = root.jsPlumb.extend({}, p.dropOptions || {});\r\n\r\n                    _makeElementDropHandler(elInfo, p, dropOptions, true, p.isTarget === true);\r\n\r\n                }.bind(this);\r\n\r\n            var inputs = el.length && el.constructor !== String ? el : [ el ];\r\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\r\n                _doOne(_info(inputs[i]));\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeSource = function (el, connectionType, doNotClearArrays) {\r\n            var info = _info(el);\r\n            _currentInstance.destroyDroppable(info.el, \"internal\");\r\n            var eldefs = this.sourceEndpointDefinitions[info.id];\r\n            if (eldefs) {\r\n                for (var def in eldefs) {\r\n                    if (connectionType == null || connectionType === def) {\r\n                        var mouseDownListener = eldefs[def].trigger;\r\n                        if (mouseDownListener) {\r\n                            _currentInstance.off(info.el, \"mousedown\", mouseDownListener);\r\n                        }\r\n                        if (!doNotClearArrays) {\r\n                            delete this.sourceEndpointDefinitions[info.id][def];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeEverySource = function () {\r\n            for (var i in this.sourceEndpointDefinitions) {\r\n                _currentInstance.unmakeSource(i, null, true);\r\n            }\r\n\r\n            this.sourceEndpointDefinitions = {};\r\n            return this;\r\n        };\r\n\r\n        var _getScope = function (el, types, connectionType) {\r\n            types = _ju.isArray(types) ? types : [ types ];\r\n            var id = _getId(el);\r\n            connectionType = connectionType || \"default\";\r\n            for (var i = 0; i < types.length; i++) {\r\n                var eldefs = this[types[i]][id];\r\n                if (eldefs && eldefs[connectionType]) {\r\n                    return eldefs[connectionType].def.scope || this.Defaults.Scope;\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        var _setScope = function (el, scope, types, connectionType) {\r\n            types = _ju.isArray(types) ? types : [ types ];\r\n            var id = _getId(el);\r\n            connectionType = connectionType || \"default\";\r\n            for (var i = 0; i < types.length; i++) {\r\n                var eldefs = this[types[i]][id];\r\n                if (eldefs && eldefs[connectionType]) {\r\n                    eldefs[connectionType].def.scope = scope;\r\n                }\r\n            }\r\n\r\n        }.bind(this);\r\n\r\n        this.getScope = function (el, scope) {\r\n            return _getScope(el, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\r\n        };\r\n        this.getSourceScope = function (el) {\r\n            return _getScope(el, \"sourceEndpointDefinitions\");\r\n        };\r\n        this.getTargetScope = function (el) {\r\n            return _getScope(el, \"targetEndpointDefinitions\");\r\n        };\r\n        this.setScope = function (el, scope, connectionType) {\r\n            this.setSourceScope(el, scope, connectionType);\r\n            this.setTargetScope(el, scope, connectionType);\r\n        };\r\n        this.setSourceScope = function (el, scope, connectionType) {\r\n            _setScope(el, scope, \"sourceEndpointDefinitions\", connectionType);\r\n            // we get the source scope during the mousedown event, but we also want to set this.\r\n            this.setDragScope(el, scope);\r\n        };\r\n        this.setTargetScope = function (el, scope, connectionType) {\r\n            _setScope(el, scope, \"targetEndpointDefinitions\", connectionType);\r\n            this.setDropScope(el, scope);\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeEveryTarget = function () {\r\n            for (var i in this.targetEndpointDefinitions) {\r\n                _currentInstance.unmakeTarget(i, true);\r\n            }\r\n\r\n            this.targetEndpointDefinitions = {};\r\n            return this;\r\n        };\r\n\r\n        // does the work of setting a source enabled or disabled.\r\n        var _setEnabled = function (type, el, state, toggle, connectionType) {\r\n            var a = type === \"source\" ? this.sourceEndpointDefinitions : this.targetEndpointDefinitions,\r\n                originalState, info, newState;\r\n\r\n            connectionType = connectionType || \"default\";\r\n\r\n            // a selector or an array\r\n            if (el.length && !_ju.isString(el)) {\r\n                originalState = [];\r\n                for (var i = 0, ii = el.length; i < ii; i++) {\r\n                    info = _info(el[i]);\r\n                    if (a[info.id] && a[info.id][connectionType]) {\r\n                        originalState[i] = a[info.id][connectionType].enabled;\r\n                        newState = toggle ? !originalState[i] : state;\r\n                        a[info.id][connectionType].enabled = newState;\r\n                        _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\r\n                    }\r\n                }\r\n            }\r\n            // otherwise a DOM element or a String ID.\r\n            else {\r\n                info = _info(el);\r\n                var id = info.id;\r\n                if (a[id] && a[id][connectionType]) {\r\n                    originalState = a[id][connectionType].enabled;\r\n                    newState = toggle ? !originalState : state;\r\n                    a[id][connectionType].enabled = newState;\r\n                    _currentInstance[newState ? \"removeClass\" : \"addClass\"](info.el, \"jtk-\" + type + \"-disabled\");\r\n                }\r\n            }\r\n            return originalState;\r\n        }.bind(this);\r\n\r\n        var _first = function (el, fn) {\r\n            if (_ju.isString(el) || !el.length) {\r\n                return fn.apply(this, [ el ]);\r\n            }\r\n            else if (el.length) {\r\n                return fn.apply(this, [ el[0] ]);\r\n            }\r\n\r\n        }.bind(this);\r\n\r\n        this.toggleSourceEnabled = function (el, connectionType) {\r\n            _setEnabled(\"source\", el, null, true, connectionType);\r\n            return this.isSourceEnabled(el, connectionType);\r\n        };\r\n\r\n        this.setSourceEnabled = function (el, state, connectionType) {\r\n            return _setEnabled(\"source\", el, state, null, connectionType);\r\n        };\r\n        this.isSource = function (el, connectionType) {\r\n            connectionType = connectionType || \"default\";\r\n            return _first(el, function (_el) {\r\n                var eldefs = this.sourceEndpointDefinitions[_info(_el).id];\r\n                return eldefs != null && eldefs[connectionType] != null;\r\n            }.bind(this));\r\n        };\r\n        this.isSourceEnabled = function (el, connectionType) {\r\n            connectionType = connectionType || \"default\";\r\n            return _first(el, function (_el) {\r\n                var sep = this.sourceEndpointDefinitions[_info(_el).id];\r\n                return sep && sep[connectionType] && sep[connectionType].enabled === true;\r\n            }.bind(this));\r\n        };\r\n\r\n        this.toggleTargetEnabled = function (el, connectionType) {\r\n            _setEnabled(\"target\", el, null, true, connectionType);\r\n            return this.isTargetEnabled(el, connectionType);\r\n        };\r\n\r\n        this.isTarget = function (el, connectionType) {\r\n            connectionType = connectionType || \"default\";\r\n            return _first(el, function (_el) {\r\n                var eldefs = this.targetEndpointDefinitions[_info(_el).id];\r\n                return eldefs != null && eldefs[connectionType] != null;\r\n            }.bind(this));\r\n        };\r\n        this.isTargetEnabled = function (el, connectionType) {\r\n            connectionType = connectionType || \"default\";\r\n            return _first(el, function (_el) {\r\n                var tep = this.targetEndpointDefinitions[_info(_el).id];\r\n                return tep && tep[connectionType] && tep[connectionType].enabled === true;\r\n            }.bind(this));\r\n        };\r\n        this.setTargetEnabled = function (el, state, connectionType) {\r\n            return _setEnabled(\"target\", el, state, null, connectionType);\r\n        };\r\n\r\n// --------------------- end makeSource/makeTarget ----------------------------------------------\r\n\r\n        this.ready = function (fn) {\r\n            _currentInstance.bind(\"ready\", fn);\r\n        };\r\n\r\n        var _elEach = function(el, fn) {\r\n            // support both lists...\r\n            if (typeof el === 'object' && el.length) {\r\n                for (var i = 0, ii = el.length; i < ii; i++) {\r\n                    fn(el[i]);\r\n                }\r\n            }\r\n            else {// ...and single strings or elements.\r\n                fn(el);\r\n            }\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        // repaint some element's endpoints and connections\r\n        this.repaint = function (el, ui, timestamp) {\r\n            return _elEach(el, function(_el) {\r\n                _draw(_el, ui, timestamp);\r\n            });\r\n        };\r\n\r\n        this.revalidate = function (el, timestamp, isIdAlready) {\r\n            return _elEach(el, function(_el) {\r\n                var elId = isIdAlready ? _el : _currentInstance.getId(_el);\r\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp:timestamp });\r\n                var dm = _currentInstance.getDragManager();\r\n                if (dm) {\r\n                    dm.updateOffsets(elId);\r\n                }\r\n                _currentInstance.repaint(_el);\r\n            });\r\n        };\r\n\r\n        // repaint every endpoint and connection.\r\n        this.repaintEverything = function () {\r\n            // TODO this timestamp causes continuous anchors to not repaint properly.\r\n            // fix this. do not just take out the timestamp. it runs a lot faster with\r\n            // the timestamp included.\r\n            var timestamp = _timestamp(), elId;\r\n\r\n            for (elId in endpointsByElement) {\r\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp: timestamp });\r\n            }\r\n\r\n            for (elId in endpointsByElement) {\r\n                _draw(elId, null, timestamp);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        this.removeAllEndpoints = function (el, recurse, affectedElements) {\r\n            affectedElements = affectedElements || [];\r\n            var _one = function (_el) {\r\n                var info = _info(_el),\r\n                    ebe = endpointsByElement[info.id],\r\n                    i, ii;\r\n\r\n                if (ebe) {\r\n                    affectedElements.push(info);\r\n                    for (i = 0, ii = ebe.length; i < ii; i++) {\r\n                        _currentInstance.deleteEndpoint(ebe[i], false);\r\n                    }\r\n                }\r\n                delete endpointsByElement[info.id];\r\n\r\n                if (recurse) {\r\n                    if (info.el && info.el.nodeType !== 3 && info.el.nodeType !== 8) {\r\n                        for (i = 0, ii = info.el.childNodes.length; i < ii; i++) {\r\n                            _one(info.el.childNodes[i]);\r\n                        }\r\n                    }\r\n                }\r\n\r\n            };\r\n            _one(el);\r\n            return this;\r\n        };\r\n\r\n        var _doRemove = function(info, affectedElements) {\r\n            _currentInstance.removeAllEndpoints(info.id, true, affectedElements);\r\n            var dm = _currentInstance.getDragManager();\r\n            var _one = function(_info) {\r\n\r\n                if (dm) {\r\n                    dm.elementRemoved(_info.id);\r\n                }\r\n                _currentInstance.anchorManager.clearFor(_info.id);\r\n                _currentInstance.anchorManager.removeFloatingConnection(_info.id);\r\n\r\n                if (_currentInstance.isSource(_info.el)) {\r\n                    _currentInstance.unmakeSource(_info.el);\r\n                }\r\n                if (_currentInstance.isTarget(_info.el)) {\r\n                    _currentInstance.unmakeTarget(_info.el);\r\n                }\r\n                _currentInstance.destroyDraggable(_info.el);\r\n                _currentInstance.destroyDroppable(_info.el);\r\n\r\n\r\n                delete _currentInstance.floatingConnections[_info.id];\r\n                delete managedElements[_info.id];\r\n                delete offsets[_info.id];\r\n                if (_info.el) {\r\n                    _currentInstance.removeElement(_info.el);\r\n                    _info.el._jsPlumb = null;\r\n                }\r\n            };\r\n\r\n            // remove all affected child elements\r\n            for (var ae = 1; ae < affectedElements.length; ae++) {\r\n                _one(affectedElements[ae]);\r\n            }\r\n            // and always remove the requested one from the dom.\r\n            _one(info);\r\n        };\r\n\r\n        /**\r\n         * Remove the given element, including cleaning up all endpoints registered for it.\r\n         * This is exposed in the public API but also used internally by jsPlumb when removing the\r\n         * element associated with a connection drag.\r\n         */\r\n        this.remove = function (el, doNotRepaint) {\r\n            var info = _info(el), affectedElements = [];\r\n            if (info.text && info.el.parentNode) {\r\n                info.el.parentNode.removeChild(info.el);\r\n            }\r\n            else if (info.id) {\r\n                _currentInstance.batch(function () {\r\n                    _doRemove(info, affectedElements);\r\n                }, doNotRepaint === true);\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.empty = function (el, doNotRepaint) {\r\n            var affectedElements = [];\r\n            var _one = function(el, dontRemoveFocus) {\r\n                var info = _info(el);\r\n                if (info.text) {\r\n                    info.el.parentNode.removeChild(info.el);\r\n                }\r\n                else if (info.el) {\r\n                    while(info.el.childNodes.length > 0) {\r\n                        _one(info.el.childNodes[0]);\r\n                    }\r\n                    if (!dontRemoveFocus) {\r\n                        _doRemove(info, affectedElements);\r\n                    }\r\n                }\r\n            };\r\n\r\n            _currentInstance.batch(function() {\r\n                _one(el, true);\r\n            }, doNotRepaint === false);\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.reset = function (doNotUnbindInstanceEventListeners) {\r\n            _currentInstance.silently(function() {\r\n                _hoverSuspended = false;\r\n                _currentInstance.removeAllGroups();\r\n                _currentInstance.removeGroupManager();\r\n                _currentInstance.deleteEveryEndpoint();\r\n                if (!doNotUnbindInstanceEventListeners) {\r\n                    _currentInstance.unbind();\r\n                }\r\n                this.targetEndpointDefinitions = {};\r\n                this.sourceEndpointDefinitions = {};\r\n                connections.length = 0;\r\n                if (this.doReset) {\r\n                    this.doReset();\r\n                }\r\n            }.bind(this));\r\n        };\r\n\r\n        var _clearObject = function (obj) {\r\n            if (obj.canvas && obj.canvas.parentNode) {\r\n                obj.canvas.parentNode.removeChild(obj.canvas);\r\n            }\r\n            obj.cleanup();\r\n            obj.destroy();\r\n        };\r\n\r\n        this.clear = function () {\r\n            _currentInstance.select().each(_clearObject);\r\n            _currentInstance.selectEndpoints().each(_clearObject);\r\n\r\n            endpointsByElement = {};\r\n            endpointsByUUID = {};\r\n        };\r\n\r\n        this.setDefaultScope = function (scope) {\r\n            DEFAULT_SCOPE = scope;\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.deriveEndpointAndAnchorSpec = function(type, dontPrependDefault) {\r\n            var bits = ((dontPrependDefault ? \"\" : \"default \") + type).split(/[\\s]/), eps = null, ep = null, a = null, as = null;\r\n            for (var i = 0; i < bits.length; i++) {\r\n                var _t = _currentInstance.getType(bits[i], \"connection\");\r\n                if (_t) {\r\n                    if (_t.endpoints) {\r\n                        eps = _t.endpoints;\r\n                    }\r\n                    if (_t.endpoint) {\r\n                        ep = _t.endpoint;\r\n                    }\r\n                    if (_t.anchors) {\r\n                        as = _t.anchors;\r\n                    }\r\n                    if (_t.anchor) {\r\n                        a = _t.anchor;\r\n                    }\r\n                }\r\n            }\r\n            return { endpoints: eps ? eps : [ ep, ep ], anchors: as ? as : [a, a ]};\r\n        };\r\n\r\n        // sets the id of some element, changing whatever we need to to keep track.\r\n        this.setId = function (el, newId, doNotSetAttribute) {\r\n            //\r\n            var id;\r\n\r\n            if (_ju.isString(el)) {\r\n                id = el;\r\n            }\r\n            else {\r\n                el = this.getElement(el);\r\n                id = this.getId(el);\r\n            }\r\n\r\n            var sConns = this.getConnections({source: id, scope: '*'}, true),\r\n                tConns = this.getConnections({target: id, scope: '*'}, true);\r\n\r\n            newId = \"\" + newId;\r\n\r\n            if (!doNotSetAttribute) {\r\n                el = this.getElement(id);\r\n                this.setAttribute(el, \"id\", newId);\r\n            }\r\n            else {\r\n                el = this.getElement(newId);\r\n            }\r\n\r\n            endpointsByElement[newId] = endpointsByElement[id] || [];\r\n            for (var i = 0, ii = endpointsByElement[newId].length; i < ii; i++) {\r\n                endpointsByElement[newId][i].setElementId(newId);\r\n                endpointsByElement[newId][i].setReferenceElement(el);\r\n            }\r\n            delete endpointsByElement[id];\r\n\r\n            this.sourceEndpointDefinitions[newId] = this.sourceEndpointDefinitions[id];\r\n            delete this.sourceEndpointDefinitions[id];\r\n            this.targetEndpointDefinitions[newId] = this.targetEndpointDefinitions[id];\r\n            delete this.targetEndpointDefinitions[id];\r\n\r\n            this.anchorManager.changeId(id, newId);\r\n            var dm = this.getDragManager();\r\n            if (dm) {\r\n                dm.changeId(id, newId);\r\n            }\r\n            managedElements[newId] = managedElements[id];\r\n            delete managedElements[id];\r\n\r\n            var _conns = function (list, epIdx, type) {\r\n                for (var i = 0, ii = list.length; i < ii; i++) {\r\n                    list[i].endpoints[epIdx].setElementId(newId);\r\n                    list[i].endpoints[epIdx].setReferenceElement(el);\r\n                    list[i][type + \"Id\"] = newId;\r\n                    list[i][type] = el;\r\n                }\r\n            };\r\n            _conns(sConns, 0, \"source\");\r\n            _conns(tConns, 1, \"target\");\r\n\r\n            this.repaint(newId);\r\n        };\r\n\r\n        this.setDebugLog = function (debugLog) {\r\n            log = debugLog;\r\n        };\r\n\r\n        this.setSuspendDrawing = function (val, repaintAfterwards) {\r\n            var curVal = _suspendDrawing;\r\n            _suspendDrawing = val;\r\n            if (val) {\r\n                _suspendedAt = new Date().getTime();\r\n            } else {\r\n                _suspendedAt = null;\r\n            }\r\n            if (repaintAfterwards) {\r\n                this.repaintEverything();\r\n            }\r\n            return curVal;\r\n        };\r\n\r\n        // returns whether or not drawing is currently suspended.\r\n        this.isSuspendDrawing = function () {\r\n            return _suspendDrawing;\r\n        };\r\n\r\n        // return timestamp for when drawing was suspended.\r\n        this.getSuspendedAt = function () {\r\n            return _suspendedAt;\r\n        };\r\n\r\n        this.batch = function (fn, doNotRepaintAfterwards) {\r\n            var _wasSuspended = this.isSuspendDrawing();\r\n            if (!_wasSuspended) {\r\n                this.setSuspendDrawing(true);\r\n            }\r\n            try {\r\n                fn();\r\n            }\r\n            catch (e) {\r\n                _ju.log(\"Function run while suspended failed\", e);\r\n            }\r\n            if (!_wasSuspended) {\r\n                this.setSuspendDrawing(false, !doNotRepaintAfterwards);\r\n            }\r\n        };\r\n\r\n        this.doWhileSuspended = this.batch;\r\n\r\n        this.getCachedData = _getCachedData;\r\n        this.timestamp = _timestamp;\r\n        this.show = function (el, changeEndpoints) {\r\n            _setVisible(el, \"block\", changeEndpoints);\r\n            return _currentInstance;\r\n        };\r\n\r\n        // TODO: update this method to return the current state.\r\n        this.toggleVisible = _toggleVisible;\r\n        this.addListener = this.bind;\r\n\r\n        var floatingConnections = [];\r\n        this.registerFloatingConnection = function(info, conn, ep) {\r\n            floatingConnections[info.id] = conn;\r\n            // only register for the target endpoint; we will not be dragging the source at any time\r\n            // before this connection is either discarded or made into a permanent connection.\r\n            _ju.addToList(endpointsByElement, info.id, ep);\r\n        };\r\n        this.getFloatingConnectionFor = function(id) {\r\n            return floatingConnections[id];\r\n        };\r\n\r\n        this.listManager = new root.jsPlumbListManager(this);\r\n    };\r\n\r\n    _ju.extend(root.jsPlumbInstance, _ju.EventGenerator, {\r\n        setAttribute: function (el, a, v) {\r\n            this.setAttribute(el, a, v);\r\n        },\r\n        getAttribute: function (el, a) {\r\n            return this.getAttribute(root.jsPlumb.getElement(el), a);\r\n        },\r\n        convertToFullOverlaySpec: function(spec) {\r\n            if (_ju.isString(spec)) {\r\n                spec = [ spec, { } ];\r\n            }\r\n            spec[1].id = spec[1].id || _ju.uuid();\r\n            return spec;\r\n        },\r\n        registerConnectionType: function (id, type) {\r\n            this._connectionTypes[id] = root.jsPlumb.extend({}, type);\r\n            if (type.overlays) {\r\n                var to = {};\r\n                for (var i = 0; i < type.overlays.length; i++) {\r\n                    // if a string, convert to object representation so that we can store the typeid on it.\r\n                    // also assign an id.\r\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\r\n                    to[fo[1].id] = fo;\r\n                }\r\n                this._connectionTypes[id].overlays = to;\r\n            }\r\n        },\r\n        registerConnectionTypes: function (types) {\r\n            for (var i in types) {\r\n                this.registerConnectionType(i, types[i]);\r\n            }\r\n        },\r\n        registerEndpointType: function (id, type) {\r\n            this._endpointTypes[id] = root.jsPlumb.extend({}, type);\r\n            if (type.overlays) {\r\n                var to = {};\r\n                for (var i = 0; i < type.overlays.length; i++) {\r\n                    // if a string, convert to object representation so that we can store the typeid on it.\r\n                    // also assign an id.\r\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\r\n                    to[fo[1].id] = fo;\r\n                }\r\n                this._endpointTypes[id].overlays = to;\r\n            }\r\n        },\r\n        registerEndpointTypes: function (types) {\r\n            for (var i in types) {\r\n                this.registerEndpointType(i, types[i]);\r\n            }\r\n        },\r\n        getType: function (id, typeDescriptor) {\r\n            return typeDescriptor === \"connection\" ? this._connectionTypes[id] : this._endpointTypes[id];\r\n        },\r\n        setIdChanged: function (oldId, newId) {\r\n            this.setId(oldId, newId, true);\r\n        },\r\n        // set parent: change the parent for some node and update all the registrations we need to.\r\n        setParent: function (el, newParent) {\r\n            var _dom = this.getElement(el),\r\n                _id = this.getId(_dom),\r\n                _pdom = this.getElement(newParent),\r\n                _pid = this.getId(_pdom),\r\n                dm = this.getDragManager();\r\n\r\n            _dom.parentNode.removeChild(_dom);\r\n            _pdom.appendChild(_dom);\r\n            if (dm) {\r\n                dm.setParent(_dom, _id, _pdom, _pid);\r\n            }\r\n        },\r\n        extend: function (o1, o2, names) {\r\n            var i;\r\n            if (names) {\r\n                for (i = 0; i < names.length; i++) {\r\n                    o1[names[i]] = o2[names[i]];\r\n                }\r\n            }\r\n            else {\r\n                for (i in o2) {\r\n                    o1[i] = o2[i];\r\n                }\r\n            }\r\n\r\n            return o1;\r\n        },\r\n        floatingConnections: {},\r\n        getFloatingAnchorIndex: function (jpc) {\r\n            return jpc.endpoints[0].isFloating() ? 0 : jpc.endpoints[1].isFloating() ? 1 : -1;\r\n        },\r\n        proxyConnection :function(connection, index, proxyEl, proxyElId, endpointGenerator, anchorGenerator) {\r\n            var proxyEp,\r\n                originalElementId = connection.endpoints[index].elementId,\r\n                originalEndpoint = connection.endpoints[index];\r\n\r\n            connection.proxies = connection.proxies || [];\r\n            if(connection.proxies[index]) {\r\n                proxyEp = connection.proxies[index].ep;\r\n            }else {\r\n                proxyEp = this.addEndpoint(proxyEl, {\r\n                    endpoint:endpointGenerator(connection, index),\r\n                    anchor:anchorGenerator(connection, index),\r\n                    parameters:{\r\n                        isProxyEndpoint:true\r\n                    }\r\n                });\r\n            }\r\n            proxyEp.setDeleteOnEmpty(true);\r\n\r\n            // for this index, stash proxy info: the new EP, the original EP.\r\n            connection.proxies[index] = { ep:proxyEp, originalEp: originalEndpoint };\r\n\r\n            // and advise the anchor manager\r\n            if (index === 0) {\r\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\r\n                // connection changed (you give the index), and here's the new element and element id.\"\r\n                this.anchorManager.sourceChanged(originalElementId, proxyElId, connection, proxyEl);\r\n            }\r\n            else {\r\n                this.anchorManager.updateOtherEndpoint(connection.endpoints[0].elementId, originalElementId, proxyElId, connection);\r\n                connection.target = proxyEl;\r\n                connection.targetId = proxyElId;\r\n            }\r\n\r\n            // detach the original EP from the connection.\r\n            originalEndpoint.detachFromConnection(connection, null, true);\r\n\r\n            // set the proxy as the new ep\r\n            proxyEp.connections = [ connection ];\r\n            connection.endpoints[index] = proxyEp;\r\n\r\n            originalEndpoint.setVisible(false);\r\n\r\n            connection.setVisible(true);\r\n\r\n            this.revalidate(proxyEl);\r\n        },\r\n        unproxyConnection : function(connection, index, proxyElId) {\r\n            // if connection cleaned up, no proxies, or none for this end of the connection, abort.\r\n            if (connection._jsPlumb == null || connection.proxies == null || connection.proxies[index] == null) {\r\n                return;\r\n            }\r\n\r\n            var originalElement = connection.proxies[index].originalEp.element,\r\n                originalElementId = connection.proxies[index].originalEp.elementId;\r\n\r\n            connection.endpoints[index] = connection.proxies[index].originalEp;\r\n            // and advise the anchor manager\r\n            if (index === 0) {\r\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\r\n                // connection changed (you give the index), and here's the new element and element id.\"\r\n                this.anchorManager.sourceChanged(proxyElId, originalElementId, connection, originalElement);\r\n            }\r\n            else {\r\n                this.anchorManager.updateOtherEndpoint(connection.endpoints[0].elementId, proxyElId, originalElementId, connection);\r\n                connection.target = originalElement;\r\n                connection.targetId = originalElementId;\r\n            }\r\n\r\n            // detach the proxy EP from the connection (which will cause it to be removed as we no longer need it)\r\n            connection.proxies[index].ep.detachFromConnection(connection, null);\r\n\r\n            connection.proxies[index].originalEp.addConnection(connection);\r\n            if(connection.isVisible()) {\r\n                connection.proxies[index].originalEp.setVisible(true);\r\n            }\r\n\r\n            // cleanup\r\n            delete connection.proxies[index];\r\n        }\r\n    });\r\n\r\n// --------------------- static instance + module registration -------------------------------------------\r\n\r\n// create static instance and assign to window if window exists.\r\n    var jsPlumb = new jsPlumbInstance();\r\n    // register on 'root' (lets us run on server or browser)\r\n    root.jsPlumb = jsPlumb;\r\n    // add 'getInstance' method to static instance\r\n    jsPlumb.getInstance = function (_defaults, overrideFns) {\r\n        var j = new jsPlumbInstance(_defaults);\r\n        if (overrideFns) {\r\n            for (var ovf in overrideFns) {\r\n                j[ovf] = overrideFns[ovf];\r\n            }\r\n        }\r\n        j.init();\r\n        return j;\r\n    };\r\n    jsPlumb.each = function (spec, fn) {\r\n        if (spec == null) {\r\n            return;\r\n        }\r\n        if (typeof spec === \"string\") {\r\n            fn(jsPlumb.getElement(spec));\r\n        }\r\n        else if (spec.length != null) {\r\n            for (var i = 0; i < spec.length; i++) {\r\n                fn(jsPlumb.getElement(spec[i]));\r\n            }\r\n        }\r\n        else {\r\n            fn(spec);\r\n        } // assume it's an element.\r\n    };\r\n\r\n    // CommonJS\r\n    if (typeof exports !== 'undefined') {\r\n        exports.jsPlumb = jsPlumb;\r\n    }\r\n\r\n// --------------------- end static instance + AMD registration -------------------------------------------\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function() {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    // ------------------------------ BEGIN OverlayCapablejsPlumbUIComponent --------------------------------------------\r\n\r\n    var _internalLabelOverlayId = \"__label\",\r\n        // this is a shortcut helper method to let people add a label as\r\n        // overlay.\r\n        _makeLabelOverlay = function (component, params) {\r\n\r\n            var _params = {\r\n                    cssClass: params.cssClass,\r\n                    labelStyle: component.labelStyle,\r\n                    id: _internalLabelOverlayId,\r\n                    component: component,\r\n                    _jsPlumb: component._jsPlumb.instance  // TODO not necessary, since the instance can be accessed through the component.\r\n                },\r\n                mergedParams = _jp.extend(_params, params);\r\n\r\n            return new _jp.Overlays[component._jsPlumb.instance.getRenderMode()].Label(mergedParams);\r\n        },\r\n        _processOverlay = function (component, o) {\r\n            var _newOverlay = null;\r\n            if (_ju.isArray(o)) {\t// this is for the shorthand [\"Arrow\", { width:50 }] syntax\r\n                // there's also a three arg version:\r\n                // [\"Arrow\", { width:50 }, {location:0.7}]\r\n                // which merges the 3rd arg into the 2nd.\r\n                var type = o[0],\r\n                    // make a copy of the object so as not to mess up anyone else's reference...\r\n                    p = _jp.extend({component: component, _jsPlumb: component._jsPlumb.instance}, o[1]);\r\n                if (o.length === 3) {\r\n                    _jp.extend(p, o[2]);\r\n                }\r\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][type](p);\r\n            } else if (o.constructor === String) {\r\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][o]({component: component, _jsPlumb: component._jsPlumb.instance});\r\n            } else {\r\n                _newOverlay = o;\r\n            }\r\n\r\n            _newOverlay.id = _newOverlay.id || _ju.uuid();\r\n            component.cacheTypeItem(\"overlay\", _newOverlay, _newOverlay.id);\r\n            component._jsPlumb.overlays[_newOverlay.id] = _newOverlay;\r\n\r\n            return _newOverlay;\r\n        };\r\n\r\n    _jp.OverlayCapableJsPlumbUIComponent = function (params) {\r\n\r\n        root.jsPlumbUIComponent.apply(this, arguments);\r\n        this._jsPlumb.overlays = {};\r\n        this._jsPlumb.overlayPositions = {};\r\n\r\n        if (params.label) {\r\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\r\n                label: params.label,\r\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\r\n                labelStyle: params.labelStyle || this._jsPlumb.instance.Defaults.LabelStyle,\r\n                id:_internalLabelOverlayId\r\n            }];\r\n        }else if(params.id){\r\n            //  label cssClass  emptyLabelStyle: {cssClass: 'emptyFlowLabel'}  by_ \r\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\r\n                label: params.label,\r\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\r\n                labelStyle: params.emptyLabelStyle || this._jsPlumb.instance.Defaults.emptyLabelStyle,\r\n                id:_internalLabelOverlayId\r\n            }];\r\n        }\r\n\r\n        this.setListenerComponent = function (c) {\r\n            if (this._jsPlumb) {\r\n                for (var i in this._jsPlumb.overlays) {\r\n                    this._jsPlumb.overlays[i].setListenerComponent(c);\r\n                }\r\n            }\r\n        };\r\n    };\r\n\r\n    _jp.OverlayCapableJsPlumbUIComponent.applyType = function (component, t) {\r\n        if (t.overlays) {\r\n            // loop through the ones in the type. if already present on the component,\r\n            // dont remove or re-add.\r\n            var keep = {}, i;\r\n\r\n            for (i in t.overlays) {\r\n\r\n                var existing = component._jsPlumb.overlays[t.overlays[i][1].id];\r\n                if (existing) {\r\n                    // maybe update from data, if there were parameterised values for instance.\r\n                    existing.updateFrom(t.overlays[i][1]);\r\n                    keep[t.overlays[i][1].id] = true;\r\n                }\r\n                else {\r\n                    var c = component.getCachedTypeItem(\"overlay\", t.overlays[i][1].id);\r\n                    if (c != null) {\r\n                        c.reattach(component._jsPlumb.instance, component);\r\n                        c.setVisible(true);\r\n                        // maybe update from data, if there were parameterised values for instance.\r\n                        c.updateFrom(t.overlays[i][1]);\r\n                        component._jsPlumb.overlays[c.id] = c;\r\n                    }\r\n                    else {\r\n                        c = component.addOverlay(t.overlays[i], true);\r\n                    }\r\n                    keep[c.id] = true;\r\n                }\r\n            }\r\n\r\n            // now loop through the full overlays and remove those that we dont want to keep\r\n            for (i in component._jsPlumb.overlays) {\r\n                if (keep[component._jsPlumb.overlays[i].id] == null) {\r\n                    component.removeOverlay(component._jsPlumb.overlays[i].id, true); // remove overlay but dont clean it up.\r\n                    // that would remove event listeners etc; overlays are never discarded by the types stuff, they are\r\n                    // just detached/reattached.\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    _ju.extend(_jp.OverlayCapableJsPlumbUIComponent, root.jsPlumbUIComponent, {\r\n\r\n        setHover: function (hover, ignoreAttachedElements) {\r\n            if (this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\r\n                for (var i in this._jsPlumb.overlays) {\r\n                    this._jsPlumb.overlays[i][hover ? \"addClass\" : \"removeClass\"](this._jsPlumb.instance.hoverClass);\r\n                }\r\n            }\r\n        },\r\n        addOverlay: function (overlay, doNotRepaint) {\r\n            var o = _processOverlay(this, overlay);\r\n\r\n            if (this.getData && o.type === \"Label\" && _ju.isArray(overlay)) {\r\n                //\r\n                // component data might contain label location - look for it here.\r\n                var d = this.getData(), p = overlay[1];\r\n                if (d) {\r\n                    var locationAttribute = p.labelLocationAttribute || \"labelLocation\";\r\n                    var loc = d ? d[locationAttribute] : null;\r\n\r\n                    if (loc) {\r\n                        o.loc = loc;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!doNotRepaint) {\r\n                this.repaint();\r\n            }\r\n            return o;\r\n        },\r\n        getOverlay: function (id) {\r\n            return this._jsPlumb.overlays[id];\r\n        },\r\n        getOverlays: function () {\r\n            return this._jsPlumb.overlays;\r\n        },\r\n        hideOverlay: function (id) {\r\n            var o = this.getOverlay(id);\r\n            if (o) {\r\n                o.hide();\r\n            }\r\n        },\r\n        hideOverlays: function () {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                this._jsPlumb.overlays[i].hide();\r\n            }\r\n        },\r\n        showOverlay: function (id) {\r\n            var o = this.getOverlay(id);\r\n            if (o) {\r\n                o.show();\r\n            }\r\n        },\r\n        showOverlays: function () {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                this._jsPlumb.overlays[i].show();\r\n            }\r\n        },\r\n        removeAllOverlays: function (doNotRepaint) {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                if (this._jsPlumb.overlays[i].cleanup) {\r\n                    this._jsPlumb.overlays[i].cleanup();\r\n                }\r\n            }\r\n\r\n            this._jsPlumb.overlays = {};\r\n            this._jsPlumb.overlayPositions = null;\r\n            this._jsPlumb.overlayPlacements= {};\r\n            if (!doNotRepaint) {\r\n                this.repaint();\r\n            }\r\n        },\r\n        removeOverlay: function (overlayId, dontCleanup) {\r\n            var o = this._jsPlumb.overlays[overlayId];\r\n            if (o) {\r\n                o.setVisible(false);\r\n                if (!dontCleanup && o.cleanup) {\r\n                    o.cleanup();\r\n                }\r\n                delete this._jsPlumb.overlays[overlayId];\r\n                if (this._jsPlumb.overlayPositions) {\r\n                    delete this._jsPlumb.overlayPositions[overlayId];\r\n                }\r\n\r\n                if (this._jsPlumb.overlayPlacements) {\r\n                    delete this._jsPlumb.overlayPlacements[overlayId];\r\n                }\r\n            }\r\n        },\r\n        removeOverlays: function () {\r\n            for (var i = 0, j = arguments.length; i < j; i++) {\r\n                this.removeOverlay(arguments[i]);\r\n            }\r\n        },\r\n        moveParent: function (newParent) {\r\n            if (this.bgCanvas) {\r\n                this.bgCanvas.parentNode.removeChild(this.bgCanvas);\r\n                newParent.appendChild(this.bgCanvas);\r\n            }\r\n\r\n            if (this.canvas && this.canvas.parentNode) {\r\n                this.canvas.parentNode.removeChild(this.canvas);\r\n                newParent.appendChild(this.canvas);\r\n\r\n                for (var i in this._jsPlumb.overlays) {\r\n                    if (this._jsPlumb.overlays[i].isAppendedAtTopLevel) {\r\n                        var el = this._jsPlumb.overlays[i].getElement();\r\n                        el.parentNode.removeChild(el);\r\n                        newParent.appendChild(el);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        getLabel: function () {\r\n            var lo = this.getOverlay(_internalLabelOverlayId);\r\n            return lo != null ? lo.getLabel() : null;\r\n        },\r\n        getLabelOverlay: function () {\r\n            return this.getOverlay(_internalLabelOverlayId);\r\n        },\r\n        setLabel: function (l) {\r\n            var lo = this.getOverlay(_internalLabelOverlayId);\r\n            if (!lo) {\r\n                var params = l.constructor === String || l.constructor === Function ? { label: l } : l;\r\n                lo = _makeLabelOverlay(this, params);\r\n                this._jsPlumb.overlays[_internalLabelOverlayId] = lo;\r\n            }\r\n            else {\r\n                if (l.constructor === String || l.constructor === Function) {\r\n                    lo.setLabel(l);\r\n                }\r\n                else {\r\n                    // labelby_ 2020050821:26:15\r\n                    if (!l.label) {\r\n                        l.label = ''\r\n                    }\r\n                    lo.setLabel(l.label);\r\n                    if (l.location) {\r\n                        lo.setLocation(l.location);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!this._jsPlumb.instance.isSuspendDrawing()) {\r\n                this.repaint();\r\n            }\r\n        },\r\n        cleanup: function (force) {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                this._jsPlumb.overlays[i].cleanup(force);\r\n                this._jsPlumb.overlays[i].destroy(force);\r\n            }\r\n            if (force) {\r\n                this._jsPlumb.overlays = {};\r\n                this._jsPlumb.overlayPositions = null;\r\n            }\r\n        },\r\n        setVisible: function (v) {\r\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\r\n        },\r\n        setAbsoluteOverlayPosition: function (overlay, xy) {\r\n            this._jsPlumb.overlayPositions[overlay.id] = xy;\r\n        },\r\n        getAbsoluteOverlayPosition: function (overlay) {\r\n            return this._jsPlumb.overlayPositions ? this._jsPlumb.overlayPositions[overlay.id] : null;\r\n        },\r\n        _clazzManip:function(action, clazz, dontUpdateOverlays) {\r\n            if (!dontUpdateOverlays) {\r\n                for (var i in this._jsPlumb.overlays) {\r\n                    this._jsPlumb.overlays[i][action + \"Class\"](clazz);\r\n                }\r\n            }\r\n        },\r\n        addClass:function(clazz, dontUpdateOverlays) {\r\n            this._clazzManip(\"add\", clazz, dontUpdateOverlays);\r\n        },\r\n        removeClass:function(clazz, dontUpdateOverlays) {\r\n            this._clazzManip(\"remove\", clazz, dontUpdateOverlays);\r\n        }\r\n    });\r\n\r\n// ------------------------------ END OverlayCapablejsPlumbUIComponent --------------------------------------------\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * This file contains the code for Endpoints.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    // create the drag handler for a connection\r\n    var _makeConnectionDragHandler = function (endpoint, placeholder, _jsPlumb) {\r\n        var stopped = false;\r\n        return {\r\n            drag: function () {\r\n                if (stopped) {\r\n                    stopped = false;\r\n                    return true;\r\n                }\r\n\r\n                if (placeholder.element) {\r\n                    var _ui = _jsPlumb.getUIPosition(arguments, _jsPlumb.getZoom());\r\n                    if (_ui != null) {\r\n                        _jsPlumb.setPosition(placeholder.element, _ui);\r\n                    }\r\n                    _jsPlumb.repaint(placeholder.element, _ui);\r\n                    // always repaint the source endpoint, because only continuous/dynamic anchors cause the endpoint\r\n                    // to be repainted, so static anchors need to be told (or the endpoint gets dragged around)\r\n                    endpoint.paint({anchorPoint:endpoint.anchor.getCurrentLocation({element:endpoint})});\r\n                }\r\n            },\r\n            stopDrag: function () {\r\n                stopped = true;\r\n            }\r\n        };\r\n    };\r\n\r\n    // creates a placeholder div for dragging purposes, adds it, and pre-computes its offset.\r\n    var _makeDraggablePlaceholder = function (placeholder, _jsPlumb, ipco, ips) {\r\n        var n = _jsPlumb.createElement(\"div\", { position : \"absolute\" });\r\n        _jsPlumb.appendElement(n);\r\n        var id = _jsPlumb.getId(n);\r\n        _jsPlumb.setPosition(n, ipco);\r\n        n.style.width = ips[0] + \"px\";\r\n        n.style.height = ips[1] + \"px\";\r\n        _jsPlumb.manage(id, n, true); // TRANSIENT MANAGE\r\n        // create and assign an id, and initialize the offset.\r\n        placeholder.id = id;\r\n        placeholder.element = n;\r\n    };\r\n\r\n    // create a floating endpoint (for drag connections)\r\n    var _makeFloatingEndpoint = function (paintStyle, referenceAnchor, endpoint, referenceCanvas, sourceElement, _jsPlumb, _newEndpoint, scope) {\r\n        var floatingAnchor = new _jp.FloatingAnchor({ reference: referenceAnchor, referenceCanvas: referenceCanvas, jsPlumbInstance: _jsPlumb });\r\n        //setting the scope here should not be the way to fix that mootools issue.  it should be fixed by not\r\n        // adding the floating endpoint as a droppable.  that makes more sense anyway!\r\n        // TRANSIENT MANAGE\r\n        return _newEndpoint({\r\n            paintStyle: paintStyle,\r\n            endpoint: endpoint,\r\n            anchor: floatingAnchor,\r\n            source: sourceElement,\r\n            scope: scope\r\n        });\r\n    };\r\n\r\n    var typeParameters = [ \"connectorStyle\", \"connectorHoverStyle\", \"connectorOverlays\",\r\n        \"connector\", \"connectionType\", \"connectorClass\", \"connectorHoverClass\" ];\r\n\r\n    // a helper function that tries to find a connection to the given element, and returns it if so. if elementWithPrecedence is null,\r\n    // or no connection to it is found, we return the first connection in our list.\r\n    var findConnectionToUseForDynamicAnchor = function (ep, elementWithPrecedence) {\r\n        var idx = 0;\r\n        if (elementWithPrecedence != null) {\r\n            for (var i = 0; i < ep.connections.length; i++) {\r\n                if (ep.connections[i].sourceId === elementWithPrecedence || ep.connections[i].targetId === elementWithPrecedence) {\r\n                    idx = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return ep.connections[idx];\r\n    };\r\n\r\n    _jp.Endpoint = function (params) {\r\n        var _jsPlumb = params._jsPlumb,\r\n            _newConnection = params.newConnection,\r\n            _newEndpoint = params.newEndpoint;\r\n\r\n        this.idPrefix = \"_jsplumb_e_\";\r\n        this.defaultLabelLocation = [ 0.5, 0.5 ];\r\n        this.defaultOverlayKeys = [\"Overlays\", \"EndpointOverlays\"];\r\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\r\n\r\n// TYPE\r\n\r\n        this.appendToDefaultType({\r\n            connectionType:params.connectionType,\r\n            maxConnections: params.maxConnections == null ? this._jsPlumb.instance.Defaults.MaxConnections : params.maxConnections, // maximum number of connections this endpoint can be the source of.,\r\n            paintStyle: params.endpointStyle || params.paintStyle || params.style || this._jsPlumb.instance.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle,\r\n            hoverPaintStyle: params.endpointHoverStyle || params.hoverPaintStyle || this._jsPlumb.instance.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle,\r\n            connectorStyle: params.connectorStyle,\r\n            connectorHoverStyle: params.connectorHoverStyle,\r\n            connectorClass: params.connectorClass,\r\n            connectorHoverClass: params.connectorHoverClass,\r\n            connectorOverlays: params.connectorOverlays,\r\n            connector: params.connector,\r\n            connectorTooltip: params.connectorTooltip\r\n        });\r\n\r\n// END TYPE\r\n\r\n        this._jsPlumb.enabled = !(params.enabled === false);\r\n        this._jsPlumb.visible = true;\r\n        this.element = _jp.getElement(params.source);\r\n        this._jsPlumb.uuid = params.uuid;\r\n        this._jsPlumb.floatingEndpoint = null;\r\n        var inPlaceCopy = null;\r\n        if (this._jsPlumb.uuid) {\r\n            params.endpointsByUUID[this._jsPlumb.uuid] = this;\r\n        }\r\n        this.elementId = params.elementId;\r\n        this.dragProxy = params.dragProxy;\r\n\r\n        this._jsPlumb.connectionCost = params.connectionCost;\r\n        this._jsPlumb.connectionsDirected = params.connectionsDirected;\r\n        this._jsPlumb.currentAnchorClass = \"\";\r\n        this._jsPlumb.events = {};\r\n\r\n        var deleteOnEmpty = params.deleteOnEmpty === true;\r\n        this.setDeleteOnEmpty = function(d) {\r\n            deleteOnEmpty = d;\r\n        };\r\n\r\n        var _updateAnchorClass = function () {\r\n            // stash old, get new\r\n            var oldAnchorClass = _jsPlumb.endpointAnchorClassPrefix + \"-\" + this._jsPlumb.currentAnchorClass;\r\n            this._jsPlumb.currentAnchorClass = this.anchor.getCssClass();\r\n            var anchorClass = _jsPlumb.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\r\n\r\n            this.removeClass(oldAnchorClass);\r\n            this.addClass(anchorClass);\r\n            // add and remove at the same time to reduce the number of reflows.\r\n            _jp.updateClasses(this.element, anchorClass, oldAnchorClass);\r\n        }.bind(this);\r\n\r\n        this.prepareAnchor = function(anchorParams) {\r\n            var a = this._jsPlumb.instance.makeAnchor(anchorParams, this.elementId, _jsPlumb);\r\n            a.bind(\"anchorChanged\", function (currentAnchor) {\r\n                this.fire(\"anchorChanged\", {endpoint: this, anchor: currentAnchor});\r\n                _updateAnchorClass();\r\n            }.bind(this));\r\n            return a;\r\n        };\r\n\r\n        this.setPreparedAnchor = function(anchor, doNotRepaint) {\r\n            this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);\r\n            this.anchor = anchor;\r\n            _updateAnchorClass();\r\n\r\n            if (!doNotRepaint) {\r\n                this._jsPlumb.instance.repaint(this.elementId);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        this.setAnchor = function (anchorParams, doNotRepaint) {\r\n            var a = this.prepareAnchor(anchorParams);\r\n            this.setPreparedAnchor(a, doNotRepaint);\r\n            return this;\r\n        };\r\n\r\n        var internalHover = function (state) {\r\n            if (this.connections.length > 0) {\r\n                for (var i = 0; i < this.connections.length; i++) {\r\n                    this.connections[i].setHover(state, false);\r\n                }\r\n            }\r\n            else {\r\n                this.setHover(state);\r\n            }\r\n        }.bind(this);\r\n\r\n        this.bind(\"mouseover\", function () {\r\n            internalHover(true);\r\n        });\r\n        this.bind(\"mouseout\", function () {\r\n            internalHover(false);\r\n        });\r\n\r\n        // ANCHOR MANAGER\r\n        if (!params._transient) { // in place copies, for example, are transient.  they will never need to be retrieved during a paint cycle, because they dont move, and then they are deleted.\r\n            this._jsPlumb.instance.anchorManager.add(this, this.elementId);\r\n        }\r\n\r\n        this.prepareEndpoint = function(ep, typeId) {\r\n            var _e = function (t, p) {\r\n                var rm = _jsPlumb.getRenderMode();\r\n                if (_jp.Endpoints[rm][t]) {\r\n                    return new _jp.Endpoints[rm][t](p);\r\n                }\r\n                if (!_jsPlumb.Defaults.DoNotThrowErrors) {\r\n                    throw { msg: \"jsPlumb: unknown endpoint type '\" + t + \"'\" };\r\n                }\r\n            };\r\n\r\n            var endpointArgs = {\r\n                _jsPlumb: this._jsPlumb.instance,\r\n                cssClass: params.cssClass,\r\n                container: params.container,\r\n                tooltip: params.tooltip,\r\n                connectorTooltip: params.connectorTooltip,\r\n                endpoint: this\r\n            };\r\n\r\n            var endpoint;\r\n\r\n            if (_ju.isString(ep)) {\r\n                endpoint = _e(ep, endpointArgs);\r\n            }\r\n            else if (_ju.isArray(ep)) {\r\n                endpointArgs = _ju.merge(ep[1], endpointArgs);\r\n                endpoint = _e(ep[0], endpointArgs);\r\n            }\r\n            else {\r\n                endpoint = ep.clone();\r\n            }\r\n\r\n            // assign a clone function using a copy of endpointArgs. this is used when a drag starts: the endpoint that was dragged is cloned,\r\n            // and the clone is left in its place while the original one goes off on a magical journey.\r\n            // the copy is to get around a closure problem, in which endpointArgs ends up getting shared by\r\n            // the whole world.\r\n            //var argsForClone = jsPlumb.extend({}, endpointArgs);\r\n            endpoint.clone = function () {\r\n                // TODO this, and the code above, can be refactored to be more dry.\r\n                if (_ju.isString(ep)) {\r\n                    return _e(ep, endpointArgs);\r\n                }\r\n                else if (_ju.isArray(ep)) {\r\n                    endpointArgs = _ju.merge(ep[1], endpointArgs);\r\n                    return _e(ep[0], endpointArgs);\r\n                }\r\n            }.bind(this);\r\n\r\n            endpoint.typeId = typeId;\r\n            return endpoint;\r\n        };\r\n\r\n        this.setEndpoint = function(ep, doNotRepaint) {\r\n            var _ep = this.prepareEndpoint(ep);\r\n            this.setPreparedEndpoint(_ep, true);\r\n        };\r\n\r\n        this.setPreparedEndpoint = function (ep, doNotRepaint) {\r\n            if (this.endpoint != null) {\r\n                this.endpoint.cleanup();\r\n                this.endpoint.destroy();\r\n            }\r\n            this.endpoint = ep;\r\n            this.type = this.endpoint.type;\r\n            this.canvas = this.endpoint.canvas;\r\n        };\r\n\r\n        _jp.extend(this, params, typeParameters);\r\n\r\n        this.isSource = params.isSource || false;\r\n        this.isTemporarySource = params.isTemporarySource || false;\r\n        this.isTarget = params.isTarget || false;\r\n\r\n        this.connections = params.connections || [];\r\n        this.connectorPointerEvents = params[\"connector-pointer-events\"];\r\n\r\n        this.scope = params.scope || _jsPlumb.getDefaultScope();\r\n        this.timestamp = null;\r\n        this.reattachConnections = params.reattach || _jsPlumb.Defaults.ReattachConnections;\r\n        this.connectionsDetachable = _jsPlumb.Defaults.ConnectionsDetachable;\r\n        if (params.connectionsDetachable === false || params.detachable === false) {\r\n            this.connectionsDetachable = false;\r\n        }\r\n        this.dragAllowedWhenFull = params.dragAllowedWhenFull !== false;\r\n\r\n        if (params.onMaxConnections) {\r\n            this.bind(\"maxConnections\", params.onMaxConnections);\r\n        }\r\n\r\n        //\r\n        // add a connection. not part of public API.\r\n        //\r\n        this.addConnection = function (connection) {\r\n            this.connections.push(connection);\r\n            this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\r\n            this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\r\n        };\r\n\r\n        this.detachFromConnection = function (connection, idx, doNotCleanup) {\r\n            idx = idx == null ? this.connections.indexOf(connection) : idx;\r\n            if (idx >= 0) {\r\n                this.connections.splice(idx, 1);\r\n                this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\r\n                this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\r\n            }\r\n\r\n            if (!doNotCleanup && deleteOnEmpty && this.connections.length === 0) {\r\n                _jsPlumb.deleteObject({\r\n                    endpoint: this,\r\n                    fireEvent: false,\r\n                    deleteAttachedObjects: doNotCleanup !== true\r\n                });\r\n            }\r\n        };\r\n\r\n        this.deleteEveryConnection = function(params) {\r\n            var c = this.connections.length;\r\n            for (var i = 0; i < c; i++) {\r\n                _jsPlumb.deleteConnection(this.connections[0], params);\r\n            }\r\n        };\r\n\r\n        this.detachFrom = function (targetEndpoint, fireEvent, originalEvent) {\r\n            var c = [];\r\n            for (var i = 0; i < this.connections.length; i++) {\r\n                if (this.connections[i].endpoints[1] === targetEndpoint || this.connections[i].endpoints[0] === targetEndpoint) {\r\n                    c.push(this.connections[i]);\r\n                }\r\n            }\r\n            for (var j = 0, count = c.length; j < count; j++) {\r\n                _jsPlumb.deleteConnection(c[0]);\r\n            }\r\n            return this;\r\n        };\r\n\r\n        this.getElement = function () {\r\n            return this.element;\r\n        };\r\n\r\n        this.setElement = function (el) {\r\n            var parentId = this._jsPlumb.instance.getId(el),\r\n                curId = this.elementId;\r\n            // remove the endpoint from the list for the current endpoint's element\r\n            _ju.removeWithFunction(params.endpointsByElement[this.elementId], function (e) {\r\n                return e.id === this.id;\r\n            }.bind(this));\r\n            this.element = _jp.getElement(el);\r\n            this.elementId = _jsPlumb.getId(this.element);\r\n            _jsPlumb.anchorManager.rehomeEndpoint(this, curId, this.element);\r\n            _jsPlumb.dragManager.endpointAdded(this.element);\r\n            _ju.addToList(params.endpointsByElement, parentId, this);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * private but must be exposed.\r\n         */\r\n        this.makeInPlaceCopy = function () {\r\n            var loc = this.anchor.getCurrentLocation({element: this}),\r\n                o = this.anchor.getOrientation(this),\r\n                acc = this.anchor.getCssClass(),\r\n                inPlaceAnchor = {\r\n                    bind: function () {\r\n                    },\r\n                    compute: function () {\r\n                        return [ loc[0], loc[1] ];\r\n                    },\r\n                    getCurrentLocation: function () {\r\n                        return [ loc[0], loc[1] ];\r\n                    },\r\n                    getOrientation: function () {\r\n                        return o;\r\n                    },\r\n                    getCssClass: function () {\r\n                        return acc;\r\n                    }\r\n                };\r\n\r\n            return _newEndpoint({\r\n                dropOptions: params.dropOptions,\r\n                anchor: inPlaceAnchor,\r\n                source: this.element,\r\n                paintStyle: this.getPaintStyle(),\r\n                endpoint: params.hideOnDrag ? \"Blank\" : this.endpoint,\r\n                _transient: true,\r\n                scope: this.scope,\r\n                reference:this\r\n            });\r\n        };\r\n\r\n        /**\r\n         * returns a connection from the pool; used when dragging starts.  just gets the head of the array if it can.\r\n         */\r\n        this.connectorSelector = function () {\r\n            return this.connections[0];\r\n        };\r\n\r\n        this.setStyle = this.setPaintStyle;\r\n\r\n        this.paint = function (params) {\r\n            params = params || {};\r\n            var timestamp = params.timestamp, recalc = !(params.recalc === false);\r\n            if (!timestamp || this.timestamp !== timestamp) {\r\n\r\n                var info = _jsPlumb.updateOffset({ elId: this.elementId, timestamp: timestamp });\r\n\r\n                var xy = params.offset ? params.offset.o : info.o;\r\n                if (xy != null) {\r\n                    var ap = params.anchorPoint, connectorPaintStyle = params.connectorPaintStyle;\r\n                    if (ap == null) {\r\n                        var wh = params.dimensions || info.s,\r\n                            anchorParams = { xy: [ xy.left, xy.top ], wh: wh, element: this, timestamp: timestamp };\r\n                        if (recalc && this.anchor.isDynamic && this.connections.length > 0) {\r\n                            var c = findConnectionToUseForDynamicAnchor(this, params.elementWithPrecedence),\r\n                                oIdx = c.endpoints[0] === this ? 1 : 0,\r\n                                oId = oIdx === 0 ? c.sourceId : c.targetId,\r\n                                oInfo = _jsPlumb.getCachedData(oId),\r\n                                oOffset = oInfo.o, oWH = oInfo.s;\r\n\r\n                            anchorParams.index = oIdx === 0 ? 1 : 0;\r\n                            anchorParams.connection = c;\r\n                            anchorParams.txy = [ oOffset.left, oOffset.top ];\r\n                            anchorParams.twh = oWH;\r\n                            anchorParams.tElement = c.endpoints[oIdx];\r\n                        } else if (this.connections.length > 0) {\r\n                            anchorParams.connection = this.connections[0];\r\n                        }\r\n                        ap = this.anchor.compute(anchorParams);\r\n                    }\r\n\r\n                    this.endpoint.compute(ap, this.anchor.getOrientation(this), this._jsPlumb.paintStyleInUse, connectorPaintStyle || this.paintStyleInUse);\r\n                    this.endpoint.paint(this._jsPlumb.paintStyleInUse, this.anchor);\r\n                    this.timestamp = timestamp;\r\n\r\n                    // paint overlays\r\n                    for (var i in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\r\n                            var o = this._jsPlumb.overlays[i];\r\n                            if (o.isVisible()) {\r\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.endpoint, this._jsPlumb.paintStyleInUse);\r\n                                o.paint(this._jsPlumb.overlayPlacements[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        this.getTypeDescriptor = function () {\r\n            return \"endpoint\";\r\n        };\r\n        this.isVisible = function () {\r\n            return this._jsPlumb.visible;\r\n        };\r\n\r\n        this.repaint = this.paint;\r\n\r\n        var draggingInitialised = false;\r\n        this.initDraggable = function () {\r\n\r\n            // is this a connection source? we make it draggable and have the\r\n            // drag listener maintain a connection with a floating endpoint.\r\n            if (!draggingInitialised && _jp.isDragSupported(this.element)) {\r\n                var placeholderInfo = { id: null, element: null },\r\n                    jpc = null,\r\n                    existingJpc = false,\r\n                    existingJpcParams = null,\r\n                    _dragHandler = _makeConnectionDragHandler(this, placeholderInfo, _jsPlumb),\r\n                    dragOptions = params.dragOptions || {},\r\n                    defaultOpts = {},\r\n                    startEvent = _jp.dragEvents.start,\r\n                    stopEvent = _jp.dragEvents.stop,\r\n                    dragEvent = _jp.dragEvents.drag,\r\n                    beforeStartEvent = _jp.dragEvents.beforeStart,\r\n                    payload;\r\n\r\n                // respond to beforeStart from katavorio; this will have, optionally, a payload of attribute values\r\n                // that were placed there by the makeSource mousedown listener.\r\n                var beforeStart = function(beforeStartParams) {\r\n                    payload = beforeStartParams.e.payload || {};\r\n                };\r\n\r\n                var start = function (startParams) {\r\n\r\n// -------------   first, get a connection to drag. this may be null, in which case we are dragging a new one.\r\n\r\n                    jpc = this.connectorSelector();\r\n\r\n// -------------------------------- now a bunch of tests about whether or not to proceed -------------------------\r\n\r\n                    var _continue = true;\r\n                    // if not enabled, return\r\n                    if (!this.isEnabled()) {\r\n                        _continue = false;\r\n                    }\r\n                    // if no connection and we're not a source - or temporarily a source, as is the case with makeSource - return.\r\n                    if (jpc == null && !this.isSource && !this.isTemporarySource) {\r\n                        _continue = false;\r\n                    }\r\n                    // otherwise if we're full and not allowed to drag, also return false.\r\n                    if (this.isSource && this.isFull() && !(jpc != null && this.dragAllowedWhenFull)) {\r\n                        _continue = false;\r\n                    }\r\n                    // if the connection was setup as not detachable or one of its endpoints\r\n                    // was setup as connectionsDetachable = false, or Defaults.ConnectionsDetachable\r\n                    // is set to false...\r\n                    if (jpc != null && !jpc.isDetachable(this)) {\r\n                        // .. and the endpoint is full\r\n                        if (this.isFull()) {\r\n                            _continue = false;\r\n                        } else {\r\n                            // otherwise, if not full, set the connection to null, and we will now proceed\r\n                            // to drag a new connection.\r\n                            jpc = null;\r\n                        }\r\n                    }\r\n\r\n                    var beforeDrag = _jsPlumb.checkCondition(jpc == null ? \"beforeDrag\" : \"beforeStartDetach\", {\r\n                        endpoint:this,\r\n                        source:this.element,\r\n                        sourceId:this.elementId,\r\n                        connection:jpc\r\n                    });\r\n                    if (beforeDrag === false) {\r\n                        _continue = false;\r\n                    }\r\n                    // else we might have been given some data. we'll pass it in to a new connection as 'data'.\r\n                    // here we also merge in the optional payload we were given on mousedown.\r\n                    else if (typeof beforeDrag === \"object\") {\r\n                        _jp.extend(beforeDrag, payload || {});\r\n                    }\r\n                    else {\r\n                        // or if no beforeDrag data, maybe use the payload on its own.\r\n                        beforeDrag = payload || {};\r\n                    }\r\n\r\n                    if (_continue === false) {\r\n                        // this is for mootools and yui. returning false from this causes jquery to stop drag.\r\n                        // the events are wrapped in both mootools and yui anyway, but i don't think returning\r\n                        // false from the start callback would stop a drag.\r\n                        if (_jsPlumb.stopDrag) {\r\n                            _jsPlumb.stopDrag(this.canvas);\r\n                        }\r\n                        _dragHandler.stopDrag();\r\n                        return false;\r\n                    }\r\n\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n\r\n                    // ok to proceed.\r\n\r\n                    // clear hover for all connections for this endpoint before continuing.\r\n                    for (var i = 0; i < this.connections.length; i++) {\r\n                        this.connections[i].setHover(false);\r\n                    }\r\n\r\n                    this.addClass(\"endpointDrag\");\r\n                    _jsPlumb.setConnectionBeingDragged(true);\r\n\r\n                    // if we're not full but there was a connection, make it null. we'll create a new one.\r\n                    if (jpc && !this.isFull() && this.isSource) {\r\n                        jpc = null;\r\n                    }\r\n\r\n                    _jsPlumb.updateOffset({ elId: this.elementId });\r\n\r\n// ----------------    make the element we will drag around, and position it -----------------------------\r\n\r\n                    var ipco = this._jsPlumb.instance.getOffset(this.canvas),\r\n                        canvasElement = this.canvas,\r\n                        ips = this._jsPlumb.instance.getSize(this.canvas);\r\n\r\n                    _makeDraggablePlaceholder(placeholderInfo, _jsPlumb, ipco, ips);\r\n\r\n                    // store the id of the dragging div and the source element. the drop function will pick these up.\r\n                    _jsPlumb.setAttributes(this.canvas, {\r\n                        \"dragId\": placeholderInfo.id,\r\n                        \"elId\": this.elementId\r\n                    });\r\n\r\n// ------------------- create an endpoint that will be our floating endpoint ------------------------------------\r\n\r\n                    var endpointToFloat = this.dragProxy || this.endpoint;\r\n                    if (this.dragProxy == null && this.connectionType != null) {\r\n                        var aae = this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);\r\n                        if (aae.endpoints[1]) {\r\n                            endpointToFloat = aae.endpoints[1];\r\n                        }\r\n                    }\r\n                    var centerAnchor = this._jsPlumb.instance.makeAnchor(\"Center\");\r\n                    centerAnchor.isFloating = true;\r\n                    this._jsPlumb.floatingEndpoint = _makeFloatingEndpoint(this.getPaintStyle(), centerAnchor, endpointToFloat, this.canvas, placeholderInfo.element, _jsPlumb, _newEndpoint, this.scope);\r\n                    var _savedAnchor = this._jsPlumb.floatingEndpoint.anchor;\r\n\r\n\r\n                    if (jpc == null) {\r\n\r\n                        this.setHover(false, false);\r\n                        // create a connection. one end is this endpoint, the other is a floating endpoint.\r\n                        jpc = _newConnection({\r\n                            sourceEndpoint: this,\r\n                            targetEndpoint: this._jsPlumb.floatingEndpoint,\r\n                            source: this.element,  // for makeSource with parent option.  ensure source element is represented correctly.\r\n                            target: placeholderInfo.element,\r\n                            anchors: [ this.anchor, this._jsPlumb.floatingEndpoint.anchor ],\r\n                            paintStyle: params.connectorStyle, // this can be null. Connection will use the default.\r\n                            hoverPaintStyle: params.connectorHoverStyle,\r\n                            connector: params.connector, // this can also be null. Connection will use the default.\r\n                            overlays: params.connectorOverlays,\r\n                            type: this.connectionType,\r\n                            cssClass: this.connectorClass,\r\n                            hoverClass: this.connectorHoverClass,\r\n                            scope:params.scope,\r\n                            data:beforeDrag\r\n                        });\r\n                        jpc.pending = true;\r\n                        jpc.addClass(_jsPlumb.draggingClass);\r\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\r\n                        this._jsPlumb.floatingEndpoint.anchor = _savedAnchor;\r\n                        // fire an event that informs that a connection is being dragged\r\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\r\n\r\n                        // register the new connection on the drag manager. This connection, at this point, is 'pending',\r\n                        // and has as its target a temporary element (the 'placeholder'). If the connection subsequently\r\n                        // becomes established, the anchor manager is informed that the target of the connection has\r\n                        // changed.\r\n\r\n                        _jsPlumb.anchorManager.newConnection(jpc);\r\n\r\n                    } else {\r\n                        existingJpc = true;\r\n                        jpc.setHover(false);\r\n                        // new anchor idx\r\n                        var anchorIdx = jpc.endpoints[0].id === this.id ? 0 : 1;\r\n                        this.detachFromConnection(jpc, null, true);                         // detach from the connection while dragging is occurring. but dont cleanup automatically.\r\n\r\n                        // store the original scope (issue 57)\r\n                        var dragScope = _jsPlumb.getDragScope(canvasElement);\r\n                        _jsPlumb.setAttribute(this.canvas, \"originalScope\", dragScope);\r\n\r\n                        // fire an event that informs that a connection is being dragged. we do this before\r\n                        // replacing the original target with the floating element info.\r\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\r\n\r\n                        // now we replace ourselves with the temporary div we created above:\r\n                        if (anchorIdx === 0) {\r\n                            existingJpcParams = [ jpc.source, jpc.sourceId, canvasElement, dragScope ];\r\n                            _jsPlumb.anchorManager.sourceChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element);\r\n\r\n                        } else {\r\n                            existingJpcParams = [ jpc.target, jpc.targetId, canvasElement, dragScope ];\r\n                            jpc.target = placeholderInfo.element;\r\n                            jpc.targetId = placeholderInfo.id;\r\n\r\n                            _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.endpoints[anchorIdx].elementId, jpc.targetId, jpc);\r\n                        }\r\n\r\n                        // store the original endpoint and assign the new floating endpoint for the drag.\r\n                        jpc.suspendedEndpoint = jpc.endpoints[anchorIdx];\r\n\r\n                        // PROVIDE THE SUSPENDED ELEMENT, BE IT A SOURCE OR TARGET (ISSUE 39)\r\n                        jpc.suspendedElement = jpc.endpoints[anchorIdx].getElement();\r\n                        jpc.suspendedElementId = jpc.endpoints[anchorIdx].elementId;\r\n                        jpc.suspendedElementType = anchorIdx === 0 ? \"source\" : \"target\";\r\n\r\n                        jpc.suspendedEndpoint.setHover(false);\r\n                        this._jsPlumb.floatingEndpoint.referenceEndpoint = jpc.suspendedEndpoint;\r\n                        jpc.endpoints[anchorIdx] = this._jsPlumb.floatingEndpoint;\r\n\r\n                        jpc.addClass(_jsPlumb.draggingClass);\r\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\r\n                    }\r\n\r\n                    _jsPlumb.registerFloatingConnection(placeholderInfo, jpc, this._jsPlumb.floatingEndpoint);\r\n\r\n                    // // register it and register connection on it.\r\n                    // _jsPlumb.floatingConnections[placeholderInfo.id] = jpc;\r\n                    //\r\n                    // // only register for the target endpoint; we will not be dragging the source at any time\r\n                    // // before this connection is either discarded or made into a permanent connection.\r\n                    // _ju.addToList(params.endpointsByElement, placeholderInfo.id, this._jsPlumb.floatingEndpoint);\r\n\r\n\r\n                    // tell jsplumb about it\r\n                    _jsPlumb.currentlyDragging = true;\r\n                }.bind(this);\r\n\r\n                var stop = function () {\r\n                    _jsPlumb.setConnectionBeingDragged(false);\r\n\r\n                    if (jpc && jpc.endpoints != null) {\r\n                        // get the actual drop event (decode from library args to stop function)\r\n                        var originalEvent = _jsPlumb.getDropEvent(arguments);\r\n                        // unlock the other endpoint (if it is dynamic, it would have been locked at drag start)\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\r\n                        jpc.endpoints[idx === 0 ? 1 : 0].anchor.unlock();\r\n                        // TODO: Dont want to know about css classes inside jsplumb, ideally.\r\n                        jpc.removeClass(_jsPlumb.draggingClass);\r\n\r\n                        // if we have the floating endpoint then the connection has not been dropped\r\n                        // on another endpoint.  If it is a new connection we throw it away. If it is an\r\n                        // existing connection we check to see if we should reattach it, throwing it away\r\n                        // if not.\r\n                        if (this._jsPlumb && (jpc.deleteConnectionNow || jpc.endpoints[idx] === this._jsPlumb.floatingEndpoint)) {\r\n                            // 6a. if the connection was an existing one...\r\n                            if (existingJpc && jpc.suspendedEndpoint) {\r\n                                // fix for issue35, thanks Sylvain Gizard: when firing the detach event make sure the\r\n                                // floating endpoint has been replaced.\r\n                                if (idx === 0) {\r\n                                    jpc.floatingElement = jpc.source;\r\n                                    jpc.floatingId = jpc.sourceId;\r\n                                    jpc.floatingEndpoint = jpc.endpoints[0];\r\n                                    jpc.floatingIndex = 0;\r\n                                    jpc.source = existingJpcParams[0];\r\n                                    jpc.sourceId = existingJpcParams[1];\r\n                                } else {\r\n                                    // keep a copy of the floating element; the anchor manager will want to clean up.\r\n                                    jpc.floatingElement = jpc.target;\r\n                                    jpc.floatingId = jpc.targetId;\r\n                                    jpc.floatingEndpoint = jpc.endpoints[1];\r\n                                    jpc.floatingIndex = 1;\r\n                                    jpc.target = existingJpcParams[0];\r\n                                    jpc.targetId = existingJpcParams[1];\r\n                                }\r\n\r\n                                var fe = this._jsPlumb.floatingEndpoint; // store for later removal.\r\n                                // restore the original scope (issue 57)\r\n                                _jsPlumb.setDragScope(existingJpcParams[2], existingJpcParams[3]);\r\n                                jpc.endpoints[idx] = jpc.suspendedEndpoint;\r\n                                // if the connection should be reattached, or the other endpoint refuses detach, then\r\n                                // reset the connection to its original state\r\n                                if (jpc.isReattach() || jpc._forceReattach || jpc._forceDetach || !_jsPlumb.deleteConnection(jpc, {originalEvent: originalEvent})) {\r\n\r\n                                    jpc.setHover(false);\r\n                                    jpc._forceDetach = null;\r\n                                    jpc._forceReattach = null;\r\n                                    this._jsPlumb.floatingEndpoint.detachFromConnection(jpc);\r\n                                    jpc.suspendedEndpoint.addConnection(jpc);\r\n\r\n                                    // TODO this code is duplicated in lots of places...and there is nothing external\r\n                                    // in the code; it all refers to the connection itself. we could add a\r\n                                    // `checkSanity(connection)` method to anchorManager that did this.\r\n                                    if (idx === 1) {\r\n                                        _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\r\n                                    }\r\n                                    else {\r\n                                        _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\r\n                                    }\r\n\r\n                                    _jsPlumb.repaint(existingJpcParams[1]);\r\n                                }\r\n                                else {\r\n                                    _jsPlumb.deleteObject({endpoint: fe});\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        // makeTargets sets this flag, to tell us we have been replaced and should delete this object.\r\n                        if (this.deleteAfterDragStop) {\r\n                            _jsPlumb.deleteObject({endpoint: this});\r\n                        }\r\n                        else {\r\n                            if (this._jsPlumb) {\r\n                                this.paint({recalc: false});\r\n                            }\r\n                        }\r\n\r\n                        // although the connection is no longer valid, there are use cases where this is useful.\r\n                        _jsPlumb.fire(\"connectionDragStop\", jpc, originalEvent);\r\n                        // fire this event to give people more fine-grained control (connectionDragStop fires a lot)\r\n                        if (jpc.pending) {\r\n                            _jsPlumb.fire(\"connectionAborted\", jpc, originalEvent);\r\n                        }\r\n                        // tell jsplumb that dragging is finished.\r\n                        _jsPlumb.currentlyDragging = false;\r\n                        jpc.suspendedElement = null;\r\n                        jpc.suspendedEndpoint = null;\r\n                        jpc = null;\r\n                    }\r\n\r\n                    // if no endpoints, jpc already cleaned up. but still we want to ensure we're reset properly.\r\n                    // remove the element associated with the floating endpoint\r\n                    // (and its associated floating endpoint and visual artefacts)\r\n                    if (placeholderInfo && placeholderInfo.element) {\r\n                        _jsPlumb.remove(placeholderInfo.element, false, false);\r\n                    }\r\n                    // remove the inplace copy\r\n                    if (inPlaceCopy) {\r\n                        _jsPlumb.deleteObject({endpoint: inPlaceCopy});\r\n                    }\r\n\r\n                    if (this._jsPlumb) {\r\n                        // make our canvas visible (TODO: hand off to library; we should not know about DOM)\r\n                        this.canvas.style.visibility = \"visible\";\r\n                        // unlock our anchor\r\n                        this.anchor.unlock();\r\n                        // clear floating anchor.\r\n                        this._jsPlumb.floatingEndpoint = null;\r\n                    }\r\n\r\n                }.bind(this);\r\n\r\n                dragOptions = _jp.extend(defaultOpts, dragOptions);\r\n                dragOptions.scope = this.scope || dragOptions.scope;\r\n                dragOptions[beforeStartEvent] = _ju.wrap(dragOptions[beforeStartEvent], beforeStart, false);\r\n                dragOptions[startEvent] = _ju.wrap(dragOptions[startEvent], start, false);\r\n                // extracted drag handler function so can be used by makeSource\r\n                dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], _dragHandler.drag);\r\n                dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], stop);\r\n                dragOptions.multipleDrop = false;\r\n\r\n                dragOptions.canDrag = function () {\r\n                    return this.isSource || this.isTemporarySource || (this.connections.length > 0 && this.connectionsDetachable !== false);\r\n                }.bind(this);\r\n\r\n                _jsPlumb.initDraggable(this.canvas, dragOptions, \"internal\");\r\n\r\n                this.canvas._jsPlumbRelatedElement = this.element;\r\n\r\n                draggingInitialised = true;\r\n            }\r\n        };\r\n\r\n        var ep = params.endpoint || this._jsPlumb.instance.Defaults.Endpoint || _jp.Defaults.Endpoint;\r\n        this.setEndpoint(ep, true);\r\n        var anchorParamsToUse = params.anchor ? params.anchor : params.anchors ? params.anchors : (_jsPlumb.Defaults.Anchor || \"Top\");\r\n        this.setAnchor(anchorParamsToUse, true);\r\n\r\n        // finally, set type if it was provided\r\n        var type = [ \"default\", (params.type || \"\")].join(\" \");\r\n        this.addType(type, params.data, true);\r\n        this.canvas = this.endpoint.canvas;\r\n        this.canvas._jsPlumb = this;\r\n\r\n        this.initDraggable();\r\n\r\n        // pulled this out into a function so we can reuse it for the inPlaceCopy canvas; you can now drop detached connections\r\n        // back onto the endpoint you detached it from.\r\n        var _initDropTarget = function (canvas, isTransient, endpoint, referenceEndpoint) {\r\n\r\n            if (_jp.isDropSupported(this.element)) {\r\n                var dropOptions = params.dropOptions || _jsPlumb.Defaults.DropOptions || _jp.Defaults.DropOptions;\r\n                dropOptions = _jp.extend({}, dropOptions);\r\n                dropOptions.scope = dropOptions.scope || this.scope;\r\n                var dropEvent = _jp.dragEvents.drop,\r\n                    overEvent = _jp.dragEvents.over,\r\n                    outEvent = _jp.dragEvents.out,\r\n                    _ep = this,\r\n                    drop = _jsPlumb.EndpointDropHandler({\r\n                        getEndpoint: function () {\r\n                            return _ep;\r\n                        },\r\n                        jsPlumb: _jsPlumb,\r\n                        enabled: function () {\r\n                            return endpoint != null ? endpoint.isEnabled() : true;\r\n                        },\r\n                        isFull: function () {\r\n                            return endpoint.isFull();\r\n                        },\r\n                        element: this.element,\r\n                        elementId: this.elementId,\r\n                        isSource: this.isSource,\r\n                        isTarget: this.isTarget,\r\n                        addClass: function (clazz) {\r\n                            _ep.addClass(clazz);\r\n                        },\r\n                        removeClass: function (clazz) {\r\n                            _ep.removeClass(clazz);\r\n                        },\r\n                        isDropAllowed: function () {\r\n                            return _ep.isDropAllowed.apply(_ep, arguments);\r\n                        },\r\n                        reference:referenceEndpoint,\r\n                        isRedrop:function(jpc, dhParams) {\r\n                            return jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\r\n                        }\r\n                    });\r\n\r\n                dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], drop, true);\r\n                dropOptions[overEvent] = _ju.wrap(dropOptions[overEvent], function () {\r\n                    var draggable = _jp.getDragObject(arguments),\r\n                        id = _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\r\n                        _jpc = _jsPlumb.getFloatingConnectionFor(id);//_jsPlumb.floatingConnections[id];\r\n\r\n                    if (_jpc != null) {\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\r\n                        // here we should fire the 'over' event if we are a target and this is a new connection,\r\n                        // or we are the same as the floating endpoint.\r\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\r\n                        if (_cont) {\r\n                            var bb = _jsPlumb.checkCondition(\"checkDropAllowed\", {\r\n                                sourceEndpoint: _jpc.endpoints[idx],\r\n                                targetEndpoint: this,\r\n                                connection: _jpc\r\n                            });\r\n                            this[(bb ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointDropAllowedClass);\r\n                            this[(bb ? \"remove\" : \"add\") + \"Class\"](_jsPlumb.endpointDropForbiddenClass);\r\n                            _jpc.endpoints[idx].anchor.over(this.anchor, this);\r\n                        }\r\n                    }\r\n                }.bind(this));\r\n\r\n                dropOptions[outEvent] = _ju.wrap(dropOptions[outEvent], function () {\r\n                    var draggable = _jp.getDragObject(arguments),\r\n                        id = draggable == null ? null : _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\r\n                        _jpc = id ? _jsPlumb.getFloatingConnectionFor(id) : null;\r\n\r\n                    if (_jpc != null) {\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\r\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id === _jpc.suspendedEndpoint.id);\r\n                        if (_cont) {\r\n                            this.removeClass(_jsPlumb.endpointDropAllowedClass);\r\n                            this.removeClass(_jsPlumb.endpointDropForbiddenClass);\r\n                            _jpc.endpoints[idx].anchor.out();\r\n                        }\r\n                    }\r\n                }.bind(this));\r\n\r\n                _jsPlumb.initDroppable(canvas, dropOptions, \"internal\", isTransient);\r\n            }\r\n        }.bind(this);\r\n\r\n        // Initialise the endpoint's canvas as a drop target. The drop handler will take care of the logic of whether\r\n        // something can actually be dropped.\r\n        if (!this.anchor.isFloating) {\r\n            _initDropTarget(this.canvas, !(params._transient || this.anchor.isFloating), this, params.reference);\r\n        }\r\n\r\n        return this;\r\n    };\r\n\r\n    _ju.extend(_jp.Endpoint, _jp.OverlayCapableJsPlumbUIComponent, {\r\n\r\n        setVisible: function (v, doNotChangeConnections, doNotNotifyOtherEndpoint) {\r\n            this._jsPlumb.visible = v;\r\n            if (this.canvas) {\r\n                this.canvas.style.display = v ? \"block\" : \"none\";\r\n            }\r\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\r\n            if (!doNotChangeConnections) {\r\n                for (var i = 0; i < this.connections.length; i++) {\r\n                    this.connections[i].setVisible(v);\r\n                    if (!doNotNotifyOtherEndpoint) {\r\n                        var oIdx = this === this.connections[i].endpoints[0] ? 1 : 0;\r\n                        // only change the other endpoint if this is its only connection.\r\n                        if (this.connections[i].endpoints[oIdx].connections.length === 1) {\r\n                            this.connections[i].endpoints[oIdx].setVisible(v, true, true);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        getAttachedElements: function () {\r\n            return this.connections;\r\n        },\r\n        applyType: function (t, doNotRepaint) {\r\n            this.setPaintStyle(t.endpointStyle || t.paintStyle, doNotRepaint);\r\n            this.setHoverPaintStyle(t.endpointHoverStyle || t.hoverPaintStyle, doNotRepaint);\r\n            if (t.maxConnections != null) {\r\n                this._jsPlumb.maxConnections = t.maxConnections;\r\n            }\r\n            if (t.scope) {\r\n                this.scope = t.scope;\r\n            }\r\n            _jp.extend(this, t, typeParameters);\r\n            if (t.cssClass != null && this.canvas) {\r\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\r\n            }\r\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\r\n        },\r\n        isEnabled: function () {\r\n            return this._jsPlumb.enabled;\r\n        },\r\n        setEnabled: function (e) {\r\n            this._jsPlumb.enabled = e;\r\n        },\r\n        cleanup: function () {\r\n            var anchorClass = this._jsPlumb.instance.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\r\n            _jp.removeClass(this.element, anchorClass);\r\n            this.anchor = null;\r\n            this.endpoint.cleanup(true);\r\n            this.endpoint.destroy();\r\n            this.endpoint = null;\r\n            // drag/drop\r\n            this._jsPlumb.instance.destroyDraggable(this.canvas, \"internal\");\r\n            this._jsPlumb.instance.destroyDroppable(this.canvas, \"internal\");\r\n        },\r\n        setHover: function (h) {\r\n            if (this.endpoint && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\r\n                this.endpoint.setHover(h);\r\n            }\r\n        },\r\n        isFull: function () {\r\n            return this._jsPlumb.maxConnections === 0 ? true : !(this.isFloating() || this._jsPlumb.maxConnections < 0 || this.connections.length < this._jsPlumb.maxConnections);\r\n        },\r\n        /**\r\n         * private but needs to be exposed.\r\n         */\r\n        isFloating: function () {\r\n            return this.anchor != null && this.anchor.isFloating;\r\n        },\r\n        isConnectedTo: function (endpoint) {\r\n            var found = false;\r\n            if (endpoint) {\r\n                for (var i = 0; i < this.connections.length; i++) {\r\n                    if (this.connections[i].endpoints[1] === endpoint || this.connections[i].endpoints[0] === endpoint) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return found;\r\n        },\r\n        getConnectionCost: function () {\r\n            return this._jsPlumb.connectionCost;\r\n        },\r\n        setConnectionCost: function (c) {\r\n            this._jsPlumb.connectionCost = c;\r\n        },\r\n        areConnectionsDirected: function () {\r\n            return this._jsPlumb.connectionsDirected;\r\n        },\r\n        setConnectionsDirected: function (b) {\r\n            this._jsPlumb.connectionsDirected = b;\r\n        },\r\n        setElementId: function (_elId) {\r\n            this.elementId = _elId;\r\n            this.anchor.elementId = _elId;\r\n        },\r\n        setReferenceElement: function (_el) {\r\n            this.element = _jp.getElement(_el);\r\n        },\r\n        setDragAllowedWhenFull: function (allowed) {\r\n            this.dragAllowedWhenFull = allowed;\r\n        },\r\n        equals: function (endpoint) {\r\n            return this.anchor.equals(endpoint.anchor);\r\n        },\r\n        getUuid: function () {\r\n            return this._jsPlumb.uuid;\r\n        },\r\n        computeAnchor: function (params) {\r\n            return this.anchor.compute(params);\r\n        }\r\n    });\r\n\r\n    root.jsPlumbInstance.prototype.EndpointDropHandler = function (dhParams) {\r\n        return function (e) {\r\n\r\n            var _jsPlumb = dhParams.jsPlumb;\r\n\r\n            // remove the classes that are added dynamically. drop is neither forbidden nor allowed now that\r\n            // the drop is finishing.\r\n            dhParams.removeClass(_jsPlumb.endpointDropAllowedClass);\r\n            dhParams.removeClass(_jsPlumb.endpointDropForbiddenClass);\r\n\r\n            var originalEvent = _jsPlumb.getDropEvent(arguments),\r\n                draggable = _jsPlumb.getDragObject(arguments),\r\n                id = _jsPlumb.getAttribute(draggable, \"dragId\"),\r\n                elId = _jsPlumb.getAttribute(draggable, \"elId\"),\r\n                scope = _jsPlumb.getAttribute(draggable, \"originalScope\"),\r\n                jpc = _jsPlumb.getFloatingConnectionFor(id);\r\n\r\n            // if no active connection, bail.\r\n            if (jpc == null) {\r\n                return;\r\n            }\r\n\r\n            // calculate if this is an existing connection.\r\n            var existingConnection = jpc.suspendedEndpoint != null;\r\n\r\n            // if suspended endpoint exists but has been cleaned up, bail. This means it's an existing connection\r\n            // that has been detached and will shortly be discarded.\r\n            if (existingConnection && jpc.suspendedEndpoint._jsPlumb == null) {\r\n                return;\r\n            }\r\n\r\n            // get the drop endpoint. for a normal connection this is just the one that would replace the currently\r\n            // floating endpoint. for a makeTarget this is a new endpoint that is created on drop. But we leave that to\r\n            // the handler to figure out.\r\n            var _ep = dhParams.getEndpoint(jpc);\r\n\r\n            // If we're not given an endpoint to use, bail.\r\n            if (_ep == null) {\r\n                return;\r\n            }\r\n\r\n            // if this is a drop back where the connection came from, mark it force reattach and\r\n            // return; the stop handler will reattach. without firing an event.\r\n            if (dhParams.isRedrop(jpc, dhParams)) {\r\n                jpc._forceReattach = true;\r\n                jpc.setHover(false);\r\n                if (dhParams.maybeCleanup) {\r\n                    dhParams.maybeCleanup(_ep);\r\n                }\r\n                return;\r\n            }\r\n\r\n            // ensure we dont bother trying to drop sources on non-source eps, and same for target.\r\n            var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\r\n            if ((idx === 0 && !dhParams.isSource)|| (idx === 1 && !dhParams.isTarget)){\r\n                if (dhParams.maybeCleanup) {\r\n                    dhParams.maybeCleanup(_ep);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (dhParams.onDrop) {\r\n                dhParams.onDrop(jpc);\r\n            }\r\n\r\n            // restore the original scope if necessary (issue 57)\r\n            if (scope) {\r\n                _jsPlumb.setDragScope(draggable, scope);\r\n            }\r\n\r\n            // if the target of the drop is full, fire an event (we abort below)\r\n            // makeTarget: keep.\r\n            var isFull = dhParams.isFull(e);\r\n            if (isFull) {\r\n                _ep.fire(\"maxConnections\", {\r\n                    endpoint: this,\r\n                    connection: jpc,\r\n                    maxConnections: _ep._jsPlumb.maxConnections\r\n                }, originalEvent);\r\n            }\r\n            //\r\n            // if endpoint enabled, not full, and matches the index of the floating endpoint...\r\n            if (!isFull &&  dhParams.enabled()) {\r\n                var _doContinue = true;\r\n\r\n                // before testing for beforeDrop, reset the connection's source/target to be the actual DOM elements\r\n                // involved (that is, stash any temporary stuff used for dragging. but we need to keep it around in\r\n                // order that the anchor manager can clean things up properly).\r\n                if (idx === 0) {\r\n                    jpc.floatingElement = jpc.source;\r\n                    jpc.floatingId = jpc.sourceId;\r\n                    jpc.floatingEndpoint = jpc.endpoints[0];\r\n                    jpc.floatingIndex = 0;\r\n                    jpc.source = dhParams.element;\r\n                    jpc.sourceId = dhParams.elementId;\r\n                } else {\r\n                    jpc.floatingElement = jpc.target;\r\n                    jpc.floatingId = jpc.targetId;\r\n                    jpc.floatingEndpoint = jpc.endpoints[1];\r\n                    jpc.floatingIndex = 1;\r\n                    jpc.target = dhParams.element;\r\n                    jpc.targetId = dhParams.elementId;\r\n                }\r\n\r\n                // if this is an existing connection and detach is not allowed we won't continue. The connection's\r\n                // endpoints have been reinstated; everything is back to how it was.\r\n                if (existingConnection && jpc.suspendedEndpoint.id !== _ep.id) {\r\n                    if (!jpc.isDetachAllowed(jpc) || !jpc.endpoints[idx].isDetachAllowed(jpc) || !jpc.suspendedEndpoint.isDetachAllowed(jpc) || !_jsPlumb.checkCondition(\"beforeDetach\", jpc)) {\r\n                        _doContinue = false;\r\n                    }\r\n                }\r\n\r\n// ------------ wrap the execution path in a function so we can support asynchronous beforeDrop\r\n\r\n                var continueFunction = function (optionalData) {\r\n                    // remove this jpc from the current endpoint, which is a floating endpoint that we will\r\n                    // subsequently discard.\r\n                    jpc.endpoints[idx].detachFromConnection(jpc);\r\n\r\n                    // if there's a suspended endpoint, detach it from the connection.\r\n                    if (jpc.suspendedEndpoint) {\r\n                        jpc.suspendedEndpoint.detachFromConnection(jpc);\r\n                    }\r\n\r\n                    jpc.endpoints[idx] = _ep;\r\n                    _ep.addConnection(jpc);\r\n\r\n                    // copy our parameters in to the connection:\r\n                    var params = _ep.getParameters();\r\n                    for (var aParam in params) {\r\n                        jpc.setParameter(aParam, params[aParam]);\r\n                    }\r\n\r\n                    if (!existingConnection) {\r\n                        // if not an existing connection and\r\n                        if (params.draggable) {\r\n                            _jsPlumb.initDraggable(this.element, dhParams.dragOptions, \"internal\", _jsPlumb);\r\n                        }\r\n                    }\r\n                    else {\r\n                        var suspendedElementId = jpc.suspendedEndpoint.elementId;\r\n                        _jsPlumb.fireMoveEvent({\r\n                            index: idx,\r\n                            originalSourceId: idx === 0 ? suspendedElementId : jpc.sourceId,\r\n                            newSourceId: idx === 0 ? _ep.elementId : jpc.sourceId,\r\n                            originalTargetId: idx === 1 ? suspendedElementId : jpc.targetId,\r\n                            newTargetId: idx === 1 ? _ep.elementId : jpc.targetId,\r\n                            originalSourceEndpoint: idx === 0 ? jpc.suspendedEndpoint : jpc.endpoints[0],\r\n                            newSourceEndpoint: idx === 0 ? _ep : jpc.endpoints[0],\r\n                            originalTargetEndpoint: idx === 1 ? jpc.suspendedEndpoint : jpc.endpoints[1],\r\n                            newTargetEndpoint: idx === 1 ? _ep : jpc.endpoints[1],\r\n                            connection: jpc\r\n                        }, originalEvent);\r\n                    }\r\n\r\n                    if (idx === 1) {\r\n                        _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\r\n                    }\r\n                    else {\r\n                        _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\r\n                    }\r\n\r\n                    // when makeSource has uniqueEndpoint:true, we want to create connections with new endpoints\r\n                    // that are subsequently deleted. So makeSource sets `finalEndpoint`, which is the Endpoint to\r\n                    // which the connection should be attached. The `detachFromConnection` call below results in the\r\n                    // temporary endpoint being cleaned up.\r\n                    if (jpc.endpoints[0].finalEndpoint) {\r\n                        var _toDelete = jpc.endpoints[0];\r\n                        _toDelete.detachFromConnection(jpc);\r\n                        jpc.endpoints[0] = jpc.endpoints[0].finalEndpoint;\r\n                        jpc.endpoints[0].addConnection(jpc);\r\n                    }\r\n\r\n                    // if optionalData was given, merge it onto the connection's data.\r\n                    if (_ju.isObject(optionalData)) {\r\n                        jpc.mergeData(optionalData);\r\n                    }\r\n                    // finalise will inform the anchor manager and also add to\r\n                    // connectionsByScope if necessary.\r\n                    _jsPlumb.finaliseConnection(jpc, null, originalEvent, false);\r\n                    jpc.setHover(false);\r\n\r\n                    // SP continuous anchor flush\r\n                    _jsPlumb.revalidate(jpc.endpoints[0].element);\r\n\r\n                }.bind(this);\r\n\r\n                var dontContinueFunction = function () {\r\n                    // otherwise just put it back on the endpoint it was on before the drag.\r\n                    if (jpc.suspendedEndpoint) {\r\n                        jpc.endpoints[idx] = jpc.suspendedEndpoint;\r\n                        jpc.setHover(false);\r\n                        jpc._forceDetach = true;\r\n                        if (idx === 0) {\r\n                            jpc.source = jpc.suspendedEndpoint.element;\r\n                            jpc.sourceId = jpc.suspendedEndpoint.elementId;\r\n                        } else {\r\n                            jpc.target = jpc.suspendedEndpoint.element;\r\n                            jpc.targetId = jpc.suspendedEndpoint.elementId;\r\n                        }\r\n                        jpc.suspendedEndpoint.addConnection(jpc);\r\n\r\n                        // TODO checkSanity\r\n                        if (idx === 1) {\r\n                            _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\r\n                        }\r\n                        else {\r\n                            _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\r\n                        }\r\n\r\n                        _jsPlumb.repaint(jpc.sourceId);\r\n                        jpc._forceDetach = false;\r\n                    }\r\n                };\r\n\r\n// --------------------------------------\r\n                // now check beforeDrop.  this will be available only on Endpoints that are setup to\r\n                // have a beforeDrop condition (although, secretly, under the hood all Endpoints and\r\n                // the Connection have them, because they are on jsPlumbUIComponent.  shhh!), because\r\n                // it only makes sense to have it on a target endpoint.\r\n                _doContinue = _doContinue && dhParams.isDropAllowed(jpc.sourceId, jpc.targetId, jpc.scope, jpc, _ep);// && jpc.pending;\r\n\r\n                if (_doContinue) {\r\n                    continueFunction(_doContinue);\r\n                    return true;\r\n                }\r\n                else {\r\n                    dontContinueFunction();\r\n                }\r\n            }\r\n\r\n            if (dhParams.maybeCleanup) {\r\n                dhParams.maybeCleanup(_ep);\r\n            }\r\n\r\n            _jsPlumb.currentlyDragging = false;\r\n        };\r\n    };\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * This file contains the code for Connections.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this,\r\n        _jp = root.jsPlumb,\r\n        _ju = root.jsPlumbUtil;\r\n\r\n    var makeConnector = function (_jsPlumb, renderMode, connectorName, connectorArgs, forComponent) {\r\n            // first make sure we have a cache for the specified renderer\r\n            _jp.Connectors[renderMode] = _jp.Connectors[renderMode] || {};\r\n\r\n            // now see if the one we want exists; if not we will try to make it\r\n            if (_jp.Connectors[renderMode][connectorName] == null) {\r\n\r\n                if (_jp.Connectors[connectorName] == null) {\r\n                    if (!_jsPlumb.Defaults.DoNotThrowErrors) {\r\n                        throw new TypeError(\"jsPlumb: unknown connector type '\" + connectorName + \"'\");\r\n                    } else {\r\n                        return null;\r\n                    }\r\n                }\r\n\r\n                _jp.Connectors[renderMode][connectorName] = function() {\r\n                    _jp.Connectors[connectorName].apply(this, arguments);\r\n                    _jp.ConnectorRenderers[renderMode].apply(this, arguments);\r\n                };\r\n\r\n                _ju.extend(_jp.Connectors[renderMode][connectorName], [ _jp.Connectors[connectorName], _jp.ConnectorRenderers[renderMode]]);\r\n\r\n            }\r\n\r\n            return new _jp.Connectors[renderMode][connectorName](connectorArgs, forComponent);\r\n        },\r\n        _makeAnchor = function (anchorParams, elementId, _jsPlumb) {\r\n            return (anchorParams) ? _jsPlumb.makeAnchor(anchorParams, elementId, _jsPlumb) : null;\r\n        },\r\n        _updateConnectedClass = function (conn, element, _jsPlumb, remove) {\r\n            if (element != null) {\r\n                element._jsPlumbConnections = element._jsPlumbConnections || {};\r\n                if (remove) {\r\n                    delete element._jsPlumbConnections[conn.id];\r\n                }\r\n                else {\r\n                    element._jsPlumbConnections[conn.id] = true;\r\n                }\r\n\r\n                if (_ju.isEmpty(element._jsPlumbConnections)) {\r\n                    _jsPlumb.removeClass(element, _jsPlumb.connectedClass);\r\n                }\r\n                else {\r\n                    _jsPlumb.addClass(element, _jsPlumb.connectedClass);\r\n                }\r\n            }\r\n        };\r\n\r\n    _jp.Connection = function (params) {\r\n        var _newEndpoint = params.newEndpoint;\r\n\r\n        this.id = params.id;\r\n        this.connector = null;\r\n        this.idPrefix = \"_jsplumb_c_\";\r\n        this.defaultLabelLocation = 0.5;\r\n        this.defaultOverlayKeys = [\"Overlays\", \"ConnectionOverlays\"];\r\n        // if a new connection is the result of moving some existing connection, params.previousConnection\r\n        // will have that Connection in it. listeners for the jsPlumbConnection event can look for that\r\n        // member and take action if they need to.\r\n        this.previousConnection = params.previousConnection;\r\n        this.source = _jp.getElement(params.source);\r\n        this.target = _jp.getElement(params.target);\r\n\r\n\r\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\r\n\r\n        // sourceEndpoint and targetEndpoint override source/target, if they are present. but\r\n        // source is not overridden if the Endpoint has declared it is not the final target of a connection;\r\n        // instead we use the source that the Endpoint declares will be the final source element.\r\n        if (params.sourceEndpoint) {\r\n            this.source = params.sourceEndpoint.getElement();\r\n            this.sourceId = params.sourceEndpoint.elementId;\r\n        } else {\r\n            this.sourceId = this._jsPlumb.instance.getId(this.source);\r\n        }\r\n\r\n        if (params.targetEndpoint) {\r\n            this.target = params.targetEndpoint.getElement();\r\n            this.targetId = params.targetEndpoint.elementId;\r\n        } else {\r\n            this.targetId = this._jsPlumb.instance.getId(this.target);\r\n        }\r\n\r\n\r\n        this.scope = params.scope; // scope may have been passed in to the connect call. if it wasn't, we will pull it from the source endpoint, after having initialised the endpoints.\r\n        this.endpoints = [];\r\n        this.endpointStyles = [];\r\n\r\n        var _jsPlumb = this._jsPlumb.instance;\r\n\r\n        _jsPlumb.manage(this.sourceId, this.source);\r\n        _jsPlumb.manage(this.targetId, this.target);\r\n\r\n        this._jsPlumb.visible = true;\r\n\r\n        this._jsPlumb.params = {\r\n            cssClass: params.cssClass,\r\n            container: params.container,\r\n            \"pointer-events\": params[\"pointer-events\"],\r\n            editorParams: params.editorParams,\r\n            overlays: params.overlays\r\n        };\r\n        this._jsPlumb.lastPaintedAt = null;\r\n\r\n        // listen to mouseover and mouseout events passed from the container delegate.\r\n        this.bind(\"mouseover\", function () {\r\n            this.setHover(true);\r\n        }.bind(this));\r\n        this.bind(\"mouseout\", function () {\r\n            this.setHover(false);\r\n        }.bind(this));\r\n\r\n\r\n// INITIALISATION CODE\r\n\r\n        this.makeEndpoint = function (isSource, el, elId, ep, definition) {\r\n            elId = elId || this._jsPlumb.instance.getId(el);\r\n            return this.prepareEndpoint(_jsPlumb, _newEndpoint, this, ep, isSource ? 0 : 1, params, el, elId, definition);\r\n        };\r\n\r\n        // if type given, get the endpoint definitions mapping to that type from the jsplumb instance, and use those.\r\n        // we apply types at the end of this constructor but endpoints are only honoured in a type definition at\r\n        // create time.\r\n        if (params.type) {\r\n            params.endpoints = params.endpoints || this._jsPlumb.instance.deriveEndpointAndAnchorSpec(params.type).endpoints;\r\n        }\r\n\r\n        var eS = this.makeEndpoint(true, this.source, this.sourceId, params.sourceEndpoint),\r\n            eT = this.makeEndpoint(false, this.target, this.targetId, params.targetEndpoint);\r\n\r\n        if (eS) {\r\n            _ju.addToList(params.endpointsByElement, this.sourceId, eS);\r\n        }\r\n        if (eT) {\r\n            _ju.addToList(params.endpointsByElement, this.targetId, eT);\r\n        }\r\n        // if scope not set, set it to be the scope for the source endpoint.\r\n        if (!this.scope) {\r\n            this.scope = this.endpoints[0].scope;\r\n        }\r\n\r\n        // if explicitly told to (or not to) delete endpoints when empty, override endpoint's preferences\r\n        if (params.deleteEndpointsOnEmpty != null) {\r\n            this.endpoints[0].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\r\n            this.endpoints[1].setDeleteOnEmpty(params.deleteEndpointsOnEmpty);\r\n        }\r\n\r\n// -------------------------- DEFAULT TYPE ---------------------------------------------\r\n\r\n        // DETACHABLE\r\n        var _detachable = _jsPlumb.Defaults.ConnectionsDetachable;\r\n        if (params.detachable === false) {\r\n            _detachable = false;\r\n        }\r\n        if (this.endpoints[0].connectionsDetachable === false) {\r\n            _detachable = false;\r\n        }\r\n        if (this.endpoints[1].connectionsDetachable === false) {\r\n            _detachable = false;\r\n        }\r\n        // REATTACH\r\n        var _reattach = params.reattach || this.endpoints[0].reattachConnections || this.endpoints[1].reattachConnections || _jsPlumb.Defaults.ReattachConnections;\r\n\r\n        this.appendToDefaultType({\r\n            detachable: _detachable,\r\n            reattach: _reattach,\r\n            paintStyle:this.endpoints[0].connectorStyle || this.endpoints[1].connectorStyle || params.paintStyle || _jsPlumb.Defaults.PaintStyle || _jp.Defaults.PaintStyle,\r\n            hoverPaintStyle:this.endpoints[0].connectorHoverStyle || this.endpoints[1].connectorHoverStyle || params.hoverPaintStyle || _jsPlumb.Defaults.HoverPaintStyle || _jp.Defaults.HoverPaintStyle\r\n        });\r\n\r\n        var _suspendedAt = _jsPlumb.getSuspendedAt();\r\n        if (!_jsPlumb.isSuspendDrawing()) {\r\n            // paint the endpoints\r\n            var myInfo = _jsPlumb.getCachedData(this.sourceId),\r\n                myOffset = myInfo.o, myWH = myInfo.s,\r\n                otherInfo = _jsPlumb.getCachedData(this.targetId),\r\n                otherOffset = otherInfo.o,\r\n                otherWH = otherInfo.s,\r\n                initialTimestamp = _suspendedAt || _jsPlumb.timestamp(),\r\n                anchorLoc = this.endpoints[0].anchor.compute({\r\n                    xy: [ myOffset.left, myOffset.top ], wh: myWH, element: this.endpoints[0],\r\n                    elementId: this.endpoints[0].elementId,\r\n                    txy: [ otherOffset.left, otherOffset.top ], twh: otherWH, tElement: this.endpoints[1],\r\n                    timestamp: initialTimestamp\r\n                });\r\n\r\n            this.endpoints[0].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\r\n\r\n            anchorLoc = this.endpoints[1].anchor.compute({\r\n                xy: [ otherOffset.left, otherOffset.top ], wh: otherWH, element: this.endpoints[1],\r\n                elementId: this.endpoints[1].elementId,\r\n                txy: [ myOffset.left, myOffset.top ], twh: myWH, tElement: this.endpoints[0],\r\n                timestamp: initialTimestamp\r\n            });\r\n            this.endpoints[1].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\r\n        }\r\n\r\n        this.getTypeDescriptor = function () {\r\n            return \"connection\";\r\n        };\r\n        this.getAttachedElements = function () {\r\n            return this.endpoints;\r\n        };\r\n\r\n        this.isDetachable = function (ep) {\r\n            return this._jsPlumb.detachable === false ? false : ep != null ? ep.connectionsDetachable === true : this._jsPlumb.detachable === true;\r\n        };\r\n        this.setDetachable = function (detachable) {\r\n            this._jsPlumb.detachable = detachable === true;\r\n        };\r\n        this.isReattach = function () {\r\n            return this._jsPlumb.reattach === true || this.endpoints[0].reattachConnections === true || this.endpoints[1].reattachConnections === true;\r\n        };\r\n        this.setReattach = function (reattach) {\r\n            this._jsPlumb.reattach = reattach === true;\r\n        };\r\n\r\n// END INITIALISATION CODE\r\n\r\n\r\n// COST + DIRECTIONALITY\r\n        // if cost not supplied, try to inherit from source endpoint\r\n        this._jsPlumb.cost = params.cost || this.endpoints[0].getConnectionCost();\r\n        this._jsPlumb.directed = params.directed;\r\n        // inherit directed flag if set no source endpoint\r\n        if (params.directed == null) {\r\n            this._jsPlumb.directed = this.endpoints[0].areConnectionsDirected();\r\n        }\r\n// END COST + DIRECTIONALITY\r\n\r\n// PARAMETERS\r\n        // merge all the parameters objects into the connection.  parameters set\r\n        // on the connection take precedence; then source endpoint params, then\r\n        // finally target endpoint params.\r\n        var _p = _jp.extend({}, this.endpoints[1].getParameters());\r\n        _jp.extend(_p, this.endpoints[0].getParameters());\r\n        _jp.extend(_p, this.getParameters());\r\n        this.setParameters(_p);\r\n// END PARAMETERS\r\n\r\n// PAINTING\r\n\r\n        this.setConnector(this.endpoints[0].connector || this.endpoints[1].connector || params.connector || _jsPlumb.Defaults.Connector || _jp.Defaults.Connector, true);\r\n        var data = params.data == null || !_ju.isObject(params.data) ? {} : params.data;\r\n        this.getData = function() { return data; };\r\n        this.setData = function(d) { data = d || {}; };\r\n        this.mergeData = function(d) { data = _jp.extend(data, d); };\r\n\r\n        // the very last thing we do is apply types, if there are any.\r\n        var _types = [ \"default\", this.endpoints[0].connectionType, this.endpoints[1].connectionType,  params.type ].join(\" \");\r\n        if (/[^\\s]/.test(_types)) {\r\n            this.addType(_types, params.data, true);\r\n        }\r\n\r\n        this.updateConnectedClass();\r\n\r\n// END PAINTING\r\n    };\r\n\r\n    _ju.extend(_jp.Connection, _jp.OverlayCapableJsPlumbUIComponent, {\r\n        applyType: function (t, doNotRepaint, typeMap) {\r\n\r\n            var _connector = null;\r\n            if (t.connector != null) {\r\n                _connector = this.getCachedTypeItem(\"connector\", typeMap.connector);\r\n                if (_connector == null) {\r\n                    _connector = this.prepareConnector(t.connector, typeMap.connector);\r\n                    this.cacheTypeItem(\"connector\", _connector, typeMap.connector);\r\n                }\r\n                this.setPreparedConnector(_connector);\r\n            }\r\n\r\n            // none of these things result in the creation of objects so can be ignored.\r\n            if (t.detachable != null) {\r\n                this.setDetachable(t.detachable);\r\n            }\r\n            if (t.reattach != null) {\r\n                this.setReattach(t.reattach);\r\n            }\r\n            if (t.scope) {\r\n                this.scope = t.scope;\r\n            }\r\n\r\n            if (t.cssClass != null && this.canvas) {\r\n                this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\r\n            }\r\n\r\n            var _anchors = null;\r\n            // this also results in the creation of objects.\r\n            if (t.anchor) {\r\n                // note that even if the param was anchor, we store `anchors`.\r\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchor);\r\n                if (_anchors == null) {\r\n                    _anchors = [ this._jsPlumb.instance.makeAnchor(t.anchor), this._jsPlumb.instance.makeAnchor(t.anchor) ];\r\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchor);\r\n                }\r\n            }\r\n            else if (t.anchors) {\r\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchors);\r\n                if (_anchors == null) {\r\n                    _anchors = [\r\n                        this._jsPlumb.instance.makeAnchor(t.anchors[0]),\r\n                        this._jsPlumb.instance.makeAnchor(t.anchors[1])\r\n                    ];\r\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchors);\r\n                }\r\n            }\r\n            if (_anchors != null) {\r\n                this.endpoints[0].anchor = _anchors[0];\r\n                this.endpoints[1].anchor = _anchors[1];\r\n                if (this.endpoints[1].anchor.isDynamic) {\r\n                    this._jsPlumb.instance.repaint(this.endpoints[1].elementId);\r\n                }\r\n            }\r\n\r\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\r\n        },\r\n        addClass: function (c, informEndpoints) {\r\n            if (informEndpoints) {\r\n                this.endpoints[0].addClass(c);\r\n                this.endpoints[1].addClass(c);\r\n                if (this.suspendedEndpoint) {\r\n                    this.suspendedEndpoint.addClass(c);\r\n                }\r\n            }\r\n            if (this.connector) {\r\n                this.connector.addClass(c);\r\n            }\r\n        },\r\n        removeClass: function (c, informEndpoints) {\r\n            if (informEndpoints) {\r\n                this.endpoints[0].removeClass(c);\r\n                this.endpoints[1].removeClass(c);\r\n                if (this.suspendedEndpoint) {\r\n                    this.suspendedEndpoint.removeClass(c);\r\n                }\r\n            }\r\n            if (this.connector) {\r\n                this.connector.removeClass(c);\r\n            }\r\n        },\r\n        isVisible: function () {\r\n            return this._jsPlumb.visible;\r\n        },\r\n        setVisible: function (v) {\r\n            this._jsPlumb.visible = v;\r\n            if (this.connector) {\r\n                this.connector.setVisible(v);\r\n            }\r\n            this.repaint();\r\n        },\r\n        cleanup: function () {\r\n            this.updateConnectedClass(true);\r\n            this.endpoints = null;\r\n            this.source = null;\r\n            this.target = null;\r\n            if (this.connector != null) {\r\n                this.connector.cleanup(true);\r\n                this.connector.destroy(true);\r\n            }\r\n            this.connector = null;\r\n        },\r\n        updateConnectedClass:function(remove) {\r\n            if (this._jsPlumb) {\r\n                _updateConnectedClass(this, this.source, this._jsPlumb.instance, remove);\r\n                _updateConnectedClass(this, this.target, this._jsPlumb.instance, remove);\r\n            }\r\n        },\r\n        setHover: function (state) {\r\n            if (this.connector && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\r\n                this.connector.setHover(state);\r\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.source, this._jsPlumb.instance.hoverSourceClass);\r\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.target, this._jsPlumb.instance.hoverTargetClass);\r\n            }\r\n        },\r\n        getUuids:function() {\r\n            return [ this.endpoints[0].getUuid(), this.endpoints[1].getUuid() ];\r\n        },\r\n        getCost: function () {\r\n            return this._jsPlumb ? this._jsPlumb.cost : -Infinity;\r\n        },\r\n        setCost: function (c) {\r\n            this._jsPlumb.cost = c;\r\n        },\r\n        isDirected: function () {\r\n            return this._jsPlumb.directed;\r\n        },\r\n        getConnector: function () {\r\n            return this.connector;\r\n        },\r\n        prepareConnector:function(connectorSpec, typeId) {\r\n            var connectorArgs = {\r\n                    _jsPlumb: this._jsPlumb.instance,\r\n                    cssClass: this._jsPlumb.params.cssClass,\r\n                    container: this._jsPlumb.params.container,\r\n                    \"pointer-events\": this._jsPlumb.params[\"pointer-events\"]\r\n                },\r\n                renderMode = this._jsPlumb.instance.getRenderMode(),\r\n                connector;\r\n\r\n            if (_ju.isString(connectorSpec)) {\r\n                connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec, connectorArgs, this);\r\n            } // lets you use a string as shorthand.\r\n            else if (_ju.isArray(connectorSpec)) {\r\n                if (connectorSpec.length === 1) {\r\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], connectorArgs, this);\r\n                }\r\n                else {\r\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], _ju.merge(connectorSpec[1], connectorArgs), this);\r\n                }\r\n            }\r\n            if (typeId != null) {\r\n                connector.typeId = typeId;\r\n            }\r\n            return connector;\r\n        },\r\n        setPreparedConnector: function(connector, doNotRepaint, doNotChangeListenerComponent, typeId) {\r\n\r\n            if (this.connector !== connector) {\r\n\r\n                var previous, previousClasses = \"\";\r\n                // the connector will not be cleaned up if it was set as part of a type, because `typeId` will be set on it\r\n                // and we havent passed in `true` for \"force\" here.\r\n                if (this.connector != null) {\r\n                    previous = this.connector;\r\n                    previousClasses = previous.getClass();\r\n                    this.connector.cleanup();\r\n                    this.connector.destroy();\r\n                }\r\n\r\n                this.connector = connector;\r\n                if (typeId) {\r\n                    this.cacheTypeItem(\"connector\", connector, typeId);\r\n                }\r\n\r\n                this.canvas = this.connector.canvas;\r\n                this.bgCanvas = this.connector.bgCanvas;\r\n\r\n                this.connector.reattach(this._jsPlumb.instance);\r\n\r\n                // put classes from prior connector onto the canvas\r\n                this.addClass(previousClasses);\r\n\r\n                // new: instead of binding listeners per connector, we now just have one delegate on the container.\r\n                // so for that handler we set the connection as the '_jsPlumb' member of the canvas element, and\r\n                // bgCanvas, if it exists, which it does right now in the VML renderer, so it won't from v 2.0.0 onwards.\r\n                if (this.canvas) {\r\n                    this.canvas._jsPlumb = this;\r\n                }\r\n                if (this.bgCanvas) {\r\n                    this.bgCanvas._jsPlumb = this;\r\n                }\r\n\r\n                if (previous != null) {\r\n                    var o = this.getOverlays();\r\n                    for (var i = 0; i < o.length; i++) {\r\n                        if (o[i].transfer) {\r\n                            o[i].transfer(this.connector);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (!doNotChangeListenerComponent) {\r\n                    this.setListenerComponent(this.connector);\r\n                }\r\n                if (!doNotRepaint) {\r\n                    this.repaint();\r\n                }\r\n            }\r\n        },\r\n        setConnector: function (connectorSpec, doNotRepaint, doNotChangeListenerComponent, typeId) {\r\n            var connector = this.prepareConnector(connectorSpec, typeId);\r\n            this.setPreparedConnector(connector, doNotRepaint, doNotChangeListenerComponent, typeId);\r\n        },\r\n        paint: function (params) {\r\n\r\n            if (!this._jsPlumb.instance.isSuspendDrawing() && this._jsPlumb.visible) {\r\n                params = params || {};\r\n                var timestamp = params.timestamp,\r\n                    // if the moving object is not the source we must transpose the two references.\r\n                    swap = false,\r\n                    tId = swap ? this.sourceId : this.targetId, sId = swap ? this.targetId : this.sourceId,\r\n                    tIdx = swap ? 0 : 1, sIdx = swap ? 1 : 0;\r\n\r\n                if (timestamp == null || timestamp !== this._jsPlumb.lastPaintedAt) {\r\n                    var sourceInfo = this._jsPlumb.instance.updateOffset({elId:sId}).o,\r\n                        targetInfo = this._jsPlumb.instance.updateOffset({elId:tId}).o,\r\n                        sE = this.endpoints[sIdx], tE = this.endpoints[tIdx];\r\n\r\n                    var sAnchorP = sE.anchor.getCurrentLocation({xy: [sourceInfo.left, sourceInfo.top], wh: [sourceInfo.width, sourceInfo.height], element: sE, timestamp: timestamp}),\r\n                        tAnchorP = tE.anchor.getCurrentLocation({xy: [targetInfo.left, targetInfo.top], wh: [targetInfo.width, targetInfo.height], element: tE, timestamp: timestamp});\r\n\r\n                    this.connector.resetBounds();\r\n\r\n                    this.connector.compute({\r\n                        sourcePos: sAnchorP,\r\n                        targetPos: tAnchorP,\r\n                        sourceOrientation:sE.anchor.getOrientation(sE),\r\n                        targetOrientation:tE.anchor.getOrientation(tE),\r\n                        sourceEndpoint: this.endpoints[sIdx],\r\n                        targetEndpoint: this.endpoints[tIdx],\r\n                        \"stroke-width\": this._jsPlumb.paintStyleInUse.strokeWidth,\r\n                        sourceInfo: sourceInfo,\r\n                        targetInfo: targetInfo\r\n                    });\r\n\r\n                    var overlayExtents = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\r\n\r\n                    // compute overlays. we do this first so we can get their placements, and adjust the\r\n                    // container if needs be (if an overlay would be clipped)\r\n                    for (var i in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\r\n                            var o = this._jsPlumb.overlays[i];\r\n                            if (o.isVisible()) {\r\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.connector, this._jsPlumb.paintStyleInUse, this.getAbsoluteOverlayPosition(o));\r\n                                overlayExtents.minX = Math.min(overlayExtents.minX, this._jsPlumb.overlayPlacements[i].minX);\r\n                                overlayExtents.maxX = Math.max(overlayExtents.maxX, this._jsPlumb.overlayPlacements[i].maxX);\r\n                                overlayExtents.minY = Math.min(overlayExtents.minY, this._jsPlumb.overlayPlacements[i].minY);\r\n                                overlayExtents.maxY = Math.max(overlayExtents.maxY, this._jsPlumb.overlayPlacements[i].maxY);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    var lineWidth = parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth || 1) / 2,\r\n                        outlineWidth = parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth || 0),\r\n                        extents = {\r\n                            xmin: Math.min(this.connector.bounds.minX - (lineWidth + outlineWidth), overlayExtents.minX),\r\n                            ymin: Math.min(this.connector.bounds.minY - (lineWidth + outlineWidth), overlayExtents.minY),\r\n                            xmax: Math.max(this.connector.bounds.maxX + (lineWidth + outlineWidth), overlayExtents.maxX),\r\n                            ymax: Math.max(this.connector.bounds.maxY + (lineWidth + outlineWidth), overlayExtents.maxY)\r\n                        };\r\n                    // paint the connector.\r\n                    this.connector.paintExtents = extents;\r\n                    this.connector.paint(this._jsPlumb.paintStyleInUse, null, extents);\r\n                    // and then the overlays\r\n                    for (var j in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(j)) {\r\n                            var p = this._jsPlumb.overlays[j];\r\n                            if (p.isVisible()) {\r\n                                p.paint(this._jsPlumb.overlayPlacements[j], extents);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                this._jsPlumb.lastPaintedAt = timestamp;\r\n            }\r\n        },\r\n        repaint: function (params) {\r\n            var p = jsPlumb.extend(params || {}, {});\r\n            p.elId = this.sourceId;\r\n            this.paint(p);\r\n        },\r\n        prepareEndpoint: function (_jsPlumb, _newEndpoint, conn, existing, index, params, element, elementId, definition) {\r\n            var e;\r\n            if (existing) {\r\n                conn.endpoints[index] = existing;\r\n                existing.addConnection(conn);\r\n            } else {\r\n                if (!params.endpoints) {\r\n                    params.endpoints = [ null, null ];\r\n                }\r\n                var ep = definition || params.endpoints[index] || params.endpoint || _jsPlumb.Defaults.Endpoints[index] || _jp.Defaults.Endpoints[index] || _jsPlumb.Defaults.Endpoint || _jp.Defaults.Endpoint;\r\n                if (!params.endpointStyles) {\r\n                    params.endpointStyles = [ null, null ];\r\n                }\r\n                if (!params.endpointHoverStyles) {\r\n                    params.endpointHoverStyles = [ null, null ];\r\n                }\r\n                var es = params.endpointStyles[index] || params.endpointStyle || _jsPlumb.Defaults.EndpointStyles[index] || _jp.Defaults.EndpointStyles[index] || _jsPlumb.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle;\r\n                // Endpoints derive their fill from the connector's stroke, if no fill was specified.\r\n                if (es.fill == null && params.paintStyle != null) {\r\n                    es.fill = params.paintStyle.stroke;\r\n                }\r\n\r\n                if (es.outlineStroke == null && params.paintStyle != null) {\r\n                    es.outlineStroke = params.paintStyle.outlineStroke;\r\n                }\r\n                if (es.outlineWidth == null && params.paintStyle != null) {\r\n                    es.outlineWidth = params.paintStyle.outlineWidth;\r\n                }\r\n\r\n                var ehs = params.endpointHoverStyles[index] || params.endpointHoverStyle || _jsPlumb.Defaults.EndpointHoverStyles[index] || _jp.Defaults.EndpointHoverStyles[index] || _jsPlumb.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle;\r\n                // endpoint hover fill style is derived from connector's hover stroke style\r\n                if (params.hoverPaintStyle != null) {\r\n                    if (ehs == null) {\r\n                        ehs = {};\r\n                    }\r\n                    if (ehs.fill == null) {\r\n                        ehs.fill = params.hoverPaintStyle.stroke;\r\n                    }\r\n                }\r\n                var a = params.anchors ? params.anchors[index] :\r\n                    params.anchor ? params.anchor :\r\n                        _makeAnchor(_jsPlumb.Defaults.Anchors[index], elementId, _jsPlumb) ||\r\n                        _makeAnchor(_jp.Defaults.Anchors[index], elementId, _jsPlumb) ||\r\n                        _makeAnchor(_jsPlumb.Defaults.Anchor, elementId, _jsPlumb) ||\r\n                        _makeAnchor(_jp.Defaults.Anchor, elementId, _jsPlumb),\r\n                    u = params.uuids ? params.uuids[index] : null;\r\n\r\n                e = _newEndpoint({\r\n                    paintStyle: es, hoverPaintStyle: ehs, endpoint: ep, connections: [ conn ],\r\n                    uuid: u, anchor: a, source: element, scope: params.scope,\r\n                    reattach: params.reattach || _jsPlumb.Defaults.ReattachConnections,\r\n                    detachable: params.detachable || _jsPlumb.Defaults.ConnectionsDetachable\r\n                });\r\n                if (existing == null) {\r\n                    e.setDeleteOnEmpty(true);\r\n                }\r\n                conn.endpoints[index] = e;\r\n\r\n                if (params.drawEndpoints === false) {\r\n                    e.setVisible(false, true, true);\r\n                }\r\n\r\n            }\r\n            return e;\r\n        },\r\n        replaceEndpoint:function(idx, endpointDef) {\r\n\r\n            var current = this.endpoints[idx],\r\n                elId = current.elementId,\r\n                ebe = this._jsPlumb.instance.getEndpoints(elId),\r\n                _idx = ebe.indexOf(current),\r\n                _new = this.makeEndpoint(idx === 0, current.element, elId, null, endpointDef);\r\n\r\n            this.endpoints[idx] = _new;\r\n\r\n            ebe.splice(_idx, 1, _new);\r\n            this._jsPlumb.instance.deleteObject({endpoint:current, deleteAttachedObjects:false});\r\n            this._jsPlumb.instance.fire(\"endpointReplaced\", {previous:current, current:_new});\r\n\r\n            this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId, this.endpoints[1].elementId, this.endpoints[1].elementId, this);\r\n\r\n        }\r\n\r\n    }); // END Connection class\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * This file contains the code for creating and manipulating anchors.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this,\r\n        _ju = root.jsPlumbUtil,\r\n        _jp = root.jsPlumb;\r\n\r\n    //\r\n    // manages anchors for all elements.\r\n    //\r\n    _jp.AnchorManager = function (params) {\r\n        var _amEndpoints = {},\r\n            continuousAnchorLocations = {},\r\n            continuousAnchorOrientations = {},\r\n            connectionsByElementId = {},\r\n            self = this,\r\n            anchorLists = {},\r\n            jsPlumbInstance = params.jsPlumbInstance,\r\n            floatingConnections = {},\r\n            // used by placeAnchors function\r\n            placeAnchorsOnLine = function (desc, elementDimensions, elementPosition, connections, horizontal, otherMultiplier, reverse) {\r\n                var a = [], step = elementDimensions[horizontal ? 0 : 1] / (connections.length + 1);\r\n\r\n                for (var i = 0; i < connections.length; i++) {\r\n                    var val = (i + 1) * step, other = otherMultiplier * elementDimensions[horizontal ? 1 : 0];\r\n                    if (reverse) {\r\n                        val = elementDimensions[horizontal ? 0 : 1] - val;\r\n                    }\r\n\r\n                    var dx = (horizontal ? val : other), x = elementPosition[0] + dx, xp = dx / elementDimensions[0],\r\n                        dy = (horizontal ? other : val), y = elementPosition[1] + dy, yp = dy / elementDimensions[1];\r\n\r\n                    a.push([ x, y, xp, yp, connections[i][1], connections[i][2] ]);\r\n                }\r\n\r\n                return a;\r\n            },\r\n            // used by edgeSortFunctions\r\n            currySort = function (reverseAngles) {\r\n                return function (a, b) {\r\n                    var r = true;\r\n                    if (reverseAngles) {\r\n                        r = a[0][0] < b[0][0];\r\n                    }\r\n                    else {\r\n                        r = a[0][0] > b[0][0];\r\n                    }\r\n                    return r === false ? -1 : 1;\r\n                };\r\n            },\r\n            // used by edgeSortFunctions\r\n            leftSort = function (a, b) {\r\n                // first get adjusted values\r\n                var p1 = a[0][0] < 0 ? -Math.PI - a[0][0] : Math.PI - a[0][0],\r\n                    p2 = b[0][0] < 0 ? -Math.PI - b[0][0] : Math.PI - b[0][0];\r\n                if (p1 > p2) {\r\n                    return 1;\r\n                }\r\n                else {\r\n                    return -1;\r\n                }\r\n            },\r\n            // used by placeAnchors\r\n            edgeSortFunctions = {\r\n                \"top\": function (a, b) {\r\n                    return a[0] > b[0] ? 1 : -1;\r\n                },\r\n                \"right\": currySort(true),\r\n                \"bottom\": currySort(true),\r\n                \"left\": leftSort\r\n            },\r\n            // used by placeAnchors\r\n            _sortHelper = function (_array, _fn) {\r\n                return _array.sort(_fn);\r\n            },\r\n            // used by AnchorManager.redraw\r\n            placeAnchors = function (elementId, _anchorLists) {\r\n                var cd = jsPlumbInstance.getCachedData(elementId), sS = cd.s, sO = cd.o,\r\n                    placeSomeAnchors = function (desc, elementDimensions, elementPosition, unsortedConnections, isHorizontal, otherMultiplier, orientation) {\r\n                        if (unsortedConnections.length > 0) {\r\n                            var sc = _sortHelper(unsortedConnections, edgeSortFunctions[desc]), // puts them in order based on the target element's pos on screen\r\n                                reverse = desc === \"right\" || desc === \"top\",\r\n                                anchors = placeAnchorsOnLine(desc, elementDimensions,\r\n                                    elementPosition, sc,\r\n                                    isHorizontal, otherMultiplier, reverse);\r\n\r\n                            // takes a computed anchor position and adjusts it for parent offset and scroll, then stores it.\r\n                            var _setAnchorLocation = function (endpoint, anchorPos) {\r\n                                continuousAnchorLocations[endpoint.id] = [ anchorPos[0], anchorPos[1], anchorPos[2], anchorPos[3] ];\r\n                                continuousAnchorOrientations[endpoint.id] = orientation;\r\n                            };\r\n\r\n                            for (var i = 0; i < anchors.length; i++) {\r\n                                var c = anchors[i][4], weAreSource = c.endpoints[0].elementId === elementId, weAreTarget = c.endpoints[1].elementId === elementId;\r\n                                if (weAreSource) {\r\n                                    _setAnchorLocation(c.endpoints[0], anchors[i]);\r\n                                }\r\n                                if (weAreTarget) {\r\n                                    _setAnchorLocation(c.endpoints[1], anchors[i]);\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                placeSomeAnchors(\"bottom\", sS, [sO.left, sO.top], _anchorLists.bottom, true, 1, [0, 1]);\r\n                placeSomeAnchors(\"top\", sS, [sO.left, sO.top], _anchorLists.top, true, 0, [0, -1]);\r\n                placeSomeAnchors(\"left\", sS, [sO.left, sO.top], _anchorLists.left, false, 0, [-1, 0]);\r\n                placeSomeAnchors(\"right\", sS, [sO.left, sO.top], _anchorLists.right, false, 1, [1, 0]);\r\n            };\r\n\r\n        this.reset = function () {\r\n            _amEndpoints = {};\r\n            connectionsByElementId = {};\r\n            anchorLists = {};\r\n        };\r\n        this.addFloatingConnection = function (key, conn) {\r\n            floatingConnections[key] = conn;\r\n        };\r\n        this.removeFloatingConnection = function (key) {\r\n            delete floatingConnections[key];\r\n        };\r\n        this.newConnection = function (conn) {\r\n            var sourceId = conn.sourceId, targetId = conn.targetId,\r\n                ep = conn.endpoints,\r\n                doRegisterTarget = true,\r\n                registerConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\r\n                    if ((sourceId === targetId) && otherAnchor.isContinuous) {\r\n                        // remove the target endpoint's canvas.  we dont need it.\r\n                        conn._jsPlumb.instance.removeElement(ep[1].canvas);\r\n                        doRegisterTarget = false;\r\n                    }\r\n                    _ju.addToList(connectionsByElementId, elId, [c, otherEndpoint, otherAnchor.constructor === _jp.DynamicAnchor]);\r\n                };\r\n\r\n            registerConnection(0, ep[0], ep[0].anchor, targetId, conn);\r\n            if (doRegisterTarget) {\r\n                registerConnection(1, ep[1], ep[1].anchor, sourceId, conn);\r\n            }\r\n        };\r\n        var removeEndpointFromAnchorLists = function (endpoint) {\r\n            (function (list, eId) {\r\n                if (list) {  // transient anchors dont get entries in this list.\r\n                    var f = function (e) {\r\n                        return e[4] === eId;\r\n                    };\r\n                    _ju.removeWithFunction(list.top, f);\r\n                    _ju.removeWithFunction(list.left, f);\r\n                    _ju.removeWithFunction(list.bottom, f);\r\n                    _ju.removeWithFunction(list.right, f);\r\n                }\r\n            })(anchorLists[endpoint.elementId], endpoint.id);\r\n        };\r\n        this.connectionDetached = function (connInfo, doNotRedraw) {\r\n            var connection = connInfo.connection || connInfo,\r\n                sourceId = connInfo.sourceId,\r\n                targetId = connInfo.targetId,\r\n                ep = connection.endpoints,\r\n                removeConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\r\n                    _ju.removeWithFunction(connectionsByElementId[elId], function (_c) {\r\n                        return _c[0].id === c.id;\r\n                    });\r\n                };\r\n\r\n            removeConnection(1, ep[1], ep[1].anchor, sourceId, connection);\r\n            removeConnection(0, ep[0], ep[0].anchor, targetId, connection);\r\n            if (connection.floatingId) {\r\n                removeConnection(connection.floatingIndex, connection.floatingEndpoint, connection.floatingEndpoint.anchor, connection.floatingId, connection);\r\n                removeEndpointFromAnchorLists(connection.floatingEndpoint);\r\n            }\r\n\r\n            // remove from anchorLists\r\n            removeEndpointFromAnchorLists(connection.endpoints[0]);\r\n            removeEndpointFromAnchorLists(connection.endpoints[1]);\r\n\r\n            if (!doNotRedraw) {\r\n                self.redraw(connection.sourceId);\r\n                if (connection.targetId !== connection.sourceId) {\r\n                    self.redraw(connection.targetId);\r\n                }\r\n            }\r\n        };\r\n        this.add = function (endpoint, elementId) {\r\n            _ju.addToList(_amEndpoints, elementId, endpoint);\r\n        };\r\n        this.changeId = function (oldId, newId) {\r\n            connectionsByElementId[newId] = connectionsByElementId[oldId];\r\n            _amEndpoints[newId] = _amEndpoints[oldId];\r\n            delete connectionsByElementId[oldId];\r\n            delete _amEndpoints[oldId];\r\n        };\r\n        this.getConnectionsFor = function (elementId) {\r\n            return connectionsByElementId[elementId] || [];\r\n        };\r\n        this.getEndpointsFor = function (elementId) {\r\n            return _amEndpoints[elementId] || [];\r\n        };\r\n        this.deleteEndpoint = function (endpoint) {\r\n            _ju.removeWithFunction(_amEndpoints[endpoint.elementId], function (e) {\r\n                return e.id === endpoint.id;\r\n            });\r\n            removeEndpointFromAnchorLists(endpoint);\r\n        };\r\n        this.clearFor = function (elementId) {\r\n            delete _amEndpoints[elementId];\r\n            _amEndpoints[elementId] = [];\r\n        };\r\n        // updates the given anchor list by either updating an existing anchor's info, or adding it. this function\r\n        // also removes the anchor from its previous list, if the edge it is on has changed.\r\n        // all connections found along the way (those that are connected to one of the faces this function\r\n        // operates on) are added to the connsToPaint list, as are their endpoints. in this way we know to repaint\r\n        // them wthout having to calculate anything else about them.\r\n        var _updateAnchorList = function (lists, theta, order, conn, aBoolean, otherElId, idx, reverse, edgeId, elId, connsToPaint, endpointsToPaint) {\r\n            // first try to find the exact match, but keep track of the first index of a matching element id along the way.s\r\n            var exactIdx = -1,\r\n                firstMatchingElIdx = -1,\r\n                endpoint = conn.endpoints[idx],\r\n                endpointId = endpoint.id,\r\n                oIdx = [1, 0][idx],\r\n                values = [\r\n                    [ theta, order ],\r\n                    conn,\r\n                    aBoolean,\r\n                    otherElId,\r\n                    endpointId\r\n                ],\r\n                listToAddTo = lists[edgeId],\r\n                listToRemoveFrom = endpoint._continuousAnchorEdge ? lists[endpoint._continuousAnchorEdge] : null,\r\n                i,\r\n                candidate;\r\n\r\n            if (listToRemoveFrom) {\r\n                var rIdx = _ju.findWithFunction(listToRemoveFrom, function (e) {\r\n                    return e[4] === endpointId;\r\n                });\r\n                if (rIdx !== -1) {\r\n                    listToRemoveFrom.splice(rIdx, 1);\r\n                    // get all connections from this list\r\n                    for (i = 0; i < listToRemoveFrom.length; i++) {\r\n                        candidate = listToRemoveFrom[i][1];\r\n                        _ju.addWithFunction(connsToPaint, candidate, function (c) {\r\n                            return c.id === candidate.id;\r\n                        });\r\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[idx], function (e) {\r\n                            return e.id === candidate.endpoints[idx].id;\r\n                        });\r\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[oIdx], function (e) {\r\n                            return e.id === candidate.endpoints[oIdx].id;\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            for (i = 0; i < listToAddTo.length; i++) {\r\n                candidate = listToAddTo[i][1];\r\n                if (params.idx === 1 && listToAddTo[i][3] === otherElId && firstMatchingElIdx === -1) {\r\n                    firstMatchingElIdx = i;\r\n                }\r\n                _ju.addWithFunction(connsToPaint, candidate, function (c) {\r\n                    return c.id === candidate.id;\r\n                });\r\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[idx], function (e) {\r\n                    return e.id === candidate.endpoints[idx].id;\r\n                });\r\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[oIdx], function (e) {\r\n                    return e.id === candidate.endpoints[oIdx].id;\r\n                });\r\n            }\r\n            if (exactIdx !== -1) {\r\n                listToAddTo[exactIdx] = values;\r\n            }\r\n            else {\r\n                var insertIdx = reverse ? firstMatchingElIdx !== -1 ? firstMatchingElIdx : 0 : listToAddTo.length; // of course we will get this from having looked through the array shortly.\r\n                listToAddTo.splice(insertIdx, 0, values);\r\n            }\r\n\r\n            // store this for next time.\r\n            endpoint._continuousAnchorEdge = edgeId;\r\n        };\r\n\r\n        //\r\n        // find the entry in an endpoint's list for this connection and update its target endpoint\r\n        // with the current target in the connection.\r\n        // This method and sourceChanged need to be folder into one.\r\n        //\r\n        this.updateOtherEndpoint = function (sourceElId, oldTargetId, newTargetId, connection) {\r\n            var sIndex = _ju.findWithFunction(connectionsByElementId[sourceElId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                }),\r\n                tIndex = _ju.findWithFunction(connectionsByElementId[oldTargetId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                });\r\n\r\n            // update or add data for source\r\n            if (sIndex !== -1) {\r\n                connectionsByElementId[sourceElId][sIndex][0] = connection;\r\n                connectionsByElementId[sourceElId][sIndex][1] = connection.endpoints[1];\r\n                connectionsByElementId[sourceElId][sIndex][2] = connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor;\r\n            }\r\n\r\n            // remove entry for previous target (if there)\r\n            if (tIndex > -1) {\r\n                connectionsByElementId[oldTargetId].splice(tIndex, 1);\r\n                // add entry for new target\r\n                _ju.addToList(connectionsByElementId, newTargetId, [connection, connection.endpoints[0], connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor]);\r\n            }\r\n\r\n            connection.updateConnectedClass();\r\n        };\r\n\r\n        //\r\n        // notification that the connection given has changed source from the originalId to the newId.\r\n        // This involves:\r\n        // 1. removing the connection from the list of connections stored for the originalId\r\n        // 2. updating the source information for the target of the connection\r\n        // 3. re-registering the connection in connectionsByElementId with the newId\r\n        //\r\n        this.sourceChanged = function (originalId, newId, connection, newElement) {\r\n            if (originalId !== newId) {\r\n\r\n                connection.sourceId = newId;\r\n                connection.source = newElement;\r\n\r\n                // remove the entry that points from the old source to the target\r\n                _ju.removeWithFunction(connectionsByElementId[originalId], function (info) {\r\n                    return info[0].id === connection.id;\r\n                });\r\n                // find entry for target and update it\r\n                var tIdx = _ju.findWithFunction(connectionsByElementId[connection.targetId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                });\r\n                if (tIdx > -1) {\r\n                    connectionsByElementId[connection.targetId][tIdx][0] = connection;\r\n                    connectionsByElementId[connection.targetId][tIdx][1] = connection.endpoints[0];\r\n                    connectionsByElementId[connection.targetId][tIdx][2] = connection.endpoints[0].anchor.constructor === _jp.DynamicAnchor;\r\n                }\r\n                // add entry for new source\r\n                _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[1], connection.endpoints[1].anchor.constructor === _jp.DynamicAnchor]);\r\n\r\n                // TODO SP not final on this yet. when a user drags an existing connection and it turns into a self\r\n                // loop, then this code hides the target endpoint (by removing it from the DOM) But I think this should\r\n                // occur only if the anchor is Continuous\r\n                if (connection.endpoints[1].anchor.isContinuous) {\r\n                    if (connection.source === connection.target) {\r\n                        connection._jsPlumb.instance.removeElement(connection.endpoints[1].canvas);\r\n                    }\r\n                    else {\r\n                        if (connection.endpoints[1].canvas.parentNode == null) {\r\n                            connection._jsPlumb.instance.appendElement(connection.endpoints[1].canvas);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                connection.updateConnectedClass();\r\n            }\r\n        };\r\n\r\n        //\r\n        // moves the given endpoint from `currentId` to `element`.\r\n        // This involves:\r\n        //\r\n        // 1. changing the key in _amEndpoints under which the endpoint is stored\r\n        // 2. changing the source or target values in all of the endpoint's connections\r\n        // 3. changing the array in connectionsByElementId in which the endpoint's connections\r\n        //    are stored (done by either sourceChanged or updateOtherEndpoint)\r\n        //\r\n        this.rehomeEndpoint = function (ep, currentId, element) {\r\n            var eps = _amEndpoints[currentId] || [],\r\n                elementId = jsPlumbInstance.getId(element);\r\n\r\n            if (elementId !== currentId) {\r\n                var idx = eps.indexOf(ep);\r\n                if (idx > -1) {\r\n                    var _ep = eps.splice(idx, 1)[0];\r\n                    self.add(_ep, elementId);\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < ep.connections.length; i++) {\r\n                if (ep.connections[i].sourceId === currentId) {\r\n                    self.sourceChanged(currentId, ep.elementId, ep.connections[i], ep.element);\r\n                }\r\n                else if (ep.connections[i].targetId === currentId) {\r\n                    ep.connections[i].targetId = ep.elementId;\r\n                    ep.connections[i].target = ep.element;\r\n                    self.updateOtherEndpoint(ep.connections[i].sourceId, currentId, ep.elementId, ep.connections[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        this.redraw = function (elementId, ui, timestamp, offsetToUI, clearEdits, doNotRecalcEndpoint) {\r\n\r\n            if (!jsPlumbInstance.isSuspendDrawing()) {\r\n                // get all the endpoints for this element\r\n                var ep = _amEndpoints[elementId] || [],\r\n                    endpointConnections = connectionsByElementId[elementId] || [],\r\n                    connectionsToPaint = [],\r\n                    endpointsToPaint = [],\r\n                    anchorsToUpdate = [];\r\n\r\n                timestamp = timestamp || jsPlumbInstance.timestamp();\r\n                // offsetToUI are values that would have been calculated in the dragManager when registering\r\n                // an endpoint for an element that had a parent (somewhere in the hierarchy) that had been\r\n                // registered as draggable.\r\n                offsetToUI = offsetToUI || {left: 0, top: 0};\r\n                if (ui) {\r\n                    ui = {\r\n                        left: ui.left + offsetToUI.left,\r\n                        top: ui.top + offsetToUI.top\r\n                    };\r\n                }\r\n\r\n                // valid for one paint cycle.\r\n                var myOffset = jsPlumbInstance.updateOffset({ elId: elementId, offset: ui, recalc: false, timestamp: timestamp }),\r\n                    orientationCache = {};\r\n\r\n                // actually, first we should compute the orientation of this element to all other elements to which\r\n                // this element is connected with a continuous anchor (whether both ends of the connection have\r\n                // a continuous anchor or just one)\r\n\r\n                for (var i = 0; i < endpointConnections.length; i++) {\r\n                    var conn = endpointConnections[i][0],\r\n                        sourceId = conn.sourceId,\r\n                        targetId = conn.targetId,\r\n                        sourceContinuous = conn.endpoints[0].anchor.isContinuous,\r\n                        targetContinuous = conn.endpoints[1].anchor.isContinuous;\r\n\r\n                    if (sourceContinuous || targetContinuous) {\r\n                        var oKey = sourceId + \"_\" + targetId,\r\n                            o = orientationCache[oKey],\r\n                            oIdx = conn.sourceId === elementId ? 1 : 0;\r\n\r\n                        if (sourceContinuous && !anchorLists[sourceId]) {\r\n                            anchorLists[sourceId] = { top: [], right: [], bottom: [], left: [] };\r\n                        }\r\n                        if (targetContinuous && !anchorLists[targetId]) {\r\n                            anchorLists[targetId] = { top: [], right: [], bottom: [], left: [] };\r\n                        }\r\n\r\n                        if (elementId !== targetId) {\r\n                            jsPlumbInstance.updateOffset({ elId: targetId, timestamp: timestamp });\r\n                        }\r\n                        if (elementId !== sourceId) {\r\n                            jsPlumbInstance.updateOffset({ elId: sourceId, timestamp: timestamp });\r\n                        }\r\n\r\n                        var td = jsPlumbInstance.getCachedData(targetId),\r\n                            sd = jsPlumbInstance.getCachedData(sourceId);\r\n\r\n                        if (targetId === sourceId && (sourceContinuous || targetContinuous)) {\r\n                            // here we may want to improve this by somehow determining the face we'd like\r\n                            // to put the connector on.  ideally, when drawing, the face should be calculated\r\n                            // by determining which face is closest to the point at which the mouse button\r\n                            // was released.  for now, we're putting it on the top face.\r\n                            _updateAnchorList( anchorLists[sourceId], -Math.PI / 2, 0, conn, false, targetId, 0, false, \"top\", sourceId, connectionsToPaint, endpointsToPaint);\r\n                            _updateAnchorList( anchorLists[targetId], -Math.PI / 2, 0, conn, false, sourceId, 1, false, \"top\", targetId, connectionsToPaint, endpointsToPaint);\r\n                        }\r\n                        else {\r\n                            if (!o) {\r\n                                o = this.calculateOrientation(sourceId, targetId, sd.o, td.o, conn.endpoints[0].anchor, conn.endpoints[1].anchor, conn);\r\n                                orientationCache[oKey] = o;\r\n                                // this would be a performance enhancement, but the computed angles need to be clamped to\r\n                                //the (-PI/2 -> PI/2) range in order for the sorting to work properly.\r\n                                /*  orientationCache[oKey2] = {\r\n                                 orientation:o.orientation,\r\n                                 a:[o.a[1], o.a[0]],\r\n                                 theta:o.theta + Math.PI,\r\n                                 theta2:o.theta2 + Math.PI\r\n                                 };*/\r\n                            }\r\n                            if (sourceContinuous) {\r\n                                _updateAnchorList(anchorLists[sourceId], o.theta, 0, conn, false, targetId, 0, false, o.a[0], sourceId, connectionsToPaint, endpointsToPaint);\r\n                            }\r\n                            if (targetContinuous) {\r\n                                _updateAnchorList(anchorLists[targetId], o.theta2, -1, conn, true, sourceId, 1, true, o.a[1], targetId, connectionsToPaint, endpointsToPaint);\r\n                            }\r\n                        }\r\n\r\n                        if (sourceContinuous) {\r\n                            _ju.addWithFunction(anchorsToUpdate, sourceId, function (a) {\r\n                                return a === sourceId;\r\n                            });\r\n                        }\r\n                        if (targetContinuous) {\r\n                            _ju.addWithFunction(anchorsToUpdate, targetId, function (a) {\r\n                                return a === targetId;\r\n                            });\r\n                        }\r\n                        _ju.addWithFunction(connectionsToPaint, conn, function (c) {\r\n                            return c.id === conn.id;\r\n                        });\r\n                        if ((sourceContinuous && oIdx === 0) || (targetContinuous && oIdx === 1)) {\r\n                            _ju.addWithFunction(endpointsToPaint, conn.endpoints[oIdx], function (e) {\r\n                                return e.id === conn.endpoints[oIdx].id;\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // place Endpoints whose anchors are continuous but have no Connections\r\n                for (i = 0; i < ep.length; i++) {\r\n                    if (ep[i].connections.length === 0 && ep[i].anchor.isContinuous) {\r\n                        if (!anchorLists[elementId]) {\r\n                            anchorLists[elementId] = { top: [], right: [], bottom: [], left: [] };\r\n                        }\r\n                        _updateAnchorList(anchorLists[elementId], -Math.PI / 2, 0, {endpoints: [ep[i], ep[i]], paint: function () {\r\n                            }}, false, elementId, 0, false, ep[i].anchor.getDefaultFace(), elementId, connectionsToPaint, endpointsToPaint);\r\n                        _ju.addWithFunction(anchorsToUpdate, elementId, function (a) {\r\n                            return a === elementId;\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // now place all the continuous anchors we need to;\r\n                for (i = 0; i < anchorsToUpdate.length; i++) {\r\n                    placeAnchors(anchorsToUpdate[i], anchorLists[anchorsToUpdate[i]]);\r\n                }\r\n\r\n                // now that continuous anchors have been placed, paint all the endpoints for this element\r\n                for (i = 0; i < ep.length; i++) {\r\n                    ep[i].paint({ timestamp: timestamp, offset: myOffset, dimensions: myOffset.s, recalc: doNotRecalcEndpoint !== true });\r\n                }\r\n\r\n                // ... and any other endpoints we came across as a result of the continuous anchors.\r\n                for (i = 0; i < endpointsToPaint.length; i++) {\r\n                    var cd = jsPlumbInstance.getCachedData(endpointsToPaint[i].elementId);\r\n                    //endpointsToPaint[i].paint({ timestamp: timestamp, offset: cd, dimensions: cd.s });\r\n                    endpointsToPaint[i].paint({ timestamp: null, offset: cd, dimensions: cd.s });\r\n                }\r\n\r\n                // paint all the standard and \"dynamic connections\", which are connections whose other anchor is\r\n                // static and therefore does need to be recomputed; we make sure that happens only one time.\r\n\r\n                // TODO we could have compiled a list of these in the first pass through connections; might save some time.\r\n                for (i = 0; i < endpointConnections.length; i++) {\r\n                    var otherEndpoint = endpointConnections[i][1];\r\n                    if (otherEndpoint.anchor.constructor === _jp.DynamicAnchor) {\r\n                        otherEndpoint.paint({ elementWithPrecedence: elementId, timestamp: timestamp });\r\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\r\n                            return c.id === endpointConnections[i][0].id;\r\n                        });\r\n                        // all the connections for the other endpoint now need to be repainted\r\n                        for (var k = 0; k < otherEndpoint.connections.length; k++) {\r\n                            if (otherEndpoint.connections[k] !== endpointConnections[i][0]) {\r\n                                _ju.addWithFunction(connectionsToPaint, otherEndpoint.connections[k], function (c) {\r\n                                    return c.id === otherEndpoint.connections[k].id;\r\n                                });\r\n                            }\r\n                        }\r\n                    } else {\r\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\r\n                            return c.id === endpointConnections[i][0].id;\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // paint current floating connection for this element, if there is one.\r\n                var fc = floatingConnections[elementId];\r\n                if (fc) {\r\n                    fc.paint({timestamp: timestamp, recalc: false, elId: elementId});\r\n                }\r\n\r\n                // paint all the connections\r\n                for (i = 0; i < connectionsToPaint.length; i++) {\r\n                    connectionsToPaint[i].paint({elId: elementId, timestamp: null, recalc: false, clearEdits: clearEdits});\r\n                }\r\n            }\r\n        };\r\n\r\n        var ContinuousAnchor = function (anchorParams) {\r\n            _ju.EventGenerator.apply(this);\r\n            this.type = \"Continuous\";\r\n            this.isDynamic = true;\r\n            this.isContinuous = true;\r\n            var faces = anchorParams.faces || [\"top\", \"right\", \"bottom\", \"left\"],\r\n                clockwise = !(anchorParams.clockwise === false),\r\n                availableFaces = { },\r\n                opposites = { \"top\": \"bottom\", \"right\": \"left\", \"left\": \"right\", \"bottom\": \"top\" },\r\n                clockwiseOptions = { \"top\": \"right\", \"right\": \"bottom\", \"left\": \"top\", \"bottom\": \"left\" },\r\n                antiClockwiseOptions = { \"top\": \"left\", \"right\": \"top\", \"left\": \"bottom\", \"bottom\": \"right\" },\r\n                secondBest = clockwise ? clockwiseOptions : antiClockwiseOptions,\r\n                lastChoice = clockwise ? antiClockwiseOptions : clockwiseOptions,\r\n                cssClass = anchorParams.cssClass || \"\",\r\n                _currentFace = null, _lockedFace = null, X_AXIS_FACES = [\"left\", \"right\"], Y_AXIS_FACES = [\"top\", \"bottom\"],\r\n                _lockedAxis = null;\r\n\r\n            for (var i = 0; i < faces.length; i++) {\r\n                availableFaces[faces[i]] = true;\r\n            }\r\n\r\n            this.getDefaultFace = function () {\r\n                return faces.length === 0 ? \"top\" : faces[0];\r\n            };\r\n\r\n            this.isRelocatable = function() { return true; };\r\n            this.isSnapOnRelocate = function() { return true; };\r\n\r\n            // if the given edge is supported, returns it. otherwise looks for a substitute that _is_\r\n            // supported. if none supported we also return the request edge.\r\n            this.verifyEdge = function (edge) {\r\n                if (availableFaces[edge]) {\r\n                    return edge;\r\n                }\r\n                else if (availableFaces[opposites[edge]]) {\r\n                    return opposites[edge];\r\n                }\r\n                else if (availableFaces[secondBest[edge]]) {\r\n                    return secondBest[edge];\r\n                }\r\n                else if (availableFaces[lastChoice[edge]]) {\r\n                    return lastChoice[edge];\r\n                }\r\n                return edge; // we have to give them something.\r\n            };\r\n\r\n            this.isEdgeSupported = function (edge) {\r\n                return  _lockedAxis == null ?\r\n\r\n                    (_lockedFace == null ? availableFaces[edge] === true : _lockedFace === edge)\r\n\r\n                    : _lockedAxis.indexOf(edge) !== -1;\r\n            };\r\n\r\n            this.setCurrentFace = function(face, overrideLock) {\r\n                _currentFace = face;\r\n                // if currently locked, and the user wants to override, do that.\r\n                if (overrideLock && _lockedFace != null) {\r\n                    _lockedFace = _currentFace;\r\n                }\r\n            };\r\n\r\n            this.getCurrentFace = function() { return _currentFace; };\r\n            this.getSupportedFaces = function() {\r\n                var af = [];\r\n                for (var k in availableFaces) {\r\n                    if (availableFaces[k]) {\r\n                        af.push(k);\r\n                    }\r\n                }\r\n                return af;\r\n            };\r\n\r\n            this.lock = function() {\r\n                _lockedFace = _currentFace;\r\n            };\r\n            this.unlock = function() {\r\n                _lockedFace = null;\r\n            };\r\n            this.isLocked = function() {\r\n                return _lockedFace != null;\r\n            };\r\n\r\n            this.lockCurrentAxis = function() {\r\n                if (_currentFace != null) {\r\n                    _lockedAxis = (_currentFace === \"left\" || _currentFace === \"right\") ? X_AXIS_FACES : Y_AXIS_FACES;\r\n                }\r\n            };\r\n\r\n            this.unlockCurrentAxis = function() {\r\n                _lockedAxis = null;\r\n            };\r\n\r\n            this.compute = function (params) {\r\n                return continuousAnchorLocations[params.element.id] || [0, 0];\r\n            };\r\n            this.getCurrentLocation = function (params) {\r\n                return continuousAnchorLocations[params.element.id] || [0, 0];\r\n            };\r\n            this.getOrientation = function (endpoint) {\r\n                return continuousAnchorOrientations[endpoint.id] || [0, 0];\r\n            };\r\n            this.getCssClass = function () {\r\n                return cssClass;\r\n            };\r\n        };\r\n\r\n        // continuous anchors\r\n        jsPlumbInstance.continuousAnchorFactory = {\r\n            get: function (params) {\r\n                return new ContinuousAnchor(params);\r\n            },\r\n            clear: function (elementId) {\r\n                delete continuousAnchorLocations[elementId];\r\n            }\r\n        };\r\n    };\r\n\r\n    _jp.AnchorManager.prototype.calculateOrientation = function (sourceId, targetId, sd, td, sourceAnchor, targetAnchor) {\r\n\r\n        var Orientation = { HORIZONTAL: \"horizontal\", VERTICAL: \"vertical\", DIAGONAL: \"diagonal\", IDENTITY: \"identity\" },\r\n            axes = [\"left\", \"top\", \"right\", \"bottom\"];\r\n\r\n        if (sourceId === targetId) {\r\n            return {\r\n                orientation: Orientation.IDENTITY,\r\n                a: [\"top\", \"top\"]\r\n            };\r\n        }\r\n\r\n        var theta = Math.atan2((td.centery - sd.centery), (td.centerx - sd.centerx)),\r\n            theta2 = Math.atan2((sd.centery - td.centery), (sd.centerx - td.centerx));\r\n\r\n// --------------------------------------------------------------------------------------\r\n\r\n        // improved face calculation. get midpoints of each face for source and target, then put in an array with all combinations of\r\n        // source/target faces. sort this array by distance between midpoints. the entry at index 0 is our preferred option. we can\r\n        // go through the array one by one until we find an entry in which each requested face is supported.\r\n        var candidates = [], midpoints = { };\r\n        (function (types, dim) {\r\n            for (var i = 0; i < types.length; i++) {\r\n                midpoints[types[i]] = {\r\n                    \"left\": [ dim[i].left, dim[i].centery ],\r\n                    \"right\": [ dim[i].right, dim[i].centery ],\r\n                    \"top\": [ dim[i].centerx, dim[i].top ],\r\n                    \"bottom\": [ dim[i].centerx , dim[i].bottom]\r\n                };\r\n            }\r\n        })([ \"source\", \"target\" ], [ sd, td ]);\r\n\r\n        for (var sf = 0; sf < axes.length; sf++) {\r\n            for (var tf = 0; tf < axes.length; tf++) {\r\n                candidates.push({\r\n                    source: axes[sf],\r\n                    target: axes[tf],\r\n                    dist: Biltong.lineLength(midpoints.source[axes[sf]], midpoints.target[axes[tf]])\r\n                });\r\n            }\r\n        }\r\n\r\n        candidates.sort(function (a, b) {\r\n            return a.dist < b.dist ? -1 : a.dist > b.dist ? 1 : 0;\r\n        });\r\n\r\n        // now go through this list and try to get an entry that satisfies both (there will be one, unless one of the anchors\r\n        // declares no available faces)\r\n        var sourceEdge = candidates[0].source, targetEdge = candidates[0].target;\r\n        for (var i = 0; i < candidates.length; i++) {\r\n\r\n            if (!sourceAnchor.isContinuous || sourceAnchor.isEdgeSupported(candidates[i].source)) {\r\n                sourceEdge = candidates[i].source;\r\n            }\r\n            else {\r\n                sourceEdge = null;\r\n            }\r\n\r\n            if (!targetAnchor.isContinuous || targetAnchor.isEdgeSupported(candidates[i].target)) {\r\n                targetEdge = candidates[i].target;\r\n            }\r\n            else {\r\n                targetEdge = null;\r\n            }\r\n\r\n            if (sourceEdge != null && targetEdge != null) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (sourceAnchor.isContinuous) {\r\n            sourceAnchor.setCurrentFace(sourceEdge);\r\n        }\r\n\r\n        if (targetAnchor.isContinuous) {\r\n            targetAnchor.setCurrentFace(targetEdge);\r\n        }\r\n\r\n// --------------------------------------------------------------------------------------\r\n\r\n        return {\r\n            a: [ sourceEdge, targetEdge ],\r\n            theta: theta,\r\n            theta2: theta2\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Anchors model a position on some element at which an Endpoint may be located.  They began as a first class citizen of jsPlumb, ie. a user\r\n     * was required to create these themselves, but over time this has been replaced by the concept of referring to them either by name (eg. \"TopMiddle\"),\r\n     * or by an array describing their coordinates (eg. [ 0, 0.5, 0, -1 ], which is the same as \"TopMiddle\").  jsPlumb now handles all of the\r\n     * creation of Anchors without user intervention.\r\n     */\r\n    _jp.Anchor = function (params) {\r\n        this.x = params.x || 0;\r\n        this.y = params.y || 0;\r\n        this.elementId = params.elementId;\r\n        this.cssClass = params.cssClass || \"\";\r\n        this.userDefinedLocation = null;\r\n        this.orientation = params.orientation || [ 0, 0 ];\r\n        this.lastReturnValue = null;\r\n        this.offsets = params.offsets || [ 0, 0 ];\r\n        this.timestamp = null;\r\n\r\n        var relocatable = params.relocatable !== false;\r\n        this.isRelocatable = function() { return relocatable; };\r\n        this.setRelocatable = function(_relocatable) { relocatable = _relocatable; };\r\n        var snapOnRelocate = params.snapOnRelocate !== false;\r\n        this.isSnapOnRelocate = function() { return snapOnRelocate; };\r\n\r\n        var locked = false;\r\n        this.lock = function() { locked = true; };\r\n        this.unlock = function() { locked = false; };\r\n        this.isLocked = function() { return locked; };\r\n\r\n        _ju.EventGenerator.apply(this);\r\n\r\n        this.compute = function (params) {\r\n\r\n            var xy = params.xy, wh = params.wh, timestamp = params.timestamp;\r\n\r\n            if (params.clearUserDefinedLocation) {\r\n                this.userDefinedLocation = null;\r\n            }\r\n\r\n            if (timestamp && timestamp === this.timestamp) {\r\n                return this.lastReturnValue;\r\n            }\r\n\r\n            if (this.userDefinedLocation != null) {\r\n                this.lastReturnValue = this.userDefinedLocation;\r\n            }\r\n            else {\r\n                this.lastReturnValue = [ xy[0] + (this.x * wh[0]) + this.offsets[0], xy[1] + (this.y * wh[1]) + this.offsets[1], this.x, this.y ];\r\n            }\r\n\r\n            this.timestamp = timestamp;\r\n            return this.lastReturnValue;\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            params = params || {};\r\n            return (this.lastReturnValue == null || (params.timestamp != null && this.timestamp !== params.timestamp)) ? this.compute(params) : this.lastReturnValue;\r\n        };\r\n\r\n        this.setPosition = function(x, y, ox, oy, overrideLock) {\r\n            if (!locked || overrideLock) {\r\n                this.x = x;\r\n                this.y = y;\r\n                this.orientation = [ ox, oy ];\r\n                this.lastReturnValue = null;\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.Anchor, _ju.EventGenerator, {\r\n        equals: function (anchor) {\r\n            if (!anchor) {\r\n                return false;\r\n            }\r\n            var ao = anchor.getOrientation(),\r\n                o = this.getOrientation();\r\n            return this.x === anchor.x && this.y === anchor.y && this.offsets[0] === anchor.offsets[0] && this.offsets[1] === anchor.offsets[1] && o[0] === ao[0] && o[1] === ao[1];\r\n        },\r\n        getUserDefinedLocation: function () {\r\n            return this.userDefinedLocation;\r\n        },\r\n        setUserDefinedLocation: function (l) {\r\n            this.userDefinedLocation = l;\r\n        },\r\n        clearUserDefinedLocation: function () {\r\n            this.userDefinedLocation = null;\r\n        },\r\n        getOrientation: function () {\r\n            return this.orientation;\r\n        },\r\n        getCssClass: function () {\r\n            return this.cssClass;\r\n        }\r\n    });\r\n\r\n    /**\r\n     * An Anchor that floats. its orientation is computed dynamically from\r\n     * its position relative to the anchor it is floating relative to.  It is used when creating\r\n     * a connection through drag and drop.\r\n     *\r\n     * TODO FloatingAnchor could totally be refactored to extend Anchor just slightly.\r\n     */\r\n    _jp.FloatingAnchor = function (params) {\r\n\r\n        _jp.Anchor.apply(this, arguments);\r\n\r\n        // this is the anchor that this floating anchor is referenced to for\r\n        // purposes of calculating the orientation.\r\n        var ref = params.reference,\r\n            // the canvas this refers to.\r\n            refCanvas = params.referenceCanvas,\r\n            size = _jp.getSize(refCanvas),\r\n            // these are used to store the current relative position of our\r\n            // anchor wrt the reference anchor. they only indicate\r\n            // direction, so have a value of 1 or -1 (or, very rarely, 0). these\r\n            // values are written by the compute method, and read\r\n            // by the getOrientation method.\r\n            xDir = 0, yDir = 0,\r\n            // temporary member used to store an orientation when the floating\r\n            // anchor is hovering over another anchor.\r\n            orientation = null,\r\n            _lastResult = null;\r\n\r\n        // clear from parent. we want floating anchor orientation to always be computed.\r\n        this.orientation = null;\r\n\r\n        // set these to 0 each; they are used by certain types of connectors in the loopback case,\r\n        // when the connector is trying to clear the element it is on. but for floating anchor it's not\r\n        // very important.\r\n        this.x = 0;\r\n        this.y = 0;\r\n\r\n        this.isFloating = true;\r\n\r\n        this.compute = function (params) {\r\n            var xy = params.xy,\r\n                result = [ xy[0] + (size[0] / 2), xy[1] + (size[1] / 2) ]; // return origin of the element. we may wish to improve this so that any object can be the drag proxy.\r\n            _lastResult = result;\r\n            return result;\r\n        };\r\n\r\n        this.getOrientation = function (_endpoint) {\r\n            if (orientation) {\r\n                return orientation;\r\n            }\r\n            else {\r\n                var o = ref.getOrientation(_endpoint);\r\n                // here we take into account the orientation of the other\r\n                // anchor: if it declares zero for some direction, we declare zero too. this might not be the most awesome. perhaps we can come\r\n                // up with a better way. it's just so that the line we draw looks like it makes sense. maybe this wont make sense.\r\n                return [ Math.abs(o[0]) * xDir * -1,\r\n                    Math.abs(o[1]) * yDir * -1 ];\r\n            }\r\n        };\r\n\r\n        /**\r\n         * notification the endpoint associated with this anchor is hovering\r\n         * over another anchor; we want to assume that anchor's orientation\r\n         * for the duration of the hover.\r\n         */\r\n        this.over = function (anchor, endpoint) {\r\n            orientation = anchor.getOrientation(endpoint);\r\n        };\r\n\r\n        /**\r\n         * notification the endpoint associated with this anchor is no\r\n         * longer hovering over another anchor; we should resume calculating\r\n         * orientation as we normally do.\r\n         */\r\n        this.out = function () {\r\n            orientation = null;\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            return _lastResult == null ? this.compute(params) : _lastResult;\r\n        };\r\n    };\r\n    _ju.extend(_jp.FloatingAnchor, _jp.Anchor);\r\n\r\n    var _convertAnchor = function (anchor, jsPlumbInstance, elementId) {\r\n        return anchor.constructor === _jp.Anchor ? anchor : jsPlumbInstance.makeAnchor(anchor, elementId, jsPlumbInstance);\r\n    };\r\n\r\n    /*\r\n     * A DynamicAnchor is an Anchor that contains a list of other Anchors, which it cycles\r\n     * through at compute time to find the one that is located closest to\r\n     * the center of the target element, and returns that Anchor's compute\r\n     * method result. this causes endpoints to follow each other with\r\n     * respect to the orientation of their target elements, which is a useful\r\n     * feature for some applications.\r\n     *\r\n     */\r\n    _jp.DynamicAnchor = function (params) {\r\n        _jp.Anchor.apply(this, arguments);\r\n\r\n        this.isDynamic = true;\r\n        this.anchors = [];\r\n        this.elementId = params.elementId;\r\n        this.jsPlumbInstance = params.jsPlumbInstance;\r\n\r\n        for (var i = 0; i < params.anchors.length; i++) {\r\n            this.anchors[i] = _convertAnchor(params.anchors[i], this.jsPlumbInstance, this.elementId);\r\n        }\r\n\r\n        this.getAnchors = function () {\r\n            return this.anchors;\r\n        };\r\n\r\n        var _curAnchor = this.anchors.length > 0 ? this.anchors[0] : null,\r\n            _lastAnchor = _curAnchor,\r\n            self = this,\r\n\r\n            // helper method to calculate the distance between the centers of the two elements.\r\n            _distance = function (anchor, cx, cy, xy, wh) {\r\n                var ax = xy[0] + (anchor.x * wh[0]), ay = xy[1] + (anchor.y * wh[1]),\r\n                    acx = xy[0] + (wh[0] / 2), acy = xy[1] + (wh[1] / 2);\r\n                return (Math.sqrt(Math.pow(cx - ax, 2) + Math.pow(cy - ay, 2)) +\r\n                    Math.sqrt(Math.pow(acx - ax, 2) + Math.pow(acy - ay, 2)));\r\n            },\r\n            // default method uses distance between element centers.  you can provide your own method in the dynamic anchor\r\n            // constructor (and also to jsPlumb.makeDynamicAnchor). the arguments to it are four arrays:\r\n            // xy - xy loc of the anchor's element\r\n            // wh - anchor's element's dimensions\r\n            // txy - xy loc of the element of the other anchor in the connection\r\n            // twh - dimensions of the element of the other anchor in the connection.\r\n            // anchors - the list of selectable anchors\r\n            _anchorSelector = params.selector || function (xy, wh, txy, twh, anchors) {\r\n                var cx = txy[0] + (twh[0] / 2), cy = txy[1] + (twh[1] / 2);\r\n                var minIdx = -1, minDist = Infinity;\r\n                for (var i = 0; i < anchors.length; i++) {\r\n                    var d = _distance(anchors[i], cx, cy, xy, wh);\r\n                    if (d < minDist) {\r\n                        minIdx = i + 0;\r\n                        minDist = d;\r\n                    }\r\n                }\r\n                return anchors[minIdx];\r\n            };\r\n\r\n        this.compute = function (params) {\r\n            var xy = params.xy, wh = params.wh, txy = params.txy, twh = params.twh;\r\n\r\n            this.timestamp = params.timestamp;\r\n\r\n            var udl = self.getUserDefinedLocation();\r\n            if (udl != null) {\r\n                return udl;\r\n            }\r\n\r\n            // if anchor is locked or an opposite element was not given, we\r\n            // maintain our state. anchor will be locked\r\n            // if it is the source of a drag and drop.\r\n            if (this.isLocked() || txy == null || twh == null) {\r\n                return _curAnchor.compute(params);\r\n            }\r\n            else {\r\n                params.timestamp = null; // otherwise clear this, i think. we want the anchor to compute.\r\n            }\r\n\r\n            _curAnchor = _anchorSelector(xy, wh, txy, twh, this.anchors);\r\n            this.x = _curAnchor.x;\r\n            this.y = _curAnchor.y;\r\n\r\n            if (_curAnchor !== _lastAnchor) {\r\n                this.fire(\"anchorChanged\", _curAnchor);\r\n            }\r\n\r\n            _lastAnchor = _curAnchor;\r\n\r\n            return _curAnchor.compute(params);\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            return this.getUserDefinedLocation() || (_curAnchor != null ? _curAnchor.getCurrentLocation(params) : null);\r\n        };\r\n\r\n        this.getOrientation = function (_endpoint) {\r\n            return _curAnchor != null ? _curAnchor.getOrientation(_endpoint) : [ 0, 0 ];\r\n        };\r\n        this.over = function (anchor, endpoint) {\r\n            if (_curAnchor != null) {\r\n                _curAnchor.over(anchor, endpoint);\r\n            }\r\n        };\r\n        this.out = function () {\r\n            if (_curAnchor != null) {\r\n                _curAnchor.out();\r\n            }\r\n        };\r\n\r\n        this.setAnchor = function(a) {\r\n            _curAnchor = a;\r\n        };\r\n\r\n        this.getCssClass = function () {\r\n            return (_curAnchor && _curAnchor.getCssClass()) || \"\";\r\n        };\r\n\r\n        /**\r\n         * Attempt to match an anchor with the given coordinates and then set it.\r\n         * @param coords\r\n         * @returns true if matching anchor found, false otherwise.\r\n         */\r\n        this.setAnchorCoordinates = function(coords) {\r\n            var idx = jsPlumbUtil.findWithFunction(this.anchors, function(a) {\r\n                return a.x === coords[0] && a.y === coords[1];\r\n            });\r\n            if (idx !== -1) {\r\n                this.setAnchor(this.anchors[idx]);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.DynamicAnchor, _jp.Anchor);\r\n\r\n// -------- basic anchors ------------------\r\n    var _curryAnchor = function (x, y, ox, oy, type, fnInit) {\r\n        _jp.Anchors[type] = function (params) {\r\n            var a = params.jsPlumbInstance.makeAnchor([ x, y, ox, oy, 0, 0 ], params.elementId, params.jsPlumbInstance);\r\n            a.type = type;\r\n            if (fnInit) {\r\n                fnInit(a, params);\r\n            }\r\n            return a;\r\n        };\r\n    };\r\n\r\n    _curryAnchor(0.5, 0, 0, -1, \"TopCenter\");\r\n    _curryAnchor(0.5, 1, 0, 1, \"BottomCenter\");\r\n    _curryAnchor(0, 0.5, -1, 0, \"LeftMiddle\");\r\n    _curryAnchor(1, 0.5, 1, 0, \"RightMiddle\");\r\n\r\n    _curryAnchor(0.5, 0, 0, -1, \"Top\");\r\n    _curryAnchor(0.5, 1, 0, 1, \"Bottom\");\r\n    _curryAnchor(0, 0.5, -1, 0, \"Left\");\r\n    _curryAnchor(1, 0.5, 1, 0, \"Right\");\r\n    _curryAnchor(0.5, 0.5, 0, 0, \"Center\");\r\n    _curryAnchor(1, 0, 0, -1, \"TopRight\");\r\n    _curryAnchor(1, 1, 0, 1, \"BottomRight\");\r\n    _curryAnchor(0, 0, 0, -1, \"TopLeft\");\r\n    _curryAnchor(0, 1, 0, 1, \"BottomLeft\");\r\n\r\n// ------- dynamic anchors -------------------\r\n\r\n    // default dynamic anchors chooses from Top, Right, Bottom, Left\r\n    _jp.Defaults.DynamicAnchors = function (params) {\r\n        return params.jsPlumbInstance.makeAnchors([\"TopCenter\", \"RightMiddle\", \"BottomCenter\", \"LeftMiddle\"], params.elementId, params.jsPlumbInstance);\r\n    };\r\n\r\n    // default dynamic anchors bound to name 'AutoDefault'\r\n    _jp.Anchors.AutoDefault = function (params) {\r\n        var a = params.jsPlumbInstance.makeDynamicAnchor(_jp.Defaults.DynamicAnchors(params));\r\n        a.type = \"AutoDefault\";\r\n        return a;\r\n    };\r\n\r\n// ------- continuous anchors -------------------\r\n\r\n    var _curryContinuousAnchor = function (type, faces) {\r\n        _jp.Anchors[type] = function (params) {\r\n            var a = params.jsPlumbInstance.makeAnchor([\"Continuous\", { faces: faces }], params.elementId, params.jsPlumbInstance);\r\n            a.type = type;\r\n            return a;\r\n        };\r\n    };\r\n\r\n    _jp.Anchors.Continuous = function (params) {\r\n        return params.jsPlumbInstance.continuousAnchorFactory.get(params);\r\n    };\r\n\r\n    _curryContinuousAnchor(\"ContinuousLeft\", [\"left\"]);\r\n    _curryContinuousAnchor(\"ContinuousTop\", [\"top\"]);\r\n    _curryContinuousAnchor(\"ContinuousBottom\", [\"bottom\"]);\r\n    _curryContinuousAnchor(\"ContinuousRight\", [\"right\"]);\r\n\r\n// ------- position assign anchors -------------------\r\n\r\n    // this anchor type lets you assign the position at connection time.\r\n    _curryAnchor(0, 0, 0, 0, \"Assign\", function (anchor, params) {\r\n        // find what to use as the \"position finder\". the user may have supplied a String which represents\r\n        // the id of a position finder in jsPlumb.AnchorPositionFinders, or the user may have supplied the\r\n        // position finder as a function.  we find out what to use and then set it on the anchor.\r\n        var pf = params.position || \"Fixed\";\r\n        anchor.positionFinder = pf.constructor === String ? params.jsPlumbInstance.AnchorPositionFinders[pf] : pf;\r\n        // always set the constructor params; the position finder might need them later (the Grid one does,\r\n        // for example)\r\n        anchor.constructorParams = params;\r\n    });\r\n\r\n    // these are the default anchor positions finders, which are used by the makeTarget function.  supplying\r\n    // a position finder argument to that function allows you to specify where the resulting anchor will\r\n    // be located\r\n    root.jsPlumbInstance.prototype.AnchorPositionFinders = {\r\n        \"Fixed\": function (dp, ep, es) {\r\n            return [ (dp.left - ep.left) / es[0], (dp.top - ep.top) / es[1] ];\r\n        },\r\n        \"Grid\": function (dp, ep, es, params) {\r\n            var dx = dp.left - ep.left, dy = dp.top - ep.top,\r\n                gx = es[0] / (params.grid[0]), gy = es[1] / (params.grid[1]),\r\n                mx = Math.floor(dx / gx), my = Math.floor(dy / gy);\r\n            return [ ((mx * gx) + (gx / 2)) / es[0], ((my * gy) + (gy / 2)) / es[1] ];\r\n        }\r\n    };\r\n\r\n// ------- perimeter anchors -------------------\r\n\r\n    _jp.Anchors.Perimeter = function (params) {\r\n        params = params || {};\r\n        var anchorCount = params.anchorCount || 60,\r\n            shape = params.shape;\r\n\r\n        if (!shape) {\r\n            throw new Error(\"no shape supplied to Perimeter Anchor type\");\r\n        }\r\n\r\n        var _circle = function () {\r\n                var r = 0.5, step = Math.PI * 2 / anchorCount, current = 0, a = [];\r\n                for (var i = 0; i < anchorCount; i++) {\r\n                    var x = r + (r * Math.sin(current)),\r\n                        y = r + (r * Math.cos(current));\r\n                    a.push([ x, y, 0, 0 ]);\r\n                    current += step;\r\n                }\r\n                return a;\r\n            },\r\n            _path = function (segments) {\r\n                var anchorsPerFace = anchorCount / segments.length, a = [],\r\n                    _computeFace = function (x1, y1, x2, y2, fractionalLength, ox, oy) {\r\n                        anchorsPerFace = anchorCount * fractionalLength;\r\n                        var dx = (x2 - x1) / anchorsPerFace, dy = (y2 - y1) / anchorsPerFace;\r\n                        for (var i = 0; i < anchorsPerFace; i++) {\r\n                            a.push([\r\n                                x1 + (dx * i),\r\n                                y1 + (dy * i),\r\n                                ox == null ? 0 : ox,\r\n                                oy == null ? 0 : oy\r\n                            ]);\r\n                        }\r\n                    };\r\n\r\n                for (var i = 0; i < segments.length; i++) {\r\n                    _computeFace.apply(null, segments[i]);\r\n                }\r\n\r\n                return a;\r\n            },\r\n            _shape = function (faces) {\r\n                var s = [];\r\n                for (var i = 0; i < faces.length; i++) {\r\n                    s.push([faces[i][0], faces[i][1], faces[i][2], faces[i][3], 1 / faces.length, faces[i][4], faces[i][5]]);\r\n                }\r\n                return _path(s);\r\n            },\r\n            _rectangle = function () {\r\n                return _shape([\r\n                    [ 0, 0, 1, 0, 0, -1 ],\r\n                    [ 1, 0, 1, 1, 1, 0 ],\r\n                    [ 1, 1, 0, 1, 0, 1 ],\r\n                    [ 0, 1, 0, 0, -1, 0 ]\r\n                ]);\r\n            };\r\n\r\n        var _shapes = {\r\n                \"Circle\": _circle,\r\n                \"Ellipse\": _circle,\r\n                \"Diamond\": function () {\r\n                    return _shape([\r\n                        [ 0.5, 0, 1, 0.5 ],\r\n                        [ 1, 0.5, 0.5, 1 ],\r\n                        [ 0.5, 1, 0, 0.5 ],\r\n                        [ 0, 0.5, 0.5, 0 ]\r\n                    ]);\r\n                },\r\n                \"Rectangle\": _rectangle,\r\n                \"Square\": _rectangle,\r\n                \"Triangle\": function () {\r\n                    return _shape([\r\n                        [ 0.5, 0, 1, 1 ],\r\n                        [ 1, 1, 0, 1 ],\r\n                        [ 0, 1, 0.5, 0]\r\n                    ]);\r\n                },\r\n                \"Path\": function (params) {\r\n                    var points = params.points, p = [], tl = 0;\r\n                    for (var i = 0; i < points.length - 1; i++) {\r\n                        var l = Math.sqrt(Math.pow(points[i][2] - points[i][0]) + Math.pow(points[i][3] - points[i][1]));\r\n                        tl += l;\r\n                        p.push([points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], l]);\r\n                    }\r\n                    for (var j = 0; j < p.length; j++) {\r\n                        p[j][4] = p[j][4] / tl;\r\n                    }\r\n                    return _path(p);\r\n                }\r\n            },\r\n            _rotate = function (points, amountInDegrees) {\r\n                var o = [], theta = amountInDegrees / 180 * Math.PI;\r\n                for (var i = 0; i < points.length; i++) {\r\n                    var _x = points[i][0] - 0.5,\r\n                        _y = points[i][1] - 0.5;\r\n\r\n                    o.push([\r\n                        0.5 + ((_x * Math.cos(theta)) - (_y * Math.sin(theta))),\r\n                        0.5 + ((_x * Math.sin(theta)) + (_y * Math.cos(theta))),\r\n                        points[i][2],\r\n                        points[i][3]\r\n                    ]);\r\n                }\r\n                return o;\r\n            };\r\n\r\n        if (!_shapes[shape]) {\r\n            throw new Error(\"Shape [\" + shape + \"] is unknown by Perimeter Anchor type\");\r\n        }\r\n\r\n        var da = _shapes[shape](params);\r\n        if (params.rotation) {\r\n            da = _rotate(da, params.rotation);\r\n        }\r\n        var a = params.jsPlumbInstance.makeDynamicAnchor(da);\r\n        a.type = \"Perimeter\";\r\n        return a;\r\n    };\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the default Connectors, Endpoint and Overlay definitions.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil, _jg = root.Biltong;\r\n\r\n    _jp.Segments = {\r\n\r\n        /*\r\n         * Class: AbstractSegment\r\n         * A Connector is made up of 1..N Segments, each of which has a Type, such as 'Straight', 'Arc',\r\n         * 'Bezier'. This is new from 1.4.2, and gives us a lot more flexibility when drawing connections: things such\r\n         * as rounded corners for flowchart connectors, for example, or a straight line stub for Bezier connections, are\r\n         * much easier to do now.\r\n         *\r\n         * A Segment is responsible for providing coordinates for painting it, and also must be able to report its length.\r\n         *\r\n         */\r\n        AbstractSegment: function (params) {\r\n            this.params = params;\r\n\r\n            /**\r\n             * Function: findClosestPointOnPath\r\n             * Finds the closest point on this segment to the given [x, y],\r\n             * returning both the x and y of the point plus its distance from\r\n             * the supplied point, and its location along the length of the\r\n             * path inscribed by the segment.  This implementation returns\r\n             * Infinity for distance and null values for everything else;\r\n             * subclasses are expected to override.\r\n             */\r\n            this.findClosestPointOnPath = function (x, y) {\r\n                return {\r\n                    d: Infinity,\r\n                    x: null,\r\n                    y: null,\r\n                    l: null\r\n                };\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: Math.min(params.x1, params.x2),\r\n                    minY: Math.min(params.y1, params.y2),\r\n                    maxX: Math.max(params.x1, params.x2),\r\n                    maxY: Math.max(params.y1, params.y2)\r\n                };\r\n            };\r\n\r\n            /**\r\n             * Computes the list of points on the segment that intersect the given line.\r\n             * @method lineIntersection\r\n             * @param {number} x1\r\n             * @param {number} y1\r\n             * @param {number} x2\r\n             * @param {number} y2\r\n             * @returns {Array<[number, number]>}\r\n             */\r\n            this.lineIntersection = function(x1, y1, x2, y2) {\r\n                return [];\r\n            };\r\n\r\n            /**\r\n             * Computes the list of points on the segment that intersect the box with the given origin and size.\r\n             * @method boxIntersection\r\n             * @param {number} x1\r\n             * @param {number} y1\r\n             * @param {number} w\r\n             * @param {number} h\r\n             * @returns {Array<[number, number]>}\r\n             */\r\n            this.boxIntersection = function(x, y, w, h) {\r\n                var a = [];\r\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\r\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\r\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\r\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\r\n                return a;\r\n            };\r\n\r\n            /**\r\n             * Computes the list of points on the segment that intersect the given bounding box, which is an object of the form { x:.., y:.., w:.., h:.. }.\r\n             * @method lineIntersection\r\n             * @param {BoundingRectangle} box\r\n             * @returns {Array<[number, number]>}\r\n             */\r\n            this.boundingBoxIntersection = function(box) {\r\n                return this.boxIntersection(box.x, box.y, box.w, box.y);\r\n            };\r\n        },\r\n        Straight: function (params) {\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\r\n                length, m, m2, x1, x2, y1, y2,\r\n                _recalc = function () {\r\n                    length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\r\n                    m = _jg.gradient({x: x1, y: y1}, {x: x2, y: y2});\r\n                    m2 = -1 / m;\r\n                };\r\n\r\n            this.type = \"Straight\";\r\n\r\n            this.getLength = function () {\r\n                return length;\r\n            };\r\n            this.getGradient = function () {\r\n                return m;\r\n            };\r\n\r\n            this.getCoordinates = function () {\r\n                return { x1: x1, y1: y1, x2: x2, y2: y2 };\r\n            };\r\n            this.setCoordinates = function (coords) {\r\n                x1 = coords.x1;\r\n                y1 = coords.y1;\r\n                x2 = coords.x2;\r\n                y2 = coords.y2;\r\n                _recalc();\r\n            };\r\n            this.setCoordinates({x1: params.x1, y1: params.y1, x2: params.x2, y2: params.y2});\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: Math.min(x1, x2),\r\n                    minY: Math.min(y1, y2),\r\n                    maxX: Math.max(x1, x2),\r\n                    maxY: Math.max(y1, y2)\r\n                };\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive. for the straight line segment this is simple maths.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n                if (location === 0 && !absolute) {\r\n                    return { x: x1, y: y1 };\r\n                }\r\n                else if (location === 1 && !absolute) {\r\n                    return { x: x2, y: y2 };\r\n                }\r\n                else {\r\n                    var l = absolute ? location > 0 ? location : length + location : location * length;\r\n                    return _jg.pointOnLine({x: x1, y: y1}, {x: x2, y: y2}, l);\r\n                }\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point - which for us is constant.\r\n             */\r\n            this.gradientAtPoint = function (_) {\r\n                return m;\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'distance' along the length of the path from 'location', where\r\n             * 'location' is a decimal from 0 to 1 inclusive, and 'distance' is a number of pixels.\r\n             * this hands off to jsPlumbUtil to do the maths, supplying two points and the distance.\r\n             */\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                var p = this.pointOnPath(location, absolute),\r\n                    farAwayPoint = distance <= 0 ? {x: x1, y: y1} : {x: x2, y: y2 };\r\n\r\n                /*\r\n                 location == 1 ? {\r\n                 x:x1 + ((x2 - x1) * 10),\r\n                 y:y1 + ((y1 - y2) * 10)\r\n                 } :\r\n                 */\r\n\r\n                if (distance <= 0 && Math.abs(distance) > 1) {\r\n                    distance *= -1;\r\n                }\r\n\r\n                return _jg.pointOnLine(p, farAwayPoint, distance);\r\n            };\r\n\r\n            // is c between a and b?\r\n            var within = function (a, b, c) {\r\n                return c >= Math.min(a, b) && c <= Math.max(a, b);\r\n            };\r\n            // find which of a and b is closest to c\r\n            var closest = function (a, b, c) {\r\n                return Math.abs(c - a) < Math.abs(c - b) ? a : b;\r\n            };\r\n\r\n            /**\r\n             Function: findClosestPointOnPath\r\n             Finds the closest point on this segment to [x,y]. See\r\n             notes on this method in AbstractSegment.\r\n             */\r\n            this.findClosestPointOnPath = function (x, y) {\r\n                var out = {\r\n                    d: Infinity,\r\n                    x: null,\r\n                    y: null,\r\n                    l: null,\r\n                    x1: x1,\r\n                    x2: x2,\r\n                    y1: y1,\r\n                    y2: y2\r\n                };\r\n\r\n                if (m === 0) {\r\n                    out.y = y1;\r\n                    out.x = within(x1, x2, x) ? x : closest(x1, x2, x);\r\n                }\r\n                else if (m === Infinity || m === -Infinity) {\r\n                    out.x = x1;\r\n                    out.y = within(y1, y2, y) ? y : closest(y1, y2, y);\r\n                }\r\n                else {\r\n                    // closest point lies on normal from given point to this line.\r\n                    var b = y1 - (m * x1),\r\n                        b2 = y - (m2 * x),\r\n                        // y1 = m.x1 + b and y1 = m2.x1 + b2\r\n                        // so m.x1 + b = m2.x1 + b2\r\n                        // x1(m - m2) = b2 - b\r\n                        // x1 = (b2 - b) / (m - m2)\r\n                        _x1 = (b2 - b) / (m - m2),\r\n                        _y1 = (m * _x1) + b;\r\n\r\n                    out.x = within(x1, x2, _x1) ? _x1 : closest(x1, x2, _x1);//_x1;\r\n                    out.y = within(y1, y2, _y1) ? _y1 : closest(y1, y2, _y1);//_y1;\r\n                }\r\n\r\n                var fractionInSegment = _jg.lineLength([ out.x, out.y ], [ x1, y1 ]);\r\n                out.d = _jg.lineLength([x, y], [out.x, out.y]);\r\n                out.l = fractionInSegment / length;\r\n                return out;\r\n            };\r\n\r\n            var _pointLiesBetween = function(q, p1, p2) {\r\n                return (p2 > p1) ? (p1 <= q && q <= p2) : (p1 >= q && q >= p2);\r\n            }, _plb = _pointLiesBetween;\r\n\r\n            /**\r\n             * Calculates all intersections of the given line with this segment.\r\n             * @param _x1\r\n             * @param _y1\r\n             * @param _x2\r\n             * @param _y2\r\n             * @returns {Array}\r\n             */\r\n            this.lineIntersection = function(_x1, _y1, _x2, _y2) {\r\n                var m2 = Math.abs(_jg.gradient({x: _x1, y: _y1}, {x: _x2, y: _y2})),\r\n                    m1 = Math.abs(m),\r\n                    b = m1 === Infinity ? x1 : y1 - (m1 * x1),\r\n                    out = [],\r\n                    b2 = m2 === Infinity ? _x1 : _y1 - (m2 * _x1);\r\n\r\n                // if lines parallel, no intersection\r\n                if  (m2 !== m1) {\r\n                    // perpendicular, segment horizontal\r\n                    if(m2 === Infinity  && m1 === 0) {\r\n                        if (_plb(_x1, x1, x2) && _plb(y1, _y1, _y2)) {\r\n                            out = [ _x1, y1 ];  // we return X on the incident line and Y from the segment\r\n                        }\r\n                    } else if(m2 === 0 && m1 === Infinity) {\r\n                        // perpendicular, segment vertical\r\n                        if(_plb(_y1, y1, y2) && _plb(x1, _x1, _x2)) {\r\n                            out = [x1, _y1];  // we return X on the segment and Y from the incident line\r\n                        }\r\n                    } else {\r\n                        var X, Y;\r\n                        if (m2 === Infinity) {\r\n                            // test line is a vertical line. where does it cross the segment?\r\n                            X = _x1;\r\n                            if (_plb(X, x1, x2)) {\r\n                                Y = (m1 * _x1) + b;\r\n                                if (_plb(Y, _y1, _y2)) {\r\n                                    out = [ X, Y ];\r\n                                }\r\n                            }\r\n                        } else if (m2 === 0) {\r\n                            Y = _y1;\r\n                            // test line is a horizontal line. where does it cross the segment?\r\n                            if (_plb(Y, y1, y2)) {\r\n                                X = (_y1 - b) / m1;\r\n                                if (_plb(X, _x1, _x2)) {\r\n                                    out = [ X, Y ];\r\n                                }\r\n                            }\r\n                        } else {\r\n                            // mX + b = m2X + b2\r\n                            // mX - m2X = b2 - b\r\n                            // X(m - m2) = b2 - b\r\n                            // X = (b2 - b) / (m - m2)\r\n                            // Y = mX + b\r\n                            X = (b2 - b) / (m1 - m2);\r\n                            Y = (m1 * X) + b;\r\n                            if(_plb(X, x1, x2) && _plb(Y, y1, y2)) {\r\n                                out = [ X,  Y];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return out;\r\n            };\r\n\r\n            /**\r\n             * Calculates all intersections of the given box with this segment. By default this method simply calls `lineIntersection` with each of the four\r\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\r\n             * @param x X position of top left corner of box\r\n             * @param y Y position of top left corner of box\r\n             * @param w width of box\r\n             * @param h height of box\r\n             * @returns {Array}\r\n             */\r\n            this.boxIntersection = function(x, y, w, h) {\r\n                var a = [];\r\n                a.push.apply(a, this.lineIntersection(x, y, x + w, y));\r\n                a.push.apply(a, this.lineIntersection(x + w, y, x + w, y + h));\r\n                a.push.apply(a, this.lineIntersection(x + w, y + h, x, y + h));\r\n                a.push.apply(a, this.lineIntersection(x, y + h, x, y));\r\n                return a;\r\n            };\r\n\r\n            /**\r\n             * Calculates all intersections of the given bounding box with this segment. By default this method simply calls `lineIntersection` with each of the four\r\n             * faces of the box; subclasses can override this if they think there's a faster way to compute the entire box at once.\r\n             * @param box Bounding box, in { x:.., y:..., w:..., h:... } format.\r\n             * @returns {Array}\r\n             */\r\n            this.boundingBoxIntersection = function(box) {\r\n                return this.boxIntersection(box.x, box.y, box.w, box.h);\r\n            };\r\n        },\r\n\r\n        /*\r\n         Arc Segment. You need to supply:\r\n\r\n         r   -   radius\r\n         cx  -   center x for the arc\r\n         cy  -   center y for the arc\r\n         ac  -   whether the arc is anticlockwise or not. default is clockwise.\r\n\r\n         and then either:\r\n\r\n         startAngle  -   startAngle for the arc.\r\n         endAngle    -   endAngle for the arc.\r\n\r\n         or:\r\n\r\n         x1          -   x for start point\r\n         y1          -   y for start point\r\n         x2          -   x for end point\r\n         y2          -   y for end point\r\n\r\n         */\r\n        Arc: function (params) {\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\r\n                _calcAngle = function (_x, _y) {\r\n                    return _jg.theta([params.cx, params.cy], [_x, _y]);\r\n                },\r\n                _calcAngleForLocation = function (segment, location) {\r\n                    if (segment.anticlockwise) {\r\n                        var sa = segment.startAngle < segment.endAngle ? segment.startAngle + TWO_PI : segment.startAngle,\r\n                            s = Math.abs(sa - segment.endAngle);\r\n                        return sa - (s * location);\r\n                    }\r\n                    else {\r\n                        var ea = segment.endAngle < segment.startAngle ? segment.endAngle + TWO_PI : segment.endAngle,\r\n                            ss = Math.abs(ea - segment.startAngle);\r\n\r\n                        return segment.startAngle + (ss * location);\r\n                    }\r\n                },\r\n                TWO_PI = 2 * Math.PI;\r\n\r\n            this.radius = params.r;\r\n            this.anticlockwise = params.ac;\r\n            this.type = \"Arc\";\r\n\r\n            if (params.startAngle && params.endAngle) {\r\n                this.startAngle = params.startAngle;\r\n                this.endAngle = params.endAngle;\r\n                this.x1 = params.cx + (this.radius * Math.cos(params.startAngle));\r\n                this.y1 = params.cy + (this.radius * Math.sin(params.startAngle));\r\n                this.x2 = params.cx + (this.radius * Math.cos(params.endAngle));\r\n                this.y2 = params.cy + (this.radius * Math.sin(params.endAngle));\r\n            }\r\n            else {\r\n                this.startAngle = _calcAngle(params.x1, params.y1);\r\n                this.endAngle = _calcAngle(params.x2, params.y2);\r\n                this.x1 = params.x1;\r\n                this.y1 = params.y1;\r\n                this.x2 = params.x2;\r\n                this.y2 = params.y2;\r\n            }\r\n\r\n            if (this.endAngle < 0) {\r\n                this.endAngle += TWO_PI;\r\n            }\r\n            if (this.startAngle < 0) {\r\n                this.startAngle += TWO_PI;\r\n            }\r\n\r\n            // segment is used by vml\r\n            //this.segment = _jg.quadrant([this.x1, this.y1], [this.x2, this.y2]);\r\n\r\n            // we now have startAngle and endAngle as positive numbers, meaning the\r\n            // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\r\n            // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\r\n\r\n            var ea = this.endAngle < this.startAngle ? this.endAngle + TWO_PI : this.endAngle;\r\n            this.sweep = Math.abs(ea - this.startAngle);\r\n            if (this.anticlockwise) {\r\n                this.sweep = TWO_PI - this.sweep;\r\n            }\r\n            var circumference = 2 * Math.PI * this.radius,\r\n                frac = this.sweep / TWO_PI,\r\n                length = circumference * frac;\r\n\r\n            this.getLength = function () {\r\n                return length;\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: params.cx - params.r,\r\n                    maxX: params.cx + params.r,\r\n                    minY: params.cy - params.r,\r\n                    maxY: params.cy + params.r\r\n                };\r\n            };\r\n\r\n            var VERY_SMALL_VALUE = 0.0000000001,\r\n                gentleRound = function (n) {\r\n                    var f = Math.floor(n), r = Math.ceil(n);\r\n                    if (n - f < VERY_SMALL_VALUE) {\r\n                        return f;\r\n                    }\r\n                    else if (r - n < VERY_SMALL_VALUE) {\r\n                        return r;\r\n                    }\r\n                    return n;\r\n                };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n\r\n                if (location === 0) {\r\n                    return { x: this.x1, y: this.y1, theta: this.startAngle };\r\n                }\r\n                else if (location === 1) {\r\n                    return { x: this.x2, y: this.y2, theta: this.endAngle };\r\n                }\r\n\r\n                if (absolute) {\r\n                    location = location / length;\r\n                }\r\n\r\n                var angle = _calcAngleForLocation(this, location),\r\n                    _x = params.cx + (params.r * Math.cos(angle)),\r\n                    _y = params.cy + (params.r * Math.sin(angle));\r\n\r\n                return { x: gentleRound(_x), y: gentleRound(_y), theta: angle };\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point.\r\n             */\r\n            this.gradientAtPoint = function (location, absolute) {\r\n                var p = this.pointOnPath(location, absolute);\r\n                var m = _jg.normal([ params.cx, params.cy ], [p.x, p.y ]);\r\n                if (!this.anticlockwise && (m === Infinity || m === -Infinity)) {\r\n                    m *= -1;\r\n                }\r\n                return m;\r\n            };\r\n\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                var p = this.pointOnPath(location, absolute),\r\n                    arcSpan = distance / circumference * 2 * Math.PI,\r\n                    dir = this.anticlockwise ? -1 : 1,\r\n                    startAngle = p.theta + (dir * arcSpan),\r\n                    startX = params.cx + (this.radius * Math.cos(startAngle)),\r\n                    startY = params.cy + (this.radius * Math.sin(startAngle));\r\n\r\n                return {x: startX, y: startY};\r\n            };\r\n\r\n            // TODO: lineIntersection\r\n        },\r\n\r\n        Bezier: function (params) {\r\n            this.curve = [\r\n                { x: params.x1, y: params.y1},\r\n                { x: params.cp1x, y: params.cp1y },\r\n                { x: params.cp2x, y: params.cp2y },\r\n                { x: params.x2, y: params.y2 }\r\n            ];\r\n\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments);\r\n            // although this is not a strictly rigorous determination of bounds\r\n            // of a bezier curve, it works for the types of curves that this segment\r\n            // type produces.\r\n            this.bounds = {\r\n                minX: Math.min(params.x1, params.x2, params.cp1x, params.cp2x),\r\n                minY: Math.min(params.y1, params.y2, params.cp1y, params.cp2y),\r\n                maxX: Math.max(params.x1, params.x2, params.cp1x, params.cp2x),\r\n                maxY: Math.max(params.y1, params.y2, params.cp1y, params.cp2y)\r\n            };\r\n\r\n            this.type = \"Bezier\";\r\n\r\n            var _translateLocation = function (_curve, location, absolute) {\r\n                if (absolute) {\r\n                    location = root.jsBezier.locationAlongCurveFrom(_curve, location > 0 ? 0 : 1, location);\r\n                }\r\n\r\n                return location;\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.pointOnCurve(this.curve, location);\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point.\r\n             */\r\n            this.gradientAtPoint = function (location, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.gradientAtPoint(this.curve, location);\r\n            };\r\n\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.pointAlongCurveFrom(this.curve, location, distance);\r\n            };\r\n\r\n            this.getLength = function () {\r\n                return root.jsBezier.getLength(this.curve);\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return this.bounds;\r\n            };\r\n\r\n            this.findClosestPointOnPath = function (x, y) {\r\n                var p = root.jsBezier.nearestPointOnCurve({x:x,y:y}, this.curve);\r\n                return {\r\n                    d:Math.sqrt(Math.pow(p.point.x - x, 2) + Math.pow(p.point.y - y, 2)),\r\n                    x:p.point.x,\r\n                    y:p.point.y,\r\n                    l:1 - p.location,\r\n                    s:this\r\n                };\r\n            };\r\n\r\n            this.lineIntersection = function(x1, y1, x2, y2) {\r\n                return root.jsBezier.lineIntersection(x1, y1, x2, y2, this.curve);\r\n            };\r\n        }\r\n    };\r\n\r\n    _jp.SegmentRenderer = {\r\n        getPath: function (segment, isFirstSegment) {\r\n            return ({\r\n                \"Straight\": function (isFirstSegment) {\r\n                    var d = segment.getCoordinates();\r\n                    return (isFirstSegment ? \"M \" + d.x1 + \" \" + d.y1 + \" \" : \"\") + \"L \" + d.x2 + \" \" + d.y2;\r\n                },\r\n                \"Bezier\": function (isFirstSegment) {\r\n                    var d = segment.params;\r\n                    return (isFirstSegment ? \"M \" + d.x2 + \" \" + d.y2 + \" \" : \"\") +\r\n                        \"C \" + d.cp2x + \" \" + d.cp2y + \" \" + d.cp1x + \" \" + d.cp1y + \" \" + d.x1 + \" \" + d.y1;\r\n                },\r\n                \"Arc\": function (isFirstSegment) {\r\n                    var d = segment.params,\r\n                        laf = segment.sweep > Math.PI ? 1 : 0,\r\n                        sf = segment.anticlockwise ? 0 : 1;\r\n\r\n                    return  (isFirstSegment ? \"M\" + segment.x1 + \" \" + segment.y1  + \" \" : \"\")  + \"A \" + segment.radius + \" \" + d.r + \" 0 \" + laf + \",\" + sf + \" \" + segment.x2 + \" \" + segment.y2;\r\n                }\r\n            })[segment.type](isFirstSegment);\r\n        }\r\n    };\r\n\r\n    /*\r\n     Class: UIComponent\r\n     Superclass for Connector and AbstractEndpoint.\r\n     */\r\n    var AbstractComponent = function () {\r\n        this.resetBounds = function () {\r\n            this.bounds = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\r\n        };\r\n        this.resetBounds();\r\n    };\r\n\r\n    /*\r\n     * Class: Connector\r\n     * Superclass for all Connectors; here is where Segments are managed.  This is exposed on jsPlumb just so it\r\n     * can be accessed from other files. You should not try to instantiate one of these directly.\r\n     *\r\n     * When this class is asked for a pointOnPath, or gradient etc, it must first figure out which segment to dispatch\r\n     * that request to. This is done by keeping track of the total connector length as segments are added, and also\r\n     * their cumulative ratios to the total length.  Then when the right segment is found it is a simple case of dispatching\r\n     * the request to it (and adjusting 'location' so that it is relative to the beginning of that segment.)\r\n     */\r\n    _jp.Connectors.AbstractConnector = function (params) {\r\n\r\n        AbstractComponent.apply(this, arguments);\r\n\r\n        var segments = [],\r\n            totalLength = 0,\r\n            segmentProportions = [],\r\n            segmentProportionalLengths = [],\r\n            stub = params.stub || 0,\r\n            sourceStub = _ju.isArray(stub) ? stub[0] : stub,\r\n            targetStub = _ju.isArray(stub) ? stub[1] : stub,\r\n            gap = params.gap || 0,\r\n            sourceGap = _ju.isArray(gap) ? gap[0] : gap,\r\n            targetGap = _ju.isArray(gap) ? gap[1] : gap,\r\n            userProvidedSegments = null,\r\n            paintInfo = null;\r\n\r\n        this.getPathData = function() {\r\n            var p = \"\";\r\n            for (var i = 0; i < segments.length; i++) {\r\n                p += _jp.SegmentRenderer.getPath(segments[i], i === 0);\r\n                p += \" \";\r\n            }\r\n            return p;\r\n        };\r\n\r\n        /**\r\n         * Function: findSegmentForPoint\r\n         * Returns the segment that is closest to the given [x,y],\r\n         * null if nothing found.  This function returns a JS\r\n         * object with:\r\n         *\r\n         *   d   -   distance from segment\r\n         *   l   -   proportional location in segment\r\n         *   x   -   x point on the segment\r\n         *   y   -   y point on the segment\r\n         *   s   -   the segment itself.\r\n         *   connectorLocation - the location on the connector of the point, expressed as a decimal between 0 and 1 inclusive.\r\n         */\r\n        this.findSegmentForPoint = function (x, y) {\r\n            var out = { d: Infinity, s: null, x: null, y: null, l: null };\r\n            for (var i = 0; i < segments.length; i++) {\r\n                var _s = segments[i].findClosestPointOnPath(x, y);\r\n                if (_s.d < out.d) {\r\n                    out.d = _s.d;\r\n                    out.l = _s.l;\r\n                    out.x = _s.x;\r\n                    out.y = _s.y;\r\n                    out.s = segments[i];\r\n                    out.x1 = _s.x1;\r\n                    out.x2 = _s.x2;\r\n                    out.y1 = _s.y1;\r\n                    out.y2 = _s.y2;\r\n                    out.index = i;\r\n                    out.connectorLocation = segmentProportions[i][0] + (_s.l * (segmentProportions[i][1] - segmentProportions[i][0]));\r\n                }\r\n            }\r\n\r\n            return out;\r\n        };\r\n\r\n        this.lineIntersection = function(x1, y1, x2, y2) {\r\n            var out = [];\r\n            for (var i = 0; i < segments.length; i++) {\r\n                out.push.apply(out, segments[i].lineIntersection(x1, y1, x2, y2));\r\n            }\r\n            return out;\r\n        };\r\n\r\n        this.boxIntersection = function(x, y, w, h) {\r\n            var out = [];\r\n            for (var i = 0; i < segments.length; i++) {\r\n                out.push.apply(out, segments[i].boxIntersection(x, y, w, h));\r\n            }\r\n            return out;\r\n        };\r\n\r\n        this.boundingBoxIntersection = function(box) {\r\n            var out = [];\r\n            for (var i = 0; i < segments.length; i++) {\r\n                out.push.apply(out, segments[i].boundingBoxIntersection(box));\r\n            }\r\n            return out;\r\n        };\r\n\r\n        var _updateSegmentProportions = function () {\r\n                var curLoc = 0;\r\n                for (var i = 0; i < segments.length; i++) {\r\n                    var sl = segments[i].getLength();\r\n                    segmentProportionalLengths[i] = sl / totalLength;\r\n                    segmentProportions[i] = [curLoc, (curLoc += (sl / totalLength)) ];\r\n                }\r\n            },\r\n\r\n            /**\r\n             * returns [segment, proportion of travel in segment, segment index] for the segment\r\n             * that contains the point which is 'location' distance along the entire path, where\r\n             * 'location' is a decimal between 0 and 1 inclusive. in this connector type, paths\r\n             * are made up of a list of segments, each of which contributes some fraction to\r\n             * the total length.\r\n             * From 1.3.10 this also supports the 'absolute' property, which lets us specify a location\r\n             * as the absolute distance in pixels, rather than a proportion of the total path.\r\n             */\r\n            _findSegmentForLocation = function (location, absolute) {\r\n                if (absolute) {\r\n                    location = location > 0 ? location / totalLength : (totalLength + location) / totalLength;\r\n                }\r\n                var idx = segmentProportions.length - 1, inSegmentProportion = 1;\r\n                for (var i = 0; i < segmentProportions.length; i++) {\r\n                    if (segmentProportions[i][1] >= location) {\r\n                        idx = i;\r\n                        // todo is this correct for all connector path types?\r\n                        inSegmentProportion = location === 1 ? 1 : location === 0 ? 0 : (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\r\n                        break;\r\n                    }\r\n                }\r\n                return { segment: segments[idx], proportion: inSegmentProportion, index: idx };\r\n            },\r\n            _addSegment = function (conn, type, params) {\r\n                if (params.x1 === params.x2 && params.y1 === params.y2) {\r\n                    return;\r\n                }\r\n                var s = new _jp.Segments[type](params);\r\n                segments.push(s);\r\n                totalLength += s.getLength();\r\n                conn.updateBounds(s);\r\n            },\r\n            _clearSegments = function () {\r\n                totalLength = segments.length = segmentProportions.length = segmentProportionalLengths.length = 0;\r\n            };\r\n\r\n        this.setSegments = function (_segs) {\r\n            userProvidedSegments = [];\r\n            totalLength = 0;\r\n            for (var i = 0; i < _segs.length; i++) {\r\n                userProvidedSegments.push(_segs[i]);\r\n                totalLength += _segs[i].getLength();\r\n            }\r\n        };\r\n\r\n        this.getLength = function() {\r\n            return totalLength;\r\n        };\r\n\r\n        var _prepareCompute = function (params) {\r\n            this.strokeWidth = params.strokeWidth;\r\n            var segment = _jg.quadrant(params.sourcePos, params.targetPos),\r\n                swapX = params.targetPos[0] < params.sourcePos[0],\r\n                swapY = params.targetPos[1] < params.sourcePos[1],\r\n                lw = params.strokeWidth || 1,\r\n                so = params.sourceEndpoint.anchor.getOrientation(params.sourceEndpoint),\r\n                to = params.targetEndpoint.anchor.getOrientation(params.targetEndpoint),\r\n                x = swapX ? params.targetPos[0] : params.sourcePos[0],\r\n                y = swapY ? params.targetPos[1] : params.sourcePos[1],\r\n                w = Math.abs(params.targetPos[0] - params.sourcePos[0]),\r\n                h = Math.abs(params.targetPos[1] - params.sourcePos[1]);\r\n\r\n            // if either anchor does not have an orientation set, we derive one from their relative\r\n            // positions.  we fix the axis to be the one in which the two elements are further apart, and\r\n            // point each anchor at the other element.  this is also used when dragging a new connection.\r\n            if (so[0] === 0 && so[1] === 0 || to[0] === 0 && to[1] === 0) {\r\n                var index = w > h ? 0 : 1, oIndex = [1, 0][index];\r\n                so = [];\r\n                to = [];\r\n                so[index] = params.sourcePos[index] > params.targetPos[index] ? -1 : 1;\r\n                to[index] = params.sourcePos[index] > params.targetPos[index] ? 1 : -1;\r\n                so[oIndex] = 0;\r\n                to[oIndex] = 0;\r\n            }\r\n\r\n            var sx = swapX ? w + (sourceGap * so[0]) : sourceGap * so[0],\r\n                sy = swapY ? h + (sourceGap * so[1]) : sourceGap * so[1],\r\n                tx = swapX ? targetGap * to[0] : w + (targetGap * to[0]),\r\n                ty = swapY ? targetGap * to[1] : h + (targetGap * to[1]),\r\n                oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\r\n\r\n            var result = {\r\n                sx: sx, sy: sy, tx: tx, ty: ty, lw: lw,\r\n                xSpan: Math.abs(tx - sx),\r\n                ySpan: Math.abs(ty - sy),\r\n                mx: (sx + tx) / 2,\r\n                my: (sy + ty) / 2,\r\n                so: so, to: to, x: x, y: y, w: w, h: h,\r\n                segment: segment,\r\n                startStubX: sx + (so[0] * sourceStub),\r\n                startStubY: sy + (so[1] * sourceStub),\r\n                endStubX: tx + (to[0] * targetStub),\r\n                endStubY: ty + (to[1] * targetStub),\r\n                isXGreaterThanStubTimes2: Math.abs(sx - tx) > (sourceStub + targetStub),\r\n                isYGreaterThanStubTimes2: Math.abs(sy - ty) > (sourceStub + targetStub),\r\n                opposite: oProduct === -1,\r\n                perpendicular: oProduct === 0,\r\n                orthogonal: oProduct === 1,\r\n                sourceAxis: so[0] === 0 ? \"y\" : \"x\",\r\n                points: [x, y, w, h, sx, sy, tx, ty ],\r\n                stubs:[sourceStub, targetStub]\r\n            };\r\n            result.anchorOrientation = result.opposite ? \"opposite\" : result.orthogonal ? \"orthogonal\" : \"perpendicular\";\r\n            return result;\r\n        };\r\n\r\n        this.getSegments = function () {\r\n            return segments;\r\n        };\r\n\r\n        this.updateBounds = function (segment) {\r\n            var segBounds = segment.getBounds();\r\n            this.bounds.minX = Math.min(this.bounds.minX, segBounds.minX);\r\n            this.bounds.maxX = Math.max(this.bounds.maxX, segBounds.maxX);\r\n            this.bounds.minY = Math.min(this.bounds.minY, segBounds.minY);\r\n            this.bounds.maxY = Math.max(this.bounds.maxY, segBounds.maxY);\r\n        };\r\n\r\n        var dumpSegmentsToConsole = function () {\r\n            console.log(\"SEGMENTS:\");\r\n            for (var i = 0; i < segments.length; i++) {\r\n                console.log(segments[i].type, segments[i].getLength(), segmentProportions[i]);\r\n            }\r\n        };\r\n\r\n        this.pointOnPath = function (location, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            return seg.segment && seg.segment.pointOnPath(seg.proportion, false) || [0, 0];\r\n        };\r\n\r\n        this.gradientAtPoint = function (location, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            return seg.segment && seg.segment.gradientAtPoint(seg.proportion, false) || 0;\r\n        };\r\n\r\n        this.pointAlongPathFrom = function (location, distance, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            // TODO what happens if this crosses to the next segment?\r\n            return seg.segment && seg.segment.pointAlongPathFrom(seg.proportion, distance, false) || [0, 0];\r\n        };\r\n\r\n        this.compute = function (params) {\r\n            paintInfo = _prepareCompute.call(this, params);\r\n\r\n            _clearSegments();\r\n            this._compute(paintInfo, params);\r\n            this.x = paintInfo.points[0];\r\n            this.y = paintInfo.points[1];\r\n            this.w = paintInfo.points[2];\r\n            this.h = paintInfo.points[3];\r\n            this.segment = paintInfo.segment;\r\n            _updateSegmentProportions();\r\n        };\r\n\r\n        return {\r\n            addSegment: _addSegment,\r\n            prepareCompute: _prepareCompute,\r\n            sourceStub: sourceStub,\r\n            targetStub: targetStub,\r\n            maxStub: Math.max(sourceStub, targetStub),\r\n            sourceGap: sourceGap,\r\n            targetGap: targetGap,\r\n            maxGap: Math.max(sourceGap, targetGap)\r\n        };\r\n    };\r\n    _ju.extend(_jp.Connectors.AbstractConnector, AbstractComponent);\r\n\r\n\r\n    // ********************************* END OF CONNECTOR TYPES *******************************************************************\r\n\r\n    // ********************************* ENDPOINT TYPES *******************************************************************\r\n\r\n    _jp.Endpoints.AbstractEndpoint = function (params) {\r\n        AbstractComponent.apply(this, arguments);\r\n        var compute = this.compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var out = this._compute.apply(this, arguments);\r\n            this.x = out[0];\r\n            this.y = out[1];\r\n            this.w = out[2];\r\n            this.h = out[3];\r\n            this.bounds.minX = this.x;\r\n            this.bounds.minY = this.y;\r\n            this.bounds.maxX = this.x + this.w;\r\n            this.bounds.maxY = this.y + this.h;\r\n            return out;\r\n        };\r\n        return {\r\n            compute: compute,\r\n            cssClass: params.cssClass\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.AbstractEndpoint, AbstractComponent);\r\n\r\n    /**\r\n     * Class: Endpoints.Dot\r\n     * A round endpoint, with default radius 10 pixels.\r\n     */\r\n\r\n    /**\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     *    radius    -    radius of the endpoint.  defaults to 10 pixels.\r\n     */\r\n    _jp.Endpoints.Dot = function (params) {\r\n        this.type = \"Dot\";\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        params = params || {};\r\n        this.radius = params.radius || 10;\r\n        this.defaultOffset = 0.5 * this.radius;\r\n        this.defaultInnerRadius = this.radius / 3;\r\n\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            this.radius = endpointStyle.radius || this.radius;\r\n            var x = anchorPoint[0] - this.radius,\r\n                y = anchorPoint[1] - this.radius,\r\n                w = this.radius * 2,\r\n                h = this.radius * 2;\r\n\r\n            if (endpointStyle.stroke) {\r\n                var lw = endpointStyle.strokeWidth || 1;\r\n                x -= lw;\r\n                y -= lw;\r\n                w += (lw * 2);\r\n                h += (lw * 2);\r\n            }\r\n            return [ x, y, w, h, this.radius ];\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Dot, _jp.Endpoints.AbstractEndpoint);\r\n\r\n    _jp.Endpoints.Rectangle = function (params) {\r\n        this.type = \"Rectangle\";\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        params = params || {};\r\n        this.width = params.width || 20;\r\n        this.height = params.height || 20;\r\n\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var width = endpointStyle.width || this.width,\r\n                height = endpointStyle.height || this.height,\r\n                x = anchorPoint[0] - (width / 2),\r\n                y = anchorPoint[1] - (height / 2);\r\n\r\n            return [ x, y, width, height];\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Rectangle, _jp.Endpoints.AbstractEndpoint);\r\n\r\n    var DOMElementEndpoint = function (params) {\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        this._jsPlumb.displayElements = [];\r\n    };\r\n    _ju.extend(DOMElementEndpoint, _jp.jsPlumbUIComponent, {\r\n        getDisplayElements: function () {\r\n            return this._jsPlumb.displayElements;\r\n        },\r\n        appendDisplayElement: function (el) {\r\n            this._jsPlumb.displayElements.push(el);\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Class: Endpoints.Image\r\n     * Draws an image as the Endpoint.\r\n     */\r\n    /**\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     *    src    -    location of the image to use.\r\n\r\n     TODO: multiple references to self. not sure quite how to get rid of them entirely. perhaps self = null in the cleanup\r\n     function will suffice\r\n\r\n     TODO this class still might leak memory.\r\n\r\n     */\r\n    _jp.Endpoints.Image = function (params) {\r\n\r\n        this.type = \"Image\";\r\n        DOMElementEndpoint.apply(this, arguments);\r\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n\r\n        var _onload = params.onload,\r\n            src = params.src || params.url,\r\n            clazz = params.cssClass ? \" \" + params.cssClass : \"\";\r\n\r\n        this._jsPlumb.img = new Image();\r\n        this._jsPlumb.ready = false;\r\n        this._jsPlumb.initialized = false;\r\n        this._jsPlumb.deleted = false;\r\n        this._jsPlumb.widthToUse = params.width;\r\n        this._jsPlumb.heightToUse = params.height;\r\n        this._jsPlumb.endpoint = params.endpoint;\r\n\r\n        this._jsPlumb.img.onload = function () {\r\n            if (this._jsPlumb != null) {\r\n                this._jsPlumb.ready = true;\r\n                this._jsPlumb.widthToUse = this._jsPlumb.widthToUse || this._jsPlumb.img.width;\r\n                this._jsPlumb.heightToUse = this._jsPlumb.heightToUse || this._jsPlumb.img.height;\r\n                if (_onload) {\r\n                    _onload(this);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        /*\r\n         Function: setImage\r\n         Sets the Image to use in this Endpoint.\r\n\r\n         Parameters:\r\n         img         -   may be a URL or an Image object\r\n         onload      -   optional; a callback to execute once the image has loaded.\r\n         */\r\n        this._jsPlumb.endpoint.setImage = function (_img, onload) {\r\n            var s = _img.constructor === String ? _img : _img.src;\r\n            _onload = onload;\r\n            this._jsPlumb.img.src = s;\r\n\r\n            if (this.canvas != null) {\r\n                this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\r\n            }\r\n        }.bind(this);\r\n\r\n        this._jsPlumb.endpoint.setImage(src, _onload);\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            this.anchorPoint = anchorPoint;\r\n            if (this._jsPlumb.ready) {\r\n                return [anchorPoint[0] - this._jsPlumb.widthToUse / 2, anchorPoint[1] - this._jsPlumb.heightToUse / 2,\r\n                    this._jsPlumb.widthToUse, this._jsPlumb.heightToUse];\r\n            }\r\n            else {\r\n                return [0, 0, 0, 0];\r\n            }\r\n        };\r\n\r\n        this.canvas = _jp.createElement(\"img\", {\r\n            position:\"absolute\",\r\n            margin:0,\r\n            padding:0,\r\n            outline:0\r\n        }, this._jsPlumb.instance.endpointClass + clazz);\r\n\r\n        if (this._jsPlumb.widthToUse) {\r\n            this.canvas.setAttribute(\"width\", this._jsPlumb.widthToUse);\r\n        }\r\n        if (this._jsPlumb.heightToUse) {\r\n            this.canvas.setAttribute(\"height\", this._jsPlumb.heightToUse);\r\n        }\r\n        this._jsPlumb.instance.appendElement(this.canvas);\r\n\r\n        this.actuallyPaint = function (d, style, anchor) {\r\n            if (!this._jsPlumb.deleted) {\r\n                if (!this._jsPlumb.initialized) {\r\n                    this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\r\n                    this.appendDisplayElement(this.canvas);\r\n                    this._jsPlumb.initialized = true;\r\n                }\r\n                var x = this.anchorPoint[0] - (this._jsPlumb.widthToUse / 2),\r\n                    y = this.anchorPoint[1] - (this._jsPlumb.heightToUse / 2);\r\n                _ju.sizeElement(this.canvas, x, y, this._jsPlumb.widthToUse, this._jsPlumb.heightToUse);\r\n            }\r\n        };\r\n\r\n        this.paint = function (style, anchor) {\r\n            if (this._jsPlumb != null) {  // may have been deleted\r\n                if (this._jsPlumb.ready) {\r\n                    this.actuallyPaint(style, anchor);\r\n                }\r\n                else {\r\n                    root.setTimeout(function () {\r\n                        this.paint(style, anchor);\r\n                    }.bind(this), 200);\r\n                }\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Image, [ DOMElementEndpoint, _jp.Endpoints.AbstractEndpoint ], {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this._jsPlumb.deleted = true;\r\n                if (this.canvas) {\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n                }\r\n                this.canvas = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Endpoints.Blank\r\n     * An Endpoint that paints nothing (visible) on the screen.  Supports cssClass and hoverClass parameters like all Endpoints.\r\n     */\r\n    _jp.Endpoints.Blank = function (params) {\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        this.type = \"Blank\";\r\n        DOMElementEndpoint.apply(this, arguments);\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            return [anchorPoint[0], anchorPoint[1], 10, 0];\r\n        };\r\n\r\n        var clazz = params.cssClass ? \" \" + params.cssClass : \"\";\r\n\r\n        this.canvas = _jp.createElement(\"div\", {\r\n            display: \"block\",\r\n            width: \"1px\",\r\n            height: \"1px\",\r\n            background: \"transparent\",\r\n            position: \"absolute\"\r\n        }, this._jsPlumb.instance.endpointClass + clazz);\r\n\r\n        this._jsPlumb.instance.appendElement(this.canvas);\r\n\r\n        this.paint = function (style, anchor) {\r\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Blank, [_jp.Endpoints.AbstractEndpoint, DOMElementEndpoint], {\r\n        cleanup: function () {\r\n            if (this.canvas && this.canvas.parentNode) {\r\n                this.canvas.parentNode.removeChild(this.canvas);\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Endpoints.Triangle\r\n     * A triangular Endpoint.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     * width   width of the triangle's base.  defaults to 55 pixels.\r\n     * height  height of the triangle from base to apex.  defaults to 55 pixels.\r\n     */\r\n    _jp.Endpoints.Triangle = function (params) {\r\n        this.type = \"Triangle\";\r\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        var self = this;\r\n        params = params || {  };\r\n        params.width = params.width || 55;\r\n        params.height = params.height || 55;\r\n        this.width = params.width;\r\n        this.height = params.height;\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var width = endpointStyle.width || self.width,\r\n                height = endpointStyle.height || self.height,\r\n                x = anchorPoint[0] - (width / 2),\r\n                y = anchorPoint[1] - (height / 2);\r\n            return [ x, y, width, height ];\r\n        };\r\n    };\r\n// ********************************* END OF ENDPOINT TYPES *******************************************************************\r\n\r\n\r\n// ********************************* OVERLAY DEFINITIONS ***********************************************************************\r\n\r\n    var AbstractOverlay = _jp.Overlays.AbstractOverlay = function (params) {\r\n        this.visible = true;\r\n        this.isAppendedAtTopLevel = true;\r\n        this.component = params.component;\r\n        this.loc = params.location == null ? 0.5 : params.location;\r\n        this.endpointLoc = params.endpointLocation == null ? [ 0.5, 0.5] : params.endpointLocation;\r\n        this.visible = params.visible !== false;\r\n    };\r\n    AbstractOverlay.prototype = {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this.component = null;\r\n                this.canvas = null;\r\n                this.endpointLoc = null;\r\n            }\r\n        },\r\n        reattach:function(instance, component) { },\r\n        setVisible: function (val) {\r\n            this.visible = val;\r\n            this.component.repaint();\r\n        },\r\n        isVisible: function () {\r\n            return this.visible;\r\n        },\r\n        hide: function () {\r\n            this.setVisible(false);\r\n        },\r\n        show: function () {\r\n            this.setVisible(true);\r\n        },\r\n        incrementLocation: function (amount) {\r\n            this.loc += amount;\r\n            this.component.repaint();\r\n        },\r\n        setLocation: function (l) {\r\n            this.loc = l;\r\n            this.component.repaint();\r\n        },\r\n        getLocation: function () {\r\n            return this.loc;\r\n        },\r\n        updateFrom:function() { }\r\n    };\r\n\r\n\r\n    /*\r\n     * Class: Overlays.Arrow\r\n     *\r\n     * An arrow overlay, defined by four points: the head, the two sides of the tail, and a 'foldback' point at some distance along the length\r\n     * of the arrow that lines from each tail point converge into.  The foldback point is defined using a decimal that indicates some fraction\r\n     * of the length of the arrow and has a default value of 0.623.  A foldback point value of 1 would mean that the arrow had a straight line\r\n     * across the tail.\r\n     */\r\n    /*\r\n     * @constructor\r\n     *\r\n     * @param {Object} params Constructor params.\r\n     * @param {Number} [params.length] Distance in pixels from head to tail baseline. default 20.\r\n     * @param {Number} [params.width] Width in pixels of the tail baseline. default 20.\r\n     * @param {String} [params.fill] Style to use when filling the arrow.  defaults to \"black\".\r\n     * @param {String} [params.stroke] Style to use when stroking the arrow. defaults to null, which means the arrow is not stroked.\r\n     * @param {Number} [params.stroke-width] Line width to use when stroking the arrow. defaults to 1, but only used if stroke is not null.\r\n     * @param {Number} [params.foldback] Distance (as a decimal from 0 to 1 inclusive) along the length of the arrow marking the point the tail points should fold back to.  defaults to 0.623.\r\n     * @param {Number} [params.location] Distance (as a decimal from 0 to 1 inclusive) marking where the arrow should sit on the connector. defaults to 0.5.\r\n     * @param {NUmber} [params.direction] Indicates the direction the arrow points in. valid values are -1 and 1; 1 is default.\r\n     */\r\n    _jp.Overlays.Arrow = function (params) {\r\n        this.type = \"Arrow\";\r\n        AbstractOverlay.apply(this, arguments);\r\n        this.isAppendedAtTopLevel = false;\r\n        params = params || {};\r\n        var self = this;\r\n\r\n        this.length = params.length || 20;\r\n        this.width = params.width || 20;\r\n        this.id = params.id;\r\n        this.direction = (params.direction || 1) < 0 ? -1 : 1;\r\n        var paintStyle = params.paintStyle || { \"stroke-width\": 1 },\r\n            // how far along the arrow the lines folding back in come to. default is 62.3%.\r\n            foldback = params.foldback || 0.623;\r\n\r\n        this.computeMaxSize = function () {\r\n            return self.width * 1.5;\r\n        };\r\n\r\n        this.elementCreated = function(p, component) {\r\n            this.path = p;\r\n            if (params.events) {\r\n                for (var i in params.events) {\r\n                    _jp.on(p, i, params.events[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        this.draw = function (component, currentConnectionPaintStyle) {\r\n\r\n            var hxy, mid, txy, tail, cxy;\r\n            if (component.pointAlongPathFrom) {\r\n\r\n                if (_ju.isString(this.loc) || this.loc > 1 || this.loc < 0) {\r\n                    var l = parseInt(this.loc, 10),\r\n                        fromLoc = this.loc < 0 ? 1 : 0;\r\n                    hxy = component.pointAlongPathFrom(fromLoc, l, false);\r\n                    mid = component.pointAlongPathFrom(fromLoc, l - (this.direction * this.length / 2), false);\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n                }\r\n                else if (this.loc === 1) {\r\n                    hxy = component.pointOnPath(this.loc);\r\n                    mid = component.pointAlongPathFrom(this.loc, -(this.length));\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n\r\n                    if (this.direction === -1) {\r\n                        var _ = txy;\r\n                        txy = hxy;\r\n                        hxy = _;\r\n                    }\r\n                }\r\n                else if (this.loc === 0) {\r\n                    txy = component.pointOnPath(this.loc);\r\n                    mid = component.pointAlongPathFrom(this.loc, this.length);\r\n                    hxy = _jg.pointOnLine(txy, mid, this.length);\r\n                    if (this.direction === -1) {\r\n                        var __ = txy;\r\n                        txy = hxy;\r\n                        hxy = __;\r\n                    }\r\n                }\r\n                else {\r\n                    hxy = component.pointAlongPathFrom(this.loc, this.direction * this.length / 2);\r\n                    mid = component.pointOnPath(this.loc);\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n                }\r\n\r\n                tail = _jg.perpendicularLineTo(hxy, txy, this.width);\r\n                cxy = _jg.pointOnLine(hxy, txy, foldback * this.length);\r\n\r\n                var d = { hxy: hxy, tail: tail, cxy: cxy },\r\n                    stroke = paintStyle.stroke || currentConnectionPaintStyle.stroke,\r\n                    fill = paintStyle.fill || currentConnectionPaintStyle.stroke,\r\n                    lineWidth = paintStyle.strokeWidth || currentConnectionPaintStyle.strokeWidth;\r\n\r\n                return {\r\n                    component: component,\r\n                    d: d,\r\n                    \"stroke-width\": lineWidth,\r\n                    stroke: stroke,\r\n                    fill: fill,\r\n                    minX: Math.min(hxy.x, tail[0].x, tail[1].x),\r\n                    maxX: Math.max(hxy.x, tail[0].x, tail[1].x),\r\n                    minY: Math.min(hxy.y, tail[0].y, tail[1].y),\r\n                    maxY: Math.max(hxy.y, tail[0].y, tail[1].y)\r\n                };\r\n            }\r\n            else {\r\n                return {component: component, minX: 0, maxX: 0, minY: 0, maxY: 0};\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.Overlays.Arrow, AbstractOverlay, {\r\n        updateFrom:function(d) {\r\n            this.length = d.length || this.length;\r\n            this.width = d.width|| this.width;\r\n            this.direction = d.direction != null ? d.direction : this.direction;\r\n            this.foldback = d.foldback|| this.foldback;\r\n        },\r\n        cleanup:function() {\r\n            if (this.path && this.canvas) {\r\n                this.canvas.removeChild(this.path);\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Overlays.PlainArrow\r\n     *\r\n     * A basic arrow.  This is in fact just one instance of the more generic case in which the tail folds back on itself to some\r\n     * point along the length of the arrow: in this case, that foldback point is the full length of the arrow.  so it just does\r\n     * a 'call' to Arrow with foldback set appropriately.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\r\n     */\r\n    _jp.Overlays.PlainArrow = function (params) {\r\n        params = params || {};\r\n        var p = _jp.extend(params, {foldback: 1});\r\n        _jp.Overlays.Arrow.call(this, p);\r\n        this.type = \"PlainArrow\";\r\n    };\r\n    _ju.extend(_jp.Overlays.PlainArrow, _jp.Overlays.Arrow);\r\n\r\n    /*\r\n     * Class: Overlays.Diamond\r\n     *\r\n     * A diamond. Like PlainArrow, this is a concrete case of the more generic case of the tail points converging on some point...it just\r\n     * happens that in this case, that point is greater than the length of the the arrow.\r\n     *\r\n     *      this could probably do with some help with positioning...due to the way it reuses the Arrow paint code, what Arrow thinks is the\r\n     *      center is actually 1/4 of the way along for this guy.  but we don't have any knowledge of pixels at this point, so we're kind of\r\n     *      stuck when it comes to helping out the Arrow class. possibly we could pass in a 'transpose' parameter or something. the value\r\n     *      would be -l/4 in this case - move along one quarter of the total length.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\r\n     */\r\n    _jp.Overlays.Diamond = function (params) {\r\n        params = params || {};\r\n        var l = params.length || 40,\r\n            p = _jp.extend(params, {length: l / 2, foldback: 2});\r\n        _jp.Overlays.Arrow.call(this, p);\r\n        this.type = \"Diamond\";\r\n    };\r\n    _ju.extend(_jp.Overlays.Diamond, _jp.Overlays.Arrow);\r\n\r\n    var _getDimensions = function (component, forceRefresh) {\r\n        if (component._jsPlumb.cachedDimensions == null || forceRefresh) {\r\n            component._jsPlumb.cachedDimensions = component.getDimensions();\r\n        }\r\n        return component._jsPlumb.cachedDimensions;\r\n    };\r\n\r\n    // abstract superclass for overlays that add an element to the DOM.\r\n    var AbstractDOMOverlay = function (params) {\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        AbstractOverlay.apply(this, arguments);\r\n\r\n        // hand off fired events to associated component.\r\n        var _f = this.fire;\r\n        this.fire = function () {\r\n            _f.apply(this, arguments);\r\n            if (this.component) {\r\n                this.component.fire.apply(this.component, arguments);\r\n            }\r\n        };\r\n\r\n        this.detached=false;\r\n        this.id = params.id;\r\n        this._jsPlumb.div = null;\r\n        this._jsPlumb.initialised = false;\r\n        this._jsPlumb.component = params.component;\r\n        this._jsPlumb.cachedDimensions = null;\r\n        this._jsPlumb.create = params.create;\r\n        this._jsPlumb.initiallyInvisible = params.visible === false;\r\n\r\n        this.getElement = function () {\r\n            if (this._jsPlumb.div == null) {\r\n                var div = this._jsPlumb.div = _jp.getElement(this._jsPlumb.create(this._jsPlumb.component));\r\n                div.style.position = \"absolute\";\r\n                jsPlumb.addClass(div, this._jsPlumb.instance.overlayClass + \" \" +\r\n                    (this.cssClass ? this.cssClass :\r\n                        params.cssClass ? params.cssClass : \"\"));\r\n                this._jsPlumb.instance.appendElement(div);\r\n                this._jsPlumb.instance.getId(div);\r\n                this.canvas = div;\r\n\r\n                // in IE the top left corner is what it placed at the desired location.  This will not\r\n                // be fixed. IE8 is not going to be supported for much longer.\r\n                var ts = \"translate(-50%, -50%)\";\r\n                div.style.webkitTransform = ts;\r\n                div.style.mozTransform = ts;\r\n                div.style.msTransform = ts;\r\n                div.style.oTransform = ts;\r\n                div.style.transform = ts;\r\n\r\n                // write the related component into the created element\r\n                div._jsPlumb = this;\r\n\r\n                if (params.visible === false) {\r\n                    div.style.display = \"none\";\r\n                }\r\n            }\r\n            return this._jsPlumb.div;\r\n        };\r\n\r\n        this.draw = function (component, currentConnectionPaintStyle, absolutePosition) {\r\n            var td = _getDimensions(this);\r\n            if (td != null && td.length === 2) {\r\n                var cxy = { x: 0, y: 0 };\r\n\r\n                // absolutePosition would have been set by a call to connection.setAbsoluteOverlayPosition.\r\n                if (absolutePosition) {\r\n                    cxy = { x: absolutePosition[0], y: absolutePosition[1] };\r\n                }\r\n                else if (component.pointOnPath) {\r\n                    var loc = this.loc, absolute = false;\r\n                    if (_ju.isString(this.loc) || this.loc < 0 || this.loc > 1) {\r\n                        loc = parseInt(this.loc, 10);\r\n                        absolute = true;\r\n                    }\r\n                    cxy = component.pointOnPath(loc, absolute);  // a connection\r\n                }\r\n                else {\r\n                    var locToUse = this.loc.constructor === Array ? this.loc : this.endpointLoc;\r\n                    cxy = { x: locToUse[0] * component.w,\r\n                        y: locToUse[1] * component.h };\r\n                }\r\n\r\n                var minx = cxy.x - (td[0] / 2),\r\n                    miny = cxy.y - (td[1] / 2);\r\n\r\n                return {\r\n                    component: component,\r\n                    d: { minx: minx, miny: miny, td: td, cxy: cxy },\r\n                    minX: minx,\r\n                    maxX: minx + td[0],\r\n                    minY: miny,\r\n                    maxY: miny + td[1]\r\n                };\r\n            }\r\n            else {\r\n                return {minX: 0, maxX: 0, minY: 0, maxY: 0};\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(AbstractDOMOverlay, [_jp.jsPlumbUIComponent, AbstractOverlay], {\r\n        getDimensions: function () {\r\n            return [1,1];\r\n        },\r\n        setVisible: function (state) {\r\n            if (this._jsPlumb.div) {\r\n                this._jsPlumb.div.style.display = state ? \"block\" : \"none\";\r\n                // if initially invisible, dimensions are 0,0 and never get updated\r\n                if (state && this._jsPlumb.initiallyInvisible) {\r\n                    _getDimensions(this, true);\r\n                    this.component.repaint();\r\n                    this._jsPlumb.initiallyInvisible = false;\r\n                }\r\n            }\r\n        },\r\n        /*\r\n         * Function: clearCachedDimensions\r\n         * Clears the cached dimensions for the label. As a performance enhancement, label dimensions are\r\n         * cached from 1.3.12 onwards. The cache is cleared when you change the label text, of course, but\r\n         * there are other reasons why the text dimensions might change - if you make a change through CSS, for\r\n         * example, you might change the font size.  in that case you should explicitly call this method.\r\n         */\r\n        clearCachedDimensions: function () {\r\n            this._jsPlumb.cachedDimensions = null;\r\n        },\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                if (this._jsPlumb.div != null) {\r\n                    this._jsPlumb.div._jsPlumb = null;\r\n                    this._jsPlumb.instance.removeElement(this._jsPlumb.div);\r\n                }\r\n            }\r\n            else {\r\n                // if not a forced cleanup, just detach child from parent for now.\r\n                if (this._jsPlumb && this._jsPlumb.div && this._jsPlumb.div.parentNode) {\r\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\r\n                }\r\n                this.detached = true;\r\n            }\r\n\r\n        },\r\n        reattach:function(instance, component) {\r\n            if (this._jsPlumb.div != null) {\r\n                instance.getContainer().appendChild(this._jsPlumb.div);\r\n            }\r\n            this.detached = false;\r\n        },\r\n        computeMaxSize: function () {\r\n            var td = _getDimensions(this);\r\n            return Math.max(td[0], td[1]);\r\n        },\r\n        paint: function (p, containerExtents) {\r\n            if (!this._jsPlumb.initialised) {\r\n                this.getElement();\r\n                p.component.appendDisplayElement(this._jsPlumb.div);\r\n                this._jsPlumb.initialised = true;\r\n                if (this.detached) {\r\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\r\n                }\r\n            }\r\n            this._jsPlumb.div.style.left = (p.component.x + p.d.minx) + \"px\";\r\n            this._jsPlumb.div.style.top = (p.component.y + p.d.miny) + \"px\";\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Overlays.Custom\r\n     * A Custom overlay. You supply a 'create' function which returns some DOM element, and jsPlumb positions it.\r\n     * The 'create' function is passed a Connection or Endpoint.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     * create - function for jsPlumb to call that returns a DOM element.\r\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\r\n     * id - optional id to use for later retrieval of this overlay.\r\n     *\r\n     */\r\n    _jp.Overlays.Custom = function (params) {\r\n        this.type = \"Custom\";\r\n        AbstractDOMOverlay.apply(this, arguments);\r\n    };\r\n    _ju.extend(_jp.Overlays.Custom, AbstractDOMOverlay);\r\n\r\n    _jp.Overlays.GuideLines = function () {\r\n        var self = this;\r\n        self.length = 50;\r\n        self.strokeWidth = 5;\r\n        this.type = \"GuideLines\";\r\n        AbstractOverlay.apply(this, arguments);\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        this.draw = function (connector, currentConnectionPaintStyle) {\r\n\r\n            var head = connector.pointAlongPathFrom(self.loc, self.length / 2),\r\n                mid = connector.pointOnPath(self.loc),\r\n                tail = _jg.pointOnLine(head, mid, self.length),\r\n                tailLine = _jg.perpendicularLineTo(head, tail, 40),\r\n                headLine = _jg.perpendicularLineTo(tail, head, 20);\r\n\r\n            return {\r\n                connector: connector,\r\n                head: head,\r\n                tail: tail,\r\n                headLine: headLine,\r\n                tailLine: tailLine,\r\n                minX: Math.min(head.x, tail.x, headLine[0].x, headLine[1].x),\r\n                minY: Math.min(head.y, tail.y, headLine[0].y, headLine[1].y),\r\n                maxX: Math.max(head.x, tail.x, headLine[0].x, headLine[1].x),\r\n                maxY: Math.max(head.y, tail.y, headLine[0].y, headLine[1].y)\r\n            };\r\n        };\r\n\r\n        // this.cleanup = function() { };  // nothing to clean up for GuideLines\r\n    };\r\n\r\n    /*\r\n     * Class: Overlays.Label\r\n\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     * cssClass - optional css class string to append to css class. This string is appended \"as-is\", so you can of course have multiple classes\r\n     *             defined.  This parameter is preferred to using labelStyle, borderWidth and borderStyle.\r\n     * label - the label to paint.  May be a string or a function that returns a string.  Nothing will be painted if your label is null or your\r\n     *         label function returns null.  empty strings _will_ be painted.\r\n     * location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\r\n     * id - optional id to use for later retrieval of this overlay.\r\n     *\r\n     *\r\n     */\r\n    _jp.Overlays.Label = function (params) {\r\n        this.labelStyle = params.labelStyle;\r\n\r\n        var labelWidth = null, labelHeight = null, labelText = null, labelPadding = null;\r\n        this.cssClass = this.labelStyle != null ? this.labelStyle.cssClass : null;\r\n        var p = _jp.extend({\r\n            create: function () {\r\n                return _jp.createElement(\"div\");\r\n            }}, params);\r\n        _jp.Overlays.Custom.call(this, p);\r\n        this.type = \"Label\";\r\n        this.label = params.label || \"\";\r\n        this.labelText = null;\r\n        if (this.labelStyle) {\r\n            var el = this.getElement();\r\n            this.labelStyle.font = this.labelStyle.font || \"12px sans-serif\";\r\n            el.style.font = this.labelStyle.font;\r\n            el.style.color = this.labelStyle.color || \"black\";\r\n            if (this.labelStyle.fill) {\r\n                el.style.background = this.labelStyle.fill;\r\n            }\r\n            if (this.labelStyle.borderWidth > 0) {\r\n                var dStyle = this.labelStyle.borderStyle ? this.labelStyle.borderStyle : \"black\";\r\n                el.style.border = this.labelStyle.borderWidth + \"px solid \" + dStyle;\r\n            }\r\n            if (this.labelStyle.padding) {\r\n                el.style.padding = this.labelStyle.padding;\r\n            }\r\n        }\r\n\r\n    };\r\n    _ju.extend(_jp.Overlays.Label, _jp.Overlays.Custom, {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this.div = null;\r\n                this.label = null;\r\n                this.labelText = null;\r\n                this.cssClass = null;\r\n                this.labelStyle = null;\r\n            }\r\n        },\r\n        getLabel: function () {\r\n            return this.label;\r\n        },\r\n        /*\r\n         * Function: setLabel\r\n         * sets the label's, um, label.  you would think i'd call this function\r\n         * 'setText', but you can pass either a Function or a String to this, so\r\n         * it makes more sense as 'setLabel'. This uses innerHTML on the label div, so keep\r\n         * that in mind if you need escaped HTML.\r\n         */\r\n        setLabel: function (l) {\r\n            this.label = l;\r\n            this.labelText = null;\r\n            this.clearCachedDimensions();\r\n            this.update();\r\n            this.component.repaint();\r\n        },\r\n        getDimensions: function () {\r\n            this.update();\r\n            return AbstractDOMOverlay.prototype.getDimensions.apply(this, arguments);\r\n        },\r\n        update: function () {\r\n            if (typeof this.label === \"function\") {\r\n                var lt = this.label(this);\r\n                this.getElement().innerHTML = lt.replace(/\\r\\n/g, \"<br/>\");\r\n            }\r\n            else {\r\n                if (this.labelText == null) {\r\n                    this.labelText = this.label;\r\n                    this.getElement().innerHTML = this.labelText.replace(/\\r\\n/g, \"<br/>\");\r\n                }\r\n            }\r\n        },\r\n        updateFrom:function(d) {\r\n            if(d.label != null){\r\n                this.setLabel(d.label);\r\n            }\r\n        }\r\n    });\r\n\r\n    // ********************************* END OF OVERLAY DEFINITIONS ***********************************************************************\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var root = this,\r\n        _ju = root.jsPlumbUtil,\r\n        _jpi = root.jsPlumbInstance;\r\n\r\n    var GROUP_COLLAPSED_CLASS = \"jtk-group-collapsed\";\r\n    var GROUP_EXPANDED_CLASS = \"jtk-group-expanded\";\r\n    var GROUP_CONTAINER_SELECTOR = \"[jtk-group-content]\";\r\n    var ELEMENT_DRAGGABLE_EVENT = \"elementDraggable\";\r\n    var STOP = \"stop\";\r\n    var REVERT = \"revert\";\r\n    var GROUP_MANAGER = \"_groupManager\";\r\n    var GROUP = \"_jsPlumbGroup\";\r\n    var GROUP_DRAG_SCOPE = \"_jsPlumbGroupDrag\";\r\n    var EVT_CHILD_ADDED = \"group:addMember\";\r\n    var EVT_CHILD_REMOVED = \"group:removeMember\";\r\n    var EVT_GROUP_ADDED = \"group:add\";\r\n    var EVT_GROUP_REMOVED = \"group:remove\";\r\n    var EVT_EXPAND = \"group:expand\";\r\n    var EVT_COLLAPSE = \"group:collapse\";\r\n    var EVT_GROUP_DRAG_STOP = \"groupDragStop\";\r\n    var EVT_CONNECTION_MOVED = \"connectionMoved\";\r\n    var EVT_INTERNAL_CONNECTION_DETACHED = \"internal.connectionDetached\";\r\n\r\n    var CMD_REMOVE_ALL = \"removeAll\";\r\n    var CMD_ORPHAN_ALL = \"orphanAll\";\r\n    var CMD_SHOW = \"show\";\r\n    var CMD_HIDE = \"hide\";\r\n\r\n    var GroupManager = function(_jsPlumb) {\r\n        var _managedGroups = {}, _connectionSourceMap = {}, _connectionTargetMap = {}, self = this;\r\n\r\n        _jsPlumb.bind(\"connection\", function(p) {\r\n            if (p.source[GROUP] != null && p.target[GROUP] != null && p.source[GROUP] === p.target[GROUP]) {\r\n                _connectionSourceMap[p.connection.id] = p.source[GROUP];\r\n                _connectionTargetMap[p.connection.id] = p.source[GROUP];\r\n            }\r\n            else {\r\n                if (p.source[GROUP] != null) {\r\n                    _ju.suggest(p.source[GROUP].connections.source, p.connection);\r\n                    _connectionSourceMap[p.connection.id] = p.source[GROUP];\r\n                }\r\n                if (p.target[GROUP] != null) {\r\n                    _ju.suggest(p.target[GROUP].connections.target, p.connection);\r\n                    _connectionTargetMap[p.connection.id] = p.target[GROUP];\r\n                }\r\n            }\r\n        });\r\n\r\n        function _cleanupDetachedConnection(conn) {\r\n            delete conn.proxies;\r\n            var group = _connectionSourceMap[conn.id], f;\r\n            if (group != null) {\r\n                f = function(c) { return c.id === conn.id; };\r\n                _ju.removeWithFunction(group.connections.source, f);\r\n                _ju.removeWithFunction(group.connections.target, f);\r\n                delete _connectionSourceMap[conn.id];\r\n            }\r\n\r\n            group = _connectionTargetMap[conn.id];\r\n            if (group != null) {\r\n                f = function(c) { return c.id === conn.id; };\r\n                _ju.removeWithFunction(group.connections.source, f);\r\n                _ju.removeWithFunction(group.connections.target, f);\r\n                delete _connectionTargetMap[conn.id];\r\n            }\r\n        }\r\n\r\n        _jsPlumb.bind(EVT_INTERNAL_CONNECTION_DETACHED, function(p) {\r\n            _cleanupDetachedConnection(p.connection);\r\n        });\r\n\r\n        _jsPlumb.bind(EVT_CONNECTION_MOVED, function(p) {\r\n            var connMap = p.index === 0 ? _connectionSourceMap : _connectionTargetMap;\r\n            var group = connMap[p.connection.id];\r\n            if (group) {\r\n                var list = group.connections[p.index === 0 ? \"source\" : \"target\"];\r\n                var idx = list.indexOf(p.connection);\r\n                if (idx !== -1) {\r\n                    list.splice(idx, 1);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.addGroup = function(group) {\r\n            _jsPlumb.addClass(group.getEl(), GROUP_EXPANDED_CLASS);\r\n            _managedGroups[group.id] = group;\r\n            group.manager = this;\r\n            _updateConnectionsForGroup(group);\r\n            _jsPlumb.fire(EVT_GROUP_ADDED, { group:group });\r\n        };\r\n\r\n        this.addToGroup = function(group, el, doNotFireEvent) {\r\n            group = this.getGroup(group);\r\n            if (group) {\r\n                var groupEl = group.getEl();\r\n\r\n                if (el._isJsPlumbGroup) {\r\n                    return;\r\n                }\r\n                var currentGroup = el._jsPlumbGroup;\r\n                // if already a member of this group, do nothing\r\n                if (currentGroup !== group) {\r\n                    var elpos = _jsPlumb.getOffset(el, true);\r\n                    var cpos = group.collapsed ? _jsPlumb.getOffset(groupEl, true) : _jsPlumb.getOffset(group.getDragArea(), true);\r\n\r\n                    // otherwise, transfer to this group.\r\n                    if (currentGroup != null) {\r\n                        currentGroup.remove(el, false, doNotFireEvent, false, group);\r\n                        self.updateConnectionsForGroup(currentGroup);\r\n                    }\r\n                    group.add(el, doNotFireEvent/*, currentGroup*/);\r\n\r\n                    var handleDroppedConnections = function (list, index) {\r\n                        var oidx = index === 0 ? 1 : 0;\r\n                        list.each(function (c) {\r\n                            c.setVisible(false);\r\n                            if (c.endpoints[oidx].element._jsPlumbGroup === group) {\r\n                                c.endpoints[oidx].setVisible(false);\r\n                                _expandConnection(c, oidx, group);\r\n                            }\r\n                            else {\r\n                                c.endpoints[index].setVisible(false);\r\n                                _collapseConnection(c, index, group);\r\n                            }\r\n                        });\r\n                    };\r\n\r\n                    if (group.collapsed) {\r\n                        handleDroppedConnections(_jsPlumb.select({source: el}), 0);\r\n                        handleDroppedConnections(_jsPlumb.select({target: el}), 1);\r\n                    }\r\n\r\n                    var elId = _jsPlumb.getId(el);\r\n                    _jsPlumb.dragManager.setParent(el, elId, groupEl, _jsPlumb.getId(groupEl), elpos);\r\n\r\n                    var newPosition = { left: elpos.left - cpos.left, top: elpos.top - cpos.top };\r\n\r\n                    _jsPlumb.setPosition(el, newPosition);\r\n\r\n                    _jsPlumb.dragManager.revalidateParent(el, elId, elpos);\r\n\r\n                    self.updateConnectionsForGroup(group);\r\n\r\n                    _jsPlumb.revalidate(elId);\r\n\r\n                    if (!doNotFireEvent) {\r\n                        var p = {group: group, el: el, pos:newPosition};\r\n                        if (currentGroup) {\r\n                            p.sourceGroup = currentGroup;\r\n                        }\r\n                        _jsPlumb.fire(EVT_CHILD_ADDED, p);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        this.removeFromGroup = function(group, el, doNotFireEvent) {\r\n            group = this.getGroup(group);\r\n            if (group) {\r\n                group.remove(el, null, doNotFireEvent);\r\n            }\r\n        };\r\n\r\n        this.getGroup = function(groupId) {\r\n            var group = groupId;\r\n            if (_ju.isString(groupId)) {\r\n                group = _managedGroups[groupId];\r\n                if (group == null) {\r\n                    throw new TypeError(\"No such group [\" + groupId + \"]\");\r\n                }\r\n            }\r\n            return group;\r\n        };\r\n\r\n        this.getGroups = function() {\r\n            var o = [];\r\n            for (var g in _managedGroups) {\r\n                o.push(_managedGroups[g]);\r\n            }\r\n            return o;\r\n        };\r\n\r\n        this.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\r\n            group = this.getGroup(group);\r\n            this.expandGroup(group, true); // this reinstates any original connections and removes all proxies, but does not fire an event.\r\n            var newPositions = group[deleteMembers ? CMD_REMOVE_ALL : CMD_ORPHAN_ALL](manipulateDOM, doNotFireEvent);\r\n            _jsPlumb.remove(group.getEl());\r\n            delete _managedGroups[group.id];\r\n            delete _jsPlumb._groups[group.id];\r\n            _jsPlumb.fire(EVT_GROUP_REMOVED, { group:group });\r\n            return newPositions; // this will be null in the case or remove, but be a map of {id->[x,y]} in the case of orphan\r\n        };\r\n\r\n        this.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\r\n            for (var g in _managedGroups) {\r\n                this.removeGroup(_managedGroups[g], deleteMembers, manipulateDOM, doNotFireEvent);\r\n            }\r\n        };\r\n\r\n        function _setVisible(group, state) {\r\n            var m = group.getMembers();\r\n            for (var i = 0; i < m.length; i++) {\r\n                _jsPlumb[state ? CMD_SHOW : CMD_HIDE](m[i], true);\r\n            }\r\n        }\r\n\r\n        var _collapseConnection = function(c, index, group) {\r\n\r\n            var otherEl = c.endpoints[index === 0 ? 1 : 0].element;\r\n            if (otherEl[GROUP] && (!otherEl[GROUP].shouldProxy() && otherEl[GROUP].collapsed)) {\r\n                return;\r\n            }\r\n\r\n            var groupEl = group.getEl(), groupElId = _jsPlumb.getId(groupEl);\r\n\r\n            _jsPlumb.proxyConnection(c, index, groupEl, groupElId, function(c, index) { return group.getEndpoint(c, index); }, function(c, index) { return group.getAnchor(c, index); });\r\n        };\r\n\r\n        this.collapseGroup = function(group) {\r\n            group = this.getGroup(group);\r\n            if (group == null || group.collapsed) {\r\n                return;\r\n            }\r\n            var groupEl = group.getEl();\r\n\r\n            // todo remove old proxy endpoints first, just in case?\r\n            //group.proxies.length = 0;\r\n\r\n            // hide all connections\r\n            _setVisible(group, false);\r\n\r\n            if (group.shouldProxy()) {\r\n                // collapses all connections in a group.\r\n                var _collapseSet = function (conns, index) {\r\n                    for (var i = 0; i < conns.length; i++) {\r\n                        var c = conns[i];\r\n                        _collapseConnection(c, index, group);\r\n                    }\r\n                };\r\n\r\n                // setup proxies for sources and targets\r\n                _collapseSet(group.connections.source, 0);\r\n                _collapseSet(group.connections.target, 1);\r\n            }\r\n\r\n            group.collapsed = true;\r\n            _jsPlumb.removeClass(groupEl, GROUP_EXPANDED_CLASS);\r\n            _jsPlumb.addClass(groupEl, GROUP_COLLAPSED_CLASS);\r\n            _jsPlumb.revalidate(groupEl);\r\n            _jsPlumb.fire(EVT_COLLAPSE, { group:group  });\r\n        };\r\n\r\n        var _expandConnection = function(c, index, group) {\r\n            _jsPlumb.unproxyConnection(c, index, _jsPlumb.getId(group.getEl()));\r\n        };\r\n\r\n        this.expandGroup = function(group, doNotFireEvent) {\r\n\r\n            group = this.getGroup(group);\r\n\r\n            if (group == null || !group.collapsed) {\r\n                return;\r\n            }\r\n            var groupEl = group.getEl();\r\n\r\n            _setVisible(group, true);\r\n\r\n            if (group.shouldProxy()) {\r\n                // collapses all connections in a group.\r\n                var _expandSet = function (conns, index) {\r\n                    for (var i = 0; i < conns.length; i++) {\r\n                        var c = conns[i];\r\n                        _expandConnection(c, index, group);\r\n                    }\r\n                };\r\n\r\n                // setup proxies for sources and targets\r\n                _expandSet(group.connections.source, 0);\r\n                _expandSet(group.connections.target, 1);\r\n            }\r\n\r\n            group.collapsed = false;\r\n            _jsPlumb.addClass(groupEl, GROUP_EXPANDED_CLASS);\r\n            _jsPlumb.removeClass(groupEl, GROUP_COLLAPSED_CLASS);\r\n            _jsPlumb.revalidate(groupEl);\r\n            this.repaintGroup(group);\r\n            if (!doNotFireEvent) {\r\n                _jsPlumb.fire(EVT_EXPAND, { group: group});\r\n            }\r\n        };\r\n\r\n        this.repaintGroup = function(group) {\r\n            group = this.getGroup(group);\r\n            var m = group.getMembers();\r\n            for (var i = 0; i < m.length; i++) {\r\n                _jsPlumb.revalidate(m[i]);\r\n            }\r\n        };\r\n\r\n        // TODO refactor this with the code that responds to `connection` events.\r\n        function _updateConnectionsForGroup(group) {\r\n            var members = group.getMembers();\r\n            var c1 = _jsPlumb.getConnections({source:members, scope:\"*\"}, true);\r\n            var c2 = _jsPlumb.getConnections({target:members, scope:\"*\"}, true);\r\n            var processed = {};\r\n            group.connections.source.length = 0;\r\n            group.connections.target.length = 0;\r\n            var oneSet = function(c) {\r\n                for (var i = 0; i < c.length; i++) {\r\n                    if (processed[c[i].id]) {\r\n                        continue;\r\n                    }\r\n                    processed[c[i].id] = true;\r\n                    if (c[i].source._jsPlumbGroup === group) {\r\n                        if (c[i].target._jsPlumbGroup !== group) {\r\n                            group.connections.source.push(c[i]);\r\n                        }\r\n                        _connectionSourceMap[c[i].id] = group;\r\n                    }\r\n                    else if (c[i].target._jsPlumbGroup === group) {\r\n                        group.connections.target.push(c[i]);\r\n                        _connectionTargetMap[c[i].id] = group;\r\n                    }\r\n                }\r\n            };\r\n            oneSet(c1); oneSet(c2);\r\n        }\r\n\r\n        this.updateConnectionsForGroup = _updateConnectionsForGroup;\r\n        this.refreshAllGroups = function() {\r\n            for (var g in _managedGroups) {\r\n                _updateConnectionsForGroup(_managedGroups[g]);\r\n                _jsPlumb.dragManager.updateOffsets(_jsPlumb.getId(_managedGroups[g].getEl()));\r\n            }\r\n        };\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {jsPlumbInstance} _jsPlumb Associated jsPlumb instance.\r\n     * @param {Object} params\r\n     * @param {Element} params.el The DOM element representing the Group.\r\n     * @param {String} [params.id] Optional ID for the Group. A UUID will be assigned as the Group's ID if you do not provide one.\r\n     * @param {Boolean} [params.constrain=false] If true, child elements will not be able to be dragged outside of the Group container.\r\n     * @param {Boolean} [params.revert=true] By default, child elements revert to the container if dragged outside. You can change this by setting `revert:false`. This behaviour is also overridden if you set `orphan` or `prune`.\r\n     * @param {Boolean} [params.orphan=false] If true, child elements dropped outside of the Group container will be removed from the Group (but not from the DOM).\r\n     * @param {Boolean} [params.prune=false] If true, child elements dropped outside of the Group container will be removed from the Group and also from the DOM.\r\n     * @param {Boolean} [params.dropOverride=false] If true, a child element that has been dropped onto some other Group will not be subject to the controls imposed by `prune`, `revert` or `orphan`.\r\n     * @constructor\r\n     */\r\n    var Group = function(_jsPlumb, params) {\r\n        var self = this;\r\n        var el = params.el;\r\n        this.getEl = function() { return el; };\r\n        this.id = params.id || _ju.uuid();\r\n        el._isJsPlumbGroup = true;\r\n\r\n        var getDragArea = this.getDragArea = function() {\r\n            var da = _jsPlumb.getSelector(el, GROUP_CONTAINER_SELECTOR);\r\n            return da && da.length > 0 ? da[0] : el;\r\n        };\r\n\r\n        var ghost = params.ghost === true;\r\n        var constrain = ghost || (params.constrain === true);\r\n        var revert = params.revert !== false;\r\n        var orphan = params.orphan === true;\r\n        var prune = params.prune === true;\r\n        var dropOverride = params.dropOverride === true;\r\n        var proxied = params.proxied !== false;\r\n        var elements = [];\r\n        this.connections = { source:[], target:[], internal:[] };\r\n\r\n        // this function, and getEndpoint below, are stubs for a future setup in which we can choose endpoint\r\n        // and anchor based upon the connection and the index (source/target) of the endpoint to be proxied.\r\n        this.getAnchor = function(conn, endpointIndex) {\r\n            return params.anchor || \"Continuous\";\r\n        };\r\n\r\n        this.getEndpoint = function(conn, endpointIndex) {\r\n            return params.endpoint || [ \"Dot\", { radius:10 }];\r\n        };\r\n\r\n        this.collapsed = false;\r\n        if (params.draggable !== false) {\r\n            var opts = {\r\n                stop:function(params) {\r\n                    _jsPlumb.fire(EVT_GROUP_DRAG_STOP, jsPlumb.extend(params, {group:self}));\r\n                },\r\n                scope:GROUP_DRAG_SCOPE\r\n            };\r\n            if (params.dragOptions) {\r\n                root.jsPlumb.extend(opts, params.dragOptions);\r\n            }\r\n            _jsPlumb.draggable(params.el, opts);\r\n        }\r\n        if (params.droppable !== false) {\r\n            _jsPlumb.droppable(params.el, {\r\n                drop:function(p) {\r\n                    var el = p.drag.el;\r\n                    if (el._isJsPlumbGroup) {\r\n                        return;\r\n                    }\r\n                    var currentGroup = el._jsPlumbGroup;\r\n                    if (currentGroup !== self) {\r\n                        if (currentGroup != null) {\r\n                            if (currentGroup.overrideDrop(el, self)) {\r\n                                return;\r\n                            }\r\n                        }\r\n                        _jsPlumb.getGroupManager().addToGroup(self, el, false);\r\n                    }\r\n\r\n                }\r\n            });\r\n        }\r\n        var _each = function(_el, fn) {\r\n            var els = _el.nodeType == null ?  _el : [ _el ];\r\n            for (var i = 0; i < els.length; i++) {\r\n                fn(els[i]);\r\n            }\r\n        };\r\n\r\n        this.overrideDrop = function(_el, targetGroup) {\r\n            return dropOverride && (revert || prune || orphan);\r\n        };\r\n\r\n        this.add = function(_el, doNotFireEvent/*, sourceGroup*/) {\r\n            var dragArea = getDragArea();\r\n            _each(_el, function(__el) {\r\n\r\n                if (__el._jsPlumbGroup != null) {\r\n                    if (__el._jsPlumbGroup === self) {\r\n                        return;\r\n                    } else {\r\n                        __el._jsPlumbGroup.remove(__el, true, doNotFireEvent, false);\r\n                    }\r\n                }\r\n\r\n                __el._jsPlumbGroup = self;\r\n                elements.push(__el);\r\n                // test if draggable and add handlers if so.\r\n                if (_jsPlumb.isAlreadyDraggable(__el)) {\r\n                    _bindDragHandlers(__el);\r\n                }\r\n\r\n                if (__el.parentNode !== dragArea) {\r\n                    dragArea.appendChild(__el);\r\n                }\r\n\r\n                // if (!doNotFireEvent) {\r\n                //     var p = {group: self, el: __el};\r\n                //     if (sourceGroup) {\r\n                //         p.sourceGroup = sourceGroup;\r\n                //     }\r\n                //     //_jsPlumb.fire(EVT_CHILD_ADDED, p);\r\n                // }\r\n            });\r\n\r\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\r\n        };\r\n\r\n        this.remove = function(el, manipulateDOM, doNotFireEvent, doNotUpdateConnections, targetGroup) {\r\n\r\n            _each(el, function(__el) {\r\n                if (__el._jsPlumbGroup === self) {\r\n                    delete __el._jsPlumbGroup;\r\n                    _ju.removeWithFunction(elements, function (e) {\r\n                        return e === __el;\r\n                    });\r\n\r\n                    if (manipulateDOM) {\r\n                        try {\r\n                            self.getDragArea().removeChild(__el);\r\n                        } catch (e) {\r\n                            jsPlumbUtil.log(\"Could not remove element from Group \" + e);\r\n                        }\r\n                    }\r\n                    _unbindDragHandlers(__el);\r\n                    if (!doNotFireEvent) {\r\n                        var p = {group: self, el: __el};\r\n                        if (targetGroup) {\r\n                            p.targetGroup = targetGroup;\r\n                        }\r\n                        _jsPlumb.fire(EVT_CHILD_REMOVED, p);\r\n                    }\r\n                }\r\n            });\r\n            if (!doNotUpdateConnections) {\r\n                _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\r\n            }\r\n        };\r\n        this.removeAll = function(manipulateDOM, doNotFireEvent) {\r\n            for (var i = 0, l = elements.length; i < l; i++) {\r\n                var el = elements[0];\r\n                self.remove(el, manipulateDOM, doNotFireEvent, true);\r\n                _jsPlumb.remove(el, true);\r\n            }\r\n            elements.length = 0;\r\n            _jsPlumb.getGroupManager().updateConnectionsForGroup(self);\r\n        };\r\n        this.orphanAll = function() {\r\n            var orphanedPositions = {};\r\n            for (var i = 0; i < elements.length; i++) {\r\n                var newPosition = _orphan(elements[i]);\r\n                orphanedPositions[newPosition[0]] = newPosition[1];\r\n            }\r\n            elements.length = 0;\r\n\r\n            return orphanedPositions;\r\n        };\r\n        this.getMembers = function() { return elements; };\r\n\r\n        el[GROUP] = this;\r\n\r\n        _jsPlumb.bind(ELEMENT_DRAGGABLE_EVENT, function(dragParams) {\r\n            // if its for the current group,\r\n            if (dragParams.el._jsPlumbGroup === this) {\r\n                _bindDragHandlers(dragParams.el);\r\n            }\r\n        }.bind(this));\r\n\r\n        function _findParent(_el) {\r\n            return _el.offsetParent;\r\n        }\r\n\r\n        function _isInsideParent(_el, pos) {\r\n            var p = _findParent(_el),\r\n                s = _jsPlumb.getSize(p),\r\n                ss = _jsPlumb.getSize(_el),\r\n                leftEdge = pos[0],\r\n                rightEdge = leftEdge + ss[0],\r\n                topEdge = pos[1],\r\n                bottomEdge = topEdge + ss[1];\r\n\r\n            return rightEdge > 0 && leftEdge < s[0] && bottomEdge > 0 && topEdge < s[1];\r\n        }\r\n\r\n        //\r\n        // orphaning an element means taking it out of the group and adding it to the main jsplumb container.\r\n        // we return the new calculated position from this method and the element's id.\r\n        //\r\n        function _orphan(_el) {\r\n            var id = _jsPlumb.getId(_el);\r\n            var pos = _jsPlumb.getOffset(_el);\r\n            _el.parentNode.removeChild(_el);\r\n            _jsPlumb.getContainer().appendChild(_el);\r\n            _jsPlumb.setPosition(_el, pos);\r\n            _unbindDragHandlers(_el);\r\n            _jsPlumb.dragManager.clearParent(_el, id);\r\n            return [id, pos];\r\n        }\r\n\r\n        //\r\n        // remove an element from the group, then either prune it from the jsplumb instance, or just orphan it.\r\n        //\r\n        function _pruneOrOrphan(p) {\r\n\r\n            var out = [];\r\n\r\n            function _one(el, left, top) {\r\n                var orphanedPosition = null;\r\n                if (!_isInsideParent(el, [left, top])) {\r\n                    var group = el._jsPlumbGroup;\r\n                    if (prune) {\r\n                        _jsPlumb.remove(el);\r\n                    } else {\r\n                        orphanedPosition = _orphan(el);\r\n                    }\r\n\r\n                    group.remove(el);\r\n                }\r\n\r\n                return orphanedPosition;\r\n            }\r\n\r\n            for (var i = 0; i < p.selection.length; i++) {\r\n                out.push(_one(p.selection[i][0], p.selection[i][1].left, p.selection[i][1].top));\r\n            }\r\n\r\n            return out.length === 1 ? out[0] : out;\r\n\r\n        }\r\n\r\n        //\r\n        // redraws the element\r\n        //\r\n        function _revalidate(_el) {\r\n            var id = _jsPlumb.getId(_el);\r\n            _jsPlumb.revalidate(_el);\r\n            _jsPlumb.dragManager.revalidateParent(_el, id);\r\n        }\r\n\r\n        //\r\n        // unbind the group specific drag/revert handlers.\r\n        //\r\n        function _unbindDragHandlers(_el) {\r\n            if (!_el._katavorioDrag) {\r\n                return;\r\n            }\r\n            if (prune || orphan) {\r\n                _el._katavorioDrag.off(STOP, _pruneOrOrphan);\r\n            }\r\n            if (!prune && !orphan && revert) {\r\n                _el._katavorioDrag.off(REVERT, _revalidate);\r\n                _el._katavorioDrag.setRevert(null);\r\n            }\r\n        }\r\n\r\n        function _bindDragHandlers(_el) {\r\n            if (!_el._katavorioDrag) {\r\n                return;\r\n            }\r\n            if (prune || orphan) {\r\n                _el._katavorioDrag.on(STOP, _pruneOrOrphan);\r\n            }\r\n\r\n            if (constrain) {\r\n                _el._katavorioDrag.setConstrain(true);\r\n            }\r\n\r\n            if (ghost) {\r\n                _el._katavorioDrag.setUseGhostProxy(true);\r\n            }\r\n\r\n            if (!prune && !orphan && revert) {\r\n                _el._katavorioDrag.on(REVERT, _revalidate);\r\n                _el._katavorioDrag.setRevert(function(__el, pos) {\r\n                    return !_isInsideParent(__el, pos);\r\n                });\r\n            }\r\n        }\r\n\r\n        this.shouldProxy = function() {\r\n            return proxied;\r\n        };\r\n\r\n        _jsPlumb.getGroupManager().addGroup(this);\r\n    };\r\n\r\n    /**\r\n     * Adds a group to the jsPlumb instance.\r\n     * @method addGroup\r\n     * @param {Object} params\r\n     * @return {Group} The newly created Group.\r\n     */\r\n    _jpi.prototype.addGroup = function(params) {\r\n        var j = this;\r\n        j._groups = j._groups || {};\r\n        if (j._groups[params.id] != null) {\r\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; a Group with that ID exists\");\r\n        }\r\n        if (params.el[GROUP] != null) {\r\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; the given element is already a Group\");\r\n        }\r\n        var group = new Group(j, params);\r\n        j._groups[group.id] = group;\r\n        if (params.collapsed) {\r\n            this.collapseGroup(group);\r\n        }\r\n        return group;\r\n    };\r\n\r\n    /**\r\n     * Add an element to a group.\r\n     * @method addToGroup\r\n     * @param {String} group Group, or ID of the group, to add the element to.\r\n     * @param {Element} el Element to add to the group.\r\n     */\r\n    _jpi.prototype.addToGroup = function(group, el, doNotFireEvent) {\r\n\r\n        var _one = function(_el) {\r\n            var id = this.getId(_el);\r\n            this.manage(id, _el);\r\n            this.getGroupManager().addToGroup(group, _el, doNotFireEvent);\r\n        }.bind(this);\r\n\r\n        if (Array.isArray(el)) {\r\n            for (var i = 0; i < el.length; i++) {\r\n                _one(el[i]);\r\n            }\r\n        } else {\r\n            _one(el);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Remove an element from a group.\r\n     * @method removeFromGroup\r\n     * @param {String} group Group, or ID of the group, to remove the element from.\r\n     * @param {Element} el Element to add to the group.\r\n     */\r\n    _jpi.prototype.removeFromGroup = function(group, el, doNotFireEvent) {\r\n        this.getGroupManager().removeFromGroup(group, el, doNotFireEvent);\r\n    };\r\n\r\n    /**\r\n     * Remove a group, and optionally remove its members from the jsPlumb instance.\r\n     * @method removeGroup\r\n     * @param {String|Group} group Group to delete, or ID of Group to delete.\r\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the group. Otherwise they will\r\n     * just be 'orphaned' (returned to the main container).\r\n     * @returns {Map[String, Position}} When deleteMembers is false, this method returns a map of {id->position}\r\n     */\r\n    _jpi.prototype.removeGroup = function(group, deleteMembers, manipulateDOM, doNotFireEvent) {\r\n        return this.getGroupManager().removeGroup(group, deleteMembers, manipulateDOM, doNotFireEvent);\r\n    };\r\n\r\n    /**\r\n     * Remove all groups, and optionally remove their members from the jsPlumb instance.\r\n     * @method removeAllGroup\r\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the groups. Otherwise they will\r\n     * just be 'orphaned' (returned to the main container).\r\n     */\r\n    _jpi.prototype.removeAllGroups = function(deleteMembers, manipulateDOM, doNotFireEvent) {\r\n        this.getGroupManager().removeAllGroups(deleteMembers, manipulateDOM, doNotFireEvent);\r\n    };\r\n\r\n    /**\r\n     * Get a Group\r\n     * @method getGroup\r\n     * @param {String} groupId ID of the group to get\r\n     * @return {Group} Group with the given ID, null if not found.\r\n     */\r\n    _jpi.prototype.getGroup = function(groupId) {\r\n        return this.getGroupManager().getGroup(groupId);\r\n    };\r\n\r\n    /**\r\n     * Gets all the Groups managed by the jsPlumb instance.\r\n     * @returns {Group[]} List of Groups. Empty if none.\r\n     */\r\n    _jpi.prototype.getGroups = function() {\r\n        return this.getGroupManager().getGroups();\r\n    };\r\n\r\n    /**\r\n     * Expands a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to expand a Group\r\n     * will vary from application to application. jsPlumb does these things:\r\n     *\r\n     * - Hides any connections that are internal to the group (connections between members, and connections from member of\r\n     * the group to the group itself)\r\n     * - Proxies all connections for which the source or target is a member of the group.\r\n     * - Hides the proxied connections.\r\n     * - Adds the jtk-group-expanded class to the group's element\r\n     * - Removes the jtk-group-collapsed class from the group's element.\r\n     *\r\n     * @method expandGroup\r\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\r\n     */\r\n    _jpi.prototype.expandGroup = function(group) {\r\n        this.getGroupManager().expandGroup(group);\r\n    };\r\n\r\n    /**\r\n     * Collapses a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to collapse a Group\r\n     * will vary from application to application. jsPlumb does these things:\r\n     *\r\n     * - Shows any connections that are internal to the group (connections between members, and connections from member of\r\n     * the group to the group itself)\r\n     * - Removes proxies for all connections for which the source or target is a member of the group.\r\n     * - Shows the previously proxied connections.\r\n     * - Adds the jtk-group-collapsed class to the group's element\r\n     * - Removes the jtk-group-expanded class from the group's element.\r\n     *\r\n     * @method expandGroup\r\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\r\n     */\r\n    _jpi.prototype.collapseGroup = function(groupId) {\r\n        this.getGroupManager().collapseGroup(groupId);\r\n    };\r\n\r\n\r\n    _jpi.prototype.repaintGroup = function(group) {\r\n        this.getGroupManager().repaintGroup(group);\r\n    };\r\n\r\n    /**\r\n     * Collapses or expands a group element depending on its current state. See notes in the collapseGroup and expandGroup method.\r\n     *\r\n     * @method toggleGroup\r\n     * @param {String|Group} group Group to expand/collapse, or ID of Group to expand/collapse.\r\n     */\r\n    _jpi.prototype.toggleGroup = function(group) {\r\n        group = this.getGroupManager().getGroup(group);\r\n        if (group != null) {\r\n            this.getGroupManager()[group.collapsed ? \"expandGroup\" : \"collapseGroup\"](group);\r\n        }\r\n    };\r\n\r\n    //\r\n    // lazy init a group manager for the given jsplumb instance.\r\n    //\r\n    _jpi.prototype.getGroupManager = function() {\r\n        var mgr = this[GROUP_MANAGER];\r\n        if (mgr == null) {\r\n            mgr = this[GROUP_MANAGER] = new GroupManager(this);\r\n        }\r\n        return mgr;\r\n    };\r\n\r\n    _jpi.prototype.removeGroupManager = function() {\r\n        delete this[GROUP_MANAGER];\r\n    };\r\n\r\n    /**\r\n     * Gets the Group that the given element belongs to, null if none.\r\n     * @method getGroupFor\r\n     * @param {String|Element} el Element, or element ID.\r\n     * @returns {Group} A Group, if found, or null.\r\n     */\r\n    _jpi.prototype.getGroupFor = function(el) {\r\n        el = this.getElement(el);\r\n        if (el) {\r\n            return el[GROUP];\r\n        }\r\n    };\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n\r\n/*\r\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n    var STRAIGHT = \"Straight\";\r\n    var ARC = \"Arc\";\r\n\r\n    var Flowchart = function (params) {\r\n        this.type = \"Flowchart\";\r\n        params = params || {};\r\n        params.stub = params.stub == null ? 30 : params.stub;\r\n        var segments,\r\n            _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\r\n            midpoint = params.midpoint == null ? 0.5 : params.midpoint,\r\n            alwaysRespectStubs = params.alwaysRespectStubs === true,\r\n            lastx = null, lasty = null, lastOrientation,\r\n            cornerRadius = params.cornerRadius != null ? params.cornerRadius : 0,\r\n\r\n            // TODO now common between this and AbstractBezierEditor; refactor into superclass?\r\n            loopbackRadius = params.loopbackRadius || 25,\r\n            isLoopbackCurrently = false,\r\n\r\n            sgn = function (n) {\r\n                return n < 0 ? -1 : n === 0 ? 0 : 1;\r\n            },\r\n            segmentDirections = function(segment) {\r\n                return [\r\n                    sgn( segment[2] - segment[0] ),\r\n                    sgn( segment[3] - segment[1] )\r\n                ];\r\n            },\r\n            /**\r\n             * helper method to add a segment.\r\n             */\r\n            addSegment = function (segments, x, y, paintInfo) {\r\n                if (lastx === x && lasty === y) {\r\n                    return;\r\n                }\r\n                var lx = lastx == null ? paintInfo.sx : lastx,\r\n                    ly = lasty == null ? paintInfo.sy : lasty,\r\n                    o = lx === x ? \"v\" : \"h\";\r\n\r\n                lastx = x;\r\n                lasty = y;\r\n                segments.push([ lx, ly, x, y, o ]);\r\n            },\r\n            segLength = function (s) {\r\n                return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\r\n            },\r\n            _cloneArray = function (a) {\r\n                var _a = [];\r\n                _a.push.apply(_a, a);\r\n                return _a;\r\n            },\r\n            writeSegments = function (conn, segments, paintInfo) {\r\n                var current = null, next, currentDirection, nextDirection;\r\n                for (var i = 0; i < segments.length - 1; i++) {\r\n\r\n                    current = current || _cloneArray(segments[i]);\r\n                    next = _cloneArray(segments[i + 1]);\r\n\r\n                    currentDirection = segmentDirections(current);\r\n                    nextDirection = segmentDirections(next);\r\n\r\n                    if (cornerRadius > 0 && current[4] !== next[4]) {\r\n\r\n                        var minSegLength = Math.min(segLength(current), segLength(next));\r\n                        var radiusToUse = Math.min(cornerRadius, minSegLength / 2);\r\n\r\n                        current[2] -= currentDirection[0] * radiusToUse;\r\n                        current[3] -= currentDirection[1] * radiusToUse;\r\n                        next[0] += nextDirection[0] * radiusToUse;\r\n                        next[1] += nextDirection[1] * radiusToUse;\r\n\r\n                        var ac = (currentDirection[1] === nextDirection[0] && nextDirection[0] === 1) ||\r\n                            ((currentDirection[1] === nextDirection[0] && nextDirection[0] === 0) && currentDirection[0] !== nextDirection[1]) ||\r\n                            (currentDirection[1] === nextDirection[0] && nextDirection[0] === -1),\r\n                            sgny = next[1] > current[3] ? 1 : -1,\r\n                            sgnx = next[0] > current[2] ? 1 : -1,\r\n                            sgnEqual = sgny === sgnx,\r\n                            cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2],\r\n                            cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\r\n\r\n                        _super.addSegment(conn, STRAIGHT, {\r\n                            x1: current[0], y1: current[1], x2: current[2], y2: current[3]\r\n                        });\r\n\r\n                        _super.addSegment(conn, ARC, {\r\n                            r: radiusToUse,\r\n                            x1: current[2],\r\n                            y1: current[3],\r\n                            x2: next[0],\r\n                            y2: next[1],\r\n                            cx: cx,\r\n                            cy: cy,\r\n                            ac: ac\r\n                        });\r\n                    }\r\n                    else {\r\n                        // dx + dy are used to adjust for line width.\r\n                        var dx = (current[2] === current[0]) ? 0 : (current[2] > current[0]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2),\r\n                            dy = (current[3] === current[1]) ? 0 : (current[3] > current[1]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2);\r\n\r\n                        _super.addSegment(conn, STRAIGHT, {\r\n                            x1: current[0] - dx, y1: current[1] - dy, x2: current[2] + dx, y2: current[3] + dy\r\n                        });\r\n                    }\r\n                    current = next;\r\n                }\r\n                if (next != null) {\r\n                    // last segment\r\n                    _super.addSegment(conn, STRAIGHT, {\r\n                        x1: next[0], y1: next[1], x2: next[2], y2: next[3]\r\n                    });\r\n                }\r\n            };\r\n\r\n        this._compute = function (paintInfo, params) {\r\n\r\n            segments = [];\r\n            lastx = null;\r\n            lasty = null;\r\n            lastOrientation = null;\r\n\r\n            var commonStubCalculator = function () {\r\n                    return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\r\n                },\r\n                stubCalculators = {\r\n                    perpendicular: commonStubCalculator,\r\n                    orthogonal: commonStubCalculator,\r\n                    opposite: function (axis) {\r\n                        var pi = paintInfo,\r\n                            idx = axis === \"x\" ? 0 : 1,\r\n                            areInProximity = {\r\n                                \"x\": function () {\r\n                                    return ( (pi.so[idx] === 1 && (\r\n                                        ( (pi.startStubX > pi.endStubX) && (pi.tx > pi.startStubX) ) ||\r\n                                        ( (pi.sx > pi.endStubX) && (pi.tx > pi.sx))))) ||\r\n\r\n                                        ( (pi.so[idx] === -1 && (\r\n                                            ( (pi.startStubX < pi.endStubX) && (pi.tx < pi.startStubX) ) ||\r\n                                            ( (pi.sx < pi.endStubX) && (pi.tx < pi.sx)))));\r\n                                },\r\n                                \"y\": function () {\r\n                                    return ( (pi.so[idx] === 1 && (\r\n                                        ( (pi.startStubY > pi.endStubY) && (pi.ty > pi.startStubY) ) ||\r\n                                        ( (pi.sy > pi.endStubY) && (pi.ty > pi.sy))))) ||\r\n\r\n                                        ( (pi.so[idx] === -1 && (\r\n                                            ( (pi.startStubY < pi.endStubY) && (pi.ty < pi.startStubY) ) ||\r\n                                            ( (pi.sy < pi.endStubY) && (pi.ty < pi.sy)))));\r\n                                }\r\n                            };\r\n\r\n                        if (!alwaysRespectStubs && areInProximity[axis]()) {\r\n                            return {\r\n                                \"x\": [(paintInfo.sx + paintInfo.tx) / 2, paintInfo.startStubY, (paintInfo.sx + paintInfo.tx) / 2, paintInfo.endStubY],\r\n                                \"y\": [paintInfo.startStubX, (paintInfo.sy + paintInfo.ty) / 2, paintInfo.endStubX, (paintInfo.sy + paintInfo.ty) / 2]\r\n                            }[axis];\r\n                        }\r\n                        else {\r\n                            return [paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY];\r\n                        }\r\n                    }\r\n                };\r\n\r\n            // calculate Stubs.\r\n            var stubs = stubCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis),\r\n                idx = paintInfo.sourceAxis === \"x\" ? 0 : 1,\r\n                oidx = paintInfo.sourceAxis === \"x\" ? 1 : 0,\r\n                ss = stubs[idx],\r\n                oss = stubs[oidx],\r\n                es = stubs[idx + 2],\r\n                oes = stubs[oidx + 2];\r\n\r\n            // add the start stub segment. use stubs for loopback as it will look better, with the loop spaced\r\n            // away from the element.\r\n            addSegment(segments, stubs[0], stubs[1], paintInfo);\r\n\r\n            // if its a loopback and we should treat it differently.\r\n            // if (false && params.sourcePos[0] === params.targetPos[0] && params.sourcePos[1] === params.targetPos[1]) {\r\n            //\r\n            //     // we use loopbackRadius here, as statemachine connectors do.\r\n            //     // so we go radius to the left from stubs[0], then upwards by 2*radius, to the right by 2*radius,\r\n            //     // down by 2*radius, left by radius.\r\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1], paintInfo);\r\n            //     addSegment(segments, stubs[0] - loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\r\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\r\n            //     addSegment(segments, stubs[0] + loopbackRadius, stubs[1], paintInfo);\r\n            //     addSegment(segments, stubs[0], stubs[1], paintInfo);\r\n            //\r\n            // }\r\n            // else {\r\n\r\n\r\n            var midx = paintInfo.startStubX + ((paintInfo.endStubX - paintInfo.startStubX) * midpoint),\r\n                midy = paintInfo.startStubY + ((paintInfo.endStubY - paintInfo.startStubY) * midpoint);\r\n\r\n            var orientations = {x: [0, 1], y: [1, 0]},\r\n                lineCalculators = {\r\n                    perpendicular: function (axis) {\r\n                        var pi = paintInfo,\r\n                            sis = {\r\n                                x: [\r\n                                    [[1, 2, 3, 4], null, [2, 1, 4, 3]],\r\n                                    null,\r\n                                    [[4, 3, 2, 1], null, [3, 4, 1, 2]]\r\n                                ],\r\n                                y: [\r\n                                    [[3, 2, 1, 4], null, [2, 3, 4, 1]],\r\n                                    null,\r\n                                    [[4, 1, 2, 3], null, [1, 4, 3, 2]]\r\n                                ]\r\n                            },\r\n                            stubs = {\r\n                                x: [[pi.startStubX, pi.endStubX], null, [pi.endStubX, pi.startStubX]],\r\n                                y: [[pi.startStubY, pi.endStubY], null, [pi.endStubY, pi.startStubY]]\r\n                            },\r\n                            midLines = {\r\n                                x: [[midx, pi.startStubY], [midx, pi.endStubY]],\r\n                                y: [[pi.startStubX, midy], [pi.endStubX, midy]]\r\n                            },\r\n                            linesToEnd = {\r\n                                x: [[pi.endStubX, pi.startStubY]],\r\n                                y: [[pi.startStubX, pi.endStubY]]\r\n                            },\r\n                            startToEnd = {\r\n                                x: [[pi.startStubX, pi.endStubY], [pi.endStubX, pi.endStubY]],\r\n                                y: [[pi.endStubX, pi.startStubY], [pi.endStubX, pi.endStubY]]\r\n                            },\r\n                            startToMidToEnd = {\r\n                                x: [[pi.startStubX, midy], [pi.endStubX, midy], [pi.endStubX, pi.endStubY]],\r\n                                y: [[midx, pi.startStubY], [midx, pi.endStubY], [pi.endStubX, pi.endStubY]]\r\n                            },\r\n                            otherStubs = {\r\n                                x: [pi.startStubY, pi.endStubY],\r\n                                y: [pi.startStubX, pi.endStubX]\r\n                            },\r\n                            soIdx = orientations[axis][0], toIdx = orientations[axis][1],\r\n                            _so = pi.so[soIdx] + 1,\r\n                            _to = pi.to[toIdx] + 1,\r\n                            otherFlipped = (pi.to[toIdx] === -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (pi.to[toIdx] === 1 && (otherStubs[axis][1] > otherStubs[axis][0])),\r\n                            stub1 = stubs[axis][_so][0],\r\n                            stub2 = stubs[axis][_so][1],\r\n                            segmentIndexes = sis[axis][_so][_to];\r\n\r\n                        if (pi.segment === segmentIndexes[3] || (pi.segment === segmentIndexes[2] && otherFlipped)) {\r\n                            return midLines[axis];\r\n                        }\r\n                        else if (pi.segment === segmentIndexes[2] && stub2 < stub1) {\r\n                            return linesToEnd[axis];\r\n                        }\r\n                        else if ((pi.segment === segmentIndexes[2] && stub2 >= stub1) || (pi.segment === segmentIndexes[1] && !otherFlipped)) {\r\n                            return startToMidToEnd[axis];\r\n                        }\r\n                        else if (pi.segment === segmentIndexes[0] || (pi.segment === segmentIndexes[1] && otherFlipped)) {\r\n                            return startToEnd[axis];\r\n                        }\r\n                    },\r\n                    orthogonal: function (axis, startStub, otherStartStub, endStub, otherEndStub) {\r\n                        var pi = paintInfo,\r\n                            extent = {\r\n                                \"x\": pi.so[0] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\r\n                                \"y\": pi.so[1] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\r\n                            }[axis];\r\n\r\n                        return {\r\n                            \"x\": [\r\n                                [extent, otherStartStub],\r\n                                [extent, otherEndStub],\r\n                                [endStub, otherEndStub]\r\n                            ],\r\n                            \"y\": [\r\n                                [otherStartStub, extent],\r\n                                [otherEndStub, extent],\r\n                                [otherEndStub, endStub]\r\n                            ]\r\n                        }[axis];\r\n                    },\r\n                    opposite: function (axis, ss, oss, es) {\r\n                        var pi = paintInfo,\r\n                            otherAxis = {\"x\": \"y\", \"y\": \"x\"}[axis],\r\n                            dim = {\"x\": \"height\", \"y\": \"width\"}[axis],\r\n                            comparator = pi[\"is\" + axis.toUpperCase() + \"GreaterThanStubTimes2\"];\r\n\r\n                        if (params.sourceEndpoint.elementId === params.targetEndpoint.elementId) {\r\n                            var _val = oss + ((1 - params.sourceEndpoint.anchor[otherAxis]) * params.sourceInfo[dim]) + _super.maxStub;\r\n                            return {\r\n                                \"x\": [\r\n                                    [ss, _val],\r\n                                    [es, _val]\r\n                                ],\r\n                                \"y\": [\r\n                                    [_val, ss],\r\n                                    [_val, es]\r\n                                ]\r\n                            }[axis];\r\n\r\n                        }\r\n                        else if (!comparator || (pi.so[idx] === 1 && ss > es) || (pi.so[idx] === -1 && ss < es)) {\r\n                            return {\r\n                                \"x\": [\r\n                                    [ss, midy],\r\n                                    [es, midy]\r\n                                ],\r\n                                \"y\": [\r\n                                    [midx, ss],\r\n                                    [midx, es]\r\n                                ]\r\n                            }[axis];\r\n                        }\r\n                        else if ((pi.so[idx] === 1 && ss < es) || (pi.so[idx] === -1 && ss > es)) {\r\n                            return {\r\n                                \"x\": [\r\n                                    [midx, pi.sy],\r\n                                    [midx, pi.ty]\r\n                                ],\r\n                                \"y\": [\r\n                                    [pi.sx, midy],\r\n                                    [pi.tx, midy]\r\n                                ]\r\n                            }[axis];\r\n                        }\r\n                    }\r\n                };\r\n\r\n            // compute the rest of the line\r\n            var p = lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis, ss, oss, es, oes);\r\n            if (p) {\r\n                for (var i = 0; i < p.length; i++) {\r\n                    addSegment(segments, p[i][0], p[i][1], paintInfo);\r\n                }\r\n            }\r\n\r\n            // line to end stub\r\n            addSegment(segments, stubs[2], stubs[3], paintInfo);\r\n\r\n            //}\r\n\r\n            // end stub to end (common)\r\n            addSegment(segments, paintInfo.tx, paintInfo.ty, paintInfo);\r\n\r\n\r\n\r\n            // write out the segments.\r\n            writeSegments(this, segments, paintInfo);\r\n\r\n        };\r\n    };\r\n\r\n    _jp.Connectors.Flowchart = Flowchart;\r\n    _ju.extend(_jp.Connectors.Flowchart, _jp.Connectors.AbstractConnector);\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the code for the Bezier connector type.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    _jp.Connectors.AbstractBezierConnector = function(params) {\r\n        params = params || {};\r\n        var showLoopback = params.showLoopback !== false,\r\n            curviness = params.curviness || 10,\r\n            margin = params.margin || 5,\r\n            proximityLimit = params.proximityLimit || 80,\r\n            clockwise = params.orientation && params.orientation === \"clockwise\",\r\n            loopbackRadius = params.loopbackRadius || 25,\r\n            isLoopbackCurrently = false,\r\n            _super;\r\n\r\n        this._compute = function (paintInfo, p) {\r\n\r\n            var sp = p.sourcePos,\r\n                tp = p.targetPos,\r\n                _w = Math.abs(sp[0] - tp[0]),\r\n                _h = Math.abs(sp[1] - tp[1]);\r\n\r\n            if (!showLoopback || (p.sourceEndpoint.elementId !== p.targetEndpoint.elementId)) {\r\n                isLoopbackCurrently = false;\r\n                this._computeBezier(paintInfo, p, sp, tp, _w, _h);\r\n            } else {\r\n                isLoopbackCurrently = true;\r\n                // a loopback connector.  draw an arc from one anchor to the other.\r\n                var x1 = p.sourcePos[0], y1 = p.sourcePos[1] - margin,\r\n                    cx = x1, cy = y1 - loopbackRadius,\r\n                    // canvas sizing stuff, to ensure the whole painted area is visible.\r\n                    _x = cx - loopbackRadius,\r\n                    _y = cy - loopbackRadius;\r\n\r\n                _w = 2 * loopbackRadius;\r\n                _h = 2 * loopbackRadius;\r\n\r\n                paintInfo.points[0] = _x;\r\n                paintInfo.points[1] = _y;\r\n                paintInfo.points[2] = _w;\r\n                paintInfo.points[3] = _h;\r\n\r\n                // ADD AN ARC SEGMENT.\r\n                _super.addSegment(this, \"Arc\", {\r\n                    loopback: true,\r\n                    x1: (x1 - _x) + 4,\r\n                    y1: y1 - _y,\r\n                    startAngle: 0,\r\n                    endAngle: 2 * Math.PI,\r\n                    r: loopbackRadius,\r\n                    ac: !clockwise,\r\n                    x2: (x1 - _x) - 4,\r\n                    y2: y1 - _y,\r\n                    cx: cx - _x,\r\n                    cy: cy - _y\r\n                });\r\n            }\r\n        };\r\n\r\n        _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\r\n        return _super;\r\n    };\r\n    _ju.extend(_jp.Connectors.AbstractBezierConnector, _jp.Connectors.AbstractConnector);\r\n\r\n    var Bezier = function (params) {\r\n        params = params || {};\r\n        this.type = \"Bezier\";\r\n\r\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\r\n            majorAnchor = params.curviness || 150,\r\n            minorAnchor = 10;\r\n\r\n        this.getCurviness = function () {\r\n            return majorAnchor;\r\n        };\r\n\r\n        this._findControlPoint = function (point, sourceAnchorPosition, targetAnchorPosition, sourceEndpoint, targetEndpoint, soo, too) {\r\n            // determine if the two anchors are perpendicular to each other in their orientation.  we swap the control\r\n            // points around if so (code could be tightened up)\r\n            var perpendicular = soo[0] !== too[0] || soo[1] === too[1],\r\n                p = [];\r\n\r\n            if (!perpendicular) {\r\n                if (soo[0] === 0) {\r\n                    p.push(sourceAnchorPosition[0] < targetAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\r\n                }\r\n                else {\r\n                    p.push(point[0] - (majorAnchor * soo[0]));\r\n                }\r\n\r\n                if (soo[1] === 0) {\r\n                    p.push(sourceAnchorPosition[1] < targetAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\r\n                }\r\n                else {\r\n                    p.push(point[1] + (majorAnchor * too[1]));\r\n                }\r\n            }\r\n            else {\r\n                if (too[0] === 0) {\r\n                    p.push(targetAnchorPosition[0] < sourceAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\r\n                }\r\n                else {\r\n                    p.push(point[0] + (majorAnchor * too[0]));\r\n                }\r\n\r\n                if (too[1] === 0) {\r\n                    p.push(targetAnchorPosition[1] < sourceAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\r\n                }\r\n                else {\r\n                    p.push(point[1] + (majorAnchor * soo[1]));\r\n                }\r\n            }\r\n\r\n            return p;\r\n        };\r\n\r\n        this._computeBezier = function (paintInfo, p, sp, tp, _w, _h) {\r\n\r\n            var _CP, _CP2,\r\n                _sx = sp[0] < tp[0] ? _w : 0,\r\n                _sy = sp[1] < tp[1] ? _h : 0,\r\n                _tx = sp[0] < tp[0] ? 0 : _w,\r\n                _ty = sp[1] < tp[1] ? 0 : _h;\r\n\r\n            _CP = this._findControlPoint([_sx, _sy], sp, tp, p.sourceEndpoint, p.targetEndpoint, paintInfo.so, paintInfo.to);\r\n            _CP2 = this._findControlPoint([_tx, _ty], tp, sp, p.targetEndpoint, p.sourceEndpoint, paintInfo.to, paintInfo.so);\r\n\r\n\r\n            _super.addSegment(this, \"Bezier\", {\r\n                x1: _sx, y1: _sy, x2: _tx, y2: _ty,\r\n                cp1x: _CP[0], cp1y: _CP[1], cp2x: _CP2[0], cp2y: _CP2[1]\r\n            });\r\n        };\r\n\r\n\r\n    };\r\n\r\n    _jp.Connectors.Bezier = Bezier;\r\n    _ju.extend(Bezier, _jp.Connectors.AbstractBezierConnector);\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the state machine connectors, which extend AbstractBezierConnector.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var _segment = function (x1, y1, x2, y2) {\r\n            if (x1 <= x2 && y2 <= y1) {\r\n                return 1;\r\n            }\r\n            else if (x1 <= x2 && y1 <= y2) {\r\n                return 2;\r\n            }\r\n            else if (x2 <= x1 && y2 >= y1) {\r\n                return 3;\r\n            }\r\n            return 4;\r\n        },\r\n\r\n        // the control point we will use depends on the faces to which each end of the connection is assigned, specifically whether or not the\r\n        // two faces are parallel or perpendicular.  if they are parallel then the control point lies on the midpoint of the axis in which they\r\n        // are parellel and varies only in the other axis; this variation is proportional to the distance that the anchor points lie from the\r\n        // center of that face.  if the two faces are perpendicular then the control point is at some distance from both the midpoints; the amount and\r\n        // direction are dependent on the orientation of the two elements. 'seg', passed in to this method, tells you which segment the target element\r\n        // lies in with respect to the source: 1 is top right, 2 is bottom right, 3 is bottom left, 4 is top left.\r\n        //\r\n        // sourcePos and targetPos are arrays of info about where on the source and target each anchor is located.  their contents are:\r\n        //\r\n        // 0 - absolute x\r\n        // 1 - absolute y\r\n        // 2 - proportional x in element (0 is left edge, 1 is right edge)\r\n        // 3 - proportional y in element (0 is top edge, 1 is bottom edge)\r\n        //\r\n        _findControlPoint = function (midx, midy, segment, sourceEdge, targetEdge, dx, dy, distance, proximityLimit) {\r\n            // TODO (maybe)\r\n            // - if anchor pos is 0.5, make the control point take into account the relative position of the elements.\r\n            if (distance <= proximityLimit) {\r\n                return [midx, midy];\r\n            }\r\n\r\n            if (segment === 1) {\r\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\r\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                }\r\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\r\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                }\r\n                else {\r\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\r\n                }\r\n            }\r\n            else if (segment === 2) {\r\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\r\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                }\r\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) {\r\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                }\r\n                else {\r\n                    return [ midx + dx, midy + (-1 * dy) ];\r\n                }\r\n            }\r\n            else if (segment === 3) {\r\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) {\r\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                }\r\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\r\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                }\r\n                else {\r\n                    return [ midx + (-1 * dx) , midy + (-1 * dy) ];\r\n                }\r\n            }\r\n            else if (segment === 4) {\r\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) {\r\n                    return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                }\r\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) {\r\n                    return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                }\r\n                else {\r\n                    return [ midx + dx , midy + (-1 * dy) ];\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n    var StateMachine = function (params) {\r\n        params = params || {};\r\n        this.type = \"StateMachine\";\r\n\r\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\r\n            curviness = params.curviness || 10,\r\n            margin = params.margin || 5,\r\n            proximityLimit = params.proximityLimit || 80,\r\n            clockwise = params.orientation && params.orientation === \"clockwise\",\r\n            _controlPoint;\r\n\r\n        this._computeBezier = function(paintInfo, params, sp, tp, w, h) {\r\n            var _sx = params.sourcePos[0] < params.targetPos[0] ? 0 : w,\r\n                _sy = params.sourcePos[1] < params.targetPos[1] ? 0 : h,\r\n                _tx = params.sourcePos[0] < params.targetPos[0] ? w : 0,\r\n                _ty = params.sourcePos[1] < params.targetPos[1] ? h : 0;\r\n\r\n            // now adjust for the margin\r\n            if (params.sourcePos[2] === 0) {\r\n                _sx -= margin;\r\n            }\r\n            if (params.sourcePos[2] === 1) {\r\n                _sx += margin;\r\n            }\r\n            if (params.sourcePos[3] === 0) {\r\n                _sy -= margin;\r\n            }\r\n            if (params.sourcePos[3] === 1) {\r\n                _sy += margin;\r\n            }\r\n            if (params.targetPos[2] === 0) {\r\n                _tx -= margin;\r\n            }\r\n            if (params.targetPos[2] === 1) {\r\n                _tx += margin;\r\n            }\r\n            if (params.targetPos[3] === 0) {\r\n                _ty -= margin;\r\n            }\r\n            if (params.targetPos[3] === 1) {\r\n                _ty += margin;\r\n            }\r\n\r\n            //\r\n            // these connectors are quadratic bezier curves, having a single control point. if both anchors\r\n            // are located at 0.5 on their respective faces, the control point is set to the midpoint and you\r\n            // get a straight line.  this is also the case if the two anchors are within 'proximityLimit', since\r\n            // it seems to make good aesthetic sense to do that. outside of that, the control point is positioned\r\n            // at 'curviness' pixels away along the normal to the straight line connecting the two anchors.\r\n            //\r\n            // there may be two improvements to this.  firstly, we might actually support the notion of avoiding nodes\r\n            // in the UI, or at least making a good effort at doing so.  if a connection would pass underneath some node,\r\n            // for example, we might increase the distance the control point is away from the midpoint in a bid to\r\n            // steer it around that node.  this will work within limits, but i think those limits would also be the likely\r\n            // limits for, once again, aesthetic good sense in the layout of a chart using these connectors.\r\n            //\r\n            // the second possible change is actually two possible changes: firstly, it is possible we should gradually\r\n            // decrease the 'curviness' as the distance between the anchors decreases; start tailing it off to 0 at some\r\n            // point (which should be configurable).  secondly, we might slightly increase the 'curviness' for connectors\r\n            // with respect to how far their anchor is from the center of its respective face. this could either look cool,\r\n            // or stupid, and may indeed work only in a way that is so subtle as to have been a waste of time.\r\n            //\r\n\r\n            var _midx = (_sx + _tx) / 2,\r\n                _midy = (_sy + _ty) / 2,\r\n                segment = _segment(_sx, _sy, _tx, _ty),\r\n                distance = Math.sqrt(Math.pow(_tx - _sx, 2) + Math.pow(_ty - _sy, 2)),\r\n                cp1x, cp2x, cp1y, cp2y;\r\n\r\n\r\n            // calculate the control point.  this code will be where we'll put in a rudimentary element avoidance scheme; it\r\n            // will work by extending the control point to force the curve to be, um, curvier.\r\n            _controlPoint = _findControlPoint(_midx,\r\n                _midy,\r\n                segment,\r\n                params.sourcePos,\r\n                params.targetPos,\r\n                curviness, curviness,\r\n                distance,\r\n                proximityLimit);\r\n\r\n            cp1x = _controlPoint[0];\r\n            cp2x = _controlPoint[0];\r\n            cp1y = _controlPoint[1];\r\n            cp2y = _controlPoint[1];\r\n\r\n            _super.addSegment(this, \"Bezier\", {\r\n                x1: _tx, y1: _ty, x2: _sx, y2: _sy,\r\n                cp1x: cp1x, cp1y: cp1y,\r\n                cp2x: cp2x, cp2y: cp2y\r\n            });\r\n        };\r\n    };\r\n\r\n    _jp.Connectors.StateMachine = StateMachine;\r\n    _ju.extend(StateMachine, _jp.Connectors.AbstractBezierConnector);\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n    var STRAIGHT = \"Straight\";\r\n\r\n    var Straight = function (params) {\r\n        this.type = STRAIGHT;\r\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\r\n\r\n        this._compute = function (paintInfo, _) {\r\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.sx, y1: paintInfo.sy, x2: paintInfo.startStubX, y2: paintInfo.startStubY});\r\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.startStubX, y1: paintInfo.startStubY, x2: paintInfo.endStubX, y2: paintInfo.endStubY});\r\n            _super.addSegment(this, STRAIGHT, {x1: paintInfo.endStubX, y1: paintInfo.endStubY, x2: paintInfo.tx, y2: paintInfo.ty});\r\n        };\r\n    };\r\n\r\n    _jp.Connectors.Straight = Straight;\r\n    _ju.extend(Straight, _jp.Connectors.AbstractConnector);\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n/*\r\n * This file contains the SVG renderers.\r\n *\r\n * Copyright (c) 2010 - 2018 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n// ************************** SVG utility methods ********************************************\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var svgAttributeMap = {\r\n            \"stroke-linejoin\": \"stroke-linejoin\",\r\n            \"stroke-dashoffset\": \"stroke-dashoffset\",\r\n            \"stroke-linecap\": \"stroke-linecap\"\r\n        },\r\n        STROKE_DASHARRAY = \"stroke-dasharray\",\r\n        DASHSTYLE = \"dashstyle\",\r\n        LINEAR_GRADIENT = \"linearGradient\",\r\n        RADIAL_GRADIENT = \"radialGradient\",\r\n        DEFS = \"defs\",\r\n        FILL = \"fill\",\r\n        STOP = \"stop\",\r\n        STROKE = \"stroke\",\r\n        STROKE_WIDTH = \"stroke-width\",\r\n        STYLE = \"style\",\r\n        NONE = \"none\",\r\n        JSPLUMB_GRADIENT = \"jsplumb_gradient_\",\r\n        LINE_WIDTH = \"strokeWidth\",\r\n        ns = {\r\n            svg: \"http://www.w3.org/2000/svg\"\r\n        },\r\n        _attr = function (node, attributes) {\r\n            for (var i in attributes) {\r\n                node.setAttribute(i, \"\" + attributes[i]);\r\n            }\r\n        },\r\n        _node = function (name, attributes) {\r\n            attributes = attributes || {};\r\n            attributes.version = \"1.1\";\r\n            attributes.xmlns = ns.svg;\r\n            return _jp.createElementNS(ns.svg, name, null, null, attributes);\r\n        },\r\n        _pos = function (d) {\r\n            return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\r\n        },\r\n        _clearGradient = function (parent) {\r\n            var els = parent.querySelectorAll(\" defs,linearGradient,radialGradient\");\r\n            for (var i = 0; i < els.length; i++) {\r\n                els[i].parentNode.removeChild(els[i]);\r\n            }\r\n        },\r\n        _updateGradient = function (parent, node, style, dimensions, uiComponent) {\r\n            var id = JSPLUMB_GRADIENT + uiComponent._jsPlumb.instance.idstamp();\r\n            // first clear out any existing gradient\r\n            _clearGradient(parent);\r\n            // this checks for an 'offset' property in the gradient, and in the absence of it, assumes\r\n            // we want a linear gradient. if it's there, we create a radial gradient.\r\n            // it is possible that a more explicit means of defining the gradient type would be\r\n            // better. relying on 'offset' means that we can never have a radial gradient that uses\r\n            // some default offset, for instance.\r\n            // issue 244 suggested the 'gradientUnits' attribute; without this, straight/flowchart connectors with gradients would\r\n            // not show gradients when the line was perfectly horizontal or vertical.\r\n            var g;\r\n            if (!style.gradient.offset) {\r\n                g = _node(LINEAR_GRADIENT, {id: id, gradientUnits: \"userSpaceOnUse\"});\r\n            }\r\n            else {\r\n                g = _node(RADIAL_GRADIENT, { id: id });\r\n            }\r\n\r\n            var defs = _node(DEFS);\r\n            parent.appendChild(defs);\r\n            defs.appendChild(g);\r\n\r\n            // the svg radial gradient seems to treat stops in the reverse\r\n            // order to how canvas does it.  so we want to keep all the maths the same, but\r\n            // iterate the actual style declarations in reverse order, if the x indexes are not in order.\r\n            for (var i = 0; i < style.gradient.stops.length; i++) {\r\n                var styleToUse = uiComponent.segment === 1 || uiComponent.segment === 2 ? i : style.gradient.stops.length - 1 - i,\r\n                    stopColor = style.gradient.stops[styleToUse][1],\r\n                    s = _node(STOP, {\"offset\": Math.floor(style.gradient.stops[i][0] * 100) + \"%\", \"stop-color\": stopColor});\r\n\r\n                g.appendChild(s);\r\n            }\r\n            var applyGradientTo = style.stroke ? STROKE : FILL;\r\n            node.setAttribute(applyGradientTo, \"url(#\" + id + \")\");\r\n        },\r\n        _applyStyles = function (parent, node, style, dimensions, uiComponent) {\r\n\r\n            node.setAttribute(FILL, style.fill ? style.fill : NONE);\r\n            node.setAttribute(STROKE, style.stroke ? style.stroke : NONE);\r\n\r\n            if (style.gradient) {\r\n                _updateGradient(parent, node, style, dimensions, uiComponent);\r\n            }\r\n            else {\r\n                // make sure we clear any existing gradient\r\n                _clearGradient(parent);\r\n                node.setAttribute(STYLE, \"\");\r\n            }\r\n\r\n            if (style.strokeWidth) {\r\n                node.setAttribute(STROKE_WIDTH, style.strokeWidth);\r\n            }\r\n\r\n            // in SVG there is a stroke-dasharray attribute we can set, and its syntax looks like\r\n            // the syntax in VML but is actually kind of nasty: values are given in the pixel\r\n            // coordinate space, whereas in VML they are multiples of the width of the stroked\r\n            // line, which makes a lot more sense.  for that reason, jsPlumb is supporting both\r\n            // the native svg 'stroke-dasharray' attribute, and also the 'dashstyle' concept from\r\n            // VML, which will be the preferred method.  the code below this converts a dashstyle\r\n            // attribute given in terms of stroke width into a pixel representation, by using the\r\n            // stroke's lineWidth.\r\n            if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\r\n                var sep = style[DASHSTYLE].indexOf(\",\") === -1 ? \" \" : \",\",\r\n                    parts = style[DASHSTYLE].split(sep),\r\n                    styleToUse = \"\";\r\n                parts.forEach(function (p) {\r\n                    styleToUse += (Math.floor(p * style.strokeWidth) + sep);\r\n                });\r\n                node.setAttribute(STROKE_DASHARRAY, styleToUse);\r\n            }\r\n            else if (style[STROKE_DASHARRAY]) {\r\n                node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\r\n            }\r\n\r\n            // extra attributes such as join type, dash offset.\r\n            for (var i in svgAttributeMap) {\r\n                if (style[i]) {\r\n                    node.setAttribute(svgAttributeMap[i], style[i]);\r\n                }\r\n            }\r\n        },\r\n        _appendAtIndex = function (svg, path, idx) {\r\n            if (svg.childNodes.length > idx) {\r\n                svg.insertBefore(path, svg.childNodes[idx]);\r\n            }\r\n            else {\r\n                svg.appendChild(path);\r\n            }\r\n        };\r\n\r\n    /**\r\n     utility methods for other objects to use.\r\n     */\r\n    _ju.svg = {\r\n        node: _node,\r\n        attr: _attr,\r\n        pos: _pos\r\n    };\r\n\r\n    // ************************** / SVG utility methods ********************************************\r\n\r\n    /*\r\n     * Base class for SVG components.\r\n     */\r\n    var SvgComponent = function (params) {\r\n        var pointerEventsSpec = params.pointerEventsSpec || \"all\", renderer = {};\r\n\r\n        _jp.jsPlumbUIComponent.apply(this, params.originalArgs);\r\n        this.canvas = null;\r\n        this.path = null;\r\n        this.svg = null;\r\n        this.bgCanvas = null;\r\n\r\n        var clazz = params.cssClass + \" \" + (params.originalArgs[0].cssClass || \"\"),\r\n            svgParams = {\r\n                \"style\": \"\",\r\n                \"width\": 0,\r\n                \"height\": 0,\r\n                \"pointer-events\": pointerEventsSpec,\r\n                \"position\": \"absolute\"\r\n            };\r\n\r\n        this.svg = _node(\"svg\", svgParams);\r\n\r\n        if (params.useDivWrapper) {\r\n            this.canvas = _jp.createElement(\"div\", { position : \"absolute\" });\r\n            _ju.sizeElement(this.canvas, 0, 0, 1, 1);\r\n            this.canvas.className = clazz;\r\n        }\r\n        else {\r\n            _attr(this.svg, { \"class\": clazz });\r\n            this.canvas = this.svg;\r\n        }\r\n\r\n        params._jsPlumb.appendElement(this.canvas, params.originalArgs[0].parent);\r\n        if (params.useDivWrapper) {\r\n            this.canvas.appendChild(this.svg);\r\n        }\r\n\r\n        var displayElements = [ this.canvas ];\r\n        this.getDisplayElements = function () {\r\n            return displayElements;\r\n        };\r\n\r\n        this.appendDisplayElement = function (el) {\r\n            displayElements.push(el);\r\n        };\r\n\r\n        this.paint = function (style, anchor, extents) {\r\n            if (style != null) {\r\n\r\n                var xy = [ this.x, this.y ], wh = [ this.w, this.h ], p;\r\n                if (extents != null) {\r\n                    if (extents.xmin < 0) {\r\n                        xy[0] += extents.xmin;\r\n                    }\r\n                    if (extents.ymin < 0) {\r\n                        xy[1] += extents.ymin;\r\n                    }\r\n                    wh[0] = extents.xmax + ((extents.xmin < 0) ? -extents.xmin : 0);\r\n                    wh[1] = extents.ymax + ((extents.ymin < 0) ? -extents.ymin : 0);\r\n                }\r\n\r\n                if (params.useDivWrapper) {\r\n                    _ju.sizeElement(this.canvas, xy[0], xy[1], wh[0], wh[1]);\r\n                    xy[0] = 0;\r\n                    xy[1] = 0;\r\n                    p = _pos([ 0, 0 ]);\r\n                }\r\n                else {\r\n                    p = _pos([ xy[0], xy[1] ]);\r\n                }\r\n\r\n                renderer.paint.apply(this, arguments);\r\n\r\n                _attr(this.svg, {\r\n                    \"style\": p,\r\n                    \"width\": wh[0] || 0,\r\n                    \"height\": wh[1] || 0\r\n                });\r\n            }\r\n        };\r\n\r\n        return {\r\n            renderer: renderer\r\n        };\r\n    };\r\n\r\n    _ju.extend(SvgComponent, _jp.jsPlumbUIComponent, {\r\n        cleanup: function (force) {\r\n            if (force || this.typeId == null) {\r\n                if (this.canvas) {\r\n                    this.canvas._jsPlumb = null;\r\n                }\r\n                if (this.svg) {\r\n                    this.svg._jsPlumb = null;\r\n                }\r\n                if (this.bgCanvas) {\r\n                    this.bgCanvas._jsPlumb = null;\r\n                }\r\n\r\n                if (this.canvas && this.canvas.parentNode) {\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n                }\r\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n                }\r\n\r\n                this.svg = null;\r\n                this.canvas = null;\r\n                this.path = null;\r\n                this.group = null;\r\n            }\r\n            else {\r\n                // if not a forced cleanup, just detach from DOM for now.\r\n                if (this.canvas && this.canvas.parentNode) {\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n                }\r\n                if (this.bgCanvas && this.bgCanvas.parentNode) {\r\n                    this.bgCanvas.parentNode.removeChild(this.bgCanvas);\r\n                }\r\n            }\r\n        },\r\n        reattach:function(instance) {\r\n            var c = instance.getContainer();\r\n            if (this.canvas && this.canvas.parentNode == null) {\r\n                c.appendChild(this.canvas);\r\n            }\r\n            if (this.bgCanvas && this.bgCanvas.parentNode == null) {\r\n                c.appendChild(this.bgCanvas);\r\n            }\r\n        },\r\n        setVisible: function (v) {\r\n            if (this.canvas) {\r\n                this.canvas.style.display = v ? \"block\" : \"none\";\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Base class for SVG connectors.\r\n     */\r\n    _jp.ConnectorRenderers.svg = function (params) {\r\n        var self = this,\r\n            _super = SvgComponent.apply(this, [\r\n                {\r\n                    cssClass: params._jsPlumb.connectorClass,\r\n                    originalArgs: arguments,\r\n                    pointerEventsSpec: \"none\",\r\n                    _jsPlumb: params._jsPlumb\r\n                }\r\n            ]);\r\n\r\n        _super.renderer.paint = function (style, anchor, extents) {\r\n\r\n            var segments = self.getSegments(), p = \"\", offset = [0, 0];\r\n            if (extents.xmin < 0) {\r\n                offset[0] = -extents.xmin;\r\n            }\r\n            if (extents.ymin < 0) {\r\n                offset[1] = -extents.ymin;\r\n            }\r\n\r\n            if (segments.length > 0) {\r\n\r\n                p = self.getPathData();\r\n\r\n                var a = {\r\n                        d: p,\r\n                        transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\r\n                        \"pointer-events\": params[\"pointer-events\"] || \"visibleStroke\"\r\n                    },\r\n                    outlineStyle = null,\r\n                    d = [self.x, self.y, self.w, self.h];\r\n\r\n                // outline style.  actually means drawing an svg object underneath the main one.\r\n                if (style.outlineStroke) {\r\n                    var outlineWidth = style.outlineWidth || 1,\r\n                        outlineStrokeWidth = style.strokeWidth + (2 * outlineWidth);\r\n                    outlineStyle = _jp.extend({}, style);\r\n                    delete outlineStyle.gradient;\r\n                    outlineStyle.stroke = style.outlineStroke;\r\n                    outlineStyle.strokeWidth = outlineStrokeWidth;\r\n\r\n                    if (self.bgPath == null) {\r\n                        self.bgPath = _node(\"path\", a);\r\n                        _jp.addClass(self.bgPath, _jp.connectorOutlineClass);\r\n                        _appendAtIndex(self.svg, self.bgPath, 0);\r\n                    }\r\n                    else {\r\n                        _attr(self.bgPath, a);\r\n                    }\r\n\r\n                    _applyStyles(self.svg, self.bgPath, outlineStyle, d, self);\r\n                }\r\n\r\n                if (self.path == null) {\r\n                    self.path = _node(\"path\", a);\r\n                    _appendAtIndex(self.svg, self.path, style.outlineStroke ? 1 : 0);\r\n                }\r\n                else {\r\n                    _attr(self.path, a);\r\n                }\r\n\r\n                _applyStyles(self.svg, self.path, style, d, self);\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.ConnectorRenderers.svg, SvgComponent);\r\n\r\n// ******************************* svg segment renderer *****************************************************\r\n\r\n\r\n// ******************************* /svg segments *****************************************************\r\n\r\n    /*\r\n     * Base class for SVG endpoints.\r\n     */\r\n    var SvgEndpoint = _jp.SvgEndpoint = function (params) {\r\n        var _super = SvgComponent.apply(this, [\r\n            {\r\n                cssClass: params._jsPlumb.endpointClass,\r\n                originalArgs: arguments,\r\n                pointerEventsSpec: \"all\",\r\n                useDivWrapper: true,\r\n                _jsPlumb: params._jsPlumb\r\n            }\r\n        ]);\r\n\r\n        _super.renderer.paint = function (style) {\r\n            var s = _jp.extend({}, style);\r\n            if (s.outlineStroke) {\r\n                s.stroke = s.outlineStroke;\r\n            }\r\n\r\n            if (this.node == null) {\r\n                this.node = this.makeNode(s);\r\n                this.svg.appendChild(this.node);\r\n            }\r\n            else if (this.updateNode != null) {\r\n                this.updateNode(this.node);\r\n            }\r\n            _applyStyles(this.svg, this.node, s, [ this.x, this.y, this.w, this.h ], this);\r\n            _pos(this.node, [ this.x, this.y ]);\r\n        }.bind(this);\r\n\r\n    };\r\n    _ju.extend(SvgEndpoint, SvgComponent);\r\n\r\n    /*\r\n     * SVG Dot Endpoint\r\n     */\r\n    _jp.Endpoints.svg.Dot = function () {\r\n        _jp.Endpoints.Dot.apply(this, arguments);\r\n        SvgEndpoint.apply(this, arguments);\r\n        this.makeNode = function (style) {\r\n            return _node(\"circle\", {\r\n                \"cx\": this.w / 2,\r\n                \"cy\": this.h / 2,\r\n                \"r\": this.radius\r\n            });\r\n        };\r\n        this.updateNode = function (node) {\r\n            _attr(node, {\r\n                \"cx\": this.w / 2,\r\n                \"cy\": this.h / 2,\r\n                \"r\": this.radius\r\n            });\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.svg.Dot, [_jp.Endpoints.Dot, SvgEndpoint]);\r\n\r\n    /*\r\n     * SVG Rectangle Endpoint\r\n     */\r\n    _jp.Endpoints.svg.Rectangle = function () {\r\n        _jp.Endpoints.Rectangle.apply(this, arguments);\r\n        SvgEndpoint.apply(this, arguments);\r\n        this.makeNode = function (style) {\r\n            return _node(\"rect\", {\r\n                \"width\": this.w,\r\n                \"height\": this.h\r\n            });\r\n        };\r\n        this.updateNode = function (node) {\r\n            _attr(node, {\r\n                \"width\": this.w,\r\n                \"height\": this.h\r\n            });\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.svg.Rectangle, [_jp.Endpoints.Rectangle, SvgEndpoint]);\r\n\r\n    /*\r\n     * SVG Image Endpoint is the default image endpoint.\r\n     */\r\n    _jp.Endpoints.svg.Image = _jp.Endpoints.Image;\r\n    /*\r\n     * Blank endpoint in svg renderer is the default Blank endpoint.\r\n     */\r\n    _jp.Endpoints.svg.Blank = _jp.Endpoints.Blank;\r\n    /*\r\n     * Label overlay in svg renderer is the default Label overlay.\r\n     */\r\n    _jp.Overlays.svg.Label = _jp.Overlays.Label;\r\n    /*\r\n     * Custom overlay in svg renderer is the default Custom overlay.\r\n     */\r\n    _jp.Overlays.svg.Custom = _jp.Overlays.Custom;\r\n\r\n    var AbstractSvgArrowOverlay = function (superclass, originalArgs) {\r\n        superclass.apply(this, originalArgs);\r\n        _jp.jsPlumbUIComponent.apply(this, originalArgs);\r\n        this.isAppendedAtTopLevel = false;\r\n        var self = this;\r\n        this.path = null;\r\n        this.paint = function (params, containerExtents) {\r\n            // only draws on connections, not endpoints.\r\n            if (params.component.svg && containerExtents) {\r\n                if (this.path == null) {\r\n                    this.path = _node(\"path\", {\r\n                        \"pointer-events\": \"all\"\r\n                    });\r\n                    params.component.svg.appendChild(this.path);\r\n                    if (this.elementCreated) {\r\n                        this.elementCreated(this.path, params.component);\r\n                    }\r\n\r\n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\r\n                }\r\n                var clazz = originalArgs && (originalArgs.length === 1) ? (originalArgs[0].cssClass || \"\") : \"\",\r\n                    offset = [0, 0];\r\n\r\n                if (containerExtents.xmin < 0) {\r\n                    offset[0] = -containerExtents.xmin;\r\n                }\r\n                if (containerExtents.ymin < 0) {\r\n                    offset[1] = -containerExtents.ymin;\r\n                }\r\n\r\n                _attr(this.path, {\r\n                    \"d\": makePath(params.d),\r\n                    \"class\": clazz,\r\n                    stroke: params.stroke ? params.stroke : null,\r\n                    fill: params.fill ? params.fill : null,\r\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n                });\r\n            }\r\n        };\r\n        var makePath = function (d) {\r\n            return (isNaN(d.cxy.x) || isNaN(d.cxy.y)) ? \"\" : \"M\" + d.hxy.x + \",\" + d.hxy.y +\r\n                \" L\" + d.tail[0].x + \",\" + d.tail[0].y +\r\n                \" L\" + d.cxy.x + \",\" + d.cxy.y +\r\n                \" L\" + d.tail[1].x + \",\" + d.tail[1].y +\r\n                \" L\" + d.hxy.x + \",\" + d.hxy.y;\r\n        };\r\n        this.transfer = function(target) {\r\n            if (target.canvas && this.path && this.path.parentNode) {\r\n                this.path.parentNode.removeChild(this.path);\r\n                target.canvas.appendChild(this.path);\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(AbstractSvgArrowOverlay, [_jp.jsPlumbUIComponent, _jp.Overlays.AbstractOverlay], {\r\n        cleanup: function (force) {\r\n            if (this.path != null) {\r\n                if (force) {\r\n                    this._jsPlumb.instance.removeElement(this.path);\r\n                }\r\n                else {\r\n                    if (this.path.parentNode) {\r\n                        this.path.parentNode.removeChild(this.path);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        reattach:function(instance, component) {\r\n            if (this.path && component.canvas) {\r\n                component.canvas.appendChild(this.path);\r\n            }\r\n        },\r\n        setVisible: function (v) {\r\n            if (this.path != null) {\r\n                (this.path.style.display = (v ? \"block\" : \"none\"));\r\n            }\r\n        }\r\n    });\r\n\r\n    _jp.Overlays.svg.Arrow = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.Arrow, [ _jp.Overlays.Arrow, AbstractSvgArrowOverlay ]);\r\n\r\n    _jp.Overlays.svg.PlainArrow = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractSvgArrowOverlay ]);\r\n\r\n    _jp.Overlays.svg.Diamond = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.Diamond, [ _jp.Overlays.Diamond, AbstractSvgArrowOverlay ]);\r\n\r\n    // a test\r\n    _jp.Overlays.svg.GuideLines = function () {\r\n        var path = null, self = this, p1_1, p1_2;\r\n        _jp.Overlays.GuideLines.apply(this, arguments);\r\n        this.paint = function (params, containerExtents) {\r\n            if (path == null) {\r\n                path = _node(\"path\");\r\n                params.connector.svg.appendChild(path);\r\n                self.attachListeners(path, params.connector);\r\n                self.attachListeners(path, self);\r\n\r\n                p1_1 = _node(\"path\");\r\n                params.connector.svg.appendChild(p1_1);\r\n                self.attachListeners(p1_1, params.connector);\r\n                self.attachListeners(p1_1, self);\r\n\r\n                p1_2 = _node(\"path\");\r\n                params.connector.svg.appendChild(p1_2);\r\n                self.attachListeners(p1_2, params.connector);\r\n                self.attachListeners(p1_2, self);\r\n            }\r\n\r\n            var offset = [0, 0];\r\n            if (containerExtents.xmin < 0) {\r\n                offset[0] = -containerExtents.xmin;\r\n            }\r\n            if (containerExtents.ymin < 0) {\r\n                offset[1] = -containerExtents.ymin;\r\n            }\r\n\r\n            _attr(path, {\r\n                \"d\": makePath(params.head, params.tail),\r\n                stroke: \"red\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n\r\n            _attr(p1_1, {\r\n                \"d\": makePath(params.tailLine[0], params.tailLine[1]),\r\n                stroke: \"blue\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n\r\n            _attr(p1_2, {\r\n                \"d\": makePath(params.headLine[0], params.headLine[1]),\r\n                stroke: \"green\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n        };\r\n\r\n        var makePath = function (d1, d2) {\r\n            return \"M \" + d1.x + \",\" + d1.y +\r\n                \" L\" + d2.x + \",\" + d2.y;\r\n        };\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.GuideLines, _jp.Overlays.GuideLines);\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n\r\n/*\r\n * This file contains code used when jsPlumb is being rendered in a DOM.\r\n *\r\n * Copyright (c) 2010 - 2019 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * https://jsplumbtoolkit.com\r\n * https://github.com/jsplumb/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil,\r\n        _jk = root.Katavorio, _jg = root.Biltong;\r\n\r\n    var _getEventManager = function(instance) {\r\n        var e = instance._mottle;\r\n        if (!e) {\r\n            e = instance._mottle = new root.Mottle();\r\n        }\r\n        return e;\r\n    };\r\n\r\n    var _getDragManager = function (instance, category) {\r\n\r\n        category = category || \"main\";\r\n        var key = \"_katavorio_\" + category;\r\n        var k = instance[key],\r\n            e = instance.getEventManager();\r\n\r\n        if (!k) {\r\n            k = new _jk({\r\n                bind: e.on,\r\n                unbind: e.off,\r\n                getSize: _jp.getSize,\r\n                getConstrainingRectangle:function(el) {\r\n                    return [ el.parentNode.scrollWidth, el.parentNode.scrollHeight ];\r\n                },\r\n                getPosition: function (el, relativeToRoot) {\r\n                    // if this is a nested draggable then compute the offset against its own offsetParent, otherwise\r\n                    // compute against the Container's origin. see also the getUIPosition method below.\r\n                    var o = instance.getOffset(el, relativeToRoot, el._katavorioDrag ? el.offsetParent : null);\r\n                    return [o.left, o.top];\r\n                },\r\n                setPosition: function (el, xy) {\r\n                    el.style.left = xy[0] + \"px\";\r\n                    el.style.top = xy[1] + \"px\";\r\n                },\r\n                addClass: _jp.addClass,\r\n                removeClass: _jp.removeClass,\r\n                intersects: _jg.intersects,\r\n                indexOf: function(l, i) { return l.indexOf(i); },\r\n                scope:instance.getDefaultScope(),\r\n                css: {\r\n                    noSelect: instance.dragSelectClass,\r\n                    droppable: \"jtk-droppable\",\r\n                    draggable: \"jtk-draggable\",\r\n                    drag: \"jtk-drag\",\r\n                    selected: \"jtk-drag-selected\",\r\n                    active: \"jtk-drag-active\",\r\n                    hover: \"jtk-drag-hover\",\r\n                    ghostProxy:\"jtk-ghost-proxy\"\r\n                }\r\n            });\r\n            k.setZoom(instance.getZoom());\r\n            instance[key] = k;\r\n            instance.bind(\"zoom\", k.setZoom);\r\n        }\r\n        return k;\r\n    };\r\n\r\n    var _dragStart=function(params) {\r\n        var options = params.el._jsPlumbDragOptions;\r\n        var cont = true;\r\n        if (options.canDrag) {\r\n            cont = options.canDrag();\r\n        }\r\n        if (cont) {\r\n            this.setHoverSuspended(true);\r\n            this.select({source: params.el}).addClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\r\n            this.select({target: params.el}).addClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\r\n            this.setConnectionBeingDragged(true);\r\n        }\r\n        return cont;\r\n    };\r\n    var _dragMove=function(params) {\r\n        var ui = this.getUIPosition(arguments, this.getZoom());\r\n        if (ui != null) {\r\n            var o = params.el._jsPlumbDragOptions;\r\n            this.draw(params.el, ui, null, true);\r\n            if (o._dragging) {\r\n                this.addClass(params.el, \"jtk-dragged\");\r\n            }\r\n            o._dragging = true;\r\n        }\r\n    };\r\n    var _dragStop=function(params) {\r\n        var elements = params.selection, uip;\r\n\r\n        var _one = function (_e) {\r\n            if (_e[1] != null) {\r\n                // run the reported offset through the code that takes parent containers\r\n                // into account, to adjust if necessary (issue 554)\r\n                uip = this.getUIPosition([{\r\n                    el:_e[2].el,\r\n                    pos:[_e[1].left, _e[1].top]\r\n                }]);\r\n                this.draw(_e[2].el, uip);\r\n            }\r\n\r\n            if (_e[0]._jsPlumbDragOptions != null) {\r\n                delete _e[0]._jsPlumbDragOptions._dragging;\r\n            }\r\n\r\n            this.removeClass(_e[0], \"jtk-dragged\");\r\n            this.select({source: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.sourceElementDraggingClass, true);\r\n            this.select({target: _e[2].el}).removeClass(this.elementDraggingClass + \" \" + this.targetElementDraggingClass, true);\r\n            this.getDragManager().dragEnded(_e[2].el);\r\n        }.bind(this);\r\n\r\n        for (var i = 0; i < elements.length; i++) {\r\n            _one(elements[i]);\r\n        }\r\n\r\n        this.setHoverSuspended(false);\r\n        this.setConnectionBeingDragged(false);\r\n    };\r\n\r\n    var _animProps = function (o, p) {\r\n        var _one = function (pName) {\r\n            if (p[pName] != null) {\r\n                if (_ju.isString(p[pName])) {\r\n                    var m = p[pName].match(/-=/) ? -1 : 1,\r\n                        v = p[pName].substring(2);\r\n                    return o[pName] + (m * v);\r\n                }\r\n                else {\r\n                    return p[pName];\r\n                }\r\n            }\r\n            else {\r\n                return o[pName];\r\n            }\r\n        };\r\n        return [ _one(\"left\"), _one(\"top\") ];\r\n    };\r\n\r\n    var _genLoc = function (prefix, e) {\r\n            if (e == null) {\r\n                return [ 0, 0 ];\r\n            }\r\n            var ts = _touches(e), t = _getTouch(ts, 0);\r\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\r\n        },\r\n        _pageLocation = _genLoc.bind(this, \"page\"),\r\n        _screenLocation = _genLoc.bind(this, \"screen\"),\r\n        _clientLocation = _genLoc.bind(this, \"client\"),\r\n        _getTouch = function (touches, idx) {\r\n            return touches.item ? touches.item(idx) : touches[idx];\r\n        },\r\n        _touches = function (e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                        [ e ];\r\n        };\r\n\r\n    /**\r\n     Manages dragging for some instance of jsPlumb.\r\n\r\n     TODO instead of this being accessed directly, it should subscribe to events on the jsPlumb instance: every method\r\n     in here is called directly by jsPlumb. But what should happen is that we have unpublished events that this listens\r\n     to.  The only trick is getting one of these instantiated with every jsPlumb instance: it needs to have a hook somehow.\r\n     Basically the general idea is to pull ALL the drag code out (prototype method registrations plus this) into a\r\n     dedicated drag script), that does not necessarily need to be included.\r\n\r\n\r\n     */\r\n    var DragManager = function (_currentInstance) {\r\n        var _draggables = {}, _dlist = [], _delements = {}, _elementsWithEndpoints = {},\r\n            // elementids mapped to the draggable to which they belong.\r\n            _draggablesForElements = {};\r\n\r\n        /**\r\n         register some element as draggable.  right now the drag init stuff is done elsewhere, and it is\r\n         possible that will continue to be the case.\r\n         */\r\n        this.register = function (el) {\r\n            var id = _currentInstance.getId(el),\r\n                parentOffset;\r\n\r\n            if (!_draggables[id]) {\r\n                _draggables[id] = el;\r\n                _dlist.push(el);\r\n                _delements[id] = {};\r\n            }\r\n\r\n            // look for child elements that have endpoints and register them against this draggable.\r\n            var _oneLevel = function (p) {\r\n                if (p) {\r\n                    for (var i = 0; i < p.childNodes.length; i++) {\r\n                        if (p.childNodes[i].nodeType !== 3 && p.childNodes[i].nodeType !== 8) {\r\n                            var cEl = jsPlumb.getElement(p.childNodes[i]),\r\n                                cid = _currentInstance.getId(p.childNodes[i], null, true);\r\n                            if (cid && _elementsWithEndpoints[cid] && _elementsWithEndpoints[cid] > 0) {\r\n                                if (!parentOffset) {\r\n                                    parentOffset = _currentInstance.getOffset(el);\r\n                                }\r\n                                var cOff = _currentInstance.getOffset(cEl);\r\n                                _delements[id][cid] = {\r\n                                    id: cid,\r\n                                    offset: {\r\n                                        left: cOff.left - parentOffset.left,\r\n                                        top: cOff.top - parentOffset.top\r\n                                    }\r\n                                };\r\n                                _draggablesForElements[cid] = id;\r\n                            }\r\n                            _oneLevel(p.childNodes[i]);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            _oneLevel(el);\r\n        };\r\n\r\n        // refresh the offsets for child elements of this element.\r\n        this.updateOffsets = function (elId, childOffsetOverrides) {\r\n            if (elId != null) {\r\n                childOffsetOverrides = childOffsetOverrides || {};\r\n                var domEl = jsPlumb.getElement(elId),\r\n                    id = _currentInstance.getId(domEl),\r\n                    children = _delements[id],\r\n                    parentOffset;\r\n\r\n                if (children) {\r\n                    for (var i in children) {\r\n                        if (children.hasOwnProperty(i)) {\r\n                            var cel = jsPlumb.getElement(i),\r\n                                cOff = childOffsetOverrides[i] || _currentInstance.getOffset(cel);\r\n\r\n                            // do not update if we have a value already and we'd just be writing 0,0\r\n                            if (cel.offsetParent == null && _delements[id][i] != null) {\r\n                                continue;\r\n                            }\r\n\r\n                            if (!parentOffset) {\r\n                                parentOffset = _currentInstance.getOffset(domEl);\r\n                            }\r\n\r\n                            _delements[id][i] = {\r\n                                id: i,\r\n                                offset: {\r\n                                    left: cOff.left - parentOffset.left,\r\n                                    top: cOff.top - parentOffset.top\r\n                                }\r\n                            };\r\n                            _draggablesForElements[i] = id;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        /**\r\n         notification that an endpoint was added to the given el.  we go up from that el's parent\r\n         node, looking for a parent that has been registered as a draggable. if we find one, we add this\r\n         el to that parent's list of elements to update on drag (if it is not there already)\r\n         */\r\n        this.endpointAdded = function (el, id) {\r\n\r\n            id = id || _currentInstance.getId(el);\r\n\r\n            var b = document.body,\r\n                p = el.parentNode;\r\n\r\n            _elementsWithEndpoints[id] = _elementsWithEndpoints[id] ? _elementsWithEndpoints[id] + 1 : 1;\r\n\r\n            while (p != null && p !== b) {\r\n                var pid = _currentInstance.getId(p, null, true);\r\n                if (pid && _draggables[pid]) {\r\n                    var pLoc = _currentInstance.getOffset(p);\r\n\r\n                    if (_delements[pid][id] == null) {\r\n                        var cLoc = _currentInstance.getOffset(el);\r\n                        _delements[pid][id] = {\r\n                            id: id,\r\n                            offset: {\r\n                                left: cLoc.left - pLoc.left,\r\n                                top: cLoc.top - pLoc.top\r\n                            }\r\n                        };\r\n                        _draggablesForElements[id] = pid;\r\n                    }\r\n                    break;\r\n                }\r\n                p = p.parentNode;\r\n            }\r\n        };\r\n\r\n        this.endpointDeleted = function (endpoint) {\r\n            if (_elementsWithEndpoints[endpoint.elementId]) {\r\n                _elementsWithEndpoints[endpoint.elementId]--;\r\n                if (_elementsWithEndpoints[endpoint.elementId] <= 0) {\r\n                    for (var i in _delements) {\r\n                        if (_delements.hasOwnProperty(i) && _delements[i]) {\r\n                            delete _delements[i][endpoint.elementId];\r\n                            delete _draggablesForElements[endpoint.elementId];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        this.changeId = function (oldId, newId) {\r\n            _delements[newId] = _delements[oldId];\r\n            _delements[oldId] = {};\r\n            _draggablesForElements[newId] = _draggablesForElements[oldId];\r\n            _draggablesForElements[oldId] = null;\r\n        };\r\n\r\n        this.getElementsForDraggable = function (id) {\r\n            return _delements[id];\r\n        };\r\n\r\n        this.elementRemoved = function (elementId) {\r\n            var elId = _draggablesForElements[elementId];\r\n            if (elId) {\r\n                delete _delements[elId][elementId];\r\n                delete _draggablesForElements[elementId];\r\n            }\r\n        };\r\n\r\n        this.reset = function () {\r\n            _draggables = {};\r\n            _dlist = [];\r\n            _delements = {};\r\n            _elementsWithEndpoints = {};\r\n        };\r\n\r\n        //\r\n        // notification drag ended. We check automatically if need to update some\r\n        // ancestor's offsets.\r\n        //\r\n        this.dragEnded = function (el) {\r\n            if (el.offsetParent != null) {\r\n                var id = _currentInstance.getId(el),\r\n                    ancestor = _draggablesForElements[id];\r\n\r\n                if (ancestor) {\r\n                    this.updateOffsets(ancestor);\r\n                }\r\n            }\r\n        };\r\n\r\n        this.setParent = function (el, elId, p, pId, currentChildLocation) {\r\n            var current = _draggablesForElements[elId];\r\n            if (!_delements[pId]) {\r\n                _delements[pId] = {};\r\n            }\r\n            var pLoc = _currentInstance.getOffset(p),\r\n                cLoc = currentChildLocation || _currentInstance.getOffset(el);\r\n\r\n            if (current && _delements[current]) {\r\n                delete _delements[current][elId];\r\n            }\r\n\r\n            _delements[pId][elId] = {\r\n                id:elId,\r\n                offset : {\r\n                    left: cLoc.left - pLoc.left,\r\n                    top: cLoc.top - pLoc.top\r\n                }\r\n            };\r\n            _draggablesForElements[elId] = pId;\r\n        };\r\n\r\n        this.clearParent = function(el, elId) {\r\n            var current = _draggablesForElements[elId];\r\n            if (current) {\r\n                delete _delements[current][elId];\r\n                delete _draggablesForElements[elId];\r\n            }\r\n        };\r\n\r\n        this.revalidateParent = function(el, elId, childOffset) {\r\n            var current = _draggablesForElements[elId];\r\n            if (current) {\r\n                var co = {};\r\n                co[elId] = childOffset;\r\n                this.updateOffsets(current, co);\r\n                _currentInstance.revalidate(current);\r\n            }\r\n        };\r\n\r\n        this.getDragAncestor = function (el) {\r\n            var de = jsPlumb.getElement(el),\r\n                id = _currentInstance.getId(de),\r\n                aid = _draggablesForElements[id];\r\n\r\n            if (aid) {\r\n                return jsPlumb.getElement(aid);\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        };\r\n\r\n    };\r\n\r\n    var _setClassName = function (el, cn, classList) {\r\n            cn = _ju.fastTrim(cn);\r\n            if (typeof el.className.baseVal !== \"undefined\") {\r\n                el.className.baseVal = cn;\r\n            }\r\n            else {\r\n                el.className = cn;\r\n            }\r\n\r\n            // recent (i currently have  61.0.3163.100) version of chrome do not update classList when you set the base val\r\n            // of an svg element's className. in the long run we'd like to move to just using classList anyway\r\n            try {\r\n                var cl = el.classList;\r\n                if (cl != null) {\r\n                    while (cl.length > 0) {\r\n                        cl.remove(cl.item(0));\r\n                    }\r\n                    for (var i = 0; i < classList.length; i++) {\r\n                        if (classList[i]) {\r\n                            cl.add(classList[i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            catch(e) {\r\n                // not fatal\r\n                _ju.log(\"JSPLUMB: cannot set class list\", e);\r\n            }\r\n        },\r\n        _getClassName = function (el) {\r\n            return (typeof el.className.baseVal === \"undefined\") ? el.className : el.className.baseVal;\r\n        },\r\n        _classManip = function (el, classesToAdd, classesToRemove) {\r\n            classesToAdd = classesToAdd == null ? [] : _ju.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\r\n            classesToRemove = classesToRemove == null ? [] : _ju.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\r\n\r\n            var className = _getClassName(el),\r\n                curClasses = className.split(/\\s+/);\r\n\r\n            var _oneSet = function (add, classes) {\r\n                for (var i = 0; i < classes.length; i++) {\r\n                    if (add) {\r\n                        if (curClasses.indexOf(classes[i]) === -1) {\r\n                            curClasses.push(classes[i]);\r\n                        }\r\n                    }\r\n                    else {\r\n                        var idx = curClasses.indexOf(classes[i]);\r\n                        if (idx !== -1) {\r\n                            curClasses.splice(idx, 1);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            _oneSet(true, classesToAdd);\r\n            _oneSet(false, classesToRemove);\r\n\r\n            _setClassName(el, curClasses.join(\" \"), curClasses);\r\n        };\r\n\r\n    root.jsPlumb.extend(root.jsPlumbInstance.prototype, {\r\n\r\n        headless: false,\r\n\r\n        pageLocation: _pageLocation,\r\n        screenLocation: _screenLocation,\r\n        clientLocation: _clientLocation,\r\n\r\n        getDragManager:function() {\r\n            if (this.dragManager == null) {\r\n                this.dragManager = new DragManager(this);\r\n            }\r\n\r\n            return this.dragManager;\r\n        },\r\n\r\n        recalculateOffsets:function(elId) {\r\n            this.getDragManager().updateOffsets(elId);\r\n        },\r\n\r\n        createElement:function(tag, style, clazz, atts) {\r\n            return this.createElementNS(null, tag, style, clazz, atts);\r\n        },\r\n\r\n        createElementNS:function(ns, tag, style, clazz, atts) {\r\n            var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\r\n            var i;\r\n            style = style || {};\r\n            for (i in style) {\r\n                e.style[i] = style[i];\r\n            }\r\n\r\n            if (clazz) {\r\n                e.className = clazz;\r\n            }\r\n\r\n            atts = atts || {};\r\n            for (i in atts) {\r\n                e.setAttribute(i, \"\" + atts[i]);\r\n            }\r\n\r\n            return e;\r\n        },\r\n\r\n        getAttribute: function (el, attName) {\r\n            return el.getAttribute != null ? el.getAttribute(attName) : null;\r\n        },\r\n\r\n        setAttribute: function (el, a, v) {\r\n            if (el.setAttribute != null) {\r\n                el.setAttribute(a, v);\r\n            }\r\n        },\r\n\r\n        setAttributes: function (el, atts) {\r\n            for (var i in atts) {\r\n                if (atts.hasOwnProperty(i)) {\r\n                    el.setAttribute(i, atts[i]);\r\n                }\r\n            }\r\n        },\r\n        appendToRoot: function (node) {\r\n            document.body.appendChild(node);\r\n        },\r\n        getRenderModes: function () {\r\n            return [ \"svg\"  ];\r\n        },\r\n        getClass:_getClassName,\r\n        addClass: function (el, clazz) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, clazz);\r\n            });\r\n        },\r\n        hasClass: function (el, clazz) {\r\n            el = jsPlumb.getElement(el);\r\n            if (el.classList) {\r\n                return el.classList.contains(clazz);\r\n            }\r\n            else {\r\n                return _getClassName(el).indexOf(clazz) !== -1;\r\n            }\r\n        },\r\n        removeClass: function (el, clazz) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, null, clazz);\r\n            });\r\n        },\r\n        toggleClass:function(el, clazz) {\r\n            if (jsPlumb.hasClass(el, clazz)) {\r\n                jsPlumb.removeClass(el, clazz);\r\n            } else {\r\n                jsPlumb.addClass(el, clazz);\r\n            }\r\n        },\r\n        updateClasses: function (el, toAdd, toRemove) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, toAdd, toRemove);\r\n            });\r\n        },\r\n        setClass: function (el, clazz) {\r\n            if (clazz != null) {\r\n                jsPlumb.each(el, function (e) {\r\n                    _setClassName(e, clazz, clazz.split(/\\s+/));\r\n                });\r\n            }\r\n        },\r\n        setPosition: function (el, p) {\r\n            el.style.left = p.left + \"px\";\r\n            el.style.top = p.top + \"px\";\r\n        },\r\n        getPosition: function (el) {\r\n            var _one = function (prop) {\r\n                var v = el.style[prop];\r\n                return v ? v.substring(0, v.length - 2) : 0;\r\n            };\r\n            return {\r\n                left: _one(\"left\"),\r\n                top: _one(\"top\")\r\n            };\r\n        },\r\n        getStyle:function(el, prop) {\r\n            if (typeof window.getComputedStyle !== 'undefined') {\r\n                return getComputedStyle(el, null).getPropertyValue(prop);\r\n            } else {\r\n                return el.currentStyle[prop];\r\n            }\r\n        },\r\n        getSelector: function (ctx, spec) {\r\n            var sel = null;\r\n            if (arguments.length === 1) {\r\n                sel = ctx.nodeType != null ? ctx : document.querySelectorAll(ctx);\r\n            }\r\n            else {\r\n                sel = ctx.querySelectorAll(spec);\r\n            }\r\n\r\n            return sel;\r\n        },\r\n        getOffset:function(el, relativeToRoot, container) {\r\n            el = jsPlumb.getElement(el);\r\n            container = container || this.getContainer();\r\n            var out = {\r\n                    left: el.offsetLeft,\r\n                    top: el.offsetTop\r\n                },\r\n                op = (relativeToRoot  || (container != null && (el !== container && el.offsetParent !== container))) ?  el.offsetParent : null,\r\n                _maybeAdjustScroll = function(offsetParent) {\r\n                    if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\r\n                        out.left -= offsetParent.scrollLeft;\r\n                        out.top -= offsetParent.scrollTop;\r\n                    }\r\n                }.bind(this);\r\n\r\n            while (op != null) {\r\n                out.left += op.offsetLeft;\r\n                out.top += op.offsetTop;\r\n                _maybeAdjustScroll(op);\r\n                op = relativeToRoot ? op.offsetParent :\r\n                    op.offsetParent === container ? null : op.offsetParent;\r\n            }\r\n\r\n            // if container is scrolled and the element (or its offset parent) is not absolute or fixed, adjust accordingly.\r\n            if (container != null && !relativeToRoot && (container.scrollTop > 0 || container.scrollLeft > 0)) {\r\n                var pp = el.offsetParent != null ? this.getStyle(el.offsetParent, \"position\") : \"static\",\r\n                    p = this.getStyle(el, \"position\");\r\n                if (p !== \"absolute\" && p !== \"fixed\" && pp !== \"absolute\" && pp !== \"fixed\") {\r\n                    out.left -= container.scrollLeft;\r\n                    out.top -= container.scrollTop;\r\n                }\r\n            }\r\n            return out;\r\n        },\r\n        //\r\n        // return x+y proportion of the given element's size corresponding to the location of the given event.\r\n        //\r\n        getPositionOnElement: function (evt, el, zoom) {\r\n            var box = typeof el.getBoundingClientRect !== \"undefined\" ? el.getBoundingClientRect() : { left: 0, top: 0, width: 0, height: 0 },\r\n                body = document.body,\r\n                docElem = document.documentElement,\r\n                scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\r\n                scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\r\n                clientTop = docElem.clientTop || body.clientTop || 0,\r\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\r\n                pst = 0,\r\n                psl = 0,\r\n                top = box.top + scrollTop - clientTop + (pst * zoom),\r\n                left = box.left + scrollLeft - clientLeft + (psl * zoom),\r\n                cl = jsPlumb.pageLocation(evt),\r\n                w = box.width || (el.offsetWidth * zoom),\r\n                h = box.height || (el.offsetHeight * zoom),\r\n                x = (cl[0] - left) / w,\r\n                y = (cl[1] - top) / h;\r\n\r\n            return [ x, y ];\r\n        },\r\n\r\n        /**\r\n         * Gets the absolute position of some element as read from the left/top properties in its style.\r\n         * @method getAbsolutePosition\r\n         * @param {Element} el The element to retrieve the absolute coordinates from. **Note** this is a DOM element, not a selector from the underlying library.\r\n         * @return {Number[]} [left, top] pixel values.\r\n         */\r\n        getAbsolutePosition: function (el) {\r\n            var _one = function (s) {\r\n                var ss = el.style[s];\r\n                if (ss) {\r\n                    return parseFloat(ss.substring(0, ss.length - 2));\r\n                }\r\n            };\r\n            return [ _one(\"left\"), _one(\"top\") ];\r\n        },\r\n\r\n        /**\r\n         * Sets the absolute position of some element by setting the left/top properties in its style.\r\n         * @method setAbsolutePosition\r\n         * @param {Element} el The element to set the absolute coordinates on. **Note** this is a DOM element, not a selector from the underlying library.\r\n         * @param {Number[]} xy x and y coordinates\r\n         * @param {Number[]} [animateFrom] Optional previous xy to animate from.\r\n         * @param {Object} [animateOptions] Options for the animation.\r\n         */\r\n        setAbsolutePosition: function (el, xy, animateFrom, animateOptions) {\r\n            if (animateFrom) {\r\n                this.animate(el, {\r\n                    left: \"+=\" + (xy[0] - animateFrom[0]),\r\n                    top: \"+=\" + (xy[1] - animateFrom[1])\r\n                }, animateOptions);\r\n            }\r\n            else {\r\n                el.style.left = xy[0] + \"px\";\r\n                el.style.top = xy[1] + \"px\";\r\n            }\r\n        },\r\n        /**\r\n         * gets the size for the element, in an array : [ width, height ].\r\n         */\r\n        getSize: function (el) {\r\n            return [ el.offsetWidth, el.offsetHeight ];\r\n        },\r\n        getWidth: function (el) {\r\n            return el.offsetWidth;\r\n        },\r\n        getHeight: function (el) {\r\n            return el.offsetHeight;\r\n        },\r\n        getRenderMode : function() { return \"svg\"; },\r\n        draggable : function (el, options) {\r\n            var info;\r\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\r\n            Array.prototype.slice.call(el).forEach(function(_el) {\r\n                info = this.info(_el);\r\n                if (info.el) {\r\n                    this._initDraggableIfNecessary(info.el, true, options, info.id, true);\r\n                }\r\n            }.bind(this));\r\n            return this;\r\n        },\r\n        snapToGrid : function(el, x, y) {\r\n            var out = [];\r\n            var _oneEl = function(_el) {\r\n                var info = this.info(_el);\r\n                if (info.el != null && info.el._katavorioDrag) {\r\n                    var snapped = info.el._katavorioDrag.snap(x, y);\r\n                    this.revalidate(info.el);\r\n                    out.push([info.el, snapped]);\r\n                }\r\n            }.bind(this);\r\n\r\n            // if you call this method with 0 arguments or 2 arguments it is assumed you want to snap all managed elements to\r\n            // a grid. if you supply one argument or 3, then you are assumed to be specifying one element.\r\n            if(arguments.length === 1 || arguments.length === 3) {\r\n                _oneEl(el, x, y);\r\n            } else {\r\n                var _me = this.getManagedElements();\r\n                for (var mel in _me) {\r\n                    _oneEl(mel, arguments[0], arguments[1]);\r\n                }\r\n            }\r\n\r\n            return out;\r\n        },\r\n        initDraggable: function (el, options, category) {\r\n            _getDragManager(this, category).draggable(el, options);\r\n            el._jsPlumbDragOptions = options;\r\n        },\r\n        destroyDraggable: function (el, category) {\r\n            _getDragManager(this, category).destroyDraggable(el);\r\n            delete el._jsPlumbDragOptions;\r\n        },\r\n        unbindDraggable: function (el, evt, fn, category) {\r\n            _getDragManager(this, category).destroyDraggable(el, evt, fn);\r\n        },\r\n        setDraggable : function (element, draggable) {\r\n            return jsPlumb.each(element, function (el) {\r\n                if (this.isDragSupported(el)) {\r\n                    this._draggableStates[this.getAttribute(el, \"id\")] = draggable;\r\n                    this.setElementDraggable(el, draggable);\r\n                }\r\n            }.bind(this));\r\n        },\r\n        _draggableStates : {},\r\n        /*\r\n         * toggles the draggable state of the given element(s).\r\n         * el is either an id, or an element object, or a list of ids/element objects.\r\n         */\r\n        toggleDraggable : function (el) {\r\n            var state;\r\n            jsPlumb.each(el, function (el) {\r\n                var elId = this.getAttribute(el, \"id\");\r\n                state = this._draggableStates[elId] == null ? false : this._draggableStates[elId];\r\n                state = !state;\r\n                this._draggableStates[elId] = state;\r\n                this.setDraggable(el, state);\r\n                return state;\r\n            }.bind(this));\r\n            return state;\r\n        },\r\n        _initDraggableIfNecessary : function (element, isDraggable, dragOptions, id, fireEvent) {\r\n            // TODO FIRST: move to DragManager. including as much of the decision to init dragging as possible.\r\n            if (!jsPlumb.headless) {\r\n                var _draggable = isDraggable == null ? false : isDraggable;\r\n                if (_draggable) {\r\n                    if (jsPlumb.isDragSupported(element, this)) {\r\n                        var options = dragOptions || this.Defaults.DragOptions;\r\n                        options = jsPlumb.extend({}, options); // make a copy.\r\n                        if (!jsPlumb.isAlreadyDraggable(element, this)) {\r\n                            var dragEvent = jsPlumb.dragEvents.drag,\r\n                                stopEvent = jsPlumb.dragEvents.stop,\r\n                                startEvent = jsPlumb.dragEvents.start;\r\n\r\n                            this.manage(id, element);\r\n\r\n                            options[startEvent] = _ju.wrap(options[startEvent], _dragStart.bind(this));\r\n\r\n                            options[dragEvent] = _ju.wrap(options[dragEvent], _dragMove.bind(this));\r\n\r\n                            options[stopEvent] = _ju.wrap(options[stopEvent], _dragStop.bind(this));\r\n\r\n                            var elId = this.getId(element); // need ID\r\n\r\n                            this._draggableStates[elId] = true;\r\n                            var draggable = this._draggableStates[elId];\r\n\r\n                            options.disabled = draggable == null ? false : !draggable;\r\n                            this.initDraggable(element, options);\r\n                            this.getDragManager().register(element);\r\n                            if (fireEvent) {\r\n                                this.fire(\"elementDraggable\", {el:element, options:options});\r\n                            }\r\n                        }\r\n                        else {\r\n                            // already draggable. attach any start, drag or stop listeners to the current Drag.\r\n                            if (dragOptions.force) {\r\n                                this.initDraggable(element, options);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        animationSupported:true,\r\n        getElement: function (el) {\r\n            if (el == null) {\r\n                return null;\r\n            }\r\n            // here we pluck the first entry if el was a list of entries.\r\n            // this is not my favourite thing to do, but previous versions of\r\n            // jsplumb supported jquery selectors, and it is possible a selector\r\n            // will be passed in here.\r\n            el = typeof el === \"string\" ? el : el.length != null && el.enctype == null ? el[0] : el;\r\n            return typeof el === \"string\" ? document.getElementById(el) : el;\r\n        },\r\n        removeElement: function (element) {\r\n            _getDragManager(this).elementRemoved(element);\r\n            this.getEventManager().remove(element);\r\n        },\r\n        //\r\n        // this adapter supports a rudimentary animation function. no easing is supported.  only\r\n        // left/top properties are supported. property delta args are expected to be in the form\r\n        //\r\n        // +=x.xxxx\r\n        //\r\n        // or\r\n        //\r\n        // -=x.xxxx\r\n        //\r\n        doAnimate: function (el, properties, options) {\r\n            options = options || {};\r\n            var o = this.getOffset(el),\r\n                ap = _animProps(o, properties),\r\n                ldist = ap[0] - o.left,\r\n                tdist = ap[1] - o.top,\r\n                d = options.duration || 250,\r\n                step = 15, steps = d / step,\r\n                linc = (step / d) * ldist,\r\n                tinc = (step / d) * tdist,\r\n                idx = 0,\r\n                _int = setInterval(function () {\r\n                    _jp.setPosition(el, {\r\n                        left: o.left + (linc * (idx + 1)),\r\n                        top: o.top + (tinc * (idx + 1))\r\n                    });\r\n                    if (options.step != null) {\r\n                        options.step(idx, Math.ceil(steps));\r\n                    }\r\n                    idx++;\r\n                    if (idx >= steps) {\r\n                        window.clearInterval(_int);\r\n                        if (options.complete != null) {\r\n                            options.complete();\r\n                        }\r\n                    }\r\n                }, step);\r\n        },\r\n        // DRAG/DROP\r\n\r\n\r\n        destroyDroppable: function (el, category) {\r\n            _getDragManager(this, category).destroyDroppable(el);\r\n        },\r\n        unbindDroppable: function (el, evt, fn, category) {\r\n            _getDragManager(this, category).destroyDroppable(el, evt, fn);\r\n        },\r\n\r\n        droppable :function(el, options) {\r\n            el = _ju.isArray(el) || (el.length != null && !_ju.isString(el)) ? el: [ el ];\r\n            var info;\r\n            options = options || {};\r\n            options.allowLoopback = false;\r\n            Array.prototype.slice.call(el).forEach(function(_el) {\r\n                info = this.info(_el);\r\n                if (info.el) {\r\n                    this.initDroppable(info.el, options);\r\n                }\r\n            }.bind(this));\r\n            return this;\r\n        },\r\n\r\n        initDroppable: function (el, options, category) {\r\n            _getDragManager(this, category).droppable(el, options);\r\n        },\r\n        isAlreadyDraggable: function (el) {\r\n            return el._katavorioDrag != null;\r\n        },\r\n        isDragSupported: function (el, options) {\r\n            return true;\r\n        },\r\n        isDropSupported: function (el, options) {\r\n            return true;\r\n        },\r\n        isElementDraggable: function (el) {\r\n            el = _jp.getElement(el);\r\n            return el._katavorioDrag && el._katavorioDrag.isEnabled();\r\n        },\r\n        getDragObject: function (eventArgs) {\r\n            return eventArgs[0].drag.getDragElement();\r\n        },\r\n        getDragScope: function (el) {\r\n            return el._katavorioDrag && el._katavorioDrag.scopes.join(\" \") || \"\";\r\n        },\r\n        getDropEvent: function (args) {\r\n            return args[0].e;\r\n        },\r\n        getUIPosition: function (eventArgs, zoom) {\r\n            // here the position reported to us by Katavorio is relative to the element's offsetParent. For top\r\n            // level nodes that is fine, but if we have a nested draggable then its offsetParent is actually\r\n            // not going to be the jsplumb container; it's going to be some child of that element. In that case\r\n            // we want to adjust the UI position to account for the offsetParent's position relative to the Container\r\n            // origin.\r\n            var el = eventArgs[0].el;\r\n            if (el.offsetParent == null) {\r\n                return null;\r\n            }\r\n            var finalPos = eventArgs[0].finalPos || eventArgs[0].pos;\r\n            var p = { left:finalPos[0], top:finalPos[1] };\r\n            if (el._katavorioDrag && el.offsetParent !== this.getContainer()) {\r\n                var oc = this.getOffset(el.offsetParent);\r\n                p.left += oc.left;\r\n                p.top += oc.top;\r\n            }\r\n            return p;\r\n        },\r\n        setDragFilter: function (el, filter, _exclude) {\r\n            if (el._katavorioDrag) {\r\n                el._katavorioDrag.setFilter(filter, _exclude);\r\n            }\r\n        },\r\n        setElementDraggable: function (el, draggable) {\r\n            el = _jp.getElement(el);\r\n            if (el._katavorioDrag) {\r\n                el._katavorioDrag.setEnabled(draggable);\r\n            }\r\n        },\r\n        setDragScope: function (el, scope) {\r\n            if (el._katavorioDrag) {\r\n                el._katavorioDrag.k.setDragScope(el, scope);\r\n            }\r\n        },\r\n        setDropScope:function(el, scope) {\r\n            if (el._katavorioDrop && el._katavorioDrop.length > 0) {\r\n                el._katavorioDrop[0].k.setDropScope(el, scope);\r\n            }\r\n        },\r\n        addToPosse:function(el, spec) {\r\n            var specs = Array.prototype.slice.call(arguments, 1);\r\n            var dm = _getDragManager(this);\r\n            _jp.each(el, function(_el) {\r\n                _el = [ _jp.getElement(_el) ];\r\n                _el.push.apply(_el, specs );\r\n                dm.addToPosse.apply(dm, _el);\r\n            });\r\n        },\r\n        setPosse:function(el, spec) {\r\n            var specs = Array.prototype.slice.call(arguments, 1);\r\n            var dm = _getDragManager(this);\r\n            _jp.each(el, function(_el) {\r\n                _el = [ _jp.getElement(_el) ];\r\n                _el.push.apply(_el, specs );\r\n                dm.setPosse.apply(dm, _el);\r\n            });\r\n        },\r\n        removeFromPosse:function(el, posseId) {\r\n            var specs = Array.prototype.slice.call(arguments, 1);\r\n            var dm = _getDragManager(this);\r\n            _jp.each(el, function(_el) {\r\n                _el = [ _jp.getElement(_el) ];\r\n                _el.push.apply(_el, specs );\r\n                dm.removeFromPosse.apply(dm, _el);\r\n            });\r\n        },\r\n        removeFromAllPosses:function(el) {\r\n            var dm = _getDragManager(this);\r\n            _jp.each(el, function(_el) { dm.removeFromAllPosses(_jp.getElement(_el)); });\r\n        },\r\n        setPosseState:function(el, posseId, state) {\r\n            var dm = _getDragManager(this);\r\n            _jp.each(el, function(_el) { dm.setPosseState(_jp.getElement(_el), posseId, state); });\r\n        },\r\n        dragEvents: {\r\n            'start': 'start', 'stop': 'stop', 'drag': 'drag', 'step': 'step',\r\n            'over': 'over', 'out': 'out', 'drop': 'drop', 'complete': 'complete',\r\n            'beforeStart':'beforeStart'\r\n        },\r\n        animEvents: {\r\n            'step': \"step\", 'complete': 'complete'\r\n        },\r\n        stopDrag: function (el) {\r\n            if (el._katavorioDrag) {\r\n                el._katavorioDrag.abort();\r\n            }\r\n        },\r\n        addToDragSelection: function (spec) {\r\n            _getDragManager(this).select(spec);\r\n        },\r\n        removeFromDragSelection: function (spec) {\r\n            _getDragManager(this).deselect(spec);\r\n        },\r\n        clearDragSelection: function () {\r\n            _getDragManager(this).deselectAll();\r\n        },\r\n        trigger: function (el, event, originalEvent, payload) {\r\n            this.getEventManager().trigger(el, event, originalEvent, payload);\r\n        },\r\n        doReset:function() {\r\n            // look for katavorio instances and reset each one if found.\r\n            for (var key in this) {\r\n                if (key.indexOf(\"_katavorio_\") === 0) {\r\n                    this[key].reset();\r\n                }\r\n            }\r\n        },\r\n        getEventManager:function() {\r\n            return _getEventManager(this);\r\n        },\r\n        on : function(el, event, callback) {\r\n            // TODO: here we would like to map the tap event if we know its\r\n            // an internal bind to a click. we have to know its internal because only\r\n            // then can we be sure that the UP event wont be consumed (tap is a synthesized\r\n            // event from a mousedown followed by a mouseup).\r\n            //event = { \"click\":\"tap\", \"dblclick\":\"dbltap\"}[event] || event;\r\n            this.getEventManager().on.apply(this, arguments);\r\n            return this;\r\n        },\r\n        off : function(el, event, callback) {\r\n            this.getEventManager().off.apply(this, arguments);\r\n            return this;\r\n        }\r\n\r\n    });\r\n\r\n    var ready = function (f) {\r\n        var _do = function () {\r\n            if (/complete|loaded|interactive/.test(document.readyState) && typeof(document.body) !== \"undefined\" && document.body != null) {\r\n                f();\r\n            }\r\n            else {\r\n                setTimeout(_do, 9);\r\n            }\r\n        };\r\n\r\n        _do();\r\n    };\r\n    ready(_jp.init);\r\n\r\n}).call(typeof window !== 'undefined' ? window : this);\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"app\"}},[_c('flow-panel')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.easyFlowVisible)?_c('div',{staticStyle:{\"height\":\"calc(100vh)\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"ef-tooltar\"},[(_vm.editing)?_c('el-input',{attrs:{\"type\":\"primary\"},on:{\"blur\":_vm.saveText},model:{value:(_vm.data.name),callback:function ($$v) {_vm.$set(_vm.data, \"name\", $$v)},expression:\"data.name\"}}):_c('el-link',{attrs:{\"type\":\"primary\",\"underline\":false},on:{\"click\":_vm.startEditing}},[_vm._v(_vm._s(_vm.data.name))]),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-button',{attrs:{\"type\":\"text\",\"icon\":\"el-icon-delete\",\"size\":\"large\",\"disabled\":!this.activeElement.type},on:{\"click\":_vm.deleteElement}}),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-button',{attrs:{\"type\":\"text\",\"icon\":\"el-icon-download\",\"size\":\"large\"},on:{\"click\":_vm.downloadData}}),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-button',{attrs:{\"type\":\"text\",\"icon\":\"el-icon-plus\",\"size\":\"large\"},on:{\"click\":_vm.zoomAdd}}),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-button',{attrs:{\"type\":\"text\",\"icon\":\"el-icon-minus\",\"size\":\"large\"},on:{\"click\":_vm.zoomSub}}),_c('div',{staticStyle:{\"float\":\"right\",\"margin-right\":\"5px\"}},[_c('el-button',{attrs:{\"plain\":\"\",\"round\":\"\",\"loading\":_vm.exeState,\"icon\":\"el-icon-thumb\",\"size\":\"mini\"},on:{\"click\":_vm.exeTaskFlow}},[_vm._v(\"\")]),_c('el-button',{staticClass:\"pub-btn\",attrs:{\"plain\":\"\",\"round\":\"\",\"icon\":\"el-icon-s-promotion\",\"type\":\"success\",\"size\":\"mini\"},on:{\"click\":_vm.pubbTaskFlow}},[_vm._v(\"\")]),_c('el-button',{attrs:{\"type\":\"info\",\"plain\":\"\",\"round\":\"\",\"icon\":\"el-icon-document\",\"size\":\"mini\"},on:{\"click\":_vm.dataInfo}},[_vm._v(\"\")]),_c('el-button',{attrs:{\"type\":\"info\",\"plain\":\"\",\"round\":\"\",\"icon\":\"el-icon-document\",\"size\":\"mini\"},on:{\"click\":_vm.openHelp}},[_vm._v(\"\")])],1)],1)])],1),_c('div',{staticStyle:{\"display\":\"flex\",\"height\":\"calc(100% - 47px)\"}},[_c('div',{staticStyle:{\"width\":\"230px\",\"border-right\":\"1px solid #dce3e8\"}},[_c('node-menu',{ref:\"nodeMenu\",on:{\"addNode\":_vm.addNode}})],1),_c('div',{attrs:{\"id\":\"panzoom\"}}),_c('div',{directives:[{name:\"flowDrag\",rawName:\"v-flowDrag\"}],ref:\"efContainer\",staticClass:\"container\",attrs:{\"id\":\"efContainer\"}},[_vm._l((_vm.data.nodeList),function(node){return [_c('flow-node',{key:node.code,attrs:{\"id\":node.code,\"node\":node,\"activeElement\":_vm.activeElement},on:{\"changeNodeSite\":_vm.changeNodeSite,\"nodeRightMenu\":_vm.nodeRightMenu,\"clickNode\":_vm.clickNode}})]}),_c('div',{staticStyle:{\"position\":\"absolute\",\"top\":\"2000px\",\"left\":\"2000px\"}},[_vm._v(\"\")])],2),_c('div',{staticStyle:{\"width\":\"auto\",\"border-left\":\"1px solid #dce3e8\",\"background-color\":\"#FBFBFB\"}},[_c('flow-node-form',{ref:\"nodeForm\",on:{\"setLineLabel\":_vm.setLineLabel,\"repaintEverything\":_vm.repaintEverything}})],1)]),(_vm.flowInfoVisible)?_c('flow-info',{ref:\"flowInfo\",attrs:{\"data\":_vm.data}}):_vm._e(),(_vm.flowHelpVisible)?_c('flow-help',{ref:\"flowHelp\"}):_vm._e(),_c('input',{staticStyle:{\"display\":\"none\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"delete\",[8,46],$event.key,[\"Backspace\",\"Delete\",\"Del\"]))return null;return _vm.delFun.apply(null, arguments)}}})],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const easyFlowMixin = {\r\n    data() {\r\n        return {\r\n            jsplumbSetting: {\r\n                // \r\n                Anchors: ['Top', 'TopCenter', 'TopRight', 'TopLeft', 'Right', 'RightMiddle', 'Bottom', 'BottomCenter', 'BottomRight', 'BottomLeft', 'Left', 'LeftMiddle'],\r\n                // ID\r\n                Container: 'efContainer',\r\n                // :  StateMachineFlowchartBezierStraight\r\n                Connector: ['Bezier', {curviness: 100}],\r\n                // Connector: ['Straight', {stub: 20, gap: 1}],\r\n                // Connector: ['Flowchart', {stub: 30, gap: 1, alwaysRespectStubs: false, midpoint: 0.5, cornerRadius: 10}],\r\n                // Connector: ['StateMachine', {margin: 5, curviness: 10, proximityLimit: 80}],\r\n                // \r\n                ConnectionsDetachable: false,\r\n                // \r\n                DeleteEndpointsOnDetach: false,\r\n                /**\r\n                 * \r\n                 * radius: \r\n                 */\r\n                // Endpoint: ['Dot', {radius: 5, cssClass: 'ef-dot', hoverClass: 'ef-dot-hover'}],\r\n                /**\r\n                 * \r\n                 * height: \r\n                 * width: \r\n                 */\r\n                // Endpoint: ['Rectangle', {height: 20, width: 20, cssClass: 'ef-rectangle', hoverClass: 'ef-rectangle-hover'}],\r\n                /**\r\n                 * \r\n                 */\r\n                // Endpoint: ['Image', {src: 'https://www.easyicon.net/api/resizeApi.php?id=1181776&size=32', cssClass: 'ef-img', hoverClass: 'ef-img-hover'}],\r\n                /**\r\n                 * \r\n                 */\r\n                Endpoint: ['Blank', {Overlays: ''}],\r\n                // Endpoints: [['Dot', {radius: 5, cssClass: 'ef-dot', hoverClass: 'ef-dot-hover'}], ['Rectangle', {height: 20, width: 20, cssClass: 'ef-rectangle', hoverClass: 'ef-rectangle-hover'}]],\r\n                /**\r\n                 * \r\n                 * fill: #12aabb\r\n                 * outlineWidth: \r\n                 */\r\n                EndpointStyle: {fill: '#1879ffa1', outlineWidth: 1},\r\n                // jsPlumb\r\n                LogEnabled: true,\r\n                /**\r\n                 * \r\n                 */\r\n                PaintStyle: {\r\n                    // \r\n                    stroke: '#E0E3E7',\r\n                    // \r\n                    strokeWidth: 1,\r\n                    //  https://blog.csdn.net/roymno2/article/details/72717101\r\n                    outlineStroke: 'transparent',\r\n                    // \r\n                    outlineWidth: 10\r\n                },\r\n                DragOptions: {cursor: 'pointer', zIndex: 2000},\r\n                /**\r\n                 *    https://www.jianshu.com/p/d9e9918fd928\r\n                 */\r\n                Overlays: [\r\n                    // \r\n                    ['Arrow', {\r\n                        width: 10, // \r\n                        length: 8, // \r\n                        location: 1, // 01\r\n                        direction: 1, // 1-1\r\n                        foldback: 0.623 // 0.6231\r\n                    }],\r\n                    // ['Diamond', {\r\n                    //     events: {\r\n                    //         dblclick: function (diamondOverlay, originalEvent) {\r\n                    //             console.log('double click on diamond overlay for : ' + diamondOverlay.component)\r\n                    //         }\r\n                    //     }\r\n                    // }],\r\n                    ['Label', {\r\n                        label: '',\r\n                        location: 0.1,\r\n                        cssClass: 'aLabel'\r\n                    }]\r\n                ],\r\n                //  svgcanvas\r\n                RenderMode: 'svg',\r\n                // \r\n                HoverPaintStyle: {stroke: '#b0b2b5', strokeWidth: 1},\r\n                // \r\n                // EndpointHoverStyle: {fill: 'red'}\r\n                Scope: 'jsPlumb_DefaultScope' // scope\r\n            },\r\n            /**\r\n             * \r\n             */\r\n            jsplumbConnectOptions: {\r\n                isSource: true,\r\n                isTarget: true,\r\n                // 4 ContinuousAutoDefault\r\n                anchor: 'Continuous',\r\n                // label\r\n                labelStyle: {\r\n                    cssClass: 'flowLabel'\r\n                },\r\n                // jsplumb label style\r\n                emptyLabelStyle: {\r\n                    cssClass: 'emptyFlowLabel'\r\n                }\r\n            },\r\n            /**\r\n             * \r\n             */\r\n            jsplumbSourceOptions: {\r\n                // DOM\r\n                filter: '.flow-node-drag',\r\n                filterExclude: false,\r\n                anchor: 'Continuous',\r\n                // \r\n                allowLoopback: true,\r\n                maxConnections: -1,\r\n                onMaxConnections: function (info, e) {\r\n                    console.log(`: ${info.maxConnections}`)\r\n                }\r\n            },\r\n            //  https://www.cnblogs.com/mq0036/p/7942139.html\r\n            jsplumbSourceOptions2: {\r\n                // DOM\r\n                filter: '.flow-node-drag',\r\n                filterExclude: false,\r\n                // anchor: 'Continuous',\r\n                // \r\n                allowLoopback: true,\r\n                connector: ['Flowchart', {curviness: 50}],\r\n                connectorStyle: {\r\n                    // \r\n                    stroke: 'red',\r\n                    // \r\n                    strokeWidth: 1,\r\n                    //  https://blog.csdn.net/roymno2/article/details/72717101\r\n                    outlineStroke: 'transparent',\r\n                    // \r\n                    outlineWidth: 10\r\n                },\r\n                connectorHoverStyle: {stroke: 'red', strokeWidth: 2}\r\n            },\r\n            jsplumbTargetOptions: {\r\n                // DOM\r\n                filter: '.flow-node-drag',\r\n                filterExclude: false,\r\n                // \r\n                anchor: 'Continuous',\r\n                allowLoopback: true,\r\n                dropOptions: {hoverClass: 'ef-drop-hover'}\r\n            }\r\n        }\r\n    }\r\n}\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"node\",class:_vm.nodeContainerClass,style:(_vm.nodeContainerStyle),on:{\"click\":_vm.clickNode,\"mouseup\":_vm.changeNodeSite}},[(_vm.color == 0)?_c('div',{staticClass:\"ef-node-left\"}):_vm._e(),(_vm.color == 1)?_c('div',{staticClass:\"ef-node-left-1\"}):_vm._e(),(_vm.color == 2)?_c('div',{staticClass:\"ef-node-left-2\"}):_vm._e(),(_vm.color == 3)?_c('div',{staticClass:\"ef-node-left-3\"}):_vm._e(),(_vm.color == 4)?_c('div',{staticClass:\"ef-node-left-4\"}):_vm._e(),(_vm.color == 5)?_c('div',{staticClass:\"ef-node-left-5\"}):_vm._e(),(_vm.color == 6)?_c('div',{staticClass:\"ef-node-left-6\"}):_vm._e(),_c('div',{staticClass:\"ef-node-left-ico flow-node-drag\"},[_c('i',{class:_vm.nodeIcoClass})]),_c('div',{staticClass:\"ef-node-text\",attrs:{\"show-overflow-tooltip\":true}},[_vm._v(\" \"+_vm._s(_vm.node.name)+\" \")]),_c('div',{staticClass:\"ef-node-right-ico\"},[_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.node.state === 'success'),expression:\"node.state === 'success'\"}],staticClass:\"el-icon-circle-check el-node-state-success\"}),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.node.state === 'error'),expression:\"node.state === 'error'\"}],staticClass:\"el-icon-circle-close el-node-state-error\"}),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.node.state === 'warning'),expression:\"node.state === 'warning'\"}],staticClass:\"el-icon-warning-outline el-node-state-warning\"}),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.node.state === 'running'),expression:\"node.state === 'running'\"}],staticClass:\"el-icon-loading el-node-state-running\"})])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div\r\n            ref=\"node\"\r\n            :style=\"nodeContainerStyle\"\r\n            @click=\"clickNode\"\r\n            @mouseup=\"changeNodeSite\"\r\n            :class=\"nodeContainerClass\"\r\n    >\r\n        <!--  -->\r\n        <div v-if=\"color == 0\" class=\"ef-node-left\"></div>\r\n        <div v-if=\"color == 1\" class=\"ef-node-left-1\"></div>\r\n        <div v-if=\"color == 2\" class=\"ef-node-left-2\"></div>\r\n        <div v-if=\"color == 3\" class=\"ef-node-left-3\"></div>\r\n        <div v-if=\"color == 4\" class=\"ef-node-left-4\"></div>\r\n        <div v-if=\"color == 5\" class=\"ef-node-left-5\"></div>\r\n        <div v-if=\"color == 6\" class=\"ef-node-left-6\"></div>\r\n        <!--  -->\r\n        <div class=\"ef-node-left-ico flow-node-drag\">\r\n            <i :class=\"nodeIcoClass\"></i>\r\n        </div>\r\n        <!--  -->\r\n        <div class=\"ef-node-text\" :show-overflow-tooltip=\"true\">\r\n            {{node.name}}\r\n        </div>\r\n        <!--  -->\r\n        <div class=\"ef-node-right-ico\">\r\n            <i class=\"el-icon-circle-check el-node-state-success\" v-show=\"node.state === 'success'\"></i>\r\n            <i class=\"el-icon-circle-close el-node-state-error\" v-show=\"node.state === 'error'\"></i>\r\n            <i class=\"el-icon-warning-outline el-node-state-warning\" v-show=\"node.state === 'warning'\"></i>\r\n            <i class=\"el-icon-loading el-node-state-running\" v-show=\"node.state === 'running'\"></i>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        props: {\r\n            node: Object,\r\n            activeElement: Object\r\n        },\r\n        data() {\r\n            return {color:0}\r\n        },\r\n        created(){\r\n            this.color = Math.floor(Math.random()*7); \r\n        },\r\n        computed: {\r\n\r\n         \r\n\r\n            nodeContainerClass() {\r\n                return {\r\n                    'ef-node-container': true,\r\n                    'ef-node-active': this.activeElement.type == 'node' ? this.activeElement.nodeCode === this.node.code : false\r\n                }\r\n            },\r\n            // \r\n            nodeContainerStyle() {\r\n                return {\r\n                    top: this.node.top,\r\n                    left: this.node.left\r\n                }\r\n            },\r\n            nodeIcoClass() {\r\n                var nodeIcoClass = {}\r\n                nodeIcoClass[this.node.ico] = true\r\n                // classviewOnly \r\n                nodeIcoClass['flow-node-drag'] = this.node.viewOnly ? false : true\r\n                return nodeIcoClass\r\n            }\r\n        },\r\n        methods: {\r\n            // \r\n            clickNode() {\r\n                this.$emit('clickNode', this.node.code)\r\n            },\r\n            // \r\n            changeNodeSite() {\r\n                // \r\n                if (this.node.left == this.$refs.node.style.left && this.node.top == this.$refs.node.style.top) {\r\n                    return;\r\n                }\r\n                this.$emit('changeNodeSite', {\r\n                    nodeCode: this.node.code,\r\n                    left: this.$refs.node.style.left,\r\n                    top: this.$refs.node.style.top,\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./node.vue?vue&type=template&id=a5824de2&\"\nimport script from \"./node.vue?vue&type=script&lang=js&\"\nexport * from \"./node.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"tool\",staticClass:\"flow-menu\"},_vm._l((_vm.menuList),function(menu){return _c('div',{key:menu.id},[_c('span',{staticClass:\"ef-node-pmenu\",on:{\"click\":function($event){menu.open = !menu.open}}},[_c('i',{class:{'el-icon-caret-bottom': menu.open,'el-icon-caret-right': !menu.open}}),_vm._v(\"\"+_vm._s(menu.name))]),_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(menu.open),expression:\"menu.open\"}],staticClass:\"ef-node-menu-ul\"},[_c('draggable',{attrs:{\"options\":_vm.draggableOptions},on:{\"end\":_vm.end,\"start\":_vm.move},model:{value:(menu.children),callback:function ($$v) {_vm.$set(menu, \"children\", $$v)},expression:\"menu.children\"}},_vm._l((menu.children),function(subMenu){return _c('li',{key:subMenu.id,staticClass:\"ef-node-menu-li\",attrs:{\"type\":subMenu.type}},[_c('i',{class:subMenu.ico}),_vm._v(\" \"+_vm._s(subMenu.name)+\" \")])}),0)],1)])}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import axios from 'axios'\r\nimport { MessageBox, Message } from 'element-ui'\r\n// import store from '@/store'\r\n// import { getToken } from '@/utils/auth'\r\n\r\n// create an axios instance\r\nconst service = axios.create({\r\n//   baseURL: process.env.VUE_APP_BASE_API, // url = base url + request url\r\nbaseURL: \"http://127.0.0.1:10002\",\r\n  // withCredentials: true, // send cookies when cross-domain requests\r\n  timeout: 5000 // request timeout\r\n})\r\n\r\n// request interceptor\r\nservice.interceptors.request.use(\r\n  config => {\r\n    // do something before request is sent\r\n\r\n    // if (store.getters.token) {\r\n    //   // let each request carry token\r\n    //   // ['X-Token'] is a custom headers key\r\n    //   // please modify it according to the actual situation\r\n    //   config.headers['X-Token'] = getToken()\r\n    // }\r\n    return config\r\n  },\r\n  error => {\r\n    // do something with request error\r\n    console.log(error) // for debug\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\n// response interceptor\r\nservice.interceptors.response.use(\r\n  /**\r\n   * If you want to get http information such as headers or status\r\n   * Please return  response => response\r\n  */\r\n\r\n  /**\r\n   * Determine the request status by custom code\r\n   * Here is just an example\r\n   * You can also judge the status by HTTP Status Code\r\n   */\r\n  response => {\r\n    const res = response.data\r\n\r\n    console.log(res)\r\n    // if the custom code is not 20000, it is judged as an error.\r\n    if (!res.IsSuccess) {\r\n      Message({\r\n        message: res.message || 'Error',\r\n        type: 'error',\r\n        duration: 5 * 1000\r\n      })\r\n\r\n      // 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;\r\n      if (res.code === 50008 || res.code === 50012 || res.code === 50014) {\r\n        // to re-login\r\n        MessageBox.confirm('You have been logged out, you can cancel to stay on this page, or log in again', 'Confirm logout', {\r\n          confirmButtonText: 'Re-Login',\r\n          cancelButtonText: 'Cancel',\r\n          type: 'warning'\r\n        }).then(() => {\r\n        //   store.dispatch('user/resetToken').then(() => {\r\n        //     location.reload()\r\n        //   })\r\n        })\r\n      }\r\n      return Promise.reject(new Error(res.message || 'Error'))\r\n    } else {\r\n      return res\r\n    }\r\n  },\r\n  error => {\r\n    console.log('err' + error) // for debug\r\n    Message({\r\n      message: error.message,\r\n      type: 'error',\r\n      duration: 5 * 1000\r\n    })\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\nexport default service","import request from '@/utils/http_request'\r\n\r\nexport function findTaskTemplateAll() {\r\n    return request({\r\n      url: '/findTaskTemplateAll',\r\n      method: 'post',\r\n    })\r\n  }\r\n  ","<template>\r\n    <div class=\"flow-menu\" ref=\"tool\">\r\n        <div v-for=\"menu  in  menuList\" :key=\"menu.id\">\r\n            <span class=\"ef-node-pmenu\" @click=\"menu.open = !menu.open\"><i :class=\"{'el-icon-caret-bottom': menu.open,'el-icon-caret-right': !menu.open}\"></i>&nbsp;{{menu.name}}</span>\r\n            <ul v-show=\"menu.open\" class=\"ef-node-menu-ul\">\r\n                <draggable @end=\"end\" @start=\"move\" v-model=\"menu.children\" :options=\"draggableOptions\">\r\n                    <li v-for=\"subMenu in menu.children\" class=\"ef-node-menu-li\" :key=\"subMenu.id\" :type=\"subMenu.type\">\r\n                        <i :class=\"subMenu.ico\"></i> {{subMenu.name}}\r\n                    </li>\r\n                </draggable>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n    import draggable from 'vuedraggable'\r\n    import { findTaskTemplateAll} from '@/api/task_template';\r\n    var mousePosition = {\r\n        left: -1,\r\n        top: -1\r\n    }\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                activeNames: '1',\r\n                // draggable https://www.cnblogs.com/weixin186/p/10108679.html\r\n                draggableOptions: {\r\n                    preventOnFilter: false,\r\n                    sort: false,\r\n                    disabled: false,\r\n                    ghostClass: 'tt',\r\n                    // H5\r\n                    forceFallback: true,\r\n                    // \r\n                    // fallbackClass: 'flow-node-draggable'\r\n                },\r\n                // id\r\n                defaultOpeneds: ['1', '2'],\r\n                menuList: [\r\n                  \r\n                    {\r\n                        id: '2',\r\n                        type: 'group',\r\n                        name: '',\r\n                        ico: 'el-icon-video-pause',\r\n                        open: true,\r\n                        children: [\r\n                        // {\r\n                        //         id: '1',\r\n                        //         type: 'START',\r\n                        //         name: '',\r\n                        //         ico: 'el-icon-time',\r\n                        //         // \r\n                        //         style: {}\r\n                        //     },\r\n                        //     {\r\n                        //         id: '2',\r\n                        //         type: 'OVER',\r\n                        //         name: '',\r\n                        //         ico: 'el-icon-time',\r\n                        //         // \r\n                        //         style: {}\r\n                        //     },\r\n                            {\r\n                                id: '21',\r\n                                type: 'DELAY',\r\n                                name: '',\r\n                                ico: 'el-icon-time',\r\n                                // \r\n                                style: {}\r\n                            }\r\n                            , {\r\n                                id: '22',\r\n                                type: 'WHILE',\r\n                                name: '',\r\n                                ico: 'el-icon-refresh',\r\n                                // \r\n                                style: {}\r\n                            }, {\r\n                                id: '23',\r\n                                type: 'LOOP',\r\n                                name: '',\r\n                                ico: 'el-icon-refresh',\r\n                                // \r\n                                style: {}\r\n                            }\r\n                        ]\r\n                    }\r\n                ],\r\n                nodeMenu: {}\r\n            }\r\n        },\r\n        components: {\r\n            draggable\r\n        },\r\n        created() {\r\n            /**\r\n             * tab\r\n             * @param event\r\n             */\r\n            if (this.isFirefox()) {\r\n                document.body.ondrop = function (event) {\r\n                    // \r\n                    mousePosition.left = event.layerX\r\n                    mousePosition.top = event.clientY - 50\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                }\r\n            }\r\n\r\n            this.findTaskTemplateAll()\r\n        },\r\n        methods: {\r\n\r\n            //\r\n        async findTaskTemplateAll() {\r\n            try {\r\n                const response = await findTaskTemplateAll();\r\n                // \r\n                console.log('findTaskTemplateAll', response);\r\n\r\n                let nodes={\r\n                        id: '1',\r\n                        type: 'group',\r\n                        name: '',\r\n                        ico: 'el-icon-video-play',\r\n                        open: true,\r\n                        children: [\r\n                        ]\r\n                    }\r\n\r\n                    response.Data.forEach(element => {\r\n                        let cc={\r\n                                id: '',\r\n                                type: '',\r\n                                name: '',\r\n                                ico: '',\r\n                                // \r\n                                style: {}\r\n                            }\r\n                            if (element.type == 0){\r\n                                cc.ico = \"el-icon-s-promotion\"\r\n                            } \r\n                            if (element.type == 1){\r\n                                cc.ico = \" el-icon-s-grid\"\r\n                            } \r\n                            cc.id = element.id\r\n                            cc.type = element.name\r\n                            cc.name = element.name\r\n                        nodes.children.push(cc)\r\n                    });\r\n                    this.menuList.push(nodes)\r\n\r\n                \r\n\r\n            } catch (error) {\r\n                console.error('findTaskTemplateAll', error);\r\n                // \r\n            }\r\n        },\r\n\r\n            // \r\n            getMenuByType(type) {\r\n                for (let i = 0; i < this.menuList.length; i++) {\r\n                    let children = this.menuList[i].children;\r\n                    for (let j = 0; j < children.length; j++) {\r\n                        if (children[j].type === type) {\r\n                            return children[j]\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            // \r\n            move(evt, a, b, c) {\r\n                var type = evt.item.attributes.type.nodeValue\r\n                this.nodeMenu = this.getMenuByType(type)\r\n            },\r\n            // \r\n            end(evt, e) {\r\n                this.$emit('addNode', evt, this.nodeMenu, mousePosition)\r\n            },\r\n            // \r\n            isFirefox() {\r\n                var userAgent = navigator.userAgent\r\n                if (userAgent.indexOf(\"Firefox\") > -1) {\r\n                    return true\r\n                }\r\n                return false\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node_menu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node_menu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./node_menu.vue?vue&type=template&id=a399b61e&\"\nimport script from \"./node_menu.vue?vue&type=script&lang=js&\"\nexport * from \"./node_menu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-dialog',{attrs:{\"title\":\"\",\"visible\":_vm.dialogVisible,\"width\":\"70%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-alert',{attrs:{\"title\":\"\",\"type\":\"warning\",\"description\":\"json\",\"show-icon\":\"\",\"close-text\":\"\"}}),_c('br'),_c('codemirror',{staticClass:\"code\",attrs:{\"value\":_vm.flowJsonData,\"options\":_vm.options}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-dialog\r\n            title=\"\"\r\n            :visible.sync=\"dialogVisible\"\r\n            width=\"70%\"\r\n    >\r\n        <el-alert\r\n                title=\"\"\r\n                type=\"warning\"\r\n                description=\"json\"\r\n                show-icon\r\n                close-text=\"\"\r\n        >\r\n        </el-alert>\r\n        <br/>\r\n        <!---->\r\n        <codemirror\r\n                :value=\"flowJsonData\"\r\n                :options=\"options\"\r\n                class=\"code\"\r\n        ></codemirror>\r\n        \r\n    </el-dialog>\r\n    \r\n</template>\r\n\r\n<script>\r\n    import 'codemirror/lib/codemirror.css'\r\n    import { codemirror } from 'vue-codemirror'\r\n    require(\"codemirror/mode/javascript/javascript.js\")\r\n\r\n    export default {\r\n        props: {\r\n            data: Object,\r\n        },\r\n        data() {\r\n            return {\r\n                dialogVisible: false,\r\n                flowJsonData: {},\r\n                options: {\r\n                    mode: {name: \"javascript\", json: true},\r\n                    lineNumbers: true\r\n                }\r\n            }\r\n        },\r\n        components: {\r\n            codemirror\r\n        },\r\n        methods: {\r\n            init() {\r\n                this.dialogVisible = true\r\n                this.flowJsonData = JSON.stringify(this.data, null, 4).toString()\r\n            },\r\n        }\r\n    }\r\n</script>\r\n<style>\r\n.pub-btn{\r\n    margin-top:  24px;\r\n    display: flex;\r\n    margin-left: auto;\r\n\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./info.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./info.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./info.vue?vue&type=template&id=6c690730&\"\nimport script from \"./info.vue?vue&type=script&lang=js&\"\nexport * from \"./info.vue?vue&type=script&lang=js&\"\nimport style0 from \"./info.vue?vue&type=style&index=0&id=6c690730&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-dialog',{attrs:{\"title\":\"\",\"visible\":_vm.dialogVisible,\"width\":\"70%\",\"customClass\":\"flowHelp\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-tabs',{attrs:{\"tab-position\":\"left\"}},[_c('el-tab-pane',{attrs:{\"label\":\"\"}},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"\")]),_c('div',[_vm._v(\"\")])],1),_c('el-tab-pane',{attrs:{\"label\":\"\"}},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"\")]),_c('div',[_vm._v(\" del \")]),_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"\")]),_c('pre',[_vm._v(\"this.deleteNode(nodeId)\")])],1),_c('el-tab-pane',{attrs:{\"label\":\"\"}},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"\")]),_c('div',[_vm._v(\"\")])],1),_c('el-tab-pane',{attrs:{\"label\":\"\"}},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"\")]),_c('div',[_vm._v(\"+\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-dialog\r\n            title=\"\"\r\n            :visible.sync=\"dialogVisible\"\r\n            width=\"70%\"\r\n            customClass=\"flowHelp\"\r\n    >\r\n        <el-tabs tab-position=\"left\">\r\n            <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div></div>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div>\r\n                    del\r\n                </div>\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <pre>this.deleteNode(nodeId)</pre>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div></div>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div>+</div>\r\n            </el-tab-pane>\r\n            <!-- <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div></div>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"\">\r\n                <el-divider content-position=\"left\"></el-divider>\r\n                <div>: https://gitee.com/xiaoka2017/easy-flow-sdk</div>\r\n            </el-tab-pane> -->\r\n        </el-tabs>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                dialogVisible: false\r\n            }\r\n        },\r\n        components: {},\r\n        methods: {\r\n            init() {\r\n                this.dialogVisible = true\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n    .flowHelp {\r\n        height: 80%;\r\n    }\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./help.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./help.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./help.vue?vue&type=template&id=6977a9c6&\"\nimport script from \"./help.vue?vue&type=script&lang=js&\"\nexport * from \"./help.vue?vue&type=script&lang=js&\"\nimport style0 from \"./help.vue?vue&type=style&index=0&id=6977a9c6&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"ef-node-form\"},[_c('div',{staticClass:\"ef-node-form-header\"},[_vm._v(\"  \")]),_c('div',{staticClass:\"ef-node-form-body\"},[_c('el-tabs',{staticClass:\"ef-node-tabs\",on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"\",\"name\":\"first\"}},[_c('el-form',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.type === 'node'),expression:\"type === 'node'\"}],ref:\"dataForm\",attrs:{\"model\":_vm.node,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-input',{attrs:{\"disabled\":true},model:{value:(_vm.node.code),callback:function ($$v) {_vm.$set(_vm.node, \"code\", $$v)},expression:\"node.code\"}})],1),_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-input',{attrs:{\"disabled\":true},model:{value:(_vm.node.type),callback:function ($$v) {_vm.$set(_vm.node, \"type\", $$v)},expression:\"node.type\"}})],1),_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-input',{model:{value:(_vm.node.name),callback:function ($$v) {_vm.$set(_vm.node, \"name\", $$v)},expression:\"node.name\"}})],1),(_vm.node.type == 'WHILE')?_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"type\":\"number\"},model:{value:(_vm.node.count),callback:function ($$v) {_vm.$set(_vm.node, \"count\", $$v)},expression:\"node.count\"}})],1):_vm._e(),(_vm.node.type == 'DELAY')?_c('el-form-item',{attrs:{\"label\":\"/\"}},[_c('el-input',{attrs:{\"placeholder\":\"/s\",\"type\":\"number\"},model:{value:(_vm.node.second),callback:function ($$v) {_vm.$set(_vm.node, \"second\", $$v)},expression:\"node.second\"}})],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"ico\"}},[_c('el-input',{model:{value:(_vm.node.ico),callback:function ($$v) {_vm.$set(_vm.node, \"ico\", $$v)},expression:\"node.ico\"}})],1),_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-select',{attrs:{\"placeholder\":\"\"},model:{value:(_vm.node.state),callback:function ($$v) {_vm.$set(_vm.node, \"state\", $$v)},expression:\"node.state\"}},_vm._l((_vm.stateList),function(item){return _c('el-option',{key:item.state,attrs:{\"label\":item.label,\"value\":item.state}})}),1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"icon\":\"el-icon-close\"}},[_vm._v(\"\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-check\"},on:{\"click\":_vm.save}},[_vm._v(\"\")])],1)],1),_c('el-form',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.type === 'line'),expression:\"type === 'line'\"}],ref:\"dataForm\",attrs:{\"model\":_vm.line,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-input',{model:{value:(_vm.line.label),callback:function ($$v) {_vm.$set(_vm.line, \"label\", $$v)},expression:\"line.label\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"icon\":\"el-icon-close\"}},[_vm._v(\"\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-check\"},on:{\"click\":_vm.saveLine}},[_vm._v(\"\")])],1)],1)],1),_c('el-tab-pane',{attrs:{\"label\":\"\",\"name\":\"second\"}},[_c('div',{staticClass:\"log-container\"},[_c('div',{ref:\"logBox\",staticClass:\"log-box\"},_vm._l((_vm.logs),function(log,index){return _c('div',{key:index,staticClass:\"log-entry\"},[_vm._v(_vm._s(log.Data))])}),0)])]),_c('el-tab-pane',{attrs:{\"label\":\"\",\"name\":\"third\"}},[_vm._v(\"\")])],1)],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <div class=\"ef-node-form\">\r\n            <div class=\"ef-node-form-header\">\r\n                \r\n            </div>\r\n            <div class=\"ef-node-form-body\">\r\n                <el-tabs class=\"ef-node-tabs\" v-model=\"activeName\" @tab-click=\"handleClick\">\r\n                    <el-tab-pane label=\"\" name=\"first\">\r\n                        <el-form :model=\"node\" ref=\"dataForm\" label-width=\"80px\" v-show=\"type === 'node'\">\r\n                            <el-form-item label=\"\">\r\n                                <el-input v-model=\"node.code\" :disabled=\"true\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"\">\r\n                                <el-input v-model=\"node.type\" :disabled=\"true\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"\">\r\n                                <el-input v-model=\"node.name\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item v-if=\"node.type == 'WHILE'\" label=\"\">\r\n                                <el-input placeholder=\"\" type=\"number\" v-model=\"node.count\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item v-if=\"node.type == 'DELAY'\" label=\"/\">\r\n                                <el-input placeholder=\"/s\" type=\"number\" v-model=\"node.second\"></el-input>\r\n                            </el-form-item>\r\n                            <!-- <el-form-item label=\"left\">\r\n                                <el-input v-model=\"node.left\" :disabled=\"true\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"top\">\r\n                                <el-input v-model=\"node.top\" :disabled=\"true\"></el-input>\r\n                            </el-form-item> -->\r\n                            <el-form-item label=\"ico\">\r\n                                <el-input v-model=\"node.ico\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"\">\r\n                                <el-select v-model=\"node.state\" placeholder=\"\">\r\n                                    <el-option v-for=\"item in stateList\" :key=\"item.state\" :label=\"item.label\"\r\n                                        :value=\"item.state\">\r\n                                    </el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button icon=\"el-icon-close\"></el-button>\r\n                                <el-button type=\"primary\" icon=\"el-icon-check\" @click=\"save\"></el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n\r\n                        <el-form :model=\"line\" ref=\"dataForm\" label-width=\"80px\" v-show=\"type === 'line'\">\r\n                            <el-form-item label=\"\">\r\n                                <el-input v-model=\"line.label\"></el-input>\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button icon=\"el-icon-close\"></el-button>\r\n                                <el-button type=\"primary\" icon=\"el-icon-check\" @click=\"saveLine\"></el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"\" name=\"second\">\r\n                        <div class=\"log-container\">\r\n                            <div class=\"log-box\" ref=\"logBox\">\r\n                                <div v-for=\"(log, index) in logs\" :key=\"index\" class=\"log-entry\">{{ log.Data }}</div>\r\n                            </div>\r\n                        </div>\r\n\r\n\r\n\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"\" name=\"third\"></el-tab-pane>\r\n                </el-tabs>\r\n\r\n\r\n            </div>\r\n            <!--            <div class=\"el-node-form-tag\"></div>-->\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { cloneDeep } from 'lodash'\r\nimport VueNativeSock from \"vue-native-websocket\";\r\nimport Vue from \"vue\"\r\nexport default {\r\n    data() {\r\n        return {\r\n            logs: [],\r\n            activeName: 'first',\r\n            visible: true,\r\n            // node  line\r\n            type: 'node',\r\n            node: {},\r\n            line: {},\r\n            data: {},\r\n            stateList: [{\r\n                state: 'success',\r\n                label: ''\r\n            }, {\r\n                state: 'warning',\r\n                label: ''\r\n            }, {\r\n                state: 'error',\r\n                label: ''\r\n            }, {\r\n                state: 'running',\r\n                label: ''\r\n            }]\r\n        }\r\n    },\r\n    created() {\r\n        this.logs.push({\"Data\":\"[]\"})\r\n        console.log(1);\r\n    },\r\n\r\n    mounted() {\r\n        Vue.use(VueNativeSock, \"ws://localhost:8801/ws\", {\r\n            format: \"json\"\r\n        });\r\n\r\n        this.$socket.onmessage = event => {\r\n            const log = JSON.parse(event.data);\r\n            if (log.Action == \"DagLog\"){\r\n                this.logs.push(log);\r\n            }\r\n            \r\n        };\r\n    },\r\n    watch: {\r\n        logs() {\r\n            this.$nextTick(() => {\r\n        this.scrollToBottom();  // \r\n      });\r\n        }\r\n    },\r\n    methods: {\r\n\r\n        scrollToBottom() {\r\n            this.$refs.logBox.scrollTop = this.$refs.logBox.scrollHeight;  // \r\n        },\r\n        /**\r\n         * ID\r\n         * @param data\r\n         * @param code\r\n         */\r\n        nodeInit(data, code) {\r\n            this.type = 'node'\r\n            this.data = data\r\n            data.nodeList.filter((node) => {\r\n                if (node.code === code) {\r\n                    this.node = cloneDeep(node)\r\n                }\r\n            })\r\n        },\r\n        lineInit(line) {\r\n            this.type = 'line'\r\n            this.line = line\r\n        },\r\n        // \r\n        saveLine() {\r\n            this.$emit('setLineLabel', this.line.from, this.line.to, this.line.label)\r\n        },\r\n        save() {\r\n            this.data.nodeList.filter((node) => {\r\n                if (node.code === this.node.code) {\r\n                    node.name = this.node.name\r\n                    node.left = this.node.left\r\n                    node.top = this.node.top\r\n                    node.ico = this.node.ico\r\n                    node.state = this.node.state\r\n                    node.count = Number(this.node.count)\r\n                    node.second = Number(this.node.second)\r\n                    this.$emit('repaintEverything')\r\n                }\r\n            })\r\n        }, handleClick(tab, event) {\r\n            console.log(tab, event);\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.el-node-form-tag {\r\n    position: absolute;\r\n    top: 50%;\r\n    margin-left: -15px;\r\n    height: 40px;\r\n    width: 15px;\r\n    background-color: #fbfbfb;\r\n    border: 1px solid rgb(220, 227, 232);\r\n    border-right: none;\r\n    z-index: 0;\r\n}\r\n\r\n.ef-node-tabs {\r\n    margin: 10px;\r\n}\r\n</style>\r\n<style>\r\n.log-container {\r\n    height: 600px;\r\n    border: 1px solid #ccc;\r\n    overflow: hidden;\r\n}\r\n\r\n.log-box {\r\n    height: 100%;\r\n    overflow: auto;\r\n    padding: 10px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.log-entry {\r\n    margin-bottom: 5px;\r\n    padding: 5px;\r\n    border: 1px solid #ddd;\r\n    background-color: #f9f9f9;\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node_form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./node_form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./node_form.vue?vue&type=template&id=450a6ec2&\"\nimport script from \"./node_form.vue?vue&type=script&lang=js&\"\nexport * from \"./node_form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./node_form.vue?vue&type=style&index=0&id=450a6ec2&prod&lang=css&\"\nimport style1 from \"./node_form.vue?vue&type=style&index=1&id=450a6ec2&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/http_request'\r\n\r\n// export const findTaskFlowAll =(params)=>{\r\n//     request('/findTaskFlowAll',null,'GET',null)\r\n// }\r\n\r\n// export const findTaskFlowBy =(params)=>{\r\n//     request('/findTaskFlowAll',params,'GET',null)\r\n// }\r\nexport function findTaskFlowAll() {\r\n    return request({\r\n      url: '/findTaskFlowAll',\r\n      method: 'post',\r\n    })\r\n  }\r\n  \r\n  export function findTaskFlowById(params) {\r\n    return request({\r\n      url: '/findTaskFlowById',\r\n      method: 'post',\r\n      params\r\n    })\r\n  }\r\n\r\n  export function pubTaskFlow(data) {\r\n    return request({\r\n      url: '/pubTaskFlow',\r\n      method: 'post',\r\n      data\r\n    })\r\n  }\r\n\r\n  export function exeTaskFlow(data) {\r\n    return request({\r\n      url: '/exeTaskFlow',\r\n      method: 'post',\r\n      data\r\n    })\r\n  }\r\n  \r\n","let dataA = {\r\n    name: 'A',\r\n    nodeList: [\r\n        {\r\n            code: 'nodeA',\r\n            name: 'A-A',\r\n            type: 'task',\r\n            left: '26px',\r\n            top: '161px',\r\n            ico: 'el-icon-user-solid'\r\n        },\r\n        {\r\n            code: 'nodeB',\r\n            name: 'A-B',\r\n            type: 'task',\r\n            left: '340px',\r\n            top: '161px',\r\n            ico: 'el-icon-goods'\r\n        },\r\n        {\r\n            code: 'nodeC',\r\n            name: 'A-C',\r\n            type: 'task',\r\n            left: '739px',\r\n            top: '161px',\r\n            ico: 'el-icon-present'\r\n        }\r\n    ],\r\n    lineList: [{\r\n        from: 'nodeA',\r\n        to: 'nodeB'\r\n    }, {\r\n        from: 'nodeB',\r\n        to: 'nodeC'\r\n    }]\r\n}\r\n\r\nexport function getDataA () {\r\n    return dataA\r\n}\r\n","let dataB = {\r\n    name: 'B',\r\n    nodeList: [\r\n        {\r\n            code: 'nodeA',\r\n            name: 'A-',\r\n            type: 'task',\r\n            left: '18px',\r\n            top: '223px',\r\n            ico: 'el-icon-user-solid',\r\n            state: 'success',\r\n            viewOnly: true\r\n        },\r\n        {\r\n            code: 'nodeB',\r\n            type: 'task',\r\n            name: 'B-B',\r\n            left: '351px',\r\n            top: '96px',\r\n            ico: 'el-icon-goods',\r\n            state: 'error'\r\n        },\r\n        {\r\n            code: 'nodeC',\r\n            name: 'B-C',\r\n            type: 'task',\r\n            left: '354px',\r\n            top: '351px',\r\n            ico: 'el-icon-present',\r\n            state: 'warning'\r\n        }, {\r\n            code: 'nodeD',\r\n            name: 'B-D',\r\n            type: 'task',\r\n            left: '723px',\r\n            top: '215px',\r\n            ico: 'el-icon-present',\r\n            state: 'running'\r\n        }\r\n    ],\r\n    lineList: [{\r\n        from: 'nodeA',\r\n        to: 'nodeB',\r\n        label: 'A'\r\n    }, {\r\n        from: 'nodeA',\r\n        to: 'nodeC',\r\n        label: 'B'\r\n    }, {\r\n        from: 'nodeB',\r\n        to: 'nodeD'\r\n    }, {\r\n        from: 'nodeC',\r\n        to: 'nodeD'\r\n    }\r\n    ]\r\n}\r\n\r\nexport function getDataB () {\r\n    return dataB\r\n}\r\n","let dataC = {\r\n    name: 'C',\r\n    nodeList: [\r\n        {\r\n            code: 'nodeA',\r\n            name: 'C-A',\r\n            type: 'task',\r\n            left: '400px',\r\n            top: '15px',\r\n            ico: 'el-icon-user-solid'\r\n        },\r\n        {\r\n            code: 'nodeB',\r\n            name: 'C-B',\r\n            type: 'task',\r\n            left: '400px',\r\n            top: '200px',\r\n            ico: 'el-icon-goods'\r\n        },\r\n        {\r\n            code: 'nodeC',\r\n            name: 'C-C',\r\n            type: 'task',\r\n            left: '400px',\r\n            top: '378px',\r\n            ico: 'el-icon-present'\r\n        }\r\n    ],\r\n    lineList: [\r\n        {\r\n            from: 'nodeA',\r\n            to: 'nodeB'\r\n        }, {\r\n            from: 'nodeB',\r\n            to: 'nodeC'\r\n        }\r\n    ]\r\n}\r\n\r\nexport function getDataC () {\r\n    return dataC\r\n}\r\n","var dataD = {\r\n    name: 'D',\r\n    nodeList: [\r\n        {\r\n            code: 'nodeA',\r\n            name: 'D-A',\r\n            type: 'task',\r\n            left: '18px',\r\n            top: '223px',\r\n            ico: 'el-icon-user-solid',\r\n            state: 'success'\r\n        },\r\n        {\r\n            code: 'nodeB',\r\n            type: 'task',\r\n            name: 'D-B',\r\n            left: '351px',\r\n            top: '96px',\r\n            ico: 'el-icon-goods',\r\n            state: 'error'\r\n        },\r\n        {\r\n            code: 'nodeC',\r\n            name: 'D-C',\r\n            type: 'task',\r\n            left: '354px',\r\n            top: '351px',\r\n            ico: 'el-icon-present',\r\n            state: 'warning'\r\n        }, {\r\n            code: 'nodeD',\r\n            name: 'D-D',\r\n            type: 'task',\r\n            left: '723px',\r\n            top: '215px',\r\n            ico: 'el-icon-present',\r\n            state: 'running'\r\n        }\r\n    ],\r\n    lineList: [{\r\n        from: 'nodeA',\r\n        to: 'nodeB',\r\n        label: ',,',\r\n        connector: 'Straight',\r\n        anchors: ['Top', 'Bottom'],\r\n        paintStyle: {strokeWidth: 2, stroke: '#1879FF'}\r\n    }, {\r\n        from: 'nodeA',\r\n        to: 'nodeC',\r\n        label: ',',\r\n        connector: 'Bezier',\r\n        anchors: ['Bottom', 'Left']\r\n    }, {\r\n        from: 'nodeB',\r\n        to: 'nodeD',\r\n        label: ','\r\n    }, {\r\n        from: 'nodeC',\r\n        to: 'nodeD',\r\n        label: ','\r\n    }, {\r\n        from: 'nodeC',\r\n        to: 'nodeC',\r\n        label: ''\r\n    }\r\n    ]\r\n}\r\n\r\nexport function getDataD() {\r\n    return dataD\r\n}\r\n","var dataE = {\r\n    name: 'E',\r\n    nodeList: [\r\n        {\r\n            code: 'nodeA',\r\n            name: 'D-A',\r\n            type: 'task',\r\n            ico: 'el-icon-user-solid',\r\n            state: 'success'\r\n        },\r\n        {\r\n            code: 'nodeB',\r\n            type: 'task',\r\n            name: 'D-B',\r\n            ico: 'el-icon-goods',\r\n            state: 'error'\r\n        },\r\n        {\r\n            code: 'nodeC',\r\n            name: 'D-C',\r\n            type: 'task',\r\n            ico: 'el-icon-present',\r\n            state: 'warning'\r\n        }, {\r\n            code: 'nodeD',\r\n            name: 'D-D',\r\n            type: 'task',\r\n            ico: 'el-icon-present',\r\n            state: 'running'\r\n        }\r\n    ],\r\n    lineList: [{\r\n        from: 'nodeA',\r\n        to: 'nodeB'\r\n    }, {\r\n        from: 'nodeA',\r\n        to: 'nodeC',\r\n        label: 'hello'\r\n    }, {\r\n        from: 'nodeB',\r\n        to: 'nodeD'\r\n    }, {\r\n        from: 'nodeC',\r\n        to: 'nodeD'\r\n    }, {\r\n        from: 'nodeC',\r\n        to: 'nodeC'\r\n    }\r\n    ]\r\n}\r\n\r\nexport function getDataE() {\r\n    return dataE\r\n}\r\n","/**\r\n *  https://github.com/chaangliu/ForceDirectedLayout/blob/master/javascript/force-directed.js\r\n * A force directed graph layout implementation by liuchang on 2018/05/10.\r\n */\r\nconst CANVAS_WIDTH = 1000\r\nconst CANVAS_HEIGHT = 1000\r\nlet k\r\nlet mNodeList = []\r\nlet mEdgeList = []\r\nlet mDxMap = {}\r\nlet mDyMap = {}\r\nlet mNodeMap = {}\r\n\r\nexport function ForceDirected(data = {}) {\r\n    // generate nodes and edges\r\n    // for (let i = 0; i < 20; i++) {\r\n    //     mNodeList.push(new Node(i))\r\n    // }\r\n    k = 0\r\n    mNodeList = []\r\n    mEdgeList = []\r\n    mDxMap = {}\r\n    mDyMap = {}\r\n    mNodeMap = {}\r\n\r\n    let nodeList = data.nodeList\r\n    for (let i = 0; i < nodeList.length; i++) {\r\n        let node = nodeList[i]\r\n        mNodeList.push(node)\r\n    }\r\n\r\n    // for (let i = 0; i < 20; i++) {\r\n    //     let edgeCount = Math.random() * 8 + 1\r\n    //     for (let j = 0; j < edgeCount; j++) {\r\n    //         let targetId = Math.floor(Math.random() * 20)\r\n    //         let edge = new Edge(i, targetId)\r\n    //         mEdgeList.push(edge)\r\n    //     }\r\n    // }\r\n    // line  edge\r\n    let lineList = data.lineList\r\n    for (let i = 0; i < lineList.length; i++) {\r\n        let line = lineList[i]\r\n        let edge = new Edge(line.from, line.to)\r\n        mEdgeList.push(edge)\r\n    }\r\n\r\n    if (mNodeList && mEdgeList) {\r\n        k = Math.sqrt(CANVAS_WIDTH * CANVAS_HEIGHT / mNodeList.length)\r\n    }\r\n    for (let i = 0; i < mNodeList.length; i++) {\r\n        let node = mNodeList[i]\r\n        if (node) {\r\n            mNodeMap[node.id] = node\r\n        }\r\n    }\r\n\r\n    // . Generate coordinates randomly.\r\n    let initialX, initialY, initialSize = 40.0\r\n    for (let i in mNodeList) {\r\n        initialX = CANVAS_WIDTH * 0.5\r\n        initialY = CANVAS_HEIGHT * 0.5\r\n        mNodeList[i].x = initialX + initialSize * (Math.random() - 0.5)\r\n        mNodeList[i].y = initialY + initialSize * (Math.random() - 0.5)\r\n    }\r\n\r\n    // 200. Iterate 200 times.\r\n    for (let i = 0; i < 200; i++) {\r\n        calculateRepulsive()\r\n        calculateTraction()\r\n        updateCoordinates()\r\n    }\r\n    // console.log(JSON.stringify(new Result(mNodeList, mEdgeList)))\r\n    // px\r\n    for (let i = 0; i < mNodeList.length; i++) {\r\n        let node = mNodeList[i]\r\n        node.left = node.x + 'px'\r\n        node.top = node.y + 'px'\r\n        node.x = undefined\r\n        node.y = undefined\r\n    }\r\n\r\n    data.nodeList = mNodeList\r\n\r\n    // console.log(data)\r\n    return data\r\n}\r\n\r\nfunction Node(id = null) {\r\n    this.id = id\r\n    this.x = 22\r\n    this.y = null\r\n}\r\n\r\nfunction Edge(source = null, target = null) {\r\n    this.source = source\r\n    this.target = target\r\n}\r\n\r\n/**\r\n * Node\r\n * Calculate the displacement generated by the repulsive force between two nodes.*\r\n */\r\nfunction calculateRepulsive() {\r\n    let ejectFactor = 6\r\n    let distX, distY, dist\r\n    for (let i = 0; i < mNodeList.length; i++) {\r\n        mDxMap[mNodeList[i].id] = 0.0\r\n        mDyMap[mNodeList[i].id] = 0.0\r\n        for (let j = 0; j < mNodeList.length; j++) {\r\n            if (i !== j) {\r\n                distX = mNodeList[i].x - mNodeList[j].x\r\n                distY = mNodeList[i].y - mNodeList[j].y\r\n                dist = Math.sqrt(distX * distX + distY * distY)\r\n            }\r\n            if (dist < 30) {\r\n                ejectFactor = 5\r\n            }\r\n            if (dist > 0 && dist < 250) {\r\n                let id = mNodeList[i].id\r\n                mDxMap[id] = mDxMap[id] + distX / dist * k * k / dist * ejectFactor\r\n                mDyMap[id] = mDyMap[id] + distY / dist * k * k / dist * ejectFactor\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * EdgeNode\r\n * Calculate the traction force generated by the edge acted on the two nodes of its two ends.\r\n */\r\nfunction calculateTraction() {\r\n    let condenseFactor = 3\r\n    let startNode, endNode\r\n    for (let e = 0; e < mEdgeList.length; e++) {\r\n        let eStartID = mEdgeList[e].source\r\n        let eEndID = mEdgeList[e].target\r\n        startNode = mNodeMap[eStartID]\r\n        endNode = mNodeMap[eEndID]\r\n        if (!startNode) {\r\n            console.log('Cannot find start node id: ' + eStartID + ', please check it out.')\r\n            return\r\n        }\r\n        if (!endNode) {\r\n            console.log('Cannot find end node id: ' + eEndID + ', please check it out.')\r\n            return\r\n        }\r\n        let distX, distY, dist\r\n        distX = startNode.x - endNode.x\r\n        distY = startNode.y - endNode.y\r\n        dist = Math.sqrt(distX * distX + distY * distY)\r\n        mDxMap[eStartID] = mDxMap[eStartID] - distX * dist / k * condenseFactor\r\n        mDyMap[eStartID] = mDyMap[eStartID] - distY * dist / k * condenseFactor\r\n        mDxMap[eEndID] = mDxMap[eEndID] + distX * dist / k * condenseFactor\r\n        mDyMap[eEndID] = mDyMap[eEndID] + distY * dist / k * condenseFactor\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * update the coordinates.\r\n */\r\nfunction updateCoordinates() {\r\n    let maxt = 4, maxty = 3 // Additional coefficients.\r\n    for (let v = 0; v < mNodeList.length; v++) {\r\n        let node = mNodeList[v]\r\n        let dx = Math.floor(mDxMap[node.id])\r\n        let dy = Math.floor(mDyMap[node.id])\r\n\r\n        if (dx < -maxt) dx = -maxt\r\n        if (dx > maxt) dx = maxt\r\n        if (dy < -maxty) dy = -maxty\r\n        if (dy > maxty) dy = maxty\r\n        node.x = node.x + dx >= CANVAS_WIDTH || node.x + dx <= 0 ? node.x - dx : node.x + dx\r\n        node.y = node.y + dy >= CANVAS_HEIGHT || node.y + dy <= 0 ? node.y - dy : node.y + dy\r\n    }\r\n}\r\n\r\nfunction Result(nodes = null, links = null) {\r\n    this.nodes = nodes\r\n    this.links = links\r\n}\r\n","var now = {\r\n    name: '',\r\n    nodeList: [\r\n    ],\r\n    lineList: [\r\n    ]\r\n}\r\n\r\nexport function getDataNow() {\r\n    return now\r\n}\r\n","<template>\r\n    <div v-if=\"easyFlowVisible\" style=\"height: calc(100vh);\">\r\n        <el-row>\r\n            <!---->\r\n            <el-col :span=\"24\">\r\n                <div class=\"ef-tooltar\">\r\n                    <el-input v-if=\"editing\" type=\"primary\" @blur=\"saveText\" v-model=\"data.name\"></el-input>\r\n                    <el-link v-else @click=\"startEditing\" type=\"primary\" :underline=\"false\">{{ data.name }}</el-link>\r\n                    <el-divider direction=\"vertical\"></el-divider>\r\n                    <el-button type=\"text\" icon=\"el-icon-delete\" size=\"large\" @click=\"deleteElement\"\r\n                        :disabled=\"!this.activeElement.type\"></el-button>\r\n                    <el-divider direction=\"vertical\"></el-divider>\r\n                    <el-button type=\"text\" icon=\"el-icon-download\" size=\"large\" @click=\"downloadData\"></el-button>\r\n                    <el-divider direction=\"vertical\"></el-divider>\r\n                    <el-button type=\"text\" icon=\"el-icon-plus\" size=\"large\" @click=\"zoomAdd\"></el-button>\r\n                    <el-divider direction=\"vertical\"></el-divider>\r\n                    <el-button type=\"text\" icon=\"el-icon-minus\" size=\"large\" @click=\"zoomSub\"></el-button>\r\n                    <div style=\"float: right;margin-right: 5px\">\r\n                        <el-button plain round :loading=\"exeState\" icon=\"el-icon-thumb\" @click=\"exeTaskFlow\"\r\n                            size=\"mini\"></el-button>\r\n                        <el-button plain round icon=\"el-icon-s-promotion\" class=\"pub-btn\" type=\"success\"\r\n                            @click=\"pubbTaskFlow\" size=\"mini\"></el-button>\r\n                        <el-button type=\"info\" plain round icon=\"el-icon-document\" @click=\"dataInfo\"\r\n                            size=\"mini\"></el-button>\r\n                        <!-- <el-button type=\"primary\" plain round @click=\"dataReloadA\" icon=\"el-icon-refresh\" size=\"mini\">A</el-button>\r\n                        <el-button type=\"primary\" plain round @click=\"dataReloadB\" icon=\"el-icon-refresh\" size=\"mini\">B</el-button>\r\n                        <el-button type=\"primary\" plain round @click=\"dataReloadC\" icon=\"el-icon-refresh\" size=\"mini\">C</el-button> -->\r\n                        <!-- <el-button type=\"primary\" plain round @click=\"dataReloadD\" icon=\"el-icon-refresh\"\r\n                            size=\"mini\"></el-button> -->\r\n                        <!-- <el-button type=\"primary\" plain round @click=\"dataReloadE\" icon=\"el-icon-refresh\" size=\"mini\"></el-button> -->\r\n                        <el-button type=\"info\" plain round icon=\"el-icon-document\" @click=\"openHelp\"\r\n                            size=\"mini\"></el-button>\r\n                    </div>\r\n                </div>\r\n            </el-col>\r\n        </el-row>\r\n        <div style=\"display: flex;height: calc(100% - 47px);\">\r\n            <div style=\"width: 230px;border-right: 1px solid #dce3e8;\">\r\n                <node-menu @addNode=\"addNode\" ref=\"nodeMenu\"></node-menu>\r\n            </div>\r\n\r\n            <div id=\"panzoom\">\r\n\r\n            </div>\r\n            <div id=\"efContainer\" ref=\"efContainer\" class=\"container\" v-flowDrag>\r\n                <template ref=\"efTemplate\" v-for=\"node in data.nodeList\">\r\n                    <flow-node :id=\"node.code\" :key=\"node.code\" :node=\"node\" :activeElement=\"activeElement\"\r\n                        @changeNodeSite=\"changeNodeSite\" @nodeRightMenu=\"nodeRightMenu\" @clickNode=\"clickNode\">\r\n                    </flow-node>\r\n                </template>\r\n                <!--  -->\r\n                <div style=\"position:absolute;top: 2000px;left: 2000px;\">&nbsp;</div>\r\n            </div>\r\n\r\n            <!--  -->\r\n            <div style=\"width: auto;border-left: 1px solid #dce3e8;background-color: #FBFBFB\">\r\n                    <flow-node-form ref=\"nodeForm\" @setLineLabel=\"setLineLabel\"\r\n                    @repaintEverything=\"repaintEverything\"></flow-node-form>\r\n            </div>\r\n        </div>\r\n        <!--  -->\r\n        <flow-info v-if=\"flowInfoVisible\" ref=\"flowInfo\" :data=\"data\"></flow-info>\r\n        <flow-help v-if=\"flowHelpVisible\" ref=\"flowHelp\"></flow-help>\r\n        <input style=\"display: none\" @keyup.delete=\"delFun\">\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport Panzoom from '@panzoom/panzoom'\r\nimport draggable from 'vuedraggable'\r\n// import { jsPlumb } from 'jsplumb'\r\n// jsplumb\r\nimport './jsplumb'\r\nimport { easyFlowMixin } from '@/components/ef/mixins'\r\nimport flowNode from '@/components/ef/node'\r\nimport nodeMenu from '@/components/ef/node_menu'\r\nimport FlowInfo from '@/components/ef/info'\r\nimport FlowHelp from '@/components/ef/help'\r\nimport FlowNodeForm from './node_form'\r\nimport { pubTaskFlow, findTaskFlowById, exeTaskFlow } from '@/api/flow';\r\nimport lodash from 'lodash'\r\nimport { getDataA } from './data_A'\r\nimport { getDataB } from './data_B'\r\nimport { getDataC } from './data_C'\r\nimport { getDataD } from './data_D'\r\nimport { getDataE } from './data_E'\r\nimport { ForceDirected } from './force-directed'\r\nimport { getDataNow } from './data_now'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            exeState: false,\r\n            editing: false,\r\n            fid: -1,\r\n            // jsPlumb \r\n            jsPlumb: null,\r\n            // \r\n            easyFlowVisible: true,\r\n            // \r\n            flowInfoVisible: false,\r\n            // \r\n            loadEasyFlowFinish: false,\r\n            flowHelpVisible: false,\r\n            // \r\n            data: {},\r\n            // \r\n            activeElement: {\r\n                //  node line\r\n                type: undefined,\r\n                // ID\r\n                nodeCode: undefined,\r\n                // ID\r\n                sourceId: undefined,\r\n                targetId: undefined\r\n            },\r\n            zoom: 0.5\r\n        }\r\n    },\r\n    // \r\n    mixins: [easyFlowMixin],\r\n    components: {\r\n        draggable, flowNode, nodeMenu, FlowInfo, FlowNodeForm, FlowHelp\r\n    },\r\n    directives: {\r\n        'flowDrag': {\r\n            bind(el, binding, vnode, oldNode) {\r\n                if (!binding) {\r\n                    return\r\n                }\r\n                el.onmousedown = (e) => {\r\n                    if (e.button == 2) {\r\n                        // \r\n                        return\r\n                    }\r\n                    //  \r\n                    let disX = e.clientX\r\n                    let disY = e.clientY\r\n                    el.style.cursor = 'move'\r\n\r\n                    document.onmousemove = function (e) {\r\n                        // \r\n                        e.preventDefault()\r\n                        const left = e.clientX - disX\r\n                        disX = e.clientX\r\n                        el.scrollLeft += -left\r\n\r\n                        const top = e.clientY - disY\r\n                        disY = e.clientY\r\n                        el.scrollTop += -top\r\n                    }\r\n\r\n                    document.onmouseup = function (e) {\r\n                        el.style.cursor = 'auto'\r\n                        document.onmousemove = null\r\n                        document.onmouseup = null\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n\r\n        //\r\n        const elem = document.getElementById('panzoom')\r\nconst panzoom = Panzoom(elem, {\r\n  maxScale: 5\r\n})\r\npanzoom.pan(10, 10)\r\npanzoom.zoom(2, { animate: true })\r\n\r\n        // // localStorage\r\n        // window.onbeforeunload = function (e) {\r\n        //         var storage = window.localStorage;\r\n        //         storage.clear()\r\n        //     }\r\n\r\n        let that = this\r\n        document.addEventListener(\"keydown\", function (event) {\r\n            if (event.key === \"Delete\") {\r\n                console.log(\"Delete key is pressed.\");\r\n                that.deleteElement()\r\n            }\r\n        });\r\n\r\n        this.jsPlumb = jsPlumb.getInstance()\r\n\r\n        let fidStorage = localStorage.getItem(\"fid\")\r\n\r\n        // \r\n        const queryString = window.location.search;\r\n        console.log('queryString:', queryString);\r\n        // \r\n        const queryParams = new URLSearchParams(queryString);\r\n\r\n        // \r\n        let fidSearch = queryParams.get('fid');\r\n        console.log('fidSearch:', fidSearch);\r\n        console.log('fidStorage:', fidStorage);\r\n\r\n\r\n\r\n        if (fidSearch != -1) {\r\n            this.getTaskFlowById(fidSearch)\r\n        } else {\r\n            this.$nextTick(() => {\r\n                this.data = getDataNow()\r\n                // A\r\n                this.dataReload(getDataNow())\r\n            })\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        startEditing() {\r\n            this.editing = true;\r\n            this.$nextTick(() => {\r\n                this.$refs.input.focus(); // \r\n            });\r\n        },\r\n        saveText() {\r\n            this.editing = false;\r\n            //  API \r\n        },\r\n        setLocationSearchFid(fid) {\r\n            window.location.search = \"?fid=\" + fid\r\n        },\r\n        getLocationSearchFid() {\r\n            // \r\n            const queryString = window.location.search;\r\n            console.log('queryString:', queryString);\r\n            // \r\n            const queryParams = new URLSearchParams(queryString);\r\n\r\n            console.log('queryParams:', queryParams);\r\n            // \r\n            return queryParams.get(\"fid\")\r\n        },\r\n\r\n        //\r\n        async pubbTaskFlow() {\r\n            try {\r\n                const response = await pubTaskFlow(this.data);\r\n                // \r\n                console.log('', response);\r\n                // \r\n                localStorage.setItem(\"fid\", response.Data.ID)\r\n                // this.setLocationSearchFid(response.Data.ID)\r\n\r\n                this.getTaskFlowById(response.Data.ID)\r\n\r\n                // this.getLocationSearchFid()\r\n                this.$notify({\r\n                    title: '',\r\n                    message: '',\r\n                    duration: 1000,\r\n                    type: 'success'\r\n                });\r\n\r\n            } catch (error) {\r\n                console.error('', error);\r\n                // \r\n            }\r\n        },\r\n\r\n        //\r\n        async exeTaskFlow() {\r\n            try {\r\n                const response = await exeTaskFlow(this.data);\r\n                // \r\n                console.log('', response);\r\n                // \r\n                this.$refs.nodeForm.activeName = \"second\"\r\n                this.exeState = true\r\n                this.$notify({\r\n                    title: '',\r\n                    duration: 1000,\r\n                    message: '',\r\n                    type: 'success'\r\n                });\r\n            } catch (error) {\r\n                console.error('', error);\r\n                // \r\n            }\r\n\r\n        },\r\n\r\n\r\n        //id\r\n        async getTaskFlowById(fid) {\r\n            try {\r\n                const response = await findTaskFlowById({ id: fid });\r\n                // \r\n                console.log('', response);\r\n                // \r\n\r\n                this.data = response.Data\r\n\r\n                this.$nextTick(() => {\r\n                    // A\r\n                    this.dataReload(this.data)\r\n                })\r\n\r\n            } catch (error) {\r\n                console.error('', error);\r\n                // \r\n            }\r\n        },\r\n\r\n\r\n        // \r\n        getUUID() {\r\n            return Math.random().toString(36).substr(3, 10)\r\n        },\r\n        jsPlumbInit() {\r\n            this.jsPlumb.ready(() => {\r\n                // \r\n                this.jsPlumb.importDefaults(this.jsplumbSetting)\r\n                // jsPlumb\r\n                this.jsPlumb.setSuspendDrawing(false, true);\r\n                // \r\n                this.loadEasyFlow()\r\n                // , https://www.cnblogs.com/ysx215/p/7615677.html\r\n                this.jsPlumb.bind('click', (conn, originalEvent) => {\r\n                    this.activeElement.type = 'line'\r\n                    this.activeElement.sourceId = conn.sourceId\r\n                    this.activeElement.targetId = conn.targetId\r\n                    this.$refs.nodeForm.lineInit({\r\n                        from: conn.sourceId,\r\n                        to: conn.targetId,\r\n                        label: conn.getLabel()\r\n                    })\r\n                })\r\n                // \r\n                this.jsPlumb.bind(\"connection\", (evt) => {\r\n\r\n                    console.log(\"evt.source.code\" + evt.source.code)\r\n                    console.log(\"evt.source.id\" + evt.source.id)\r\n                    let from = evt.source.id\r\n                    let to = evt.target.id\r\n                    if (this.loadEasyFlowFinish) {\r\n                        this.data.lineList.push({ from: from, to: to })\r\n                    }\r\n                })\r\n\r\n                // \r\n                this.jsPlumb.bind(\"connectionDetached\", (evt) => {\r\n                    this.deleteLine(evt.sourceId, evt.targetId)\r\n                })\r\n\r\n                // \r\n                this.jsPlumb.bind(\"connectionMoved\", (evt) => {\r\n                    this.changeLine(evt.originalSourceId, evt.originalTargetId)\r\n                })\r\n\r\n                // \r\n                this.jsPlumb.bind(\"contextmenu\", (evt) => {\r\n                    console.log('contextmenu', evt)\r\n                })\r\n\r\n                // \r\n                this.jsPlumb.bind(\"beforeDrop\", (evt) => {\r\n\r\n                    let from = evt.sourceId\r\n                    let to = evt.targetId\r\n                    if (from === to) {\r\n                        this.$notify.error('')\r\n                        return false\r\n                    }\r\n                    if (this.hasLine(from, to)) {\r\n                        this.$notify.error(',')\r\n                        return false\r\n                    }\r\n                    if (this.hashOppositeLine(from, to)) {\r\n                        this.$notify.error('');\r\n                        return false\r\n                    }\r\n                    this.$notify.success('')\r\n                    return true\r\n                })\r\n\r\n                // beforeDetach\r\n                this.jsPlumb.bind(\"beforeDetach\", (evt) => {\r\n                    console.log('beforeDetach', evt)\r\n                })\r\n                this.jsPlumb.setContainer(this.$refs.efContainer)\r\n            })\r\n        },\r\n        // \r\n        loadEasyFlow() {\r\n            // \r\n            console.log(\"----------\" + this.data.nodeList)\r\n            for (var i = 0; i < this.data.nodeList.length; i++) {\r\n                let node = this.data.nodeList[i]\r\n                // \r\n                this.jsPlumb.makeSource(node.code, lodash.merge(this.jsplumbSourceOptions, {}))\r\n                // // \r\n                this.jsPlumb.makeTarget(node.code, this.jsplumbTargetOptions)\r\n                if (!node.viewOnly) {\r\n                    this.jsPlumb.draggable(node.code, {\r\n                        containment: 'parent',\r\n                        stop: function (el) {\r\n                            // \r\n                            console.log(': ', el)\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n            // \r\n            console.log(\"----------\" + this.data.lineList)\r\n            for (var i = 0; i < this.data.lineList.length; i++) {\r\n                let line = this.data.lineList[i]\r\n                var connParam = {\r\n                    source: line.from,\r\n                    target: line.to,\r\n                    label: line.label ? line.label : '',\r\n                    connector: line.connector ? line.connector : '',\r\n                    anchors: line.anchors ? line.anchors : undefined,\r\n                    paintStyle: line.paintStyle ? line.paintStyle : undefined,\r\n                }\r\n                console.log(\"connParam\" + connParam)\r\n                this.jsPlumb.connect(connParam, this.jsplumbConnectOptions)\r\n            }\r\n            this.$nextTick(function () {\r\n                this.loadEasyFlowFinish = true\r\n            })\r\n        },\r\n        // \r\n        setLineLabel(from, to, label) {\r\n            var conn = this.jsPlumb.getConnections({\r\n                source: from,\r\n                target: to\r\n            })[0]\r\n            if (!label || label === '') {\r\n                conn.removeClass('flowLabel')\r\n                conn.addClass('emptyFlowLabel')\r\n            } else {\r\n                conn.addClass('flowLabel')\r\n            }\r\n            conn.setLabel({\r\n                label: label,\r\n            })\r\n            this.data.lineList.forEach(function (line) {\r\n                if (line.from == from && line.to == to) {\r\n                    line.label = label\r\n                }\r\n            })\r\n\r\n        },\r\n        // \r\n        deleteElement() {\r\n            if (this.activeElement.type === 'node') {\r\n                this.deleteNode(this.activeElement.nodeCode)\r\n            } else if (this.activeElement.type === 'line') {\r\n                this.$confirm('?', '', {\r\n                    confirmButtonText: '',\r\n                    cancelButtonText: '',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    var conn = this.jsPlumb.getConnections({\r\n                        source: this.activeElement.sourceId,\r\n                        target: this.activeElement.targetId\r\n                    })[0]\r\n                    this.jsPlumb.deleteConnection(conn)\r\n                }).catch(() => {\r\n                })\r\n            }\r\n        },\r\n        // \r\n        deleteLine(from, to) {\r\n            this.data.lineList = this.data.lineList.filter(function (line) {\r\n                if (line.from == from && line.to == to) {\r\n                    return false\r\n                }\r\n                return true\r\n            })\r\n        },\r\n        // \r\n        changeLine(oldFrom, oldTo) {\r\n            this.deleteLine(oldFrom, oldTo)\r\n        },\r\n        // \r\n        changeNodeSite(data) {\r\n            for (var i = 0; i < this.data.nodeList.length; i++) {\r\n                let node = this.data.nodeList[i]\r\n                if (node.code === data.nodeCode) {\r\n                    node.left = data.left\r\n                    node.top = data.top\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * \r\n         * @param evt\r\n         * @param nodeMenu \r\n         * @param mousePosition \r\n         */\r\n        addNode(evt, nodeMenu, mousePosition) {\r\n            var screenX = evt.originalEvent.clientX, screenY = evt.originalEvent.clientY\r\n            let efContainer = this.$refs.efContainer\r\n            var containerRect = efContainer.getBoundingClientRect()\r\n            var left = screenX, top = screenY\r\n            // \r\n            if (left < containerRect.x || left > containerRect.width + containerRect.x || top < containerRect.y || containerRect.y > containerRect.y + containerRect.height) {\r\n                this.$notify.error(\"\")\r\n                return\r\n            }\r\n            left = left - containerRect.x + efContainer.scrollLeft\r\n            top = top - containerRect.y + efContainer.scrollTop\r\n            // \r\n            left -= 85\r\n            top -= 16\r\n            var nodeCode = this.getUUID()\r\n            // \r\n            var origName = nodeMenu.name\r\n            var nodeName = origName\r\n            var index = 1\r\n            while (index < 10000) {\r\n                var repeat = false\r\n                for (var i = 0; i < this.data.nodeList.length; i++) {\r\n                    let node = this.data.nodeList[i]\r\n                    if (node.name === nodeName) {\r\n                        nodeName = origName + index\r\n                        repeat = true\r\n                    }\r\n                }\r\n                if (repeat) {\r\n                    index++\r\n                    continue\r\n                }\r\n                break\r\n            }\r\n            var node = {\r\n                code: nodeCode,\r\n                name: nodeName,\r\n                type: nodeMenu.type,\r\n                left: left + 'px',\r\n                top: top + 'px',\r\n                ico: nodeMenu.ico,\r\n                state: 'success'\r\n            }\r\n            /**\r\n             * \r\n             */\r\n            this.data.nodeList.push(node)\r\n            this.$nextTick(function () {\r\n                this.jsPlumb.makeSource(nodeCode, this.jsplumbSourceOptions)\r\n                this.jsPlumb.makeTarget(nodeCode, this.jsplumbTargetOptions)\r\n                this.jsPlumb.draggable(nodeCode, {\r\n                    containment: 'parent',\r\n                    stop: function (el) {\r\n                        // \r\n                        console.log(': ', el)\r\n                    }\r\n                })\r\n            })\r\n        },\r\n        /**\r\n         * \r\n         * @param nodeCode ID\r\n         */\r\n        deleteNode(nodeCode) {\r\n            this.$confirm('' + nodeCode + '?', '', {\r\n                confirmButtonText: '',\r\n                cancelButtonText: '',\r\n                type: 'warning',\r\n                closeOnClickModal: false\r\n            }).then(() => {\r\n                /**\r\n                 * \r\n                 */\r\n                this.data.nodeList = this.data.nodeList.filter(function (node) {\r\n                    if (node.code === nodeCode) {\r\n                        // \r\n                        // node.show = false\r\n                        return false\r\n                    }\r\n                    return true\r\n                })\r\n                this.$nextTick(function () {\r\n                    this.jsPlumb.removeAllEndpoints(nodeCode);\r\n                })\r\n            }).catch(() => {\r\n            })\r\n            return true\r\n        },\r\n        clickNode(nodeCode) {\r\n            this.activeElement.type = 'node'\r\n            this.activeElement.nodeCode = nodeCode\r\n            this.$refs.nodeForm.nodeInit(this.data, nodeCode)\r\n        },\r\n        // \r\n        hasLine(from, to) {\r\n            for (var i = 0; i < this.data.lineList.length; i++) {\r\n                var line = this.data.lineList[i]\r\n                if (line.from === from && line.to === to) {\r\n                    return true\r\n                }\r\n            }\r\n            return false\r\n        },\r\n        // \r\n        hashOppositeLine(from, to) {\r\n            return this.hasLine(to, from)\r\n        },\r\n        nodeRightMenu(nodeCode, evt) {\r\n            this.menu.show = true\r\n            this.menu.curNodeId = nodeCode\r\n            this.menu.left = evt.x + 'px'\r\n            this.menu.top = evt.y + 'px'\r\n        },\r\n        repaintEverything() {\r\n            this.jsPlumb.repaint()\r\n        },\r\n        // \r\n        dataInfo() {\r\n            this.flowInfoVisible = true\r\n            this.$nextTick(function () {\r\n                this.$refs.flowInfo.init()\r\n            })\r\n        },\r\n        pubdataInfo() {\r\n            this.flowInfoVisible = true\r\n            this.$nextTick(function () {\r\n                this.$refs.flowInfo.init()\r\n            })\r\n        },\r\n        // \r\n        dataReload(data) {\r\n            this.easyFlowVisible = false\r\n            // this.data.nodeList = []\r\n            // this.data.lineList = []\r\n            this.$nextTick(() => {\r\n                // data = lodash.cloneDeep(data)\r\n                this.easyFlowVisible = true\r\n                // this.data = data\r\n                this.$nextTick(() => {\r\n                    this.jsPlumb = jsPlumb.getInstance()\r\n                    this.$nextTick(() => {\r\n                        this.jsPlumbInit()\r\n                    })\r\n                })\r\n            })\r\n        },\r\n        // dataA\r\n        dataReloadA() {\r\n            this.dataReload(getDataA())\r\n        },\r\n        // dataB\r\n        dataReloadB() {\r\n            this.dataReload(getDataB())\r\n        },\r\n        // dataC\r\n        dataReloadC() {\r\n            this.dataReload(getDataC())\r\n        },\r\n        // dataD\r\n        dataReloadD() {\r\n            this.dataReload(getDataD())\r\n        },\r\n        // dataE\r\n        dataReloadE() {\r\n            let dataE = getDataE()\r\n            let tempData = lodash.cloneDeep(dataE)\r\n            let data = ForceDirected(tempData)\r\n            this.dataReload(data)\r\n            this.$message({\r\n                message: '',\r\n                type: 'warning'\r\n            });\r\n        },\r\n        zoomAdd() {\r\n            if (this.zoom >= 1) {\r\n                return\r\n            }\r\n            this.zoom = this.zoom + 0.1\r\n            this.$refs.efContainer.style.transform = `scale(${this.zoom})`\r\n            this.jsPlumb.setZoom(this.zoom)\r\n        },\r\n        zoomSub() {\r\n            if (this.zoom <= 0) {\r\n                return\r\n            }\r\n            this.zoom = this.zoom - 0.1\r\n            this.$refs.efContainer.style.transform = `scale(${this.zoom})`\r\n            this.jsPlumb.setZoom(this.zoom)\r\n        },\r\n        // \r\n        downloadData() {\r\n            this.$confirm('', '', {\r\n                confirmButtonText: '',\r\n                cancelButtonText: '',\r\n                type: 'warning',\r\n                closeOnClickModal: false\r\n            }).then(() => {\r\n                var datastr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(this.data, null, '\\t'));\r\n                var downloadAnchorNode = document.createElement('a')\r\n                downloadAnchorNode.setAttribute(\"href\", datastr);\r\n                downloadAnchorNode.setAttribute(\"download\", 'data.json')\r\n                downloadAnchorNode.click();\r\n                downloadAnchorNode.remove();\r\n                this.$notify.success(\",...\")\r\n            }).catch(() => {\r\n            })\r\n        },\r\n        openHelp() {\r\n            this.flowHelpVisible = true\r\n            this.$nextTick(function () {\r\n                this.$refs.flowHelp.init()\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n/**/\r\n::-webkit-scrollbar {\r\n    width: 6px;\r\n    height: 6px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    border-radius: 3px;\r\n    -webkit-box-shadow: inset 0 0 5px #a8a8a8a2; background: rgba(116, 113, 113, 0.082);\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./panel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./panel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./panel.vue?vue&type=template&id=35784710&\"\nimport script from \"./panel.vue?vue&type=script&lang=js&\"\nexport * from \"./panel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./panel.vue?vue&type=style&index=0&id=35784710&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n      <flow-panel></flow-panel>\n  </div>\n</template>\n\n<script>\n  import FlowPanel from './components/ef/panel'\n\n  export default {\n      name: 'App',\n      components: {\n          FlowPanel\n      }\n  }\n</script>\n","import mod from \"-!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=24c6f42f&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nimport ElementUI from 'element-ui'\nimport 'element-ui/lib/theme-chalk/index.css'\nimport '@/components/ef/index.css'\nVue.use(ElementUI, {size: 'small'})\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkkv_flow\"] = self[\"webpackChunkkv_flow\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(6525); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["Math","sgn","x","Vectors","subtract","v1","v2","y","dotProduct","square","v","sqrt","scale","s","maxRecursion","flatnessTolerance","pow","_distanceFromCurve","point","curve","candidates","w","_convertToBezier","degree","length","higherDegree","numSolutions","_findRoots","dist","t","i","_bezier","newDist","location","distance","_nearestPointOnCurve","td","c","d","cdTable","z","row","column","parseFloat","n","m","k","lb","max","ub","min","j","depth","left_count","right_count","left","right","left_t","right_t","_getCrossingCount","_isFlatEnough","_computeXIntercept","sign","old_sign","n_crossings","error","intercept_1","intercept_2","left_intercept","right_intercept","a","b","det","dInv","a1","b1","c1","a2","b2","c2","max_distance_above","max_distance_below","value","XLK","YLK","XNM","YNM","XMK","YMK","detInv","S","temp","_curveFunctionCache","_getCurveFunctions","order","fns","f_term","l_term","c_term","t_term","one_minus_t_term","_termFunc","terms","p","push","_pointOnPath","cc","_x","_y","_dist","p1","p2","_isPoint","_pointAlongPath","prev","tally","curLoc","direction","cur","abs","_length","_pointAlongPathFrom","_locationAlongPathFrom","_gradientAtPoint","slice","dy","dx","Infinity","atan","_gradientAtPointAlongPathFrom","_perpendicularToPathAt","_theta2","sin","cos","_lineIntersection","x1","y1","x2","y2","coeffs","_computeCoefficients","r","_cubicRoots","apply","intersections","t2","t3","_boxIntersection","h","_boundingBoxIntersection","boundingBox","_computeCoefficientsForAxis","axis","T","A","B","C","Q","R","D","th","acos","PI","jsBezier","this","distanceFromCurve","gradientAtPoint","gradientAtPointAlongCurveFrom","nearestPointOnCurve","pointOnCurve","pointAlongCurveFrom","perpendicularToCurveAt","locationAlongCurveFrom","getLength","lineIntersection","boxIntersection","boundingBoxIntersection","version","exports","call","window","root","Biltong","_isa","Object","prototype","toString","_pointHelper","fn","_gradient","gradient","_p1","_p2","_quadrant","normal","lineLength","quadrant","_segmentMultipliers","theta","intersects","r1","r2","encloses","allowSharedEdges","v3","v4","_inverseSegmentMultipliers","pointOnLine","fromPoint","toPoint","segmentMultiplier","perpendicularLineTo","theta2","_touch","view","target","pageX","pageY","screenX","screenY","clientX","clientY","Touch","identifier","_uuid","_touchList","list","Array","arguments","item","index","_touchAndList","matchesSelector","el","selector","ctx","parentNode","possibles","querySelectorAll","_gel","constructor","String","document","getElementById","_t","e","srcElement","_pi","obj","doCompute","path","indexOf","end","out","_one","_d","l","splice","guid","_store","event","g","__ta","__tauid","_unstore","__taExtra","_unbind","__taUnstore","_curryChildFilter","children","evt","split","_fn","pathInfo","registerExtraFunction","newFn","DefaultHandler","isTouchDevice","touchMap","tfn","_bind","getAttribute","setAttribute","SmartClickHandler","__taSmartClicks","down","__tad","_pageLocation","up","__tau","click","_tapProfiles","touches","taps","TapHandler","clickThreshold","dblClickThreshold","isMouseDevice","__taTapHandler","tt","tap","dbltap","contextmenu","downSelectors","finished","setTimeout","clearSingle","clearDouble","currentTarget","tc","_touchCount","eventId","hasOwnProperty","pLoop","meeHelper","type","__tamee","MouseEnterExitHandler","activeElements","over","mouseenter","mouseexit","relatedTarget","toElement","documentElement","iev","rv","navigator","appName","ua","userAgent","re","RegExp","exec","$1","isIELT9","_genLoc","prefix","ts","_touches","_getTouch","scrollLeft","scrollTop","_screenLocation","_clientLocation","idx","changedTouches","targetTouches","originalFn","addEventListener","attachEvent","key","_each","_el","removeEventListener","detachEvent","__taTouchProxy","Window","top","tagName","replace","random","Mottle","params","mouseEnterExitHandler","tapHandler","_smartClicks","smartClicks","_doBind","remove","removeChild","on","_c","_e","_f","off","trigger","originalEvent","payload","originalIsMouse","MouseEvent","eventToBind","bindingAMouseEvent","pl","sl","cl","_decorate","_evt","eventGenerators","touchList","init","initTouchEvent","initEvent","initMouseEvent","createEvent","ite","evtName","dispatchEvent","createEventObject","eventType","eventName","fireEvent","consume","doNotPreventDefault","stopPropagation","returnValue","preventDefault","pageLocation","setForceTouchEvents","setForceMouseEvents","_suggest","head","unshift","_vanquish","_difference","l1","l2","_isString","f","getOffsetRect","elem","box","getBoundingClientRect","body","docElem","pageYOffset","pageXOffset","clientTop","clientLeft","round","findDelegateElement","parentElement","childElement","currentParent","findMatchingSelector","availableSelectors","draggableId","filter","matches","exclude","filterExclude","DEFAULT_GRID_X","DEFAULT_GRID_Y","isIE9","_pl","_classes","delegatedDraggable","draggable","droppable","drag","selected","active","hover","noSelect","ghostProxy","clonedDrag","_defaultScope","_events","_devNull","_true","_foreach","from","_setDroppablesActive","dd","val","andHover","setActive","updatePosition","setHover","_consume","_defaultInputFilterSelector","_inputFilter","_katavorio","getInputFilterSelector","Super","css","scope","addClass","_class","uuid","enabled","setEnabled","isEnabled","toggleEnabled","setScope","scopes","addScope","removeScope","toggleScope","katavorio","TRUE","FALSE","Drag","rightButtonCanDrag","currentParentPosition","ghostParentPosition","ghostDx","ghostDy","downAt","posAtDown","pagePosAtDown","pageDelta","moving","initialScroll","consumeStartEvent","dragEl","clone","_multipleDrop","scroll","multipleDrop","isConstrained","useGhostProxy","cloneNode","elementToDrag","activeSelectorParams","ghostProxyParent","Date","getTime","constrain","snapThreshold","_snap","pos","gridX","gridY","thresholdX","thresholdY","_dx","floor","_dxl","_dxt","_dy","_dyl","_dyt","posses","posseRoles","toGrid","grid","tx","ty","snap","getPosition","snapped","setPosition","setUseGhostProxy","revertFunction","negativeFilter","allowNegative","_setConstrain","_constrainRect","_size","bind","containment","setConstrain","setRevert","revert","_assignId","_katavorioId","_filters","_testFilter","_setFilter","setFilter","_exclude","addFilter","removeFilter","clearAllFilters","canDrag","constrainRect","matchingDroppables","intersectingDroppables","addSelector","downListener","defaultPrevented","isNotRightClick","which","button","match","style","position","parent","appendChild","moveListener","upListener","markSelection","markPosses","_dispatch","consumeFilteredEvents","_continue","mark","abort","ignoreZoom","getZoom","moveBy","updateSelection","updatePosses","unbind","removeClass","unmark","unmarkSelection","unmarkPosses","stop","notifyPosseDragStop","getFilters","getDragElement","retrieveOriginalElement","listeners","events","start","beforeStart","ghostProxyOffsets","result","notifyStart","force","positions","sel","getSelection","dPos","finalPos","selection","andNotify","cs","size","getSize","getMatchingDroppables","dragClass","getConstrainingRectangle","notifySelectionDragStart","doNotCheckDroppables","offsetLeft","offsetTop","sort","_rankSort","retVal","drop","desiredLoc","cPos","gp","rect","pageRect","focusDropElement","pagePosition","canDrop","isHover","destroy","handle","Drop","rank","_activeClass","activeClass","_hoverClass","hoverClass","allowLoopback","_katavorioDragHover","Katavorio","katavorioParams","_selection","_selectionMap","_dragsByScope","_dropsByScope","_zoom","_reg","map","_obj","_unreg","_prepareParams","_m","_dd","_p","_mistletoe","existingDrag","_css","overrideCss","_scope","inputFilterSelector","setInputFilterSelector","o","_katavorioDrag","_katavorioDrop","select","deselect","_s","deselectAll","_posses","members","_posseAction","notifySelectionDragStop","setZoom","_scopeManip","kObj","_kObj","snapToGrid","getDragsForScope","getDropsForScope","_destroy","selIdx","_removeListener","elementRemoved","destroyDraggable","destroyDroppable","reset","_processOneSpec","_spec","dontAddExisting","posseId","id","posse","name","addToPosse","spec","setPosse","diff","removeFromPosse","TypeError","removeFromAllPosses","setPosseState","state","jsPlumbUtil","isArray","isNumber","isString","isBoolean","isNull","isObject","isDate","isFunction","isNamedFunction","isEmpty","merge","collations","overwrites","ar","cMap","oMap","inObj","q","term","lc","str","array","last","_getArray","a_1","functionChain","successValue","failValue","populate","model","values","functionPrefix","doNotExpandFunctions","getValue","fromString","substring","findWithFunction","removeWithFunction","addWithFunction","hashFunction","addToList","insertAtStart","suggest","insertAtHead","extend","child","_protoFn","_copyProtoChain","focus","proto","__proto__","_makeFn","protoFn","_oneSet","fastTrim","ws","test","charAt","each","mergeWithParents","parentAttribute","_def","_parent","def","overrides","mergeStrategy","d_1","_getDef","done","log","args","_i","logEnabled","console","msg","wrap","wrappedFunction","newFunction","returnOnThisValue","EventGenerator","_this","_listeners","eventsSuspended","tick","eventsToDieOn","queue","listener","__jsPlumb","fire","_gone","ret","shouldFireEvent","_drain","pop","eventOrListener","getListener","forEvent","setSuspendEvents","isSuspendEvents","silently","cleanupListeners","sizeElement","height","width","DEFAULT_OPTIONS","deriveAnchor","edge","ep","conn","bottom","ListManager","jsPlumbInstance","count","instance","lists","addList","options","listManager","removeList","scrollableLists","getSelector","_maybeUpdateParentList","source","jsPlumbListManager","dp","getInstanceIndex","join","List","_jsPlumbList","container","getContainer","_jsPlumbScrollHandler","anchor","deriveEndpoint","endpoint","_maybeUpdateDraggable","hasClass","recalculateOffsets","scrollHandler","elId","getId","_jsPlumbProxies","proxyConnection","endpoints","offsetHeight","unproxyConnection","revalidate","_ju","_timestamp","_updateHoverStyle","component","_jsPlumb","paintStyle","hoverPaintStyle","mergedHoverStyle","jsPlumb","fill","_updateAttachedElements","timestamp","sourceElement","affectedElements","getAttachedElements","_splitType","_mapType","typeId","_applyTypes","doNotRepaint","getDefaultType","getTypeDescriptor","defType","types","tid","getType","applyType","repaint","jsPlumbUIComponent","self","idPrefix","parameters","paintStyleInUse","beforeDetach","beforeDrop","overlayPlacements","Defaults","HoverClass","typeCache","cacheTypeItem","getCachedTypeItem","overlays","oo","defaultOverlayKeys","fo","convertToFullOverlaySpec","_defaultType","getDefaultScope","appendToDefaultType","create","isDetachAllowed","connection","isDropAllowed","sourceId","targetId","dropEndpoint","checkCondition","domListeners","setListenerComponent","_removeTypeCssHelper","typeIndex","cssClass","canvas","getParameter","setParameter","getParameters","setParameters","getClass","clazz","updateClasses","classesToAdd","classesToRemove","setType","clearTypes","reapplyTypes","hasType","addType","_cont","removeType","toggleType","setPaintStyle","setHoverPaintStyle","getPaintStyle","getHoverPaintStyle","ignoreAttachedElements","currentlyDragging","isHoverSuspended","method","isSuspendDrawing","recalc","_jsPlumbInstanceIndex","_defaults","Anchor","Anchors","ConnectionsDetachable","ConnectionOverlays","Connector","Container","DoNotThrowErrors","DragOptions","DropOptions","Endpoint","EndpointOverlays","Endpoints","EndpointStyle","EndpointStyles","EndpointHoverStyle","EndpointHoverStyles","HoverPaintStyle","LabelStyle","color","LogEnabled","Overlays","MaxConnections","PaintStyle","stroke","ReattachConnections","RenderMode","Scope","_connectionTypes","_endpointTypes","_currentInstance","_instanceIndex","_bb","_initialDefaults","_info","nodeType","text","getElement","_getId","repaintEverything","_container","_containerDelegations","unbindContainer","setContainer","moveParent","selectEndpoints","previousContainer","eventAliases","_oneDelegateHandler","componentType","jp","alias","_addOneDelegate","_oneDelegate","managedElements","initialized","importDefaults","restoreDefaults","connections","endpointsByElement","endpointsByUUID","offsets","offsetTimestamps","connectionBeingDragged","sizes","_suspendDrawing","_suspendedAt","DEFAULT_SCOPE","_curIdStamp","_idstamp","_appendElement","appendToRoot","_draw","element","ui","clearEdits","repaintEls","dm","getDragManager","getElementsForDraggable","_updateOffset","offset","anchorManager","redraw","_getEndpoint","_scopeMatch","e1","e2","s1","s2","_mergeOverrides","_prepareConnectionParams","referenceParams","sourceEndpoint","targetEndpoint","uuids","isFull","connectionType","connectorOverlays","connectorPointerEvents","_addEndpoint","anchors","endpointStyles","endpointStyle","endpointHoverStyles","endpointHoverStyle","addEndpoint","_oneElementDef","defs","matchType","newConnection","tep","epDef","label","newEndpoint","uniqueEndpoint","finalEndpoint","setDeleteOnEmpty","sourceEndpointDefinitions","targetEndpointDefinitions","_newConnection","connectionFunc","ConnectionType","getDefaultConnectionType","_newEndpoint","finaliseConnection","_finaliseConnection","con","isDetachable","initDraggable","jpc","doInformAnchorManager","suspendedEndpoint","pending","isTemporarySource","doNotFireConnectionEvent","eventArgs","endpointFunc","EndpointType","fireDetachEvent","elementId","_manage","headless","endpointAdded","_operation","func","ii","jj","_setVisible","alsoChangeEndpoints","setVisible","info","oidx","isVisible","_toggleVisible","changeEndpoints","_getCachedData","doNotCreateIfNotFound","undefined","setConnectionBeingDragged","isConnectionBeingDragged","getManagedElements","connectorClass","connectorOutlineClass","connectedClass","endpointClass","endpointConnectedClass","endpointFullClass","endpointDropAllowedClass","endpointDropForbiddenClass","overlayClass","draggingClass","elementDraggingClass","sourceElementDraggingClass","targetElementDraggingClass","endpointAnchorClassPrefix","hoverSourceClass","hoverTargetClass","dragSelectClass","Connectors","ConnectorRenderers","SVG","results","inputs","_ensureContainer","myOffset","paint","anchorLoc","compute","xy","wh","addEndpoints","animate","properties","animationSupported","del","stepFunction","animEvents","step","completeFunction","complete","doAnimate","conditionName","connect","stTypes","epDefs","_set","sid","sep","_st","cId","oldEndpoint","evtParams","originalSourceId","newSourceId","originalTargetId","newTargetId","addConnection","makeEndpoint","detachFromConnection","fireMoveEvent","setSource","sourceChanged","setTarget","updateOtherEndpoint","deleteEndpoint","object","dontUpdateHover","deleteAttachedObjects","deleteObject","deleteEveryEndpoint","_is","setSuspendDrawing","doFireEvent","connType","argIsConnection","connectionDetached","unregisterEndpoint","newEndpoints","IS_DETACH_ALLOWED","BEFORE_DETACH","CHECK_CONDITION","deleteConnection","cleanup","deleteEveryConnection","deletedCount","batch","deleteConnectionsForElement","endpointCount","connectionCount","unravelConnection","unravelEndpoint","doNotCleanup","_setOperation","_getOperation","setter","getter","prepareList","input","doNotGetIds","filterList","missingIsFalse","getConnections","flat","sources","targets","_addOne","ss","proxies","originalEp","_curryEach","executor","_curryGet","_makeCommonSelectHandler","get","setters","getters","_makeConnectionSelectHandler","common","setDetachable","setReattach","setConnector","delete","isReattach","_makeEndpointSelectHandler","setAnchor","noElementFilters","elements","either","sourceMatchExact","targetMatchExact","inner","_ep","noMatchSource","isSource","noMatchTarget","isTarget","getAllConnections","getEndpoint","getEndpoints","getDefaultEndpointType","Connection","draw","appendElement","_hoverSuspended","setHoverSuspended","hide","idstamp","candidate","can","offsetParent","_getContainerFromDefaults","manage","_transient","unmanage","getOffset","centerx","centery","updateOffset","AnchorManager","makeAnchor","pp","_a","specimen","newAnchor","getOrientation","DynamicAnchor","anchorParams","orientation","makeAnchors","makeDynamicAnchor","anchorSelector","selectorFilter","_instance","negate","ok","_makeElementDropHandler","elInfo","dropOptions","proxyComponent","_drop","EndpointDropHandler","targetCount","maxConnections","onDrop","unlock","isRedrop","suspendedElement","eps","deriveEndpointAndAnchorSpec","_mtNew","positionFinder","dropPosition","getUIPosition","elPosition","elSize","ap","constructorParams","maybeCleanup","dropEvent","dragEvents","_drag","de","_jsPlumbRelatedElement","initDroppable","makeTarget","_doOne","elid","_isJsPlumbGroup","createEndpoint","targetDef","unmakeTarget","doNotClearArrays","makeSource","aae","onMaxConnections","_del","stopEvent","dragEvent","dragOptions","existingStop","endpointAddedButNoDragYet","anchorDef","oldAnchor","oldConnection","mouseDownListener","sourceCount","elxy","getPositionOnElement","tempEndpointParams","_delTempEndpoint","extract","att","setDragFilter","unmakeSource","eldefs","unmakeEverySource","_getScope","_setScope","getScope","getSourceScope","getTargetScope","setSourceScope","setTargetScope","setDragScope","setDropScope","unmakeEveryTarget","_setEnabled","toggle","originalState","newState","_first","toggleSourceEnabled","isSourceEnabled","setSourceEnabled","toggleTargetEnabled","isTargetEnabled","setTargetEnabled","ready","_elEach","isIdAlready","updateOffsets","removeAllEndpoints","recurse","ebe","childNodes","_doRemove","clearFor","removeFloatingConnection","floatingConnections","removeElement","ae","empty","dontRemoveFocus","doNotUnbindInstanceEventListeners","removeAllGroups","removeGroupManager","doReset","_clearObject","clear","setDefaultScope","dontPrependDefault","bits","as","setId","newId","doNotSetAttribute","sConns","tConns","setElementId","setReferenceElement","changeId","_conns","epIdx","setDebugLog","debugLog","repaintAfterwards","curVal","getSuspendedAt","doNotRepaintAfterwards","_wasSuspended","doWhileSuspended","getCachedData","show","toggleVisible","addListener","registerFloatingConnection","getFloatingConnectionFor","registerConnectionType","to","registerConnectionTypes","registerEndpointType","registerEndpointTypes","typeDescriptor","setIdChanged","oldId","setParent","newParent","_dom","_id","_pdom","_pid","o1","o2","names","getFloatingAnchorIndex","isFloating","proxyEl","proxyElId","endpointGenerator","anchorGenerator","proxyEp","originalElementId","originalEndpoint","isProxyEndpoint","originalElement","getInstance","overrideFns","ovf","_jp","_internalLabelOverlayId","_makeLabelOverlay","_params","labelStyle","mergedParams","getRenderMode","Label","_processOverlay","_newOverlay","OverlayCapableJsPlumbUIComponent","overlayPositions","labelLocation","defaultLabelLocation","emptyLabelStyle","keep","existing","updateFrom","reattach","addOverlay","removeOverlay","overlay","getData","locationAttribute","labelLocationAttribute","loc","getOverlay","getOverlays","hideOverlay","hideOverlays","showOverlay","showOverlays","removeAllOverlays","overlayId","dontCleanup","removeOverlays","bgCanvas","isAppendedAtTopLevel","getLabel","lo","getLabelOverlay","setLabel","Function","setLocation","setAbsoluteOverlayPosition","getAbsoluteOverlayPosition","_clazzManip","action","dontUpdateOverlays","_makeConnectionDragHandler","placeholder","stopped","_ui","anchorPoint","getCurrentLocation","stopDrag","_makeDraggablePlaceholder","ipco","ips","createElement","_makeFloatingEndpoint","referenceAnchor","referenceCanvas","floatingAnchor","FloatingAnchor","reference","typeParameters","findConnectionToUseForDynamicAnchor","elementWithPrecedence","connectorStyle","connectorHoverStyle","connectorHoverClass","connector","connectorTooltip","visible","floatingEndpoint","inPlaceCopy","dragProxy","connectionCost","connectionsDirected","currentAnchorClass","deleteOnEmpty","_updateAnchorClass","oldAnchorClass","getCssClass","anchorClass","prepareAnchor","currentAnchor","setPreparedAnchor","continuousAnchorFactory","internalHover","add","prepareEndpoint","rm","endpointArgs","tooltip","setEndpoint","setPreparedEndpoint","reattachConnections","connectionsDetachable","detachable","dragAllowedWhenFull","detachFrom","setElement","parentId","curId","rehomeEndpoint","dragManager","makeInPlaceCopy","acc","inPlaceAnchor","hideOnDrag","connectorSelector","setStyle","connectorPaintStyle","dimensions","isDynamic","oIdx","oId","oInfo","oOffset","oWH","txy","twh","tElement","draggingInitialised","isDragSupported","placeholderInfo","existingJpc","existingJpcParams","_dragHandler","defaultOpts","startEvent","beforeStartEvent","beforeStartParams","startParams","beforeDrag","canvasElement","setAttributes","endpointToFloat","centerAnchor","_savedAnchor","data","anchorIdx","dragScope","getDragScope","suspendedElementId","suspendedElementType","referenceEndpoint","getDropEvent","deleteConnectionNow","floatingElement","floatingId","floatingIndex","fe","_forceReattach","_forceDetach","deleteAfterDragStop","visibility","anchorParamsToUse","_initDropTarget","isTransient","isDropSupported","overEvent","outEvent","dhParams","getDragObject","_jpc","bb","doNotChangeConnections","doNotNotifyOtherEndpoint","display","isConnectedTo","found","getConnectionCost","setConnectionCost","areConnectionsDirected","setConnectionsDirected","_elId","setDragAllowedWhenFull","allowed","equals","getUuid","computeAnchor","existingConnection","_doContinue","continueFunction","optionalData","aParam","originalSourceEndpoint","newSourceEndpoint","originalTargetEndpoint","newTargetEndpoint","_toDelete","mergeData","dontContinueFunction","makeConnector","renderMode","connectorName","connectorArgs","forComponent","_makeAnchor","_updateConnectedClass","_jsPlumbConnections","previousConnection","editorParams","lastPaintedAt","definition","eS","eT","deleteEndpointsOnEmpty","_detachable","_reattach","myInfo","myWH","otherInfo","otherOffset","otherWH","initialTimestamp","cost","directed","setData","_types","updateConnectedClass","typeMap","_connector","prepareConnector","setPreparedConnector","_anchors","informEndpoints","getUuids","getCost","setCost","isDirected","getConnector","connectorSpec","doNotChangeListenerComponent","previous","previousClasses","transfer","swap","tId","sId","tIdx","sIdx","sourceInfo","targetInfo","sE","tE","sAnchorP","tAnchorP","resetBounds","sourcePos","targetPos","sourceOrientation","targetOrientation","strokeWidth","overlayExtents","minX","minY","maxX","maxY","lineWidth","outlineWidth","extents","xmin","bounds","ymin","xmax","ymax","paintExtents","es","outlineStroke","ehs","u","drawEndpoints","replaceEndpoint","endpointDef","current","_idx","_new","_amEndpoints","continuousAnchorLocations","continuousAnchorOrientations","connectionsByElementId","anchorLists","placeAnchorsOnLine","desc","elementDimensions","elementPosition","horizontal","otherMultiplier","reverse","other","xp","yp","currySort","reverseAngles","leftSort","edgeSortFunctions","_sortHelper","_array","placeAnchors","_anchorLists","cd","sS","sO","placeSomeAnchors","unsortedConnections","isHorizontal","sc","_setAnchorLocation","anchorPos","weAreSource","weAreTarget","addFloatingConnection","doRegisterTarget","registerConnection","otherIndex","otherEndpoint","otherAnchor","isContinuous","removeEndpointFromAnchorLists","eId","connInfo","doNotRedraw","removeConnection","getConnectionsFor","getEndpointsFor","_updateAnchorList","aBoolean","otherElId","edgeId","connsToPaint","endpointsToPaint","exactIdx","firstMatchingElIdx","endpointId","listToAddTo","listToRemoveFrom","_continuousAnchorEdge","rIdx","insertIdx","sourceElId","oldTargetId","sIndex","tIndex","originalId","newElement","currentId","offsetToUI","doNotRecalcEndpoint","endpointConnections","connectionsToPaint","anchorsToUpdate","orientationCache","sourceContinuous","targetContinuous","oKey","sd","calculateOrientation","getDefaultFace","fc","ContinuousAnchor","faces","clockwise","availableFaces","opposites","clockwiseOptions","antiClockwiseOptions","secondBest","lastChoice","_currentFace","_lockedFace","X_AXIS_FACES","Y_AXIS_FACES","_lockedAxis","isRelocatable","isSnapOnRelocate","verifyEdge","isEdgeSupported","setCurrentFace","face","overrideLock","getCurrentFace","getSupportedFaces","af","lock","isLocked","lockCurrentAxis","unlockCurrentAxis","sourceAnchor","targetAnchor","Orientation","HORIZONTAL","VERTICAL","DIAGONAL","IDENTITY","axes","atan2","midpoints","dim","sf","tf","sourceEdge","targetEdge","userDefinedLocation","lastReturnValue","relocatable","setRelocatable","_relocatable","snapOnRelocate","locked","clearUserDefinedLocation","ox","oy","ao","getUserDefinedLocation","setUserDefinedLocation","ref","refCanvas","xDir","yDir","_lastResult","_endpoint","_convertAnchor","getAnchors","_curAnchor","_lastAnchor","_distance","cx","cy","ax","ay","acx","acy","_anchorSelector","minIdx","minDist","udl","setAnchorCoordinates","coords","_curryAnchor","fnInit","DynamicAnchors","AutoDefault","_curryContinuousAnchor","Continuous","pf","AnchorPositionFinders","gx","gy","mx","my","Perimeter","anchorCount","shape","Error","_circle","_path","segments","anchorsPerFace","_computeFace","fractionalLength","_shape","_rectangle","_shapes","points","tl","_rotate","amountInDegrees","da","rotation","_jg","Segments","AbstractSegment","findClosestPointOnPath","getBounds","Straight","m2","_recalc","getGradient","getCoordinates","setCoordinates","pointOnPath","absolute","_","pointAlongPathFrom","farAwayPoint","within","closest","_x1","_y1","fractionInSegment","_pointLiesBetween","_plb","_x2","_y2","m1","X","Y","Arc","_calcAngle","_calcAngleForLocation","segment","anticlockwise","sa","startAngle","endAngle","TWO_PI","ea","radius","ac","sweep","circumference","frac","VERY_SMALL_VALUE","gentleRound","ceil","angle","arcSpan","dir","startX","startY","Bezier","cp1x","cp1y","cp2x","cp2y","_translateLocation","_curve","SegmentRenderer","getPath","isFirstSegment","laf","AbstractComponent","AbstractConnector","totalLength","segmentProportions","segmentProportionalLengths","stub","sourceStub","targetStub","gap","sourceGap","targetGap","userProvidedSegments","paintInfo","getPathData","findSegmentForPoint","connectorLocation","_updateSegmentProportions","_findSegmentForLocation","inSegmentProportion","proportion","_addSegment","updateBounds","_clearSegments","setSegments","_segs","_prepareCompute","swapX","swapY","lw","so","oIndex","sx","sy","oProduct","xSpan","ySpan","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","opposite","perpendicular","orthogonal","sourceAxis","stubs","anchorOrientation","getSegments","segBounds","seg","_compute","addSegment","prepareCompute","maxStub","maxGap","AbstractEndpoint","Dot","defaultOffset","defaultInnerRadius","Rectangle","DOMElementEndpoint","displayElements","getDisplayElements","appendDisplayElement","Image","_onload","onload","src","url","img","deleted","widthToUse","heightToUse","setImage","_img","margin","padding","outline","actuallyPaint","Blank","background","Triangle","AbstractOverlay","endpointLoc","endpointLocation","incrementLocation","amount","getLocation","Arrow","foldback","computeMaxSize","elementCreated","currentConnectionPaintStyle","hxy","mid","tail","cxy","parseInt","fromLoc","__","PlainArrow","Diamond","_getDimensions","forceRefresh","cachedDimensions","getDimensions","AbstractDOMOverlay","detached","div","initialised","initiallyInvisible","webkitTransform","mozTransform","msTransform","oTransform","transform","absolutePosition","locToUse","minx","miny","clearCachedDimensions","containerExtents","Custom","GuideLines","tailLine","headLine","labelText","font","borderWidth","dStyle","borderStyle","border","update","lt","innerHTML","_jpi","GROUP_COLLAPSED_CLASS","GROUP_EXPANDED_CLASS","GROUP_CONTAINER_SELECTOR","ELEMENT_DRAGGABLE_EVENT","STOP","REVERT","GROUP_MANAGER","GROUP","GROUP_DRAG_SCOPE","EVT_CHILD_ADDED","EVT_CHILD_REMOVED","EVT_GROUP_ADDED","EVT_GROUP_REMOVED","EVT_EXPAND","EVT_COLLAPSE","EVT_GROUP_DRAG_STOP","EVT_CONNECTION_MOVED","EVT_INTERNAL_CONNECTION_DETACHED","CMD_REMOVE_ALL","CMD_ORPHAN_ALL","CMD_SHOW","CMD_HIDE","GroupManager","_managedGroups","_connectionSourceMap","_connectionTargetMap","_cleanupDetachedConnection","group","getMembers","connMap","addGroup","getEl","manager","_updateConnectionsForGroup","addToGroup","doNotFireEvent","getGroup","groupEl","currentGroup","_jsPlumbGroup","elpos","cpos","collapsed","getDragArea","updateConnectionsForGroup","handleDroppedConnections","_expandConnection","_collapseConnection","newPosition","revalidateParent","sourceGroup","removeFromGroup","groupId","getGroups","removeGroup","deleteMembers","manipulateDOM","expandGroup","newPositions","_groups","otherEl","shouldProxy","groupElId","getAnchor","collapseGroup","_collapseSet","conns","processed","oneSet","_expandSet","repaintGroup","refreshAllGroups","Group","ghost","orphan","prune","dropOverride","proxied","internal","endpointIndex","opts","overrideDrop","getGroupManager","els","_findParent","_isInsideParent","leftEdge","rightEdge","topEdge","bottomEdge","_orphan","_unbindDragHandlers","clearParent","_pruneOrOrphan","orphanedPosition","_revalidate","_bindDragHandlers","__el","targetGroup","dragArea","isAlreadyDraggable","doNotUpdateConnections","removeAll","orphanAll","orphanedPositions","dragParams","toggleGroup","mgr","getGroupFor","STRAIGHT","ARC","Flowchart","_super","midpoint","alwaysRespectStubs","lastx","lasty","cornerRadius","loopbackRadius","segmentDirections","lx","ly","segLength","_cloneArray","writeSegments","next","currentDirection","nextDirection","minSegLength","radiusToUse","sgny","sgnx","sgnEqual","commonStubCalculator","stubCalculators","pi","areInProximity","oss","oes","midx","midy","orientations","lineCalculators","sis","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","_so","_to","otherFlipped","stub1","stub2","segmentIndexes","startStub","otherStartStub","endStub","otherEndStub","extent","otherAxis","comparator","toUpperCase","_val","AbstractBezierConnector","showLoopback","curviness","proximityLimit","sp","tp","_w","_h","loopback","_computeBezier","majorAnchor","minorAnchor","getCurviness","_findControlPoint","sourceAnchorPosition","targetAnchorPosition","soo","too","_CP","_CP2","_sx","_sy","_tx","_ty","_segment","StateMachine","_controlPoint","_midx","_midy","svgAttributeMap","STROKE_DASHARRAY","DASHSTYLE","LINEAR_GRADIENT","RADIAL_GRADIENT","DEFS","FILL","STROKE","STROKE_WIDTH","STYLE","NONE","JSPLUMB_GRADIENT","LINE_WIDTH","ns","svg","_attr","node","attributes","_node","xmlns","createElementNS","_pos","_clearGradient","_updateGradient","uiComponent","gradientUnits","stops","styleToUse","stopColor","applyGradientTo","_applyStyles","parts","forEach","_appendAtIndex","insertBefore","attr","SvgComponent","pointerEventsSpec","renderer","originalArgs","svgParams","useDivWrapper","className","outlineStyle","outlineStrokeWidth","bgPath","SvgEndpoint","makeNode","updateNode","AbstractSvgArrowOverlay","superclass","makePath","isNaN","p1_1","p1_2","attachListeners","d1","d2","_jk","_getEventManager","_mottle","_getDragManager","category","getEventManager","scrollWidth","scrollHeight","relativeToRoot","_dragStart","_jsPlumbDragOptions","cont","_dragMove","_dragging","_dragStop","uip","dragEnded","_animProps","pName","DragManager","_draggables","_dlist","_delements","_elementsWithEndpoints","_draggablesForElements","register","parentOffset","_oneLevel","cEl","cid","cOff","childOffsetOverrides","domEl","cel","pid","pLoc","cLoc","endpointDeleted","ancestor","pId","currentChildLocation","childOffset","co","getDragAncestor","aid","_setClassName","cn","classList","baseVal","_getClassName","_classManip","curClasses","classes","screenLocation","clientLocation","tag","atts","attName","getRenderModes","contains","toggleClass","toAdd","toRemove","setClass","prop","getStyle","getComputedStyle","getPropertyValue","currentStyle","op","_maybeAdjustScroll","zoom","pst","psl","offsetWidth","getAbsolutePosition","setAbsolutePosition","animateFrom","animateOptions","getWidth","getHeight","_initDraggableIfNecessary","_oneEl","_me","mel","unbindDraggable","setDraggable","_draggableStates","setElementDraggable","toggleDraggable","isDraggable","_draggable","disabled","enctype","ldist","tdist","duration","steps","linc","tinc","_int","setInterval","clearInterval","unbindDroppable","isElementDraggable","oc","specs","addToDragSelection","removeFromDragSelection","clearDragSelection","callback","_do","readyState","render","_vm","_self","attrs","staticRenderFns","easyFlowVisible","staticStyle","staticClass","editing","saveText","$$v","$set","expression","startEditing","_v","activeElement","deleteElement","downloadData","zoomAdd","zoomSub","exeState","exeTaskFlow","pubbTaskFlow","dataInfo","openHelp","addNode","directives","rawName","_l","nodeList","code","changeNodeSite","nodeRightMenu","clickNode","setLineLabel","flowInfoVisible","flowHelpVisible","$event","_k","keyCode","delFun","easyFlowMixin","jsplumbSetting","DeleteEndpointsOnDetach","cursor","zIndex","jsplumbConnectOptions","jsplumbSourceOptions","jsplumbSourceOptions2","jsplumbTargetOptions","class","nodeContainerClass","nodeContainerStyle","nodeIcoClass","props","created","computed","nodeCode","ico","viewOnly","methods","$emit","$refs","menuList","menu","open","draggableOptions","move","subMenu","service","axios","baseURL","timeout","interceptors","request","use","config","Promise","reject","response","res","IsSuccess","Message","message","MessageBox","confirm","confirmButtonText","cancelButtonText","then","findTaskTemplateAll","mousePosition","activeNames","preventOnFilter","ghostClass","forceFallback","defaultOpeneds","nodeMenu","components","isFirefox","ondrop","layerX","nodes","Data","getMenuByType","nodeValue","dialogVisible","flowJsonData","require","mode","json","lineNumbers","codemirror","JSON","stringify","handleClick","activeName","second","stateList","save","line","saveLine","logs","mounted","Vue","VueNativeSock","format","$socket","onmessage","parse","Action","watch","$nextTick","scrollToBottom","logBox","nodeInit","cloneDeep","lineInit","Number","tab","findTaskFlowById","pubTaskFlow","dataA","lineList","getDataA","dataB","getDataB","dataC","getDataC","dataD","getDataD","dataE","getDataE","CANVAS_WIDTH","CANVAS_HEIGHT","mNodeList","mEdgeList","mDxMap","mDyMap","mNodeMap","ForceDirected","Edge","initialX","initialY","initialSize","calculateRepulsive","calculateTraction","updateCoordinates","distX","distY","ejectFactor","startNode","endNode","condenseFactor","eStartID","eEndID","maxt","maxty","now","getDataNow","fid","loadEasyFlowFinish","mixins","flowNode","FlowInfo","FlowNodeForm","FlowHelp","binding","vnode","oldNode","onmousedown","disX","disY","onmousemove","onmouseup","panzoom","Panzoom","maxScale","pan","that","fidStorage","localStorage","getItem","queryString","search","queryParams","URLSearchParams","fidSearch","getTaskFlowById","dataReload","setLocationSearchFid","getLocationSearchFid","setItem","ID","$notify","title","nodeForm","getUUID","substr","jsPlumbInit","loadEasyFlow","deleteLine","changeLine","hasLine","hashOppositeLine","success","efContainer","lodash","connParam","deleteNode","$confirm","catch","oldFrom","oldTo","containerRect","origName","nodeName","repeat","closeOnClickModal","curNodeId","flowInfo","pubdataInfo","dataReloadA","dataReloadB","dataReloadC","dataReloadD","dataReloadE","tempData","$message","datastr","encodeURIComponent","downloadAnchorNode","flowHelp","FlowPanel","productionTip","ElementUI","App","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","loaded","__webpack_modules__","deferred","O","chunkIds","priority","notFulfilled","fulfilled","keys","every","__esModule","defineProperty","enumerable","globalThis","Symbol","toStringTag","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}